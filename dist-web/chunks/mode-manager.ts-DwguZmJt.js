const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["chunks/core-ai-yFIunLTZ.js","chunks/vendor-zustand-BWsgwsXr.js","chunks/vendor-react-gmX1Lmvt.js","chunks/vendor-react-dom-Bkb6jJ_S.js","chunks/vendor-Vl2WtvH-.js","chunks/core-memory-DmK-uh9X.js","chunks/tradeStore-CHfkU4NA.js"])))=>i.map(i=>d[i]);
import{d as g,_ as d,i as f}from"./core-ai-yFIunLTZ.js";import{c as D}from"./vendor-zustand-BWsgwsXr.js";var E=Object.defineProperty,k=(r,e,t)=>e in r?E(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,A=(r,e,t)=>k(r,e+"",t);class S{constructor(){A(this,"cachedResult",null)}detectTorBrowser(){if(this.cachedResult)return this.cachedResult;const e=[];let t="low",o=!1;const i=navigator.userAgent;(i.includes("TorBrowser")||i.includes("Tor"))&&(e.push("user_agent"),t="high",o=!0),navigator.plugins.length===0&&navigator.mimeTypes.length===0&&(e.push("no_plugins"),t==="low"&&(t="medium"),!o&&e.length>=2&&(o=!0));const n=window.screen.width,a=window.screen.height;(n===1e3&&a===700||n===1e3&&a===740)&&(e.push("screen_dimensions"),t==="low"&&(t="medium"));const s=Intl.DateTimeFormat().resolvedOptions().timeZone;(s==="UTC"||s==="Etc/UTC")&&(e.push("timezone_utc"),t==="low"&&(t="medium"));try{const c=document.createElement("canvas"),u=c.getContext("webgl")||c.getContext("experimental-webgl");if(u){const p=u.getExtension("WEBGL_debug_renderer_info");if(p){const y=u.getParameter(p.UNMASKED_VENDOR_WEBGL),b=u.getParameter(p.UNMASKED_RENDERER_WEBGL);y&&b&&(y.includes("Mesa")||b.includes("Mesa"))&&(e.push("webgl_fingerprint"),t==="low"&&(t="medium"))}}}catch{}(window.tor||navigator.tor)&&(e.push("tor_api"),t="high",o=!0),this.checkTorService().then(c=>{c&&(e.push("tor_service"),t!=="high"&&(t="high"),o=!0,this.cachedResult={isTorBrowser:!0,confidence:"high",indicators:[...e],canEnableGhostMode:!0})}).catch(()=>{}),t==="high"&&(o=!0),t==="medium"&&e.length>=3&&(o=!0);const l={isTorBrowser:o,confidence:t,indicators:e,canEnableGhostMode:o&&t!=="low"};return this.cachedResult=l,l}async checkTorService(){try{return!1}catch{return!1}}canEnableGhostMode(){return this.detectTorBrowser().canEnableGhostMode}getConfidence(){return this.detectTorBrowser().confidence}clearCache(){this.cachedResult=null}}let m=null;function x(){return m||(m=new S),m}function T(){return x().detectTorBrowser()}var P=Object.defineProperty,C=(r,e,t)=>e in r?P(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,L=(r,e,t)=>C(r,e+"",t);class G{constructor(){L(this,"cachedCapabilities",null)}detectCapabilities(){if(this.cachedCapabilities)return this.cachedCapabilities;const e={hasWASM:this.detectWASM(),hasWebGL:this.detectWebGL(),hasWebGL2:this.detectWebGL2(),hasServiceWorker:this.detectServiceWorker(),hasIndexedDB:this.detectIndexedDB(),hasLocalStorage:this.detectLocalStorage(),ramEstimate:this.estimateRAM(),cpuCores:this.detectCPUCores(),isLowEnd:!1,isMobile:this.detectMobile(),isTablet:this.detectTablet(),isDesktop:this.detectDesktop(),userAgent:navigator.userAgent,platform:navigator.platform,screenWidth:window.screen.width,screenHeight:window.screen.height,pixelRatio:window.devicePixelRatio||1,connectionType:this.detectConnectionType()};return"getBattery"in navigator&&navigator.getBattery().then(t=>{e.batteryLevel=t.level,e.isCharging=t.charging}).catch(()=>{}),e.isLowEnd=this.isLowEndDevice(e),this.cachedCapabilities=e,e}detectWASM(){try{return typeof WebAssembly<"u"&&typeof WebAssembly.instantiate=="function"}catch{return!1}}detectWebGL(){try{const e=document.createElement("canvas");return!!(e.getContext("webgl")||e.getContext("experimental-webgl"))}catch{return!1}}detectWebGL2(){try{return!!document.createElement("canvas").getContext("webgl2")}catch{return!1}}detectServiceWorker(){return"serviceWorker"in navigator}detectIndexedDB(){try{return"indexedDB"in window&&!!window.indexedDB}catch{return!1}}detectLocalStorage(){try{const e="__redix_test__";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch{return!1}}estimateRAM(){if("deviceMemory"in navigator)return navigator.deviceMemory||4;const e=navigator.userAgent.toLowerCase();return this.detectMobile()||this.detectTablet()?e.includes("iphone 1")||e.includes("iphone 12")||e.includes("iphone 13")||e.includes("iphone 14")||e.includes("iphone 15")?6:e.includes("iphone")||e.includes("android")?4:2:8}detectCPUCores(){return navigator.hardwareConcurrency||2}isLowEndDevice(e){const t=e.ramEstimate||4,o=e.cpuCores||2,i=e.hasWASM!==!1;return!!(t<2||o<2||!i&&(e.isMobile||e.isTablet)||t<4&&o<4&&(e.isMobile||e.isTablet))}detectMobile(){const e=navigator.userAgent.toLowerCase();return/android|webos|iphone|ipod|blackberry|iemobile|opera mini/i.test(e)&&!this.detectTablet()}detectTablet(){const e=navigator.userAgent.toLowerCase(),t=(navigator.maxTouchPoints??0)>2;return!!(/ipad|android(?!.*mobile)|tablet|playbook|silk/i.test(e)||t&&/MacIntel/.test(navigator.platform))}detectDesktop(){return!this.detectMobile()&&!this.detectTablet()}detectConnectionType(){if("connection"in navigator){const e=navigator.connection||navigator.mozConnection||navigator.webkitConnection;if(e){const t=e.effectiveType;if(t==="slow-2g"||t==="2g")return"2g";if(t==="3g")return"3g";if(t==="4g")return"4g"}}return"unknown"}getRecommendedFeatures(e){const t=e||this.detectCapabilities();return{useWASMAI:t.hasWASM&&!t.isLowEnd,useCloudAI:!t.isLowEnd&&t.ramEstimate>=4,useDOMPooling:!0,useServiceWorker:t.hasServiceWorker&&!t.isLowEnd,maxTabs:t.isLowEnd?3:t.ramEstimate<4?5:10,enableAnimations:!t.isLowEnd&&t.ramEstimate>=4,enableWebGL:t.hasWebGL&&!t.isLowEnd}}clearCache(){this.cachedCapabilities=null}}var I=Object.defineProperty,R=(r,e,t)=>e in r?I(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,v=(r,e,t)=>R(r,typeof e!="symbol"?e+"":e,t);class B{constructor(){v(this,"config"),v(this,"torDetector"),v(this,"deviceDetector"),this.torDetector=new S,this.deviceDetector=new G;const e=T();this.config={enabled:!1,localAIOnly:!1,noCloudAPIs:!1,noStorage:!1,noScripts:!1,noTracking:!0,ephemeralSession:!1,torDetected:e.isTorBrowser,securityLevel:e.isTorBrowser?"maximum":"high"}}activateGhostMode(){document.documentElement.classList.add("ghost-mode"),document.documentElement.setAttribute("data-ghost-mode","true"),this.blockTracking(),console.log("ðŸ”’ Ghost Mode activated - Tracking blocked, functionality preserved"),console.log("ðŸ”’ Tor detected:",this.config.torDetected),console.log("ðŸ”’ Tracking blocked:",this.config.noTracking)}blockTracking(){const e=window.fetch;window.fetch=async function(...o){const i=typeof o[0]=="string"?o[0]:o[0]instanceof Request?o[0].url:"";return[/doubleclick\.net/i,/google-analytics\.com/i,/googletagmanager\.com/i,/facebook\.net/i,/facebook\.com\/tr/i,/analytics\./i,/tracking\./i,/adservice\./i,/ads\./i,/advertising\./i,/adserver\./i,/pixel\./i,/beacon\./i,/tracker\./i].some(a=>a.test(i))?Promise.reject(new Error("Tracking blocked by Ghost Mode")):e.apply(this,o)},new MutationObserver(o=>{o.forEach(i=>{i.addedNodes.forEach(n=>{if(n.nodeType===Node.ELEMENT_NODE){const a=n;if(a.tagName==="SCRIPT"){const s=a.src;s&&[/google-analytics\.com/i,/googletagmanager\.com/i,/facebook\.net/i,/analytics\./i,/tracking\./i].some(c=>c.test(s))&&a.remove()}if(a.tagName==="IFRAME"){const s=a.src;s&&[/doubleclick\.net/i,/google-analytics\.com/i,/facebook\.com/i,/ads\./i].some(c=>c.test(s))&&a.remove()}}})})}).observe(document,{childList:!0,subtree:!0})}enable(){if(this.config.enabled)return;const e=T();!e.isTorBrowser&&!confirm(`âš ï¸ Ghost Mode is most secure when running inside Tor Browser.

Without Tor Browser, some security features may be limited.

Enable Ghost Mode anyway?`)||(this.config.enabled=!0,this.config.securityLevel=e.isTorBrowser?"maximum":"high",this.activateGhostMode())}disable(){this.config.enabled&&(this.config.enabled=!1,this.config.securityLevel="standard",document.documentElement.classList.remove("ghost-mode"),document.documentElement.removeAttribute("data-ghost-mode"),console.log("ðŸ”“ Ghost Mode disabled"))}isEnabled(){return this.config.enabled}getConfig(){return{...this.config}}canUseCloudAPI(){return!this.config.enabled||!this.config.noCloudAPIs}canUseStorage(){return!this.config.enabled||!this.config.noStorage}canUseScripts(){return!this.config.enabled||!this.config.noScripts}getSecurityStatus(){if(!this.config.enabled)return"Standard security";const e=[];return this.config.torDetected&&e.push("ðŸ”’ Tor: Active"),this.config.localAIOnly&&e.push("ðŸ¤– AI: Local"),this.config.noTracking&&e.push("ðŸš« Tracking: Blocked"),this.config.ephemeralSession&&e.push("ðŸ’¨ Session: Ephemeral"),e.join(" | ")||"Ghost Mode: Active"}}let w=null;function _(){return w||(w=new B),w}function F(){return _().isEnabled()}const M={Browse:{id:"Browse",name:"Browse",icon:"Globe",description:"Default browsing with balanced privacy and performance.",privacyDefaults:{ghost:!1,proxy:"none",trackingProtection:!0},onActivate:async()=>{const{useAppStore:r}=await d(async()=>{const{useAppStore:t}=await import("./core-ai-yFIunLTZ.js").then(o=>o.Q);return{useAppStore:t}},__vite__mapDeps([0,1,2,3,4,5]));r.getState().setResearchPaneOpen(!1),r.getState().setMemorySidebarOpen(!1);const{useTradeStore:e}=await d(async()=>{const{useTradeStore:t}=await import("./tradeStore-CHfkU4NA.js");return{useTradeStore:t}},__vite__mapDeps([6,1,2,3,4,0,5]));e.getState().setSidebarOpen(!1),r.getState().graphDockOpen&&r.getState().toggleGraphDock()}},Research:{id:"Research",name:"Research",icon:"Search",description:"Deep research workflow with SuperMemory + agents.",defaultTools:["memory","agent","reader"],privacyDefaults:{ghost:!1,proxy:"none",trackingProtection:!0},aiContext:{prompt:"You are the Research Mode assistant. Provide structured answers with citations and highlight contradictions.",agentId:"research.agent"},onActivate:async()=>{const{useAppStore:r}=await d(async()=>{const{useAppStore:e}=await import("./core-ai-yFIunLTZ.js").then(t=>t.Q);return{useAppStore:e}},__vite__mapDeps([0,1,2,3,4,5]));r.getState().setMemorySidebarOpen(!0),r.getState().setResearchPaneOpen(!0)},onDeactivate:async()=>{const{useAppStore:r}=await d(async()=>{const{useAppStore:e}=await import("./core-ai-yFIunLTZ.js").then(t=>t.Q);return{useAppStore:e}},__vite__mapDeps([0,1,2,3,4,5]));r.getState().setResearchPaneOpen(!1)}},Trade:{id:"Trade",name:"Trade",icon:"TrendingUp",description:"Market intelligence with live charts, privacy defaults, and data firewalls.",defaultTools:["charts","sentiment","eco-balance"],privacyDefaults:{ghost:!0,proxy:"vpn",trackingProtection:!0},aiContext:{prompt:"You are the Trade Mode assistant. Provide price action, key levels, risk notes, and market context for trading queries.",agentId:"trade.agent"},onActivate:async()=>{const{useTradeStore:r}=await d(async()=>{const{useTradeStore:e}=await import("./tradeStore-CHfkU4NA.js");return{useTradeStore:e}},__vite__mapDeps([6,1,2,3,4,0,5]));r.getState().setSidebarOpen(!0)},onDeactivate:async()=>{const{useTradeStore:r}=await d(async()=>{const{useTradeStore:e}=await import("./tradeStore-CHfkU4NA.js");return{useTradeStore:e}},__vite__mapDeps([6,1,2,3,4,0,5]));r.getState().setSidebarOpen(!1)}},Games:{id:"Games",name:"Games",icon:"Gamepad",description:"Optimized for low-latency streaming and controller input.",privacyDefaults:{ghost:!1,proxy:"none",trackingProtection:!1}},Docs:{id:"Docs",name:"Docs",icon:"FileText",description:"Document authoring and summarization.",defaultTools:["editor","summarizer"],aiContext:{prompt:"You are the Docs Mode assistant. Summarize documents, extract key information, and help with documentation queries.",agentId:"docs.agent"}},Images:{id:"Images",name:"Images",icon:"Image",description:"Visual search and inspiration boards.",aiContext:{prompt:"You are the Images Mode assistant. Help users find and analyze images, create inspiration boards, and work with visual content.",agentId:"images.agent"}},Threats:{id:"Threats",name:"Threats",icon:"Shield",description:"Security analysis with network isolation.",privacyDefaults:{ghost:!0,proxy:"tor",trackingProtection:!0},defaultTools:["threat-intel","sandbox"],aiContext:{prompt:"You are the Threats Mode assistant. Analyze security threats, provide threat intelligence, and help with security analysis.",agentId:"threats.agent"}},GraphMind:{id:"GraphMind",name:"GraphMind",icon:"GitBranch",description:"Knowledge graph view of SuperMemory and research trails.",defaultTools:["graph"],aiContext:{prompt:"You are the GraphMind assistant. Help users explore their knowledge graph by identifying connections, relationships, and patterns in their SuperMemory.",agentId:"graphmind.agent"},onActivate:async()=>{const{useAppStore:r}=await d(async()=>{const{useAppStore:e}=await import("./core-ai-yFIunLTZ.js").then(t=>t.Q);return{useAppStore:e}},__vite__mapDeps([0,1,2,3,4,5]));r.getState().graphDockOpen||r.getState().toggleGraphDock()},onDeactivate:async()=>{const{useAppStore:r}=await d(async()=>{const{useAppStore:e}=await import("./core-ai-yFIunLTZ.js").then(t=>t.Q);return{useAppStore:e}},__vite__mapDeps([0,1,2,3,4,5]));r.getState().graphDockOpen&&r.getState().toggleGraphDock()}}},h=D((r,e)=>({currentMode:"Browse",previousMode:null,modes:M,loading:!1,async activateMode(t){const{currentMode:o,modes:i}=e();if(t===o)return;const n=i[t];if(n){r({loading:!0}),g({type:"redix:mode:activating",payload:{from:o,to:t},source:"mode-manager"});try{await i[o]?.onDeactivate?.(),await O(n),await n.onActivate?.(),r({previousMode:o,currentMode:t,loading:!1}),g({type:"redix:mode:activated",payload:{mode:t},source:"mode-manager"})}catch(a){console.error("[ModeManager] Failed to activate mode:",a),r({loading:!1}),g({type:"redix:mode:error",payload:{mode:t,error:a instanceof Error?a.message:String(a)},source:"mode-manager"})}}},registerMode(t){r(o=>({modes:{...o.modes,[t.id]:{...M[t.id],...t}}}))}}));async function O(r){const e=_();if(r.privacyDefaults?.ghost?e.enable():e.disable(),r.privacyDefaults?.proxy&&r.privacyDefaults.proxy!=="none")try{r.privacyDefaults.proxy==="tor"?await f.proxy.set({type:"socks5",host:"127.0.0.1",port:9050}):r.privacyDefaults.proxy==="vpn"&&await f.proxy.set({type:"socks5",host:"127.0.0.1",port:1080})}catch(t){console.warn("[ModeManager] Failed to apply proxy defaults:",t)}else try{await f.proxy.set({mode:"direct"})}catch(t){console.warn("[ModeManager] Failed to clear proxy:",t)}g({type:"redix:mode:privacy",payload:{mode:r.id,defaults:r.privacyDefaults},source:"mode-manager"})}const U={activate:r=>h.getState().activateMode(r),register:r=>h.getState().registerMode(r),getCurrent:()=>h.getState().modes[h.getState().currentMode]};export{U as M,T as d,_ as g,F as i};
//# sourceMappingURL=mode-manager.ts-DwguZmJt.js.map
