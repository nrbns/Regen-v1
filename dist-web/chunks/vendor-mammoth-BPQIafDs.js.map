{"version":3,"file":"vendor-mammoth-BPQIafDs.js","sources":["../../node_modules/mammoth/lib/promises.js","../../node_modules/mammoth/lib/documents.js","../../node_modules/mammoth/lib/results.js","../../node_modules/mammoth/lib/zipfile.js","../../node_modules/mammoth/lib/xml/nodes.js","../../node_modules/mammoth/lib/xml/xmldom.js","../../node_modules/mammoth/lib/xml/reader.js","../../node_modules/mammoth/lib/xml/writer.js","../../node_modules/mammoth/lib/xml/index.js","../../node_modules/mammoth/lib/docx/office-xml-reader.js","../../node_modules/mammoth/lib/transforms.js","../../node_modules/mammoth/lib/docx/uris.js","../../node_modules/mammoth/lib/docx/body-reader.js","../../node_modules/mammoth/lib/docx/document-xml-reader.js","../../node_modules/mammoth/lib/docx/relationships-reader.js","../../node_modules/mammoth/lib/docx/content-types-reader.js","../../node_modules/mammoth/lib/docx/numbering-xml.js","../../node_modules/mammoth/lib/docx/styles-reader.js","../../node_modules/mammoth/lib/docx/notes-reader.js","../../node_modules/mammoth/lib/docx/comments-reader.js","../../node_modules/mammoth/browser/docx/files.js","../../node_modules/mammoth/lib/docx/docx-reader.js","../../node_modules/mammoth/lib/docx/style-map.js","../../node_modules/mammoth/lib/html/ast.js","../../node_modules/mammoth/lib/html/simplify.js","../../node_modules/mammoth/lib/html/index.js","../../node_modules/mammoth/lib/styles/html-paths.js","../../node_modules/mammoth/lib/images.js","../../node_modules/mammoth/lib/writers/html-writer.js","../../node_modules/mammoth/lib/writers/markdown-writer.js","../../node_modules/mammoth/lib/writers/index.js","../../node_modules/mammoth/lib/document-to-html.js","../../node_modules/mammoth/lib/raw-text.js","../../node_modules/mammoth/lib/styles/document-matchers.js","../../node_modules/mammoth/lib/styles/parser/tokeniser.js","../../node_modules/mammoth/lib/style-reader.js","../../node_modules/mammoth/lib/options-reader.js","../../node_modules/mammoth/browser/unzip.js","../../node_modules/mammoth/lib/underline.js","../../node_modules/mammoth/lib/index.js"],"sourcesContent":["var _ = require(\"underscore\");\nvar bluebird = require(\"bluebird/js/release/promise\")();\n\nexports.defer = defer;\nexports.when = bluebird.resolve;\nexports.resolve = bluebird.resolve;\nexports.all = bluebird.all;\nexports.props = bluebird.props;\nexports.reject = bluebird.reject;\nexports.promisify = bluebird.promisify;\nexports.mapSeries = bluebird.mapSeries;\nexports.attempt = bluebird.attempt;\n\nexports.nfcall = function(func) {\n    var args = Array.prototype.slice.call(arguments, 1);\n    var promisedFunc = bluebird.promisify(func);\n    return promisedFunc.apply(null, args);\n};\n\nbluebird.prototype.fail = bluebird.prototype.caught;\n\nbluebird.prototype.also = function(func) {\n    return this.then(function(value) {\n        var returnValue = _.extend({}, value, func(value));\n        return bluebird.props(returnValue);\n    });\n};\n\nfunction defer() {\n    var resolve;\n    var reject;\n    var promise = new bluebird.Promise(function(resolveArg, rejectArg) {\n        resolve = resolveArg;\n        reject = rejectArg;\n    });\n\n    return {\n        resolve: resolve,\n        reject: reject,\n        promise: promise\n    };\n}\n","var _ = require(\"underscore\");\n\nvar types = exports.types = {\n    document: \"document\",\n    paragraph: \"paragraph\",\n    run: \"run\",\n    text: \"text\",\n    tab: \"tab\",\n    checkbox: \"checkbox\",\n    hyperlink: \"hyperlink\",\n    noteReference: \"noteReference\",\n    image: \"image\",\n    note: \"note\",\n    commentReference: \"commentReference\",\n    comment: \"comment\",\n    table: \"table\",\n    tableRow: \"tableRow\",\n    tableCell: \"tableCell\",\n    \"break\": \"break\",\n    bookmarkStart: \"bookmarkStart\"\n};\n\nfunction Document(children, options) {\n    options = options || {};\n    return {\n        type: types.document,\n        children: children,\n        notes: options.notes || new Notes({}),\n        comments: options.comments || []\n    };\n}\n\nfunction Paragraph(children, properties) {\n    properties = properties || {};\n    var indent = properties.indent || {};\n    return {\n        type: types.paragraph,\n        children: children,\n        styleId: properties.styleId || null,\n        styleName: properties.styleName || null,\n        numbering: properties.numbering || null,\n        alignment: properties.alignment || null,\n        indent: {\n            start: indent.start || null,\n            end: indent.end || null,\n            firstLine: indent.firstLine || null,\n            hanging: indent.hanging || null\n        }\n    };\n}\n\nfunction Run(children, properties) {\n    properties = properties || {};\n    return {\n        type: types.run,\n        children: children,\n        styleId: properties.styleId || null,\n        styleName: properties.styleName || null,\n        isBold: !!properties.isBold,\n        isUnderline: !!properties.isUnderline,\n        isItalic: !!properties.isItalic,\n        isStrikethrough: !!properties.isStrikethrough,\n        isAllCaps: !!properties.isAllCaps,\n        isSmallCaps: !!properties.isSmallCaps,\n        verticalAlignment: properties.verticalAlignment || verticalAlignment.baseline,\n        font: properties.font || null,\n        fontSize: properties.fontSize || null,\n        highlight: properties.highlight || null\n    };\n}\n\nvar verticalAlignment = {\n    baseline: \"baseline\",\n    superscript: \"superscript\",\n    subscript: \"subscript\"\n};\n\nfunction Text(value) {\n    return {\n        type: types.text,\n        value: value\n    };\n}\n\nfunction Tab() {\n    return {\n        type: types.tab\n    };\n}\n\nfunction Checkbox(options) {\n    return {\n        type: types.checkbox,\n        checked: options.checked\n    };\n}\n\nfunction Hyperlink(children, options) {\n    return {\n        type: types.hyperlink,\n        children: children,\n        href: options.href,\n        anchor: options.anchor,\n        targetFrame: options.targetFrame\n    };\n}\n\nfunction NoteReference(options) {\n    return {\n        type: types.noteReference,\n        noteType: options.noteType,\n        noteId: options.noteId\n    };\n}\n\nfunction Notes(notes) {\n    this._notes = _.indexBy(notes, function(note) {\n        return noteKey(note.noteType, note.noteId);\n    });\n}\n\nNotes.prototype.resolve = function(reference) {\n    return this.findNoteByKey(noteKey(reference.noteType, reference.noteId));\n};\n\nNotes.prototype.findNoteByKey = function(key) {\n    return this._notes[key] || null;\n};\n\nfunction Note(options) {\n    return {\n        type: types.note,\n        noteType: options.noteType,\n        noteId: options.noteId,\n        body: options.body\n    };\n}\n\nfunction commentReference(options) {\n    return {\n        type: types.commentReference,\n        commentId: options.commentId\n    };\n}\n\nfunction comment(options) {\n    return {\n        type: types.comment,\n        commentId: options.commentId,\n        body: options.body,\n        authorName: options.authorName,\n        authorInitials: options.authorInitials\n    };\n}\n\nfunction noteKey(noteType, id) {\n    return noteType + \"-\" + id;\n}\n\nfunction Image(options) {\n    return {\n        type: types.image,\n        // `read` is retained for backwards compatibility, but other read\n        // methods should be preferred.\n        read: function(encoding) {\n            if (encoding) {\n                return options.readImage(encoding);\n            } else {\n                return options.readImage().then(function(arrayBuffer) {\n                    return Buffer.from(arrayBuffer);\n                });\n            }\n        },\n        readAsArrayBuffer: function() {\n            return options.readImage();\n        },\n        readAsBase64String: function() {\n            return options.readImage(\"base64\");\n        },\n        readAsBuffer: function() {\n            return options.readImage().then(function(arrayBuffer) {\n                return Buffer.from(arrayBuffer);\n            });\n        },\n        altText: options.altText,\n        contentType: options.contentType\n    };\n}\n\nfunction Table(children, properties) {\n    properties = properties || {};\n    return {\n        type: types.table,\n        children: children,\n        styleId: properties.styleId || null,\n        styleName: properties.styleName || null\n    };\n}\n\nfunction TableRow(children, options) {\n    options = options || {};\n    return {\n        type: types.tableRow,\n        children: children,\n        isHeader: options.isHeader || false\n    };\n}\n\nfunction TableCell(children, options) {\n    options = options || {};\n    return {\n        type: types.tableCell,\n        children: children,\n        colSpan: options.colSpan == null ? 1 : options.colSpan,\n        rowSpan: options.rowSpan == null ? 1 : options.rowSpan\n    };\n}\n\nfunction Break(breakType) {\n    return {\n        type: types[\"break\"],\n        breakType: breakType\n    };\n}\n\nfunction BookmarkStart(options) {\n    return {\n        type: types.bookmarkStart,\n        name: options.name\n    };\n}\n\nexports.document = exports.Document = Document;\nexports.paragraph = exports.Paragraph = Paragraph;\nexports.run = exports.Run = Run;\nexports.text = exports.Text = Text;\nexports.tab = exports.Tab = Tab;\nexports.checkbox = exports.Checkbox = Checkbox;\nexports.Hyperlink = Hyperlink;\nexports.noteReference = exports.NoteReference = NoteReference;\nexports.Notes = Notes;\nexports.Note = Note;\nexports.commentReference = commentReference;\nexports.comment = comment;\nexports.Image = Image;\nexports.Table = Table;\nexports.TableRow = TableRow;\nexports.TableCell = TableCell;\nexports.lineBreak = Break(\"line\");\nexports.pageBreak = Break(\"page\");\nexports.columnBreak = Break(\"column\");\nexports.BookmarkStart = BookmarkStart;\n\nexports.verticalAlignment = verticalAlignment;\n","var _ = require(\"underscore\");\n\n\nexports.Result = Result;\nexports.success = success;\nexports.warning = warning;\nexports.error = error;\n\n\nfunction Result(value, messages) {\n    this.value = value;\n    this.messages = messages || [];\n}\n\nResult.prototype.map = function(func) {\n    return new Result(func(this.value), this.messages);\n};\n\nResult.prototype.flatMap = function(func) {\n    var funcResult = func(this.value);\n    return new Result(funcResult.value, combineMessages([this, funcResult]));\n};\n\nResult.prototype.flatMapThen = function(func) {\n    var that = this;\n    return func(this.value).then(function(otherResult) {\n        return new Result(otherResult.value, combineMessages([that, otherResult]));\n    });\n};\n\nResult.combine = function(results) {\n    var values = _.flatten(_.pluck(results, \"value\"));\n    var messages = combineMessages(results);\n    return new Result(values, messages);\n};\n\nfunction success(value) {\n    return new Result(value, []);\n}\n\nfunction warning(message) {\n    return {\n        type: \"warning\",\n        message: message\n    };\n}\n\nfunction error(exception) {\n    return {\n        type: \"error\",\n        message: exception.message,\n        error: exception\n    };\n}\n\nfunction combineMessages(results) {\n    var messages = [];\n    _.flatten(_.pluck(results, \"messages\"), true).forEach(function(message) {\n        if (!containsMessage(messages, message)) {\n            messages.push(message);\n        }\n    });\n    return messages;\n}\n\nfunction containsMessage(messages, message) {\n    return _.find(messages, isSameMessage.bind(null, message)) !== undefined;\n}\n\nfunction isSameMessage(first, second) {\n    return first.type === second.type && first.message === second.message;\n}\n","var base64js = require(\"base64-js\");\nvar JSZip = require(\"jszip\");\n\nexports.openArrayBuffer = openArrayBuffer;\nexports.splitPath = splitPath;\nexports.joinPath = joinPath;\n\nfunction openArrayBuffer(arrayBuffer) {\n    return JSZip.loadAsync(arrayBuffer).then(function(zipFile) {\n        function exists(name) {\n            return zipFile.file(name) !== null;\n        }\n\n        function read(name, encoding) {\n            return zipFile.file(name).async(\"uint8array\").then(function(array) {\n                if (encoding === \"base64\") {\n                    return base64js.fromByteArray(array);\n                } else if (encoding) {\n                    var decoder = new TextDecoder(encoding);\n                    return decoder.decode(array);\n                } else {\n                    return array;\n                }\n            });\n        }\n\n        function write(name, contents) {\n            zipFile.file(name, contents);\n        }\n\n        function toArrayBuffer() {\n            return zipFile.generateAsync({type: \"arraybuffer\"});\n        }\n\n        return {\n            exists: exists,\n            read: read,\n            write: write,\n            toArrayBuffer: toArrayBuffer\n        };\n    });\n}\n\nfunction splitPath(path) {\n    var lastIndex = path.lastIndexOf(\"/\");\n    if (lastIndex === -1) {\n        return {dirname: \"\", basename: path};\n    } else {\n        return {\n            dirname: path.substring(0, lastIndex),\n            basename: path.substring(lastIndex + 1)\n        };\n    }\n}\n\nfunction joinPath() {\n    var nonEmptyPaths = Array.prototype.filter.call(arguments, function(path) {\n        return path;\n    });\n\n    var relevantPaths = [];\n\n    nonEmptyPaths.forEach(function(path) {\n        if (/^\\//.test(path)) {\n            relevantPaths = [path];\n        } else {\n            relevantPaths.push(path);\n        }\n    });\n\n    return relevantPaths.join(\"/\");\n}\n","var _ = require(\"underscore\");\n\n\nexports.Element = Element;\nexports.element = function(name, attributes, children) {\n    return new Element(name, attributes, children);\n};\nexports.text = function(value) {\n    return {\n        type: \"text\",\n        value: value\n    };\n};\n\n\nvar emptyElement = exports.emptyElement = {\n    first: function() {\n        return null;\n    },\n    firstOrEmpty: function() {\n        return emptyElement;\n    },\n    attributes: {},\n    children: []\n};\n\nfunction Element(name, attributes, children) {\n    this.type = \"element\";\n    this.name = name;\n    this.attributes = attributes || {};\n    this.children = children || [];\n}\n\nElement.prototype.first = function(name) {\n    return _.find(this.children, function(child) {\n        return child.name === name;\n    });\n};\n\nElement.prototype.firstOrEmpty = function(name) {\n    return this.first(name) || emptyElement;\n};\n\nElement.prototype.getElementsByTagName = function(name) {\n    var elements = _.filter(this.children, function(child) {\n        return child.name === name;\n    });\n    return toElementList(elements);\n};\n\nElement.prototype.text = function() {\n    if (this.children.length === 0) {\n        return \"\";\n    } else if (this.children.length !== 1 || this.children[0].type !== \"text\") {\n        throw new Error(\"Not implemented\");\n    }\n    return this.children[0].value;\n};\n\nvar elementListPrototype = {\n    getElementsByTagName: function(name) {\n        return toElementList(_.flatten(this.map(function(element) {\n            return element.getElementsByTagName(name);\n        }, true)));\n    }\n};\n\nfunction toElementList(array) {\n    return _.extend(array, elementListPrototype);\n}\n","var xmldom = require(\"@xmldom/xmldom\");\nvar dom = require(\"@xmldom/xmldom/lib/dom\");\n\nfunction parseFromString(string) {\n    var error = null;\n\n    var domParser = new xmldom.DOMParser({\n        errorHandler: function(level, message) {\n            error = {level: level, message: message};\n        }\n    });\n\n    var document = domParser.parseFromString(string);\n\n    if (error === null) {\n        return document;\n    } else {\n        throw new Error(error.level + \": \" + error.message);\n    }\n}\n\nexports.parseFromString = parseFromString;\nexports.Node = dom.Node;\n","var promises = require(\"../promises\");\nvar _ = require(\"underscore\");\n\nvar xmldom = require(\"./xmldom\");\nvar nodes = require(\"./nodes\");\nvar Element = nodes.Element;\n\nexports.readString = readString;\n\nvar Node = xmldom.Node;\n\nfunction readString(xmlString, namespaceMap) {\n    namespaceMap = namespaceMap || {};\n\n    try {\n        var document = xmldom.parseFromString(xmlString, \"text/xml\");\n    } catch (error) {\n        return promises.reject(error);\n    }\n\n    if (document.documentElement.tagName === \"parsererror\") {\n        return promises.resolve(new Error(document.documentElement.textContent));\n    }\n\n    function convertNode(node) {\n        switch (node.nodeType) {\n        case Node.ELEMENT_NODE:\n            return convertElement(node);\n        case Node.TEXT_NODE:\n            return nodes.text(node.nodeValue);\n        }\n    }\n\n    function convertElement(element) {\n        var convertedName = convertName(element);\n\n        var convertedChildren = [];\n        _.forEach(element.childNodes, function(childNode) {\n            var convertedNode = convertNode(childNode);\n            if (convertedNode) {\n                convertedChildren.push(convertedNode);\n            }\n        });\n\n        var convertedAttributes = {};\n        _.forEach(element.attributes, function(attribute) {\n            convertedAttributes[convertName(attribute)] = attribute.value;\n        });\n\n        return new Element(convertedName, convertedAttributes, convertedChildren);\n    }\n\n    function convertName(node) {\n        if (node.namespaceURI) {\n            var mappedPrefix = namespaceMap[node.namespaceURI];\n            var prefix;\n            if (mappedPrefix) {\n                prefix = mappedPrefix + \":\";\n            } else {\n                prefix = \"{\" + node.namespaceURI + \"}\";\n            }\n            return prefix + node.localName;\n        } else {\n            return node.localName;\n        }\n    }\n\n    return promises.resolve(convertNode(document.documentElement));\n}\n","var _ = require(\"underscore\");\nvar xmlbuilder = require(\"xmlbuilder\");\n\n\nexports.writeString = writeString;\n\n\nfunction writeString(root, namespaces) {\n    var uriToPrefix = _.invert(namespaces);\n    \n    var nodeWriters = {\n        element: writeElement,\n        text: writeTextNode\n    };\n\n    function writeNode(builder, node) {\n        return nodeWriters[node.type](builder, node);\n    }\n\n    function writeElement(builder, element) {\n        var elementBuilder = builder.element(mapElementName(element.name), element.attributes);\n        element.children.forEach(function(child) {\n            writeNode(elementBuilder, child);\n        });\n    }\n    \n    function mapElementName(name) {\n        var longFormMatch = /^\\{(.*)\\}(.*)$/.exec(name);\n        if (longFormMatch) {\n            var prefix = uriToPrefix[longFormMatch[1]];\n            return prefix + (prefix === \"\" ? \"\" : \":\") + longFormMatch[2];\n        } else {\n            return name;\n        }\n    }\n    \n    function writeDocument(root) {\n        var builder = xmlbuilder\n            .create(mapElementName(root.name), {\n                version: '1.0',\n                encoding: 'UTF-8',\n                standalone: true\n            });\n        \n        _.forEach(namespaces, function(uri, prefix) {\n            var key = \"xmlns\" + (prefix === \"\" ? \"\" : \":\" + prefix);\n            builder.attribute(key, uri);\n        });\n        \n        root.children.forEach(function(child) {\n            writeNode(builder, child);\n        });\n        return builder.end();\n    }\n\n    return writeDocument(root);\n}\n\nfunction writeTextNode(builder, node) {\n    builder.text(node.value);\n}\n","var nodes = require(\"./nodes\");\n\nexports.Element = nodes.Element;\nexports.element = nodes.element;\nexports.emptyElement = nodes.emptyElement;\nexports.text = nodes.text;\nexports.readString = require(\"./reader\").readString;\nexports.writeString = require(\"./writer\").writeString;\n","var _ = require(\"underscore\");\n\nvar promises = require(\"../promises\");\nvar xml = require(\"../xml\");\n\n\nexports.read = read;\nexports.readXmlFromZipFile = readXmlFromZipFile;\n\nvar xmlNamespaceMap = {\n    // Transitional format\n    \"http://schemas.openxmlformats.org/wordprocessingml/2006/main\": \"w\",\n    \"http://schemas.openxmlformats.org/officeDocument/2006/relationships\": \"r\",\n    \"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\": \"wp\",\n    \"http://schemas.openxmlformats.org/drawingml/2006/main\": \"a\",\n    \"http://schemas.openxmlformats.org/drawingml/2006/picture\": \"pic\",\n\n    // Strict format\n    \"http://purl.oclc.org/ooxml/wordprocessingml/main\": \"w\",\n    \"http://purl.oclc.org/ooxml/officeDocument/relationships\": \"r\",\n    \"http://purl.oclc.org/ooxml/drawingml/wordprocessingDrawing\": \"wp\",\n    \"http://purl.oclc.org/ooxml/drawingml/main\": \"a\",\n    \"http://purl.oclc.org/ooxml/drawingml/picture\": \"pic\",\n\n    // Common\n    \"http://schemas.openxmlformats.org/package/2006/content-types\": \"content-types\",\n    \"http://schemas.openxmlformats.org/package/2006/relationships\": \"relationships\",\n    \"http://schemas.openxmlformats.org/markup-compatibility/2006\": \"mc\",\n    \"urn:schemas-microsoft-com:vml\": \"v\",\n    \"urn:schemas-microsoft-com:office:word\": \"office-word\",\n\n    // [MS-DOCX]: Word Extensions to the Office Open XML (.docx) File Format\n    // https://learn.microsoft.com/en-us/openspecs/office_standards/ms-docx/b839fe1f-e1ca-4fa6-8c26-5954d0abbccd\n    \"http://schemas.microsoft.com/office/word/2010/wordml\": \"wordml\"\n};\n\n\nfunction read(xmlString) {\n    return xml.readString(xmlString, xmlNamespaceMap)\n        .then(function(document) {\n            return collapseAlternateContent(document)[0];\n        });\n}\n\n\nfunction readXmlFromZipFile(docxFile, path) {\n    if (docxFile.exists(path)) {\n        return docxFile.read(path, \"utf-8\")\n            .then(stripUtf8Bom)\n            .then(read);\n    } else {\n        return promises.resolve(null);\n    }\n}\n\n\nfunction stripUtf8Bom(xmlString) {\n    return xmlString.replace(/^\\uFEFF/g, '');\n}\n\n\nfunction collapseAlternateContent(node) {\n    if (node.type === \"element\") {\n        if (node.name === \"mc:AlternateContent\") {\n            return node.firstOrEmpty(\"mc:Fallback\").children;\n        } else {\n            node.children = _.flatten(node.children.map(collapseAlternateContent, true));\n            return [node];\n        }\n    } else {\n        return [node];\n    }\n}\n","var _ = require(\"underscore\");\n\nexports.paragraph = paragraph;\nexports.run = run;\nexports._elements = elements;\nexports._elementsOfType = elementsOfType;\nexports.getDescendantsOfType = getDescendantsOfType;\nexports.getDescendants = getDescendants;\n\nfunction paragraph(transform) {\n    return elementsOfType(\"paragraph\", transform);\n}\n\nfunction run(transform) {\n    return elementsOfType(\"run\", transform);\n}\n\nfunction elementsOfType(elementType, transform) {\n    return elements(function(element) {\n        if (element.type === elementType) {\n            return transform(element);\n        } else {\n            return element;\n        }\n    });\n}\n\nfunction elements(transform) {\n    return function transformElement(element) {\n        if (element.children) {\n            var children = _.map(element.children, transformElement);\n            element = _.extend(element, {children: children});\n        }\n        return transform(element);\n    };\n}\n\n\nfunction getDescendantsOfType(element, type) {\n    return getDescendants(element).filter(function(descendant) {\n        return descendant.type === type;\n    });\n}\n\nfunction getDescendants(element) {\n    var descendants = [];\n\n    visitDescendants(element, function(descendant) {\n        descendants.push(descendant);\n    });\n\n    return descendants;\n}\n\nfunction visitDescendants(element, visit) {\n    if (element.children) {\n        element.children.forEach(function(child) {\n            visitDescendants(child, visit);\n            visit(child);\n        });\n    }\n}\n","exports.uriToZipEntryName = uriToZipEntryName;\nexports.replaceFragment = replaceFragment;\n\nfunction uriToZipEntryName(base, uri) {\n    if (uri.charAt(0) === \"/\") {\n        return uri.substr(1);\n    } else {\n        // In general, we should check first and second for trailing and leading slashes,\n        // but in our specific case this seems to be sufficient\n        return base + \"/\" + uri;\n    }\n}\n\n\nfunction replaceFragment(uri, fragment) {\n    var hashIndex = uri.indexOf(\"#\");\n    if (hashIndex !== -1) {\n        uri = uri.substring(0, hashIndex);\n    }\n    return uri + \"#\" + fragment;\n}\n","exports.createBodyReader = createBodyReader;\nexports._readNumberingProperties = readNumberingProperties;\n\nvar dingbatToUnicode = require(\"dingbat-to-unicode\");\nvar _ = require(\"underscore\");\n\nvar documents = require(\"../documents\");\nvar Result = require(\"../results\").Result;\nvar warning = require(\"../results\").warning;\nvar xml = require(\"../xml\");\nvar transforms = require(\"../transforms\");\nvar uris = require(\"./uris\");\n\nfunction createBodyReader(options) {\n    return {\n        readXmlElement: function(element) {\n            return new BodyReader(options).readXmlElement(element);\n        },\n        readXmlElements: function(elements) {\n            return new BodyReader(options).readXmlElements(elements);\n        }\n    };\n}\n\nfunction BodyReader(options) {\n    var complexFieldStack = [];\n    var currentInstrText = [];\n\n    // When a paragraph is marked as deleted, its contents should be combined\n    // with the following paragraph. See 17.13.5.15 del (Deleted Paragraph) of\n    // ECMA-376 4th edition Part 1.\n    var deletedParagraphContents = [];\n\n    var relationships = options.relationships;\n    var contentTypes = options.contentTypes;\n    var docxFile = options.docxFile;\n    var files = options.files;\n    var numbering = options.numbering;\n    var styles = options.styles;\n\n    function readXmlElements(elements) {\n        var results = elements.map(readXmlElement);\n        return combineResults(results);\n    }\n\n    function readXmlElement(element) {\n        if (element.type === \"element\") {\n            var handler = xmlElementReaders[element.name];\n            if (handler) {\n                return handler(element);\n            } else if (!Object.prototype.hasOwnProperty.call(ignoreElements, element.name)) {\n                var message = warning(\"An unrecognised element was ignored: \" + element.name);\n                return emptyResultWithMessages([message]);\n            }\n        }\n        return emptyResult();\n    }\n\n    function readParagraphProperties(element) {\n        return readParagraphStyle(element).map(function(style) {\n            return {\n                type: \"paragraphProperties\",\n                styleId: style.styleId,\n                styleName: style.name,\n                alignment: element.firstOrEmpty(\"w:jc\").attributes[\"w:val\"],\n                numbering: readNumberingProperties(style.styleId, element.firstOrEmpty(\"w:numPr\"), numbering),\n                indent: readParagraphIndent(element.firstOrEmpty(\"w:ind\"))\n            };\n        });\n    }\n\n    function readParagraphIndent(element) {\n        return {\n            start: element.attributes[\"w:start\"] || element.attributes[\"w:left\"],\n            end: element.attributes[\"w:end\"] || element.attributes[\"w:right\"],\n            firstLine: element.attributes[\"w:firstLine\"],\n            hanging: element.attributes[\"w:hanging\"]\n        };\n    }\n\n    function readRunProperties(element) {\n        return readRunStyle(element).map(function(style) {\n            var fontSizeString = element.firstOrEmpty(\"w:sz\").attributes[\"w:val\"];\n            // w:sz gives the font size in half points, so halve the value to get the size in points\n            var fontSize = /^[0-9]+$/.test(fontSizeString) ? parseInt(fontSizeString, 10) / 2 : null;\n\n            return {\n                type: \"runProperties\",\n                styleId: style.styleId,\n                styleName: style.name,\n                verticalAlignment: element.firstOrEmpty(\"w:vertAlign\").attributes[\"w:val\"],\n                font: element.firstOrEmpty(\"w:rFonts\").attributes[\"w:ascii\"],\n                fontSize: fontSize,\n                isBold: readBooleanElement(element.first(\"w:b\")),\n                isUnderline: readUnderline(element.first(\"w:u\")),\n                isItalic: readBooleanElement(element.first(\"w:i\")),\n                isStrikethrough: readBooleanElement(element.first(\"w:strike\")),\n                isAllCaps: readBooleanElement(element.first(\"w:caps\")),\n                isSmallCaps: readBooleanElement(element.first(\"w:smallCaps\")),\n                highlight: readHighlightValue(element.firstOrEmpty(\"w:highlight\").attributes[\"w:val\"])\n            };\n        });\n    }\n\n    function readUnderline(element) {\n        if (element) {\n            var value = element.attributes[\"w:val\"];\n            return value !== undefined && value !== \"false\" && value !== \"0\" && value !== \"none\";\n        } else {\n            return false;\n        }\n    }\n\n    function readBooleanElement(element) {\n        if (element) {\n            var value = element.attributes[\"w:val\"];\n            return value !== \"false\" && value !== \"0\";\n        } else {\n            return false;\n        }\n    }\n\n    function readBooleanAttributeValue(value) {\n        return value !== \"false\" && value !== \"0\";\n    }\n\n    function readHighlightValue(value) {\n        if (!value || value === \"none\") {\n            return null;\n        } else {\n            return value;\n        }\n    }\n\n    function readParagraphStyle(element) {\n        return readStyle(element, \"w:pStyle\", \"Paragraph\", styles.findParagraphStyleById);\n    }\n\n    function readRunStyle(element) {\n        return readStyle(element, \"w:rStyle\", \"Run\", styles.findCharacterStyleById);\n    }\n\n    function readTableStyle(element) {\n        return readStyle(element, \"w:tblStyle\", \"Table\", styles.findTableStyleById);\n    }\n\n    function readStyle(element, styleTagName, styleType, findStyleById) {\n        var messages = [];\n        var styleElement = element.first(styleTagName);\n        var styleId = null;\n        var name = null;\n        if (styleElement) {\n            styleId = styleElement.attributes[\"w:val\"];\n            if (styleId) {\n                var style = findStyleById(styleId);\n                if (style) {\n                    name = style.name;\n                } else {\n                    messages.push(undefinedStyleWarning(styleType, styleId));\n                }\n            }\n        }\n        return elementResultWithMessages({styleId: styleId, name: name}, messages);\n    }\n\n    function readFldChar(element) {\n        var type = element.attributes[\"w:fldCharType\"];\n        if (type === \"begin\") {\n            complexFieldStack.push({type: \"begin\", fldChar: element});\n            currentInstrText = [];\n        } else if (type === \"end\") {\n            var complexFieldEnd = complexFieldStack.pop();\n            if (complexFieldEnd.type === \"begin\") {\n                complexFieldEnd = parseCurrentInstrText(complexFieldEnd);\n            }\n            if (complexFieldEnd.type === \"checkbox\") {\n                return elementResult(documents.checkbox({\n                    checked: complexFieldEnd.checked\n                }));\n            }\n        } else if (type === \"separate\") {\n            var complexFieldSeparate = complexFieldStack.pop();\n            var complexField = parseCurrentInstrText(complexFieldSeparate);\n            complexFieldStack.push(complexField);\n        }\n        return emptyResult();\n    }\n\n    function currentHyperlinkOptions() {\n        var topHyperlink = _.last(complexFieldStack.filter(function(complexField) {\n            return complexField.type === \"hyperlink\";\n        }));\n        return topHyperlink ? topHyperlink.options : null;\n    }\n\n    function parseCurrentInstrText(complexField) {\n        return parseInstrText(\n            currentInstrText.join(''),\n            complexField.type === \"begin\"\n                ? complexField.fldChar\n                : xml.emptyElement\n        );\n    }\n\n    function parseInstrText(instrText, fldChar) {\n        var externalLinkResult = /\\s*HYPERLINK \"(.*)\"/.exec(instrText);\n        if (externalLinkResult) {\n            return {type: \"hyperlink\", options: {href: externalLinkResult[1]}};\n        }\n\n        var internalLinkResult = /\\s*HYPERLINK\\s+\\\\l\\s+\"(.*)\"/.exec(instrText);\n        if (internalLinkResult) {\n            return {type: \"hyperlink\", options: {anchor: internalLinkResult[1]}};\n        }\n\n        var checkboxResult = /\\s*FORMCHECKBOX\\s*/.exec(instrText);\n        if (checkboxResult) {\n            var checkboxElement = fldChar\n                .firstOrEmpty(\"w:ffData\")\n                .firstOrEmpty(\"w:checkBox\");\n            var checkedElement = checkboxElement.first(\"w:checked\");\n            var checked = checkedElement == null\n                ? readBooleanElement(checkboxElement.first(\"w:default\"))\n                : readBooleanElement(checkedElement);\n            return {type: \"checkbox\", checked: checked};\n        }\n\n        return {type: \"unknown\"};\n    }\n\n    function readInstrText(element) {\n        currentInstrText.push(element.text());\n        return emptyResult();\n    }\n\n    function readSymbol(element) {\n        // See 17.3.3.30 sym (Symbol Character) of ECMA-376 4th edition Part 1\n        var font = element.attributes[\"w:font\"];\n        var char = element.attributes[\"w:char\"];\n        var unicodeCharacter = dingbatToUnicode.hex(font, char);\n        if (unicodeCharacter == null && /^F0..$/.test(char)) {\n            unicodeCharacter = dingbatToUnicode.hex(font, char.substring(2));\n        }\n\n        if (unicodeCharacter == null) {\n            return emptyResultWithMessages([warning(\n                \"A w:sym element with an unsupported character was ignored: char \" +  char + \" in font \" + font\n            )]);\n        } else {\n            return elementResult(new documents.Text(unicodeCharacter.string));\n        }\n    }\n\n    function noteReferenceReader(noteType) {\n        return function(element) {\n            var noteId = element.attributes[\"w:id\"];\n            return elementResult(new documents.NoteReference({\n                noteType: noteType,\n                noteId: noteId\n            }));\n        };\n    }\n\n    function readCommentReference(element) {\n        return elementResult(documents.commentReference({\n            commentId: element.attributes[\"w:id\"]\n        }));\n    }\n\n    function readChildElements(element) {\n        return readXmlElements(element.children);\n    }\n\n    var xmlElementReaders = {\n        \"w:p\": function(element) {\n            var paragraphPropertiesElement = element.firstOrEmpty(\"w:pPr\");\n\n            var isDeleted = !!paragraphPropertiesElement\n                .firstOrEmpty(\"w:rPr\")\n                .first(\"w:del\");\n\n            if (isDeleted) {\n                element.children.forEach(function(child) {\n                    deletedParagraphContents.push(child);\n                });\n                return emptyResult();\n            } else {\n                var childrenXml = element.children;\n                if (deletedParagraphContents.length > 0) {\n                    childrenXml = deletedParagraphContents.concat(childrenXml);\n                    deletedParagraphContents = [];\n                }\n                return ReadResult.map(\n                    readParagraphProperties(paragraphPropertiesElement),\n                    readXmlElements(childrenXml),\n                    function(properties, children) {\n                        return new documents.Paragraph(children, properties);\n                    }\n                ).insertExtra();\n            }\n        },\n        \"w:r\": function(element) {\n            return ReadResult.map(\n                readRunProperties(element.firstOrEmpty(\"w:rPr\")),\n                readXmlElements(element.children),\n                function(properties, children) {\n                    var hyperlinkOptions = currentHyperlinkOptions();\n                    if (hyperlinkOptions !== null) {\n                        children = [new documents.Hyperlink(children, hyperlinkOptions)];\n                    }\n\n                    return new documents.Run(children, properties);\n                }\n            );\n        },\n        \"w:fldChar\": readFldChar,\n        \"w:instrText\": readInstrText,\n        \"w:t\": function(element) {\n            return elementResult(new documents.Text(element.text()));\n        },\n        \"w:tab\": function(element) {\n            return elementResult(new documents.Tab());\n        },\n        \"w:noBreakHyphen\": function() {\n            return elementResult(new documents.Text(\"\\u2011\"));\n        },\n        \"w:softHyphen\": function(element) {\n            return elementResult(new documents.Text(\"\\u00AD\"));\n        },\n        \"w:sym\": readSymbol,\n        \"w:hyperlink\": function(element) {\n            var relationshipId = element.attributes[\"r:id\"];\n            var anchor = element.attributes[\"w:anchor\"];\n            return readXmlElements(element.children).map(function(children) {\n                function create(options) {\n                    var targetFrame = element.attributes[\"w:tgtFrame\"] || null;\n\n                    return new documents.Hyperlink(\n                        children,\n                        _.extend({targetFrame: targetFrame}, options)\n                    );\n                }\n\n                if (relationshipId) {\n                    var href = relationships.findTargetByRelationshipId(relationshipId);\n                    if (anchor) {\n                        href = uris.replaceFragment(href, anchor);\n                    }\n                    return create({href: href});\n                } else if (anchor) {\n                    return create({anchor: anchor});\n                } else {\n                    return children;\n                }\n            });\n        },\n        \"w:tbl\": readTable,\n        \"w:tr\": readTableRow,\n        \"w:tc\": readTableCell,\n        \"w:footnoteReference\": noteReferenceReader(\"footnote\"),\n        \"w:endnoteReference\": noteReferenceReader(\"endnote\"),\n        \"w:commentReference\": readCommentReference,\n        \"w:br\": function(element) {\n            var breakType = element.attributes[\"w:type\"];\n            if (breakType == null || breakType === \"textWrapping\") {\n                return elementResult(documents.lineBreak);\n            } else if (breakType === \"page\") {\n                return elementResult(documents.pageBreak);\n            } else if (breakType === \"column\") {\n                return elementResult(documents.columnBreak);\n            } else {\n                return emptyResultWithMessages([warning(\"Unsupported break type: \" + breakType)]);\n            }\n        },\n        \"w:bookmarkStart\": function(element){\n            var name = element.attributes[\"w:name\"];\n            if (name === \"_GoBack\") {\n                return emptyResult();\n            } else {\n                return elementResult(new documents.BookmarkStart({name: name}));\n            }\n        },\n\n        \"mc:AlternateContent\": function(element) {\n            return readChildElements(element.firstOrEmpty(\"mc:Fallback\"));\n        },\n\n        \"w:sdt\": function(element) {\n            var contentResult = readXmlElements(element.firstOrEmpty(\"w:sdtContent\").children);\n            return contentResult.map(function(content) {\n                // From the WordML standard: https://learn.microsoft.com/en-us/openspecs/office_standards/ms-docx/3350cb64-931f-41f7-8824-f18b2568ce66\n                //\n                // > A CT_SdtCheckbox element that specifies that the parent\n                // > structured document tag is a checkbox when displayed in the\n                // > document. The parent structured document tag contents MUST\n                // > contain a single character and optionally an additional\n                // > character in a deleted run.\n\n                var checkbox = element\n                    .firstOrEmpty(\"w:sdtPr\")\n                    .first(\"wordml:checkbox\");\n\n                if (checkbox) {\n                    var checkedElement = checkbox.first(\"wordml:checked\");\n                    var isChecked = !!checkedElement && readBooleanAttributeValue(\n                        checkedElement.attributes[\"wordml:val\"]\n                    );\n                    var documentCheckbox = documents.checkbox({\n                        checked: isChecked\n                    });\n\n                    var hasCheckbox = false;\n                    var replacedContent = content.map(transforms._elementsOfType(\n                        documents.types.text,\n                        function(text) {\n                            if (text.value.length > 0 && !hasCheckbox) {\n                                hasCheckbox = true;\n                                return documentCheckbox;\n                            } else {\n                                return text;\n                            }\n                        }\n                    ));\n\n                    if (hasCheckbox) {\n                        return replacedContent;\n                    } else {\n                        return documentCheckbox;\n                    }\n\n                } else {\n                    return content;\n                }\n            });\n        },\n\n        \"w:ins\": readChildElements,\n        \"w:object\": readChildElements,\n        \"w:smartTag\": readChildElements,\n        \"w:drawing\": readChildElements,\n        \"w:pict\": function(element) {\n            return readChildElements(element).toExtra();\n        },\n        \"v:roundrect\": readChildElements,\n        \"v:shape\": readChildElements,\n        \"v:textbox\": readChildElements,\n        \"w:txbxContent\": readChildElements,\n        \"wp:inline\": readDrawingElement,\n        \"wp:anchor\": readDrawingElement,\n        \"v:imagedata\": readImageData,\n        \"v:group\": readChildElements,\n        \"v:rect\": readChildElements\n    };\n\n    return {\n        readXmlElement: readXmlElement,\n        readXmlElements: readXmlElements\n    };\n\n\n    function readTable(element) {\n        var propertiesResult = readTableProperties(element.firstOrEmpty(\"w:tblPr\"));\n        return readXmlElements(element.children)\n            .flatMap(calculateRowSpans)\n            .flatMap(function(children) {\n                return propertiesResult.map(function(properties) {\n                    return documents.Table(children, properties);\n                });\n            });\n    }\n\n    function readTableProperties(element) {\n        return readTableStyle(element).map(function(style) {\n            return {\n                styleId: style.styleId,\n                styleName: style.name\n            };\n        });\n    }\n\n    function readTableRow(element) {\n        var properties = element.firstOrEmpty(\"w:trPr\");\n\n        // See 17.13.5.12 del (Deleted Table Row) of ECMA-376 4th edition Part 1\n        var isDeleted = !!properties.first(\"w:del\");\n        if (isDeleted) {\n            return emptyResult();\n        }\n\n        var isHeader = !!properties.first(\"w:tblHeader\");\n        return readXmlElements(element.children).map(function(children) {\n            return documents.TableRow(children, {isHeader: isHeader});\n        });\n    }\n\n    function readTableCell(element) {\n        return readXmlElements(element.children).map(function(children) {\n            var properties = element.firstOrEmpty(\"w:tcPr\");\n\n            var gridSpan = properties.firstOrEmpty(\"w:gridSpan\").attributes[\"w:val\"];\n            var colSpan = gridSpan ? parseInt(gridSpan, 10) : 1;\n\n            var cell = documents.TableCell(children, {colSpan: colSpan});\n            cell._vMerge = readVMerge(properties);\n            return cell;\n        });\n    }\n\n    function readVMerge(properties) {\n        var element = properties.first(\"w:vMerge\");\n        if (element) {\n            var val = element.attributes[\"w:val\"];\n            return val === \"continue\" || !val;\n        } else {\n            return null;\n        }\n    }\n\n    function calculateRowSpans(rows) {\n        var unexpectedNonRows = _.any(rows, function(row) {\n            return row.type !== documents.types.tableRow;\n        });\n        if (unexpectedNonRows) {\n            removeVMergeProperties(rows);\n            return elementResultWithMessages(rows, [warning(\n                \"unexpected non-row element in table, cell merging may be incorrect\"\n            )]);\n        }\n        var unexpectedNonCells = _.any(rows, function(row) {\n            return _.any(row.children, function(cell) {\n                return cell.type !== documents.types.tableCell;\n            });\n        });\n        if (unexpectedNonCells) {\n            removeVMergeProperties(rows);\n            return elementResultWithMessages(rows, [warning(\n                \"unexpected non-cell element in table row, cell merging may be incorrect\"\n            )]);\n        }\n\n        var columns = {};\n\n        rows.forEach(function(row) {\n            var cellIndex = 0;\n            row.children.forEach(function(cell) {\n                if (cell._vMerge && columns[cellIndex]) {\n                    columns[cellIndex].rowSpan++;\n                } else {\n                    columns[cellIndex] = cell;\n                    cell._vMerge = false;\n                }\n                cellIndex += cell.colSpan;\n            });\n        });\n\n        rows.forEach(function(row) {\n            row.children = row.children.filter(function(cell) {\n                return !cell._vMerge;\n            });\n            row.children.forEach(function(cell) {\n                delete cell._vMerge;\n            });\n        });\n\n        return elementResult(rows);\n    }\n\n    function removeVMergeProperties(rows) {\n        rows.forEach(function(row) {\n            var cells = transforms.getDescendantsOfType(row, documents.types.tableCell);\n            cells.forEach(function(cell) {\n                delete cell._vMerge;\n            });\n        });\n    }\n\n    function readDrawingElement(element) {\n        var blips = element\n            .getElementsByTagName(\"a:graphic\")\n            .getElementsByTagName(\"a:graphicData\")\n            .getElementsByTagName(\"pic:pic\")\n            .getElementsByTagName(\"pic:blipFill\")\n            .getElementsByTagName(\"a:blip\");\n\n        return combineResults(blips.map(readBlip.bind(null, element)));\n    }\n\n    function readBlip(element, blip) {\n        var properties = element.first(\"wp:docPr\").attributes;\n        var altText = isBlank(properties.descr) ? properties.title : properties.descr;\n        var blipImageFile = findBlipImageFile(blip);\n        if (blipImageFile === null) {\n            return emptyResultWithMessages([warning(\"Could not find image file for a:blip element\")]);\n        } else {\n            return readImage(blipImageFile, altText);\n        }\n    }\n\n    function isBlank(value) {\n        return value == null || /^\\s*$/.test(value);\n    }\n\n    function findBlipImageFile(blip) {\n        var embedRelationshipId = blip.attributes[\"r:embed\"];\n        var linkRelationshipId = blip.attributes[\"r:link\"];\n        if (embedRelationshipId) {\n            return findEmbeddedImageFile(embedRelationshipId);\n        } else if (linkRelationshipId) {\n            var imagePath = relationships.findTargetByRelationshipId(linkRelationshipId);\n            return {\n                path: imagePath,\n                read: files.read.bind(files, imagePath)\n            };\n        } else {\n            return null;\n        }\n    }\n\n    function readImageData(element) {\n        var relationshipId = element.attributes['r:id'];\n\n        if (relationshipId) {\n            return readImage(\n                findEmbeddedImageFile(relationshipId),\n                element.attributes[\"o:title\"]);\n        } else {\n            return emptyResultWithMessages([warning(\"A v:imagedata element without a relationship ID was ignored\")]);\n        }\n    }\n\n    function findEmbeddedImageFile(relationshipId) {\n        var path = uris.uriToZipEntryName(\"word\", relationships.findTargetByRelationshipId(relationshipId));\n        return {\n            path: path,\n            read: docxFile.read.bind(docxFile, path)\n        };\n    }\n\n    function readImage(imageFile, altText) {\n        var contentType = contentTypes.findContentType(imageFile.path);\n\n        var image = documents.Image({\n            readImage: imageFile.read,\n            altText: altText,\n            contentType: contentType\n        });\n        var warnings = supportedImageTypes[contentType] ?\n            [] : warning(\"Image of type \" + contentType + \" is unlikely to display in web browsers\");\n        return elementResultWithMessages(image, warnings);\n    }\n\n    function undefinedStyleWarning(type, styleId) {\n        return warning(\n            type + \" style with ID \" + styleId + \" was referenced but not defined in the document\");\n    }\n}\n\n\nfunction readNumberingProperties(styleId, element, numbering) {\n    var level = element.firstOrEmpty(\"w:ilvl\").attributes[\"w:val\"];\n    var numId = element.firstOrEmpty(\"w:numId\").attributes[\"w:val\"];\n    if (level !== undefined && numId !== undefined) {\n        return numbering.findLevel(numId, level);\n    }\n\n    if (styleId != null) {\n        var levelByStyleId = numbering.findLevelByParagraphStyleId(styleId);\n        if (levelByStyleId != null) {\n            return levelByStyleId;\n        }\n    }\n\n    // Some malformed documents define numbering levels without an index, and\n    // reference the numbering using a w:numPr element without a w:ilvl child.\n    // To handle such cases, we assume a level of 0 as a fallback.\n    if (numId !== undefined) {\n        return numbering.findLevel(numId, \"0\");\n    }\n\n    return null;\n}\n\nvar supportedImageTypes = {\n    \"image/png\": true,\n    \"image/gif\": true,\n    \"image/jpeg\": true,\n    \"image/svg+xml\": true,\n    \"image/tiff\": true\n};\n\nvar ignoreElements = {\n    \"office-word:wrap\": true,\n    \"v:shadow\": true,\n    \"v:shapetype\": true,\n    \"w:annotationRef\": true,\n    \"w:bookmarkEnd\": true,\n    \"w:sectPr\": true,\n    \"w:proofErr\": true,\n    \"w:lastRenderedPageBreak\": true,\n    \"w:commentRangeStart\": true,\n    \"w:commentRangeEnd\": true,\n    \"w:del\": true,\n    \"w:footnoteRef\": true,\n    \"w:endnoteRef\": true,\n    \"w:pPr\": true,\n    \"w:rPr\": true,\n    \"w:tblPr\": true,\n    \"w:tblGrid\": true,\n    \"w:trPr\": true,\n    \"w:tcPr\": true\n};\n\nfunction emptyResultWithMessages(messages) {\n    return new ReadResult(null, null, messages);\n}\n\nfunction emptyResult() {\n    return new ReadResult(null);\n}\n\nfunction elementResult(element) {\n    return new ReadResult(element);\n}\n\nfunction elementResultWithMessages(element, messages) {\n    return new ReadResult(element, null, messages);\n}\n\nfunction ReadResult(element, extra, messages) {\n    this.value = element || [];\n    this.extra = extra || [];\n    this._result = new Result({\n        element: this.value,\n        extra: extra\n    }, messages);\n    this.messages = this._result.messages;\n}\n\nReadResult.prototype.toExtra = function() {\n    return new ReadResult(null, joinElements(this.extra, this.value), this.messages);\n};\n\nReadResult.prototype.insertExtra = function() {\n    var extra = this.extra;\n    if (extra && extra.length) {\n        return new ReadResult(joinElements(this.value, extra), null, this.messages);\n    } else {\n        return this;\n    }\n};\n\nReadResult.prototype.map = function(func) {\n    var result = this._result.map(function(value) {\n        return func(value.element);\n    });\n    return new ReadResult(result.value, this.extra, result.messages);\n};\n\nReadResult.prototype.flatMap = function(func) {\n    var result = this._result.flatMap(function(value) {\n        return func(value.element)._result;\n    });\n    return new ReadResult(result.value.element, joinElements(this.extra, result.value.extra), result.messages);\n};\n\nReadResult.map = function(first, second, func) {\n    return new ReadResult(\n        func(first.value, second.value),\n        joinElements(first.extra, second.extra),\n        first.messages.concat(second.messages)\n    );\n};\n\nfunction combineResults(results) {\n    var result = Result.combine(_.pluck(results, \"_result\"));\n    return new ReadResult(\n        _.flatten(_.pluck(result.value, \"element\")),\n        _.filter(_.flatten(_.pluck(result.value, \"extra\")), identity),\n        result.messages\n    );\n}\n\nfunction joinElements(first, second) {\n    return _.flatten([first, second]);\n}\n\nfunction identity(value) {\n    return value;\n}\n","exports.DocumentXmlReader = DocumentXmlReader;\n\nvar documents = require(\"../documents\");\nvar Result = require(\"../results\").Result;\n\n\nfunction DocumentXmlReader(options) {\n    var bodyReader = options.bodyReader;\n\n    function convertXmlToDocument(element) {\n        var body = element.first(\"w:body\");\n\n        if (body == null) {\n            throw new Error(\"Could not find the body element: are you sure this is a docx file?\");\n        }\n\n        var result = bodyReader.readXmlElements(body.children)\n            .map(function(children) {\n                return new documents.Document(children, {\n                    notes: options.notes,\n                    comments: options.comments\n                });\n            });\n        return new Result(result.value, result.messages);\n    }\n\n    return {\n        convertXmlToDocument: convertXmlToDocument\n    };\n}\n","exports.readRelationships = readRelationships;\nexports.defaultValue = new Relationships([]);\nexports.Relationships = Relationships;\n\n\nfunction readRelationships(element) {\n    var relationships = [];\n    element.children.forEach(function(child) {\n        if (child.name === \"relationships:Relationship\") {\n            var relationship = {\n                relationshipId: child.attributes.Id,\n                target: child.attributes.Target,\n                type: child.attributes.Type\n            };\n            relationships.push(relationship);\n        }\n    });\n    return new Relationships(relationships);\n}\n\nfunction Relationships(relationships) {\n    var targetsByRelationshipId = {};\n    relationships.forEach(function(relationship) {\n        targetsByRelationshipId[relationship.relationshipId] = relationship.target;\n    });\n\n    var targetsByType = {};\n    relationships.forEach(function(relationship) {\n        if (!targetsByType[relationship.type]) {\n            targetsByType[relationship.type] = [];\n        }\n        targetsByType[relationship.type].push(relationship.target);\n    });\n\n    return {\n        findTargetByRelationshipId: function(relationshipId) {\n            return targetsByRelationshipId[relationshipId];\n        },\n        findTargetsByType: function(type) {\n            return targetsByType[type] || [];\n        }\n    };\n}\n","exports.readContentTypesFromXml = readContentTypesFromXml;\n\nvar fallbackContentTypes = {\n    \"png\": \"png\",\n    \"gif\": \"gif\",\n    \"jpeg\": \"jpeg\",\n    \"jpg\": \"jpeg\",\n    \"tif\": \"tiff\",\n    \"tiff\": \"tiff\",\n    \"bmp\": \"bmp\"\n};\n\nexports.defaultContentTypes = contentTypes({}, {});\n\n\nfunction readContentTypesFromXml(element) {\n    var extensionDefaults = {};\n    var overrides = {};\n    \n    element.children.forEach(function(child) {\n        if (child.name === \"content-types:Default\") {\n            extensionDefaults[child.attributes.Extension] = child.attributes.ContentType;\n        }\n        if (child.name === \"content-types:Override\") {\n            var name = child.attributes.PartName;\n            if (name.charAt(0) === \"/\") {\n                name = name.substring(1);\n            }\n            overrides[name] = child.attributes.ContentType;\n        }\n    });\n    return contentTypes(overrides, extensionDefaults);\n}\n\nfunction contentTypes(overrides, extensionDefaults) {\n    return {\n        findContentType: function(path) {\n            var overrideContentType = overrides[path];\n            if (overrideContentType) {\n                return overrideContentType;\n            } else {\n                var pathParts = path.split(\".\");\n                var extension = pathParts[pathParts.length - 1];\n                if (extensionDefaults.hasOwnProperty(extension)) {\n                    return extensionDefaults[extension];\n                } else {\n                    var fallback = fallbackContentTypes[extension.toLowerCase()];\n                    if (fallback) {\n                        return \"image/\" + fallback;\n                    } else {\n                        return null;\n                    }\n                }\n            }\n        }\n    };\n    \n}\n","var _ = require(\"underscore\");\n\nexports.readNumberingXml = readNumberingXml;\nexports.Numbering = Numbering;\nexports.defaultNumbering = new Numbering({}, {});\n\nfunction Numbering(nums, abstractNums, styles) {\n    var allLevels = _.flatten(_.values(abstractNums).map(function(abstractNum) {\n        return _.values(abstractNum.levels);\n    }));\n\n    var levelsByParagraphStyleId = _.indexBy(\n        allLevels.filter(function(level) {\n            return level.paragraphStyleId != null;\n        }),\n        \"paragraphStyleId\"\n    );\n\n    function findLevel(numId, level) {\n        var num = nums[numId];\n        if (num) {\n            var abstractNum = abstractNums[num.abstractNumId];\n            if (!abstractNum) {\n                return null;\n            } else if (abstractNum.numStyleLink == null) {\n                return abstractNums[num.abstractNumId].levels[level];\n            } else {\n                var style = styles.findNumberingStyleById(abstractNum.numStyleLink);\n                return findLevel(style.numId, level);\n            }\n        } else {\n            return null;\n        }\n    }\n\n    function findLevelByParagraphStyleId(styleId) {\n        return levelsByParagraphStyleId[styleId] || null;\n    }\n\n    return {\n        findLevel: findLevel,\n        findLevelByParagraphStyleId: findLevelByParagraphStyleId\n    };\n}\n\nfunction readNumberingXml(root, options) {\n    if (!options || !options.styles) {\n        throw new Error(\"styles is missing\");\n    }\n\n    var abstractNums = readAbstractNums(root);\n    var nums = readNums(root, abstractNums);\n    return new Numbering(nums, abstractNums, options.styles);\n}\n\nfunction readAbstractNums(root) {\n    var abstractNums = {};\n    root.getElementsByTagName(\"w:abstractNum\").forEach(function(element) {\n        var id = element.attributes[\"w:abstractNumId\"];\n        abstractNums[id] = readAbstractNum(element);\n    });\n    return abstractNums;\n}\n\nfunction readAbstractNum(element) {\n    var levels = {};\n\n    // Some malformed documents define numbering levels without an index, and\n    // reference the numbering using a w:numPr element without a w:ilvl child.\n    // To handle such cases, we assume a level of 0 as a fallback.\n    var levelWithoutIndex = null;\n\n    element.getElementsByTagName(\"w:lvl\").forEach(function(levelElement) {\n        var levelIndex = levelElement.attributes[\"w:ilvl\"];\n        var numFmt = levelElement.firstOrEmpty(\"w:numFmt\").attributes[\"w:val\"];\n        var isOrdered = numFmt !== \"bullet\";\n        var paragraphStyleId = levelElement.firstOrEmpty(\"w:pStyle\").attributes[\"w:val\"];\n\n        if (levelIndex === undefined) {\n            levelWithoutIndex = {\n                isOrdered: isOrdered,\n                level: \"0\",\n                paragraphStyleId: paragraphStyleId\n            };\n        } else {\n            levels[levelIndex] = {\n                isOrdered: isOrdered,\n                level: levelIndex,\n                paragraphStyleId: paragraphStyleId\n            };\n        }\n    });\n\n    if (levelWithoutIndex !== null && levels[levelWithoutIndex.level] === undefined) {\n        levels[levelWithoutIndex.level] = levelWithoutIndex;\n    }\n\n    var numStyleLink = element.firstOrEmpty(\"w:numStyleLink\").attributes[\"w:val\"];\n\n    return {levels: levels, numStyleLink: numStyleLink};\n}\n\nfunction readNums(root) {\n    var nums = {};\n    root.getElementsByTagName(\"w:num\").forEach(function(element) {\n        var numId = element.attributes[\"w:numId\"];\n        var abstractNumId = element.first(\"w:abstractNumId\").attributes[\"w:val\"];\n        nums[numId] = {abstractNumId: abstractNumId};\n    });\n    return nums;\n}\n","exports.readStylesXml = readStylesXml;\nexports.Styles = Styles;\nexports.defaultStyles = new Styles({}, {});\n\nfunction Styles(paragraphStyles, characterStyles, tableStyles, numberingStyles) {\n    return {\n        findParagraphStyleById: function(styleId) {\n            return paragraphStyles[styleId];\n        },\n        findCharacterStyleById: function(styleId) {\n            return characterStyles[styleId];\n        },\n        findTableStyleById: function(styleId) {\n            return tableStyles[styleId];\n        },\n        findNumberingStyleById: function(styleId) {\n            return numberingStyles[styleId];\n        }\n    };\n}\n\nStyles.EMPTY = new Styles({}, {}, {}, {});\n\nfunction readStylesXml(root) {\n    var paragraphStyles = {};\n    var characterStyles = {};\n    var tableStyles = {};\n    var numberingStyles = {};\n\n    var styles = {\n        \"paragraph\": paragraphStyles,\n        \"character\": characterStyles,\n        \"table\": tableStyles,\n        \"numbering\": numberingStyles\n    };\n\n    root.getElementsByTagName(\"w:style\").forEach(function(styleElement) {\n        var style = readStyleElement(styleElement);\n        var styleSet = styles[style.type];\n\n        // Per 17.7.4.17 style (Style Definition) of ECMA-376 4th edition Part 1:\n        //\n        // > If multiple style definitions each declare the same value for their\n        // > styleId, then the first such instance shall keep its current\n        // > identifier with all other instances being reassigned in any manner\n        // > desired.\n        //\n        // For the purpose of conversion, there's no point holding onto styles\n        // with reassigned style IDs, so we ignore such style definitions.\n\n        if (styleSet && styleSet[style.styleId] === undefined) {\n            styleSet[style.styleId] = style;\n        }\n    });\n\n    return new Styles(paragraphStyles, characterStyles, tableStyles, numberingStyles);\n}\n\nfunction readStyleElement(styleElement) {\n    var type = styleElement.attributes[\"w:type\"];\n\n    if (type === \"numbering\") {\n        return readNumberingStyleElement(type, styleElement);\n    } else {\n        var styleId = readStyleId(styleElement);\n        var name = styleName(styleElement);\n        return {type: type, styleId: styleId, name: name};\n    }\n}\n\nfunction styleName(styleElement) {\n    var nameElement = styleElement.first(\"w:name\");\n    return nameElement ? nameElement.attributes[\"w:val\"] : null;\n}\n\nfunction readNumberingStyleElement(type, styleElement) {\n    var styleId = readStyleId(styleElement);\n\n    var numId = styleElement\n        .firstOrEmpty(\"w:pPr\")\n        .firstOrEmpty(\"w:numPr\")\n        .firstOrEmpty(\"w:numId\")\n        .attributes[\"w:val\"];\n\n    return {type: type, numId: numId, styleId: styleId};\n}\n\nfunction readStyleId(styleElement) {\n    return styleElement.attributes[\"w:styleId\"];\n}\n","var documents = require(\"../documents\");\nvar Result = require(\"../results\").Result;\n\nexports.createFootnotesReader = createReader.bind(this, \"footnote\");\nexports.createEndnotesReader = createReader.bind(this, \"endnote\");\n\nfunction createReader(noteType, bodyReader) {\n    function readNotesXml(element) {\n        return Result.combine(element.getElementsByTagName(\"w:\" + noteType)\n            .filter(isFootnoteElement)\n            .map(readFootnoteElement));\n    }\n\n    function isFootnoteElement(element) {\n        var type = element.attributes[\"w:type\"];\n        return type !== \"continuationSeparator\" && type !== \"separator\";\n    }\n\n    function readFootnoteElement(footnoteElement) {\n        var id = footnoteElement.attributes[\"w:id\"];\n        return bodyReader.readXmlElements(footnoteElement.children)\n            .map(function(body) {\n                return documents.Note({noteType: noteType, noteId: id, body: body});\n            });\n    }\n    \n    return readNotesXml;\n}\n","var documents = require(\"../documents\");\nvar Result = require(\"../results\").Result;\n\nfunction createCommentsReader(bodyReader) {\n    function readCommentsXml(element) {\n        return Result.combine(element.getElementsByTagName(\"w:comment\")\n            .map(readCommentElement));\n    }\n\n    function readCommentElement(element) {\n        var id = element.attributes[\"w:id\"];\n\n        function readOptionalAttribute(name) {\n            return (element.attributes[name] || \"\").trim() || null;\n        }\n\n        return bodyReader.readXmlElements(element.children)\n            .map(function(body) {\n                return documents.comment({\n                    commentId: id,\n                    body: body,\n                    authorName: readOptionalAttribute(\"w:author\"),\n                    authorInitials: readOptionalAttribute(\"w:initials\")\n                });\n            });\n    }\n    \n    return readCommentsXml;\n}\n\nexports.createCommentsReader = createCommentsReader;\n","var promises = require(\"../../lib/promises\");\n\nexports.Files = Files;\n\n\nfunction Files() {\n    function read(uri) {\n        return promises.reject(new Error(\"could not open external image: '\" + uri + \"'\\ncannot open linked files from a web browser\"));\n    }\n    \n    return {\n        read: read\n    };\n}\n","exports.read = read;\nexports._findPartPaths = findPartPaths;\n\nvar promises = require(\"../promises\");\nvar documents = require(\"../documents\");\nvar Result = require(\"../results\").Result;\nvar zipfile = require(\"../zipfile\");\n\nvar readXmlFromZipFile = require(\"./office-xml-reader\").readXmlFromZipFile;\nvar createBodyReader = require(\"./body-reader\").createBodyReader;\nvar DocumentXmlReader = require(\"./document-xml-reader\").DocumentXmlReader;\nvar relationshipsReader = require(\"./relationships-reader\");\nvar contentTypesReader = require(\"./content-types-reader\");\nvar numberingXml = require(\"./numbering-xml\");\nvar stylesReader = require(\"./styles-reader\");\nvar notesReader = require(\"./notes-reader\");\nvar commentsReader = require(\"./comments-reader\");\nvar Files = require(\"./files\").Files;\n\n\nfunction read(docxFile, input, options) {\n    input = input || {};\n    options = options || {};\n\n    var files = new Files({\n        externalFileAccess: options.externalFileAccess,\n        relativeToFile: input.path\n    });\n\n    return promises.props({\n        contentTypes: readContentTypesFromZipFile(docxFile),\n        partPaths: findPartPaths(docxFile),\n        docxFile: docxFile,\n        files: files\n    }).also(function(result) {\n        return {\n            styles: readStylesFromZipFile(docxFile, result.partPaths.styles)\n        };\n    }).also(function(result) {\n        return {\n            numbering: readNumberingFromZipFile(docxFile, result.partPaths.numbering, result.styles)\n        };\n    }).also(function(result) {\n        return {\n            footnotes: readXmlFileWithBody(result.partPaths.footnotes, result, function(bodyReader, xml) {\n                if (xml) {\n                    return notesReader.createFootnotesReader(bodyReader)(xml);\n                } else {\n                    return new Result([]);\n                }\n            }),\n            endnotes: readXmlFileWithBody(result.partPaths.endnotes, result, function(bodyReader, xml) {\n                if (xml) {\n                    return notesReader.createEndnotesReader(bodyReader)(xml);\n                } else {\n                    return new Result([]);\n                }\n            }),\n            comments: readXmlFileWithBody(result.partPaths.comments, result, function(bodyReader, xml) {\n                if (xml) {\n                    return commentsReader.createCommentsReader(bodyReader)(xml);\n                } else {\n                    return new Result([]);\n                }\n            })\n        };\n    }).also(function(result) {\n        return {\n            notes: result.footnotes.flatMap(function(footnotes) {\n                return result.endnotes.map(function(endnotes) {\n                    return new documents.Notes(footnotes.concat(endnotes));\n                });\n            })\n        };\n    }).then(function(result) {\n        return readXmlFileWithBody(result.partPaths.mainDocument, result, function(bodyReader, xml) {\n            return result.notes.flatMap(function(notes) {\n                return result.comments.flatMap(function(comments) {\n                    var reader = new DocumentXmlReader({\n                        bodyReader: bodyReader,\n                        notes: notes,\n                        comments: comments\n                    });\n                    return reader.convertXmlToDocument(xml);\n                });\n            });\n        });\n    });\n}\n\nfunction findPartPaths(docxFile) {\n    return readPackageRelationships(docxFile).then(function(packageRelationships) {\n        var mainDocumentPath = findPartPath({\n            docxFile: docxFile,\n            relationships: packageRelationships,\n            relationshipType: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\",\n            basePath: \"\",\n            fallbackPath: \"word/document.xml\"\n        });\n\n        if (!docxFile.exists(mainDocumentPath)) {\n            throw new Error(\"Could not find main document part. Are you sure this is a valid .docx file?\");\n        }\n\n        return xmlFileReader({\n            filename: relationshipsFilename(mainDocumentPath),\n            readElement: relationshipsReader.readRelationships,\n            defaultValue: relationshipsReader.defaultValue\n        })(docxFile).then(function(documentRelationships) {\n            function findPartRelatedToMainDocument(name) {\n                return findPartPath({\n                    docxFile: docxFile,\n                    relationships: documentRelationships,\n                    relationshipType: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/\" + name,\n                    basePath: zipfile.splitPath(mainDocumentPath).dirname,\n                    fallbackPath: \"word/\" + name + \".xml\"\n                });\n            }\n\n            return {\n                mainDocument: mainDocumentPath,\n                comments: findPartRelatedToMainDocument(\"comments\"),\n                endnotes: findPartRelatedToMainDocument(\"endnotes\"),\n                footnotes: findPartRelatedToMainDocument(\"footnotes\"),\n                numbering: findPartRelatedToMainDocument(\"numbering\"),\n                styles: findPartRelatedToMainDocument(\"styles\")\n            };\n        });\n    });\n}\n\nfunction findPartPath(options) {\n    var docxFile = options.docxFile;\n    var relationships = options.relationships;\n    var relationshipType = options.relationshipType;\n    var basePath = options.basePath;\n    var fallbackPath = options.fallbackPath;\n\n    var targets = relationships.findTargetsByType(relationshipType);\n    var normalisedTargets = targets.map(function(target) {\n        return stripPrefix(zipfile.joinPath(basePath, target), \"/\");\n    });\n    var validTargets = normalisedTargets.filter(function(target) {\n        return docxFile.exists(target);\n    });\n    if (validTargets.length === 0) {\n        return fallbackPath;\n    } else {\n        return validTargets[0];\n    }\n}\n\nfunction stripPrefix(value, prefix) {\n    if (value.substring(0, prefix.length) === prefix) {\n        return value.substring(prefix.length);\n    } else {\n        return value;\n    }\n}\n\nfunction xmlFileReader(options) {\n    return function(zipFile) {\n        return readXmlFromZipFile(zipFile, options.filename)\n            .then(function(element) {\n                return element ? options.readElement(element) : options.defaultValue;\n            });\n    };\n}\n\nfunction readXmlFileWithBody(filename, options, func) {\n    var readRelationshipsFromZipFile = xmlFileReader({\n        filename: relationshipsFilename(filename),\n        readElement: relationshipsReader.readRelationships,\n        defaultValue: relationshipsReader.defaultValue\n    });\n\n    return readRelationshipsFromZipFile(options.docxFile).then(function(relationships) {\n        var bodyReader = new createBodyReader({\n            relationships: relationships,\n            contentTypes: options.contentTypes,\n            docxFile: options.docxFile,\n            numbering: options.numbering,\n            styles: options.styles,\n            files: options.files\n        });\n        return readXmlFromZipFile(options.docxFile, filename)\n            .then(function(xml) {\n                return func(bodyReader, xml);\n            });\n    });\n}\n\nfunction relationshipsFilename(filename) {\n    var split = zipfile.splitPath(filename);\n    return zipfile.joinPath(split.dirname, \"_rels\", split.basename + \".rels\");\n}\n\nvar readContentTypesFromZipFile = xmlFileReader({\n    filename: \"[Content_Types].xml\",\n    readElement: contentTypesReader.readContentTypesFromXml,\n    defaultValue: contentTypesReader.defaultContentTypes\n});\n\nfunction readNumberingFromZipFile(zipFile, path, styles) {\n    return xmlFileReader({\n        filename: path,\n        readElement: function(element) {\n            return numberingXml.readNumberingXml(element, {styles: styles});\n        },\n        defaultValue: numberingXml.defaultNumbering\n    })(zipFile);\n}\n\nfunction readStylesFromZipFile(zipFile, path) {\n    return xmlFileReader({\n        filename: path,\n        readElement: stylesReader.readStylesXml,\n        defaultValue: stylesReader.defaultStyles\n    })(zipFile);\n}\n\nvar readPackageRelationships = xmlFileReader({\n    filename: \"_rels/.rels\",\n    readElement: relationshipsReader.readRelationships,\n    defaultValue: relationshipsReader.defaultValue\n});\n","var _ = require(\"underscore\");\n\nvar promises = require(\"../promises\");\nvar xml = require(\"../xml\");\n\nexports.writeStyleMap = writeStyleMap;\nexports.readStyleMap = readStyleMap;\n\n\nvar schema = \"http://schemas.zwobble.org/mammoth/style-map\";\nvar styleMapPath = \"mammoth/style-map\";\nvar styleMapAbsolutePath = \"/\" + styleMapPath;\n\nfunction writeStyleMap(docxFile, styleMap) {\n    docxFile.write(styleMapPath, styleMap);\n    return updateRelationships(docxFile).then(function() {\n        return updateContentTypes(docxFile);\n    });\n}\n\nfunction updateRelationships(docxFile) {\n    var path = \"word/_rels/document.xml.rels\";\n    var relationshipsUri = \"http://schemas.openxmlformats.org/package/2006/relationships\";\n    var relationshipElementName = \"{\" + relationshipsUri + \"}Relationship\";\n    return docxFile.read(path, \"utf8\")\n        .then(xml.readString)\n        .then(function(relationshipsContainer) {\n            var relationships = relationshipsContainer.children;\n            addOrUpdateElement(relationships, relationshipElementName, \"Id\", {\n                \"Id\": \"rMammothStyleMap\",\n                \"Type\": schema,\n                \"Target\": styleMapAbsolutePath\n            });\n            \n            var namespaces = {\"\": relationshipsUri};\n            return docxFile.write(path, xml.writeString(relationshipsContainer, namespaces));\n        });\n}\n\nfunction updateContentTypes(docxFile) {\n    var path = \"[Content_Types].xml\";\n    var contentTypesUri = \"http://schemas.openxmlformats.org/package/2006/content-types\";\n    var overrideName = \"{\" + contentTypesUri + \"}Override\";\n    return docxFile.read(path, \"utf8\")\n        .then(xml.readString)\n        .then(function(typesElement) {\n            var children = typesElement.children;\n            addOrUpdateElement(children, overrideName, \"PartName\", {\n                \"PartName\": styleMapAbsolutePath,\n                \"ContentType\": \"text/prs.mammoth.style-map\"\n            });\n            var namespaces = {\"\": contentTypesUri};\n            return docxFile.write(path, xml.writeString(typesElement, namespaces));\n        });\n}\n\nfunction addOrUpdateElement(elements, name, identifyingAttribute, attributes) {\n    var existingElement = _.find(elements, function(element) {\n        return element.name === name &&\n            element.attributes[identifyingAttribute] === attributes[identifyingAttribute];\n    });\n    if (existingElement) {\n        existingElement.attributes = attributes;\n    } else {\n        elements.push(xml.element(name, attributes));\n    }\n}\n\nfunction readStyleMap(docxFile) {\n    if (docxFile.exists(styleMapPath)) {\n        return docxFile.read(styleMapPath, \"utf8\");\n    } else {\n        return promises.resolve(null);\n    }\n}\n","var htmlPaths = require(\"../styles/html-paths\");\n\n\nfunction nonFreshElement(tagName, attributes, children) {\n    return elementWithTag(\n        htmlPaths.element(tagName, attributes, {fresh: false}),\n        children);\n}\n\nfunction freshElement(tagName, attributes, children) {\n    var tag = htmlPaths.element(tagName, attributes, {fresh: true});\n    return elementWithTag(tag, children);\n}\n\nfunction elementWithTag(tag, children) {\n    return {\n        type: \"element\",\n        tag: tag,\n        children: children || []\n    };\n}\n\nfunction text(value) {\n    return {\n        type: \"text\",\n        value: value\n    };\n}\n\nvar forceWrite = {\n    type: \"forceWrite\"\n};\n\nexports.freshElement = freshElement;\nexports.nonFreshElement = nonFreshElement;\nexports.elementWithTag = elementWithTag;\nexports.text = text;\nexports.forceWrite = forceWrite;\n\nvar voidTagNames = {\n    \"br\": true,\n    \"hr\": true,\n    \"img\": true,\n    \"input\": true\n};\n\nfunction isVoidElement(node) {\n    return (node.children.length === 0) && voidTagNames[node.tag.tagName];\n}\n\nexports.isVoidElement = isVoidElement;\n","var _ = require(\"underscore\");\n\nvar ast = require(\"./ast\");\n\nfunction simplify(nodes) {\n    return collapse(removeEmpty(nodes));\n}\n\nfunction collapse(nodes) {\n    var children = [];\n    \n    nodes.map(collapseNode).forEach(function(child) {\n        appendChild(children, child);\n    });\n    return children;\n}\n\nfunction collapseNode(node) {\n    return collapsers[node.type](node);\n}\n\nvar collapsers = {\n    element: collapseElement,\n    text: identity,\n    forceWrite: identity\n};\n\nfunction collapseElement(node) {\n    return ast.elementWithTag(node.tag, collapse(node.children));\n}\n\nfunction identity(value) {\n    return value;\n}\n\nfunction appendChild(children, child) {\n    var lastChild = children[children.length - 1];\n    if (child.type === \"element\" && !child.tag.fresh && lastChild && lastChild.type === \"element\" && child.tag.matchesElement(lastChild.tag)) {\n        if (child.tag.separator) {\n            appendChild(lastChild.children, ast.text(child.tag.separator));\n        }\n        child.children.forEach(function(grandChild) {\n            // Mutation is fine since simplifying elements create a copy of the children.\n            appendChild(lastChild.children, grandChild);\n        });\n    } else {\n        children.push(child);\n    }\n}\n\nfunction removeEmpty(nodes) {\n    return flatMap(nodes, function(node) {\n        return emptiers[node.type](node);\n    });\n}\n\nfunction flatMap(values, func) {\n    return _.flatten(_.map(values, func), true);\n}\n\nvar emptiers = {\n    element: elementEmptier,\n    text: textEmptier,\n    forceWrite: neverEmpty\n};\n\nfunction neverEmpty(node) {\n    return [node];\n}\n\nfunction elementEmptier(element) {\n    var children = removeEmpty(element.children);\n    if (children.length === 0 && !ast.isVoidElement(element)) {\n        return [];\n    } else {\n        return [ast.elementWithTag(element.tag, children)];\n    }\n}\n\nfunction textEmptier(node) {\n    if (node.value.length === 0) {\n        return [];\n    } else {\n        return [node];\n    }\n}\n\nmodule.exports = simplify;\n","var ast = require(\"./ast\");\n\nexports.freshElement = ast.freshElement;\nexports.nonFreshElement = ast.nonFreshElement;\nexports.elementWithTag = ast.elementWithTag;\nexports.text = ast.text;\nexports.forceWrite = ast.forceWrite;\n\nexports.simplify = require(\"./simplify\");\n\nfunction write(writer, nodes) {\n    nodes.forEach(function(node) {\n        writeNode(writer, node);\n    });\n}\n\nfunction writeNode(writer, node) {\n    toStrings[node.type](writer, node);\n}\n\nvar toStrings = {\n    element: generateElementString,\n    text: generateTextString,\n    forceWrite: function() { }\n};\n\nfunction generateElementString(writer, node) {\n    if (ast.isVoidElement(node)) {\n        writer.selfClosing(node.tag.tagName, node.tag.attributes);\n    } else {\n        writer.open(node.tag.tagName, node.tag.attributes);\n        write(writer, node.children);\n        writer.close(node.tag.tagName);\n    }\n}\n\nfunction generateTextString(writer, node) {\n    writer.text(node.value);\n}\n\nexports.write = write;\n","var _ = require(\"underscore\");\n\nvar html = require(\"../html\");\n\nexports.topLevelElement = topLevelElement;\nexports.elements = elements;\nexports.element = element;\n\nfunction topLevelElement(tagName, attributes) {\n    return elements([element(tagName, attributes, {fresh: true})]);\n}\n\nfunction elements(elementStyles) {\n    return new HtmlPath(elementStyles.map(function(elementStyle) {\n        if (_.isString(elementStyle)) {\n            return element(elementStyle);\n        } else {\n            return elementStyle;\n        }\n    }));\n}\n\nfunction HtmlPath(elements) {\n    this._elements = elements;\n}\n\nHtmlPath.prototype.wrap = function wrap(children) {\n    var result = children();\n    for (var index = this._elements.length - 1; index >= 0; index--) {\n        result = this._elements[index].wrapNodes(result);\n    }\n    return result;\n};\n\nfunction element(tagName, attributes, options) {\n    options = options || {};\n    return new Element(tagName, attributes, options);\n}\n\nfunction Element(tagName, attributes, options) {\n    var tagNames = {};\n    if (_.isArray(tagName)) {\n        tagName.forEach(function(tagName) {\n            tagNames[tagName] = true;\n        });\n        tagName = tagName[0];\n    } else {\n        tagNames[tagName] = true;\n    }\n    \n    this.tagName = tagName;\n    this.tagNames = tagNames;\n    this.attributes = attributes || {};\n    this.fresh = options.fresh;\n    this.separator = options.separator;\n}\n\nElement.prototype.matchesElement = function(element) {\n    return this.tagNames[element.tagName] && _.isEqual(this.attributes || {}, element.attributes || {});\n};\n\nElement.prototype.wrap = function wrap(generateNodes) {\n    return this.wrapNodes(generateNodes());\n};\n\nElement.prototype.wrapNodes = function wrapNodes(nodes) {\n    return [html.elementWithTag(this, nodes)];\n};\n\nexports.empty = elements([]);\nexports.ignore = {\n    wrap: function() {\n        return [];\n    }\n};\n","var _ = require(\"underscore\");\n\nvar promises = require(\"./promises\");\nvar Html = require(\"./html\");\n\nexports.imgElement = imgElement;\n\nfunction imgElement(func) {\n    return function(element, messages) {\n        return promises.when(func(element)).then(function(result) {\n            var attributes = {};\n            if (element.altText) {\n                attributes.alt = element.altText;\n            }\n            _.extend(attributes, result);\n\n            return [Html.freshElement(\"img\", attributes)];\n        });\n    };\n}\n\n// Undocumented, but retained for backwards-compatibility with 0.3.x\nexports.inline = exports.imgElement;\n\nexports.dataUri = imgElement(function(element) {\n    return element.readAsBase64String().then(function(imageBuffer) {\n        return {\n            src: \"data:\" + element.contentType + \";base64,\" + imageBuffer\n        };\n    });\n});\n","var _ = require(\"underscore\");\n\nexports.writer = writer;\n\nfunction writer(options) {\n    options = options || {};\n    if (options.prettyPrint) {\n        return prettyWriter();\n    } else {\n        return simpleWriter();\n    }\n}\n\n\nvar indentedElements = {\n    div: true,\n    p: true,\n    ul: true,\n    li: true\n};\n\n\nfunction prettyWriter() {\n    var indentationLevel = 0;\n    var indentation = \"  \";\n    var stack = [];\n    var start = true;\n    var inText = false;\n\n    var writer = simpleWriter();\n\n    function open(tagName, attributes) {\n        if (indentedElements[tagName]) {\n            indent();\n        }\n        stack.push(tagName);\n        writer.open(tagName, attributes);\n        if (indentedElements[tagName]) {\n            indentationLevel++;\n        }\n        start = false;\n    }\n\n    function close(tagName) {\n        if (indentedElements[tagName]) {\n            indentationLevel--;\n            indent();\n        }\n        stack.pop();\n        writer.close(tagName);\n    }\n\n    function text(value) {\n        startText();\n        var text = isInPre() ? value : value.replace(\"\\n\", \"\\n\" + indentation);\n        writer.text(text);\n    }\n\n    function selfClosing(tagName, attributes) {\n        indent();\n        writer.selfClosing(tagName, attributes);\n    }\n\n    function insideIndentedElement() {\n        return stack.length === 0 || indentedElements[stack[stack.length - 1]];\n    }\n\n    function startText() {\n        if (!inText) {\n            indent();\n            inText = true;\n        }\n    }\n\n    function indent() {\n        inText = false;\n        if (!start && insideIndentedElement() && !isInPre()) {\n            writer._append(\"\\n\");\n            for (var i = 0; i < indentationLevel; i++) {\n                writer._append(indentation);\n            }\n        }\n    }\n\n    function isInPre() {\n        return _.some(stack, function(tagName) {\n            return tagName === \"pre\";\n        });\n    }\n\n    return {\n        asString: writer.asString,\n        open: open,\n        close: close,\n        text: text,\n        selfClosing: selfClosing\n    };\n}\n\n\nfunction simpleWriter() {\n    var fragments = [];\n\n    function open(tagName, attributes) {\n        var attributeString = generateAttributeString(attributes);\n        fragments.push(\"<\" + tagName + attributeString + \">\");\n    }\n\n    function close(tagName) {\n        fragments.push(\"</\" + tagName + \">\");\n    }\n\n    function selfClosing(tagName, attributes) {\n        var attributeString = generateAttributeString(attributes);\n        fragments.push(\"<\" + tagName + attributeString + \" />\");\n    }\n\n    function generateAttributeString(attributes) {\n        return _.map(attributes, function(value, key) {\n            return \" \" + key + '=\"' + escapeHtmlAttribute(value) + '\"';\n        }).join(\"\");\n    }\n\n    function text(value) {\n        fragments.push(escapeHtmlText(value));\n    }\n\n    function append(html) {\n        fragments.push(html);\n    }\n\n    function asString() {\n        return fragments.join(\"\");\n    }\n\n    return {\n        asString: asString,\n        open: open,\n        close: close,\n        text: text,\n        selfClosing: selfClosing,\n        _append: append\n    };\n}\n\nfunction escapeHtmlText(value) {\n    return value\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;');\n}\n\nfunction escapeHtmlAttribute(value) {\n    return value\n        .replace(/&/g, '&amp;')\n        .replace(/\"/g, '&quot;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;');\n}\n","var _ = require(\"underscore\");\n\n\nfunction symmetricMarkdownElement(end) {\n    return markdownElement(end, end);\n}\n\nfunction markdownElement(start, end) {\n    return function() {\n        return {start: start, end: end};\n    };\n}\n\nfunction markdownLink(attributes) {\n    var href = attributes.href || \"\";\n    if (href) {\n        return {\n            start: \"[\",\n            end: \"](\" + href + \")\",\n            anchorPosition: \"before\"\n        };\n    } else {\n        return {};\n    }\n}\n\nfunction markdownImage(attributes) {\n    var src = attributes.src || \"\";\n    var altText = attributes.alt || \"\";\n    if (src || altText) {\n        return {start: \"![\" + altText + \"](\" + src + \")\"};\n    } else {\n        return {};\n    }\n}\n\nfunction markdownList(options) {\n    return function(attributes, list) {\n        return {\n            start: list ? \"\\n\" : \"\",\n            end: list ? \"\" : \"\\n\",\n            list: {\n                isOrdered: options.isOrdered,\n                indent: list ? list.indent + 1 : 0,\n                count: 0\n            }\n        };\n    };\n}\n\nfunction markdownListItem(attributes, list, listItem) {\n    list = list || {indent: 0, isOrdered: false, count: 0};\n    list.count++;\n    listItem.hasClosed = false;\n    \n    var bullet = list.isOrdered ? list.count + \".\" : \"-\";\n    var start = repeatString(\"\\t\", list.indent) + bullet + \" \";\n        \n    return {\n        start: start,\n        end: function() {\n            if (!listItem.hasClosed) {\n                listItem.hasClosed = true;\n                return \"\\n\";\n            }\n        }\n    };\n}\n\nvar htmlToMarkdown = {\n    \"p\": markdownElement(\"\", \"\\n\\n\"),\n    \"br\": markdownElement(\"\", \"  \\n\"),\n    \"ul\": markdownList({isOrdered: false}),\n    \"ol\": markdownList({isOrdered: true}),\n    \"li\": markdownListItem,\n    \"strong\": symmetricMarkdownElement(\"__\"),\n    \"em\": symmetricMarkdownElement(\"*\"),\n    \"a\": markdownLink,\n    \"img\": markdownImage\n};\n\n(function() {\n    for (var i = 1; i <= 6; i++) {\n        htmlToMarkdown[\"h\" + i] = markdownElement(repeatString(\"#\", i) + \" \", \"\\n\\n\");\n    }\n})();\n\nfunction repeatString(value, count) {\n    return new Array(count + 1).join(value);\n}\n\nfunction markdownWriter() {\n    var fragments = [];\n    var elementStack = [];\n    var list = null;\n    var listItem = {};\n    \n    function open(tagName, attributes) {\n        attributes = attributes || {};\n        \n        var createElement = htmlToMarkdown[tagName] || function() {\n            return {};\n        };\n        var element = createElement(attributes, list, listItem);\n        elementStack.push({end: element.end, list: list});\n        \n        if (element.list) {\n            list = element.list;\n        }\n        \n        var anchorBeforeStart = element.anchorPosition === \"before\";\n        if (anchorBeforeStart) {\n            writeAnchor(attributes);\n        }\n\n        fragments.push(element.start || \"\");\n        if (!anchorBeforeStart) {\n            writeAnchor(attributes);\n        }\n    }\n    \n    function writeAnchor(attributes) {\n        if (attributes.id) {\n            fragments.push('<a id=\"' + attributes.id + '\"></a>');\n        }\n    }\n    \n    function close(tagName) {\n        var element = elementStack.pop();\n        list = element.list;\n        var end = _.isFunction(element.end) ? element.end() : element.end;\n        fragments.push(end || \"\");\n    }\n    \n    function selfClosing(tagName, attributes) {\n        open(tagName, attributes);\n        close(tagName);\n    }\n    \n    function text(value) {\n        fragments.push(escapeMarkdown(value));\n    }\n    \n    function asString() {\n        return fragments.join(\"\");\n    }\n\n    return {\n        asString: asString,\n        open: open,\n        close: close,\n        text: text,\n        selfClosing: selfClosing\n    };\n}\n\nexports.writer = markdownWriter;\n\nfunction escapeMarkdown(value) {\n    return value\n        .replace(/\\\\/g, '\\\\\\\\')\n        .replace(/([\\`\\*_\\{\\}\\[\\]\\(\\)\\#\\+\\-\\.\\!])/g, '\\\\$1');\n}\n","var htmlWriter = require(\"./html-writer\");\nvar markdownWriter = require(\"./markdown-writer\");\n\nexports.writer = writer;\n\n\nfunction writer(options) {\n    options = options || {};\n    if (options.outputFormat === \"markdown\") {\n        return markdownWriter.writer();\n    } else {\n        return htmlWriter.writer(options);\n    }\n}\n","var _ = require(\"underscore\");\n\nvar promises = require(\"./promises\");\nvar documents = require(\"./documents\");\nvar htmlPaths = require(\"./styles/html-paths\");\nvar results = require(\"./results\");\nvar images = require(\"./images\");\nvar Html = require(\"./html\");\nvar writers = require(\"./writers\");\n\nexports.DocumentConverter = DocumentConverter;\n\n\nfunction DocumentConverter(options) {\n    return {\n        convertToHtml: function(element) {\n            var comments = _.indexBy(\n                element.type === documents.types.document ? element.comments : [],\n                \"commentId\"\n            );\n            var conversion = new DocumentConversion(options, comments);\n            return conversion.convertToHtml(element);\n        }\n    };\n}\n\nfunction DocumentConversion(options, comments) {\n    var noteNumber = 1;\n\n    var noteReferences = [];\n\n    var referencedComments = [];\n\n    options = _.extend({ignoreEmptyParagraphs: true}, options);\n    var idPrefix = options.idPrefix === undefined ? \"\" : options.idPrefix;\n    var ignoreEmptyParagraphs = options.ignoreEmptyParagraphs;\n\n    var defaultParagraphStyle = htmlPaths.topLevelElement(\"p\");\n\n    var styleMap = options.styleMap || [];\n\n    function convertToHtml(document) {\n        var messages = [];\n\n        var html = elementToHtml(document, messages, {});\n\n        var deferredNodes = [];\n        walkHtml(html, function(node) {\n            if (node.type === \"deferred\") {\n                deferredNodes.push(node);\n            }\n        });\n        var deferredValues = {};\n        return promises.mapSeries(deferredNodes, function(deferred) {\n            return deferred.value().then(function(value) {\n                deferredValues[deferred.id] = value;\n            });\n        }).then(function() {\n            function replaceDeferred(nodes) {\n                return flatMap(nodes, function(node) {\n                    if (node.type === \"deferred\") {\n                        return deferredValues[node.id];\n                    } else if (node.children) {\n                        return [\n                            _.extend({}, node, {\n                                children: replaceDeferred(node.children)\n                            })\n                        ];\n                    } else {\n                        return [node];\n                    }\n                });\n            }\n            var writer = writers.writer({\n                prettyPrint: options.prettyPrint,\n                outputFormat: options.outputFormat\n            });\n            Html.write(writer, Html.simplify(replaceDeferred(html)));\n            return new results.Result(writer.asString(), messages);\n        });\n    }\n\n    function convertElements(elements, messages, options) {\n        return flatMap(elements, function(element) {\n            return elementToHtml(element, messages, options);\n        });\n    }\n\n    function elementToHtml(element, messages, options) {\n        if (!options) {\n            throw new Error(\"options not set\");\n        }\n        var handler = elementConverters[element.type];\n        if (handler) {\n            return handler(element, messages, options);\n        } else {\n            return [];\n        }\n    }\n\n    function convertParagraph(element, messages, options) {\n        return htmlPathForParagraph(element, messages).wrap(function() {\n            var content = convertElements(element.children, messages, options);\n            if (ignoreEmptyParagraphs) {\n                return content;\n            } else {\n                return [Html.forceWrite].concat(content);\n            }\n        });\n    }\n\n    function htmlPathForParagraph(element, messages) {\n        var style = findStyle(element);\n\n        if (style) {\n            return style.to;\n        } else {\n            if (element.styleId) {\n                messages.push(unrecognisedStyleWarning(\"paragraph\", element));\n            }\n            return defaultParagraphStyle;\n        }\n    }\n\n    function convertRun(run, messages, options) {\n        var nodes = function() {\n            return convertElements(run.children, messages, options);\n        };\n        var paths = [];\n        if (run.highlight !== null) {\n            var path = findHtmlPath({type: \"highlight\", color: run.highlight});\n            if (path) {\n                paths.push(path);\n            }\n        }\n        if (run.isSmallCaps) {\n            paths.push(findHtmlPathForRunProperty(\"smallCaps\"));\n        }\n        if (run.isAllCaps) {\n            paths.push(findHtmlPathForRunProperty(\"allCaps\"));\n        }\n        if (run.isStrikethrough) {\n            paths.push(findHtmlPathForRunProperty(\"strikethrough\", \"s\"));\n        }\n        if (run.isUnderline) {\n            paths.push(findHtmlPathForRunProperty(\"underline\"));\n        }\n        if (run.verticalAlignment === documents.verticalAlignment.subscript) {\n            paths.push(htmlPaths.element(\"sub\", {}, {fresh: false}));\n        }\n        if (run.verticalAlignment === documents.verticalAlignment.superscript) {\n            paths.push(htmlPaths.element(\"sup\", {}, {fresh: false}));\n        }\n        if (run.isItalic) {\n            paths.push(findHtmlPathForRunProperty(\"italic\", \"em\"));\n        }\n        if (run.isBold) {\n            paths.push(findHtmlPathForRunProperty(\"bold\", \"strong\"));\n        }\n        var stylePath = htmlPaths.empty;\n        var style = findStyle(run);\n        if (style) {\n            stylePath = style.to;\n        } else if (run.styleId) {\n            messages.push(unrecognisedStyleWarning(\"run\", run));\n        }\n        paths.push(stylePath);\n\n        paths.forEach(function(path) {\n            nodes = path.wrap.bind(path, nodes);\n        });\n\n        return nodes();\n    }\n\n    function findHtmlPathForRunProperty(elementType, defaultTagName) {\n        var path = findHtmlPath({type: elementType});\n        if (path) {\n            return path;\n        } else if (defaultTagName) {\n            return htmlPaths.element(defaultTagName, {}, {fresh: false});\n        } else {\n            return htmlPaths.empty;\n        }\n    }\n\n    function findHtmlPath(element, defaultPath) {\n        var style = findStyle(element);\n        return style ? style.to : defaultPath;\n    }\n\n    function findStyle(element) {\n        for (var i = 0; i < styleMap.length; i++) {\n            if (styleMap[i].from.matches(element)) {\n                return styleMap[i];\n            }\n        }\n    }\n\n    function recoveringConvertImage(convertImage) {\n        return function(image, messages) {\n            return promises.attempt(function() {\n                return convertImage(image, messages);\n            }).caught(function(error) {\n                messages.push(results.error(error));\n                return [];\n            });\n        };\n    }\n\n    function noteHtmlId(note) {\n        return referentHtmlId(note.noteType, note.noteId);\n    }\n\n    function noteRefHtmlId(note) {\n        return referenceHtmlId(note.noteType, note.noteId);\n    }\n\n    function referentHtmlId(referenceType, referenceId) {\n        return htmlId(referenceType + \"-\" + referenceId);\n    }\n\n    function referenceHtmlId(referenceType, referenceId) {\n        return htmlId(referenceType + \"-ref-\" + referenceId);\n    }\n\n    function htmlId(suffix) {\n        return idPrefix + suffix;\n    }\n\n    var defaultTablePath = htmlPaths.elements([\n        htmlPaths.element(\"table\", {}, {fresh: true})\n    ]);\n\n    function convertTable(element, messages, options) {\n        return findHtmlPath(element, defaultTablePath).wrap(function() {\n            return convertTableChildren(element, messages, options);\n        });\n    }\n\n    function convertTableChildren(element, messages, options) {\n        var bodyIndex = _.findIndex(element.children, function(child) {\n            return !child.type === documents.types.tableRow || !child.isHeader;\n        });\n        if (bodyIndex === -1) {\n            bodyIndex = element.children.length;\n        }\n        var children;\n        if (bodyIndex === 0) {\n            children = convertElements(\n                element.children,\n                messages,\n                _.extend({}, options, {isTableHeader: false})\n            );\n        } else {\n            var headRows = convertElements(\n                element.children.slice(0, bodyIndex),\n                messages,\n                _.extend({}, options, {isTableHeader: true})\n            );\n            var bodyRows = convertElements(\n                element.children.slice(bodyIndex),\n                messages,\n                _.extend({}, options, {isTableHeader: false})\n            );\n            children = [\n                Html.freshElement(\"thead\", {}, headRows),\n                Html.freshElement(\"tbody\", {}, bodyRows)\n            ];\n        }\n        return [Html.forceWrite].concat(children);\n    }\n\n    function convertTableRow(element, messages, options) {\n        var children = convertElements(element.children, messages, options);\n        return [\n            Html.freshElement(\"tr\", {}, [Html.forceWrite].concat(children))\n        ];\n    }\n\n    function convertTableCell(element, messages, options) {\n        var tagName = options.isTableHeader ? \"th\" : \"td\";\n        var children = convertElements(element.children, messages, options);\n        var attributes = {};\n        if (element.colSpan !== 1) {\n            attributes.colspan = element.colSpan.toString();\n        }\n        if (element.rowSpan !== 1) {\n            attributes.rowspan = element.rowSpan.toString();\n        }\n\n        return [\n            Html.freshElement(tagName, attributes, [Html.forceWrite].concat(children))\n        ];\n    }\n\n    function convertCommentReference(reference, messages, options) {\n        return findHtmlPath(reference, htmlPaths.ignore).wrap(function() {\n            var comment = comments[reference.commentId];\n            var count = referencedComments.length + 1;\n            var label = \"[\" + commentAuthorLabel(comment) + count + \"]\";\n            referencedComments.push({label: label, comment: comment});\n            // TODO: remove duplication with note references\n            return [\n                Html.freshElement(\"a\", {\n                    href: \"#\" + referentHtmlId(\"comment\", reference.commentId),\n                    id: referenceHtmlId(\"comment\", reference.commentId)\n                }, [Html.text(label)])\n            ];\n        });\n    }\n\n    function convertComment(referencedComment, messages, options) {\n        // TODO: remove duplication with note references\n\n        var label = referencedComment.label;\n        var comment = referencedComment.comment;\n        var body = convertElements(comment.body, messages, options).concat([\n            Html.nonFreshElement(\"p\", {}, [\n                Html.text(\" \"),\n                Html.freshElement(\"a\", {\"href\": \"#\" + referenceHtmlId(\"comment\", comment.commentId)}, [\n                    Html.text(\"\")\n                ])\n            ])\n        ]);\n\n        return [\n            Html.freshElement(\n                \"dt\",\n                {\"id\": referentHtmlId(\"comment\", comment.commentId)},\n                [Html.text(\"Comment \" + label)]\n            ),\n            Html.freshElement(\"dd\", {}, body)\n        ];\n    }\n\n    function convertBreak(element, messages, options) {\n        return htmlPathForBreak(element).wrap(function() {\n            return [];\n        });\n    }\n\n    function htmlPathForBreak(element) {\n        var style = findStyle(element);\n        if (style) {\n            return style.to;\n        } else if (element.breakType === \"line\") {\n            return htmlPaths.topLevelElement(\"br\");\n        } else {\n            return htmlPaths.empty;\n        }\n    }\n\n    var elementConverters = {\n        \"document\": function(document, messages, options) {\n            var children = convertElements(document.children, messages, options);\n            var notes = noteReferences.map(function(noteReference) {\n                return document.notes.resolve(noteReference);\n            });\n            var notesNodes = convertElements(notes, messages, options);\n            return children.concat([\n                Html.freshElement(\"ol\", {}, notesNodes),\n                Html.freshElement(\"dl\", {}, flatMap(referencedComments, function(referencedComment) {\n                    return convertComment(referencedComment, messages, options);\n                }))\n            ]);\n        },\n        \"paragraph\": convertParagraph,\n        \"run\": convertRun,\n        \"text\": function(element, messages, options) {\n            return [Html.text(element.value)];\n        },\n        \"tab\": function(element, messages, options) {\n            return [Html.text(\"\\t\")];\n        },\n        \"hyperlink\": function(element, messages, options) {\n            var href = element.anchor ? \"#\" + htmlId(element.anchor) : element.href;\n            var attributes = {href: href};\n            if (element.targetFrame != null) {\n                attributes.target = element.targetFrame;\n            }\n\n            var children = convertElements(element.children, messages, options);\n            return [Html.nonFreshElement(\"a\", attributes, children)];\n        },\n        \"checkbox\": function(element) {\n            var attributes = {type: \"checkbox\"};\n            if (element.checked) {\n                attributes[\"checked\"] = \"checked\";\n            }\n            return [Html.freshElement(\"input\", attributes)];\n        },\n        \"bookmarkStart\": function(element, messages, options) {\n            var anchor = Html.freshElement(\"a\", {\n                id: htmlId(element.name)\n            }, [Html.forceWrite]);\n            return [anchor];\n        },\n        \"noteReference\": function(element, messages, options) {\n            noteReferences.push(element);\n            var anchor = Html.freshElement(\"a\", {\n                href: \"#\" + noteHtmlId(element),\n                id: noteRefHtmlId(element)\n            }, [Html.text(\"[\" + (noteNumber++) + \"]\")]);\n\n            return [Html.freshElement(\"sup\", {}, [anchor])];\n        },\n        \"note\": function(element, messages, options) {\n            var children = convertElements(element.body, messages, options);\n            var backLink = Html.elementWithTag(htmlPaths.element(\"p\", {}, {fresh: false}), [\n                Html.text(\" \"),\n                Html.freshElement(\"a\", {href: \"#\" + noteRefHtmlId(element)}, [Html.text(\"\")])\n            ]);\n            var body = children.concat([backLink]);\n\n            return Html.freshElement(\"li\", {id: noteHtmlId(element)}, body);\n        },\n        \"commentReference\": convertCommentReference,\n        \"comment\": convertComment,\n        \"image\": deferredConversion(recoveringConvertImage(options.convertImage || images.dataUri)),\n        \"table\": convertTable,\n        \"tableRow\": convertTableRow,\n        \"tableCell\": convertTableCell,\n        \"break\": convertBreak\n    };\n    return {\n        convertToHtml: convertToHtml\n    };\n}\n\nvar deferredId = 1;\n\nfunction deferredConversion(func) {\n    return function(element, messages, options) {\n        return [\n            {\n                type: \"deferred\",\n                id: deferredId++,\n                value: function() {\n                    return func(element, messages, options);\n                }\n            }\n        ];\n    };\n}\n\nfunction unrecognisedStyleWarning(type, element) {\n    return results.warning(\n        \"Unrecognised \" + type + \" style: '\" + element.styleName + \"'\" +\n        \" (Style ID: \" + element.styleId + \")\"\n    );\n}\n\nfunction flatMap(values, func) {\n    return _.flatten(values.map(func), true);\n}\n\nfunction walkHtml(nodes, callback) {\n    nodes.forEach(function(node) {\n        callback(node);\n        if (node.children) {\n            walkHtml(node.children, callback);\n        }\n    });\n}\n\nvar commentAuthorLabel = exports.commentAuthorLabel = function commentAuthorLabel(comment) {\n    return comment.authorInitials || \"\";\n};\n","var documents = require(\"./documents\");\n\nfunction convertElementToRawText(element) {\n    if (element.type === \"text\") {\n        return element.value;\n    } else if (element.type === documents.types.tab) {\n        return \"\\t\";\n    } else {\n        var tail = element.type === \"paragraph\" ? \"\\n\\n\" : \"\";\n        return (element.children || []).map(convertElementToRawText).join(\"\") + tail;\n    }\n}\n\nexports.convertElementToRawText = convertElementToRawText;\n","exports.paragraph = paragraph;\nexports.run = run;\nexports.table = table;\nexports.bold = new Matcher(\"bold\");\nexports.italic = new Matcher(\"italic\");\nexports.underline = new Matcher(\"underline\");\nexports.strikethrough = new Matcher(\"strikethrough\");\nexports.allCaps = new Matcher(\"allCaps\");\nexports.smallCaps = new Matcher(\"smallCaps\");\nexports.highlight = highlight;\nexports.commentReference = new Matcher(\"commentReference\");\nexports.lineBreak = new BreakMatcher({breakType: \"line\"});\nexports.pageBreak = new BreakMatcher({breakType: \"page\"});\nexports.columnBreak = new BreakMatcher({breakType: \"column\"});\nexports.equalTo = equalTo;\nexports.startsWith = startsWith;\n\n\nfunction paragraph(options) {\n    return new Matcher(\"paragraph\", options);\n}\n\nfunction run(options) {\n    return new Matcher(\"run\", options);\n}\n\nfunction table(options) {\n    return new Matcher(\"table\", options);\n}\n\nfunction highlight(options) {\n    return new HighlightMatcher(options);\n}\n\nfunction Matcher(elementType, options) {\n    options = options || {};\n    this._elementType = elementType;\n    this._styleId = options.styleId;\n    this._styleName = options.styleName;\n    if (options.list) {\n        this._listIndex = options.list.levelIndex;\n        this._listIsOrdered = options.list.isOrdered;\n    }\n}\n\nMatcher.prototype.matches = function(element) {\n    return element.type === this._elementType &&\n        (this._styleId === undefined || element.styleId === this._styleId) &&\n        (this._styleName === undefined || (element.styleName && this._styleName.operator(this._styleName.operand, element.styleName))) &&\n        (this._listIndex === undefined || isList(element, this._listIndex, this._listIsOrdered)) &&\n        (this._breakType === undefined || this._breakType === element.breakType);\n};\n\nfunction HighlightMatcher(options) {\n    options = options || {};\n    this._color = options.color;\n}\n\nHighlightMatcher.prototype.matches = function(element) {\n    return element.type === \"highlight\" &&\n        (this._color === undefined || element.color === this._color);\n};\n\nfunction BreakMatcher(options) {\n    options = options || {};\n    this._breakType = options.breakType;\n}\n\nBreakMatcher.prototype.matches = function(element) {\n    return element.type === \"break\" &&\n        (this._breakType === undefined || element.breakType === this._breakType);\n};\n\nfunction isList(element, levelIndex, isOrdered) {\n    return element.numbering &&\n        element.numbering.level == levelIndex &&\n        element.numbering.isOrdered == isOrdered;\n}\n\nfunction equalTo(value) {\n    return {\n        operator: operatorEqualTo,\n        operand: value\n    };\n}\n\nfunction startsWith(value) {\n    return {\n        operator: operatorStartsWith,\n        operand: value\n    };\n}\n\nfunction operatorEqualTo(first, second) {\n    return first.toUpperCase() === second.toUpperCase();\n}\n\nfunction operatorStartsWith(first, second) {\n    return second.toUpperCase().indexOf(first.toUpperCase()) === 0;\n}\n","var lop = require(\"lop\");\nvar RegexTokeniser = lop.RegexTokeniser;\n\nexports.tokenise = tokenise;\n\nvar stringPrefix = \"'((?:\\\\\\\\.|[^'])*)\";\n\nfunction tokenise(string) {\n    var identifierCharacter = \"(?:[a-zA-Z\\\\-_]|\\\\\\\\.)\";\n    var tokeniser = new RegexTokeniser([\n        {name: \"identifier\", regex: new RegExp(\"(\" + identifierCharacter + \"(?:\" + identifierCharacter + \"|[0-9])*)\")},\n        {name: \"dot\", regex: /\\./},\n        {name: \"colon\", regex: /:/},\n        {name: \"gt\", regex: />/},\n        {name: \"whitespace\", regex: /\\s+/},\n        {name: \"arrow\", regex: /=>/},\n        {name: \"equals\", regex: /=/},\n        {name: \"startsWith\", regex: /\\^=/},\n        {name: \"open-paren\", regex: /\\(/},\n        {name: \"close-paren\", regex: /\\)/},\n        {name: \"open-square-bracket\", regex: /\\[/},\n        {name: \"close-square-bracket\", regex: /\\]/},\n        {name: \"string\", regex: new RegExp(stringPrefix + \"'\")},\n        {name: \"unterminated-string\", regex: new RegExp(stringPrefix)},\n        {name: \"integer\", regex: /([0-9]+)/},\n        {name: \"choice\", regex: /\\|/},\n        {name: \"bang\", regex: /(!)/}\n    ]);\n    return tokeniser.tokenise(string);\n}\n","var _ = require(\"underscore\");\nvar lop = require(\"lop\");\n\nvar documentMatchers = require(\"./styles/document-matchers\");\nvar htmlPaths = require(\"./styles/html-paths\");\nvar tokenise = require(\"./styles/parser/tokeniser\").tokenise;\nvar results = require(\"./results\");\n\nexports.readHtmlPath = readHtmlPath;\nexports.readDocumentMatcher = readDocumentMatcher;\nexports.readStyle = readStyle;\n\n\nfunction readStyle(string) {\n    return parseString(styleRule, string);\n}\n\nfunction createStyleRule() {\n    return lop.rules.sequence(\n        lop.rules.sequence.capture(documentMatcherRule()),\n        lop.rules.tokenOfType(\"whitespace\"),\n        lop.rules.tokenOfType(\"arrow\"),\n        lop.rules.sequence.capture(lop.rules.optional(lop.rules.sequence(\n            lop.rules.tokenOfType(\"whitespace\"),\n            lop.rules.sequence.capture(htmlPathRule())\n        ).head())),\n        lop.rules.tokenOfType(\"end\")\n    ).map(function(documentMatcher, htmlPath) {\n        return {\n            from: documentMatcher,\n            to: htmlPath.valueOrElse(htmlPaths.empty)\n        };\n    });\n}\n\nfunction readDocumentMatcher(string) {\n    return parseString(documentMatcherRule(), string);\n}\n\nfunction documentMatcherRule() {\n    var sequence = lop.rules.sequence;\n\n    var identifierToConstant = function(identifier, constant) {\n        return lop.rules.then(\n            lop.rules.token(\"identifier\", identifier),\n            function() {\n                return constant;\n            }\n        );\n    };\n\n    var paragraphRule = identifierToConstant(\"p\", documentMatchers.paragraph);\n    var runRule = identifierToConstant(\"r\", documentMatchers.run);\n\n    var elementTypeRule = lop.rules.firstOf(\"p or r or table\",\n        paragraphRule,\n        runRule\n    );\n\n    var styleIdRule = lop.rules.sequence(\n        lop.rules.tokenOfType(\"dot\"),\n        lop.rules.sequence.cut(),\n        lop.rules.sequence.capture(identifierRule)\n    ).map(function(styleId) {\n        return {styleId: styleId};\n    });\n\n    var styleNameMatcherRule = lop.rules.firstOf(\"style name matcher\",\n        lop.rules.then(\n            lop.rules.sequence(\n                lop.rules.tokenOfType(\"equals\"),\n                lop.rules.sequence.cut(),\n                lop.rules.sequence.capture(stringRule)\n            ).head(),\n            function(styleName) {\n                return {styleName: documentMatchers.equalTo(styleName)};\n            }\n        ),\n        lop.rules.then(\n            lop.rules.sequence(\n                lop.rules.tokenOfType(\"startsWith\"),\n                lop.rules.sequence.cut(),\n                lop.rules.sequence.capture(stringRule)\n            ).head(),\n            function(styleName) {\n                return {styleName: documentMatchers.startsWith(styleName)};\n            }\n        )\n    );\n\n    var styleNameRule = lop.rules.sequence(\n        lop.rules.tokenOfType(\"open-square-bracket\"),\n        lop.rules.sequence.cut(),\n        lop.rules.token(\"identifier\", \"style-name\"),\n        lop.rules.sequence.capture(styleNameMatcherRule),\n        lop.rules.tokenOfType(\"close-square-bracket\")\n    ).head();\n\n\n    var listTypeRule = lop.rules.firstOf(\"list type\",\n        identifierToConstant(\"ordered-list\", {isOrdered: true}),\n        identifierToConstant(\"unordered-list\", {isOrdered: false})\n    );\n    var listRule = sequence(\n        lop.rules.tokenOfType(\"colon\"),\n        sequence.capture(listTypeRule),\n        sequence.cut(),\n        lop.rules.tokenOfType(\"open-paren\"),\n        sequence.capture(integerRule),\n        lop.rules.tokenOfType(\"close-paren\")\n    ).map(function(listType, levelNumber) {\n        return {\n            list: {\n                isOrdered: listType.isOrdered,\n                levelIndex: levelNumber - 1\n            }\n        };\n    });\n\n    function createMatcherSuffixesRule(rules) {\n        var matcherSuffix = lop.rules.firstOf.apply(\n            lop.rules.firstOf,\n            [\"matcher suffix\"].concat(rules)\n        );\n        var matcherSuffixes = lop.rules.zeroOrMore(matcherSuffix);\n        return lop.rules.then(matcherSuffixes, function(suffixes) {\n            var matcherOptions = {};\n            suffixes.forEach(function(suffix) {\n                _.extend(matcherOptions, suffix);\n            });\n            return matcherOptions;\n        });\n    }\n\n    var paragraphOrRun = sequence(\n        sequence.capture(elementTypeRule),\n        sequence.capture(createMatcherSuffixesRule([\n            styleIdRule,\n            styleNameRule,\n            listRule\n        ]))\n    ).map(function(createMatcher, matcherOptions) {\n        return createMatcher(matcherOptions);\n    });\n\n    var table = sequence(\n        lop.rules.token(\"identifier\", \"table\"),\n        sequence.capture(createMatcherSuffixesRule([\n            styleIdRule,\n            styleNameRule\n        ]))\n    ).map(function(options) {\n        return documentMatchers.table(options);\n    });\n\n    var bold = identifierToConstant(\"b\", documentMatchers.bold);\n    var italic = identifierToConstant(\"i\", documentMatchers.italic);\n    var underline = identifierToConstant(\"u\", documentMatchers.underline);\n    var strikethrough = identifierToConstant(\"strike\", documentMatchers.strikethrough);\n    var allCaps = identifierToConstant(\"all-caps\", documentMatchers.allCaps);\n    var smallCaps = identifierToConstant(\"small-caps\", documentMatchers.smallCaps);\n\n    var highlight = sequence(\n        lop.rules.token(\"identifier\", \"highlight\"),\n        lop.rules.sequence.capture(lop.rules.optional(lop.rules.sequence(\n            lop.rules.tokenOfType(\"open-square-bracket\"),\n            lop.rules.sequence.cut(),\n            lop.rules.token(\"identifier\", \"color\"),\n            lop.rules.tokenOfType(\"equals\"),\n            lop.rules.sequence.capture(stringRule),\n            lop.rules.tokenOfType(\"close-square-bracket\")\n        ).head()))\n    ).map(function(color) {\n        return documentMatchers.highlight({\n            color: color.valueOrElse(undefined)\n        });\n    });\n\n    var commentReference = identifierToConstant(\"comment-reference\", documentMatchers.commentReference);\n\n    var breakMatcher = sequence(\n        lop.rules.token(\"identifier\", \"br\"),\n        sequence.cut(),\n        lop.rules.tokenOfType(\"open-square-bracket\"),\n        lop.rules.token(\"identifier\", \"type\"),\n        lop.rules.tokenOfType(\"equals\"),\n        sequence.capture(stringRule),\n        lop.rules.tokenOfType(\"close-square-bracket\")\n    ).map(function(breakType) {\n        switch (breakType) {\n        case \"line\":\n            return documentMatchers.lineBreak;\n        case \"page\":\n            return documentMatchers.pageBreak;\n        case \"column\":\n            return documentMatchers.columnBreak;\n        default:\n            // TODO: handle unknown document matchers\n        }\n    });\n\n    return lop.rules.firstOf(\"element type\",\n        paragraphOrRun,\n        table,\n        bold,\n        italic,\n        underline,\n        strikethrough,\n        allCaps,\n        smallCaps,\n        highlight,\n        commentReference,\n        breakMatcher\n    );\n}\n\nfunction readHtmlPath(string) {\n    return parseString(htmlPathRule(), string);\n}\n\nfunction htmlPathRule() {\n    var capture = lop.rules.sequence.capture;\n    var whitespaceRule = lop.rules.tokenOfType(\"whitespace\");\n    var freshRule = lop.rules.then(\n        lop.rules.optional(lop.rules.sequence(\n            lop.rules.tokenOfType(\"colon\"),\n            lop.rules.token(\"identifier\", \"fresh\")\n        )),\n        function(option) {\n            return option.map(function() {\n                return true;\n            }).valueOrElse(false);\n        }\n    );\n\n    var separatorRule = lop.rules.then(\n        lop.rules.optional(lop.rules.sequence(\n            lop.rules.tokenOfType(\"colon\"),\n            lop.rules.token(\"identifier\", \"separator\"),\n            lop.rules.tokenOfType(\"open-paren\"),\n            capture(stringRule),\n            lop.rules.tokenOfType(\"close-paren\")\n        ).head()),\n        function(option) {\n            return option.valueOrElse(\"\");\n        }\n    );\n\n    var tagNamesRule = lop.rules.oneOrMoreWithSeparator(\n        identifierRule,\n        lop.rules.tokenOfType(\"choice\")\n    );\n\n    var styleElementRule = lop.rules.sequence(\n        capture(tagNamesRule),\n        capture(lop.rules.zeroOrMore(attributeOrClassRule)),\n        capture(freshRule),\n        capture(separatorRule)\n    ).map(function(tagName, attributesList, fresh, separator) {\n        var attributes = {};\n        var options = {};\n        attributesList.forEach(function(attribute) {\n            if (attribute.append && attributes[attribute.name]) {\n                attributes[attribute.name] += \" \" + attribute.value;\n            } else {\n                attributes[attribute.name] = attribute.value;\n            }\n        });\n        if (fresh) {\n            options.fresh = true;\n        }\n        if (separator) {\n            options.separator = separator;\n        }\n        return htmlPaths.element(tagName, attributes, options);\n    });\n\n    return lop.rules.firstOf(\"html path\",\n        lop.rules.then(lop.rules.tokenOfType(\"bang\"), function() {\n            return htmlPaths.ignore;\n        }),\n        lop.rules.then(\n            lop.rules.zeroOrMoreWithSeparator(\n                styleElementRule,\n                lop.rules.sequence(\n                    whitespaceRule,\n                    lop.rules.tokenOfType(\"gt\"),\n                    whitespaceRule\n                )\n            ),\n            htmlPaths.elements\n        )\n    );\n}\n\nvar identifierRule = lop.rules.then(\n    lop.rules.tokenOfType(\"identifier\"),\n    decodeEscapeSequences\n);\nvar integerRule = lop.rules.tokenOfType(\"integer\");\n\nvar stringRule = lop.rules.then(\n    lop.rules.tokenOfType(\"string\"),\n    decodeEscapeSequences\n);\n\nvar escapeSequences = {\n    \"n\": \"\\n\",\n    \"r\": \"\\r\",\n    \"t\": \"\\t\"\n};\n\nfunction decodeEscapeSequences(value) {\n    return value.replace(/\\\\(.)/g, function(match, code) {\n        return escapeSequences[code] || code;\n    });\n}\n\nvar attributeRule = lop.rules.sequence(\n    lop.rules.tokenOfType(\"open-square-bracket\"),\n    lop.rules.sequence.cut(),\n    lop.rules.sequence.capture(identifierRule),\n    lop.rules.tokenOfType(\"equals\"),\n    lop.rules.sequence.capture(stringRule),\n    lop.rules.tokenOfType(\"close-square-bracket\")\n).map(function(name, value) {\n    return {name: name, value: value, append: false};\n});\n\nvar classRule = lop.rules.sequence(\n    lop.rules.tokenOfType(\"dot\"),\n    lop.rules.sequence.cut(),\n    lop.rules.sequence.capture(identifierRule)\n).map(function(className) {\n    return {name: \"class\", value: className, append: true};\n});\n\nvar attributeOrClassRule = lop.rules.firstOf(\n    \"attribute or class\",\n    attributeRule,\n    classRule\n);\n\nfunction parseString(rule, string) {\n    var tokens = tokenise(string);\n    var parser = lop.Parser();\n    var parseResult = parser.parseTokens(rule, tokens);\n    if (parseResult.isSuccess()) {\n        return results.success(parseResult.value());\n    } else {\n        return new results.Result(null, [results.warning(describeFailure(string, parseResult))]);\n    }\n}\n\nfunction describeFailure(input, parseResult) {\n    return \"Did not understand this style mapping, so ignored it: \" + input + \"\\n\" +\n        parseResult.errors().map(describeError).join(\"\\n\");\n}\n\nfunction describeError(error) {\n    return \"Error was at character number \" + error.characterNumber() + \": \" +\n        \"Expected \" + error.expected + \" but got \" + error.actual;\n}\n\nvar styleRule = createStyleRule();\n","exports.readOptions = readOptions;\n\n\nvar _ = require(\"underscore\");\n\nvar defaultStyleMap = exports._defaultStyleMap = [\n    \"p.Heading1 => h1:fresh\",\n    \"p.Heading2 => h2:fresh\",\n    \"p.Heading3 => h3:fresh\",\n    \"p.Heading4 => h4:fresh\",\n    \"p.Heading5 => h5:fresh\",\n    \"p.Heading6 => h6:fresh\",\n    \"p[style-name='Heading 1'] => h1:fresh\",\n    \"p[style-name='Heading 2'] => h2:fresh\",\n    \"p[style-name='Heading 3'] => h3:fresh\",\n    \"p[style-name='Heading 4'] => h4:fresh\",\n    \"p[style-name='Heading 5'] => h5:fresh\",\n    \"p[style-name='Heading 6'] => h6:fresh\",\n    \"p[style-name='heading 1'] => h1:fresh\",\n    \"p[style-name='heading 2'] => h2:fresh\",\n    \"p[style-name='heading 3'] => h3:fresh\",\n    \"p[style-name='heading 4'] => h4:fresh\",\n    \"p[style-name='heading 5'] => h5:fresh\",\n    \"p[style-name='heading 6'] => h6:fresh\",\n\n    // Apple Pages\n    \"p.Heading => h1:fresh\",\n    \"p[style-name='Heading'] => h1:fresh\",\n\n    \"r[style-name='Strong'] => strong\",\n\n    \"p[style-name='footnote text'] => p:fresh\",\n    \"r[style-name='footnote reference'] =>\",\n    \"p[style-name='endnote text'] => p:fresh\",\n    \"r[style-name='endnote reference'] =>\",\n    \"p[style-name='annotation text'] => p:fresh\",\n    \"r[style-name='annotation reference'] =>\",\n\n    // LibreOffice\n    \"p[style-name='Footnote'] => p:fresh\",\n    \"r[style-name='Footnote anchor'] =>\",\n    \"p[style-name='Endnote'] => p:fresh\",\n    \"r[style-name='Endnote anchor'] =>\",\n\n    \"p:unordered-list(1) => ul > li:fresh\",\n    \"p:unordered-list(2) => ul|ol > li > ul > li:fresh\",\n    \"p:unordered-list(3) => ul|ol > li > ul|ol > li > ul > li:fresh\",\n    \"p:unordered-list(4) => ul|ol > li > ul|ol > li > ul|ol > li > ul > li:fresh\",\n    \"p:unordered-list(5) => ul|ol > li > ul|ol > li > ul|ol > li > ul|ol > li > ul > li:fresh\",\n    \"p:ordered-list(1) => ol > li:fresh\",\n    \"p:ordered-list(2) => ul|ol > li > ol > li:fresh\",\n    \"p:ordered-list(3) => ul|ol > li > ul|ol > li > ol > li:fresh\",\n    \"p:ordered-list(4) => ul|ol > li > ul|ol > li > ul|ol > li > ol > li:fresh\",\n    \"p:ordered-list(5) => ul|ol > li > ul|ol > li > ul|ol > li > ul|ol > li > ol > li:fresh\",\n\n    \"r[style-name='Hyperlink'] =>\",\n\n    \"p[style-name='Normal'] => p:fresh\",\n\n    // Apple Pages\n    \"p.Body => p:fresh\",\n    \"p[style-name='Body'] => p:fresh\"\n];\n\nvar standardOptions = exports._standardOptions = {\n    externalFileAccess: false,\n    transformDocument: identity,\n    includeDefaultStyleMap: true,\n    includeEmbeddedStyleMap: true\n};\n\nfunction readOptions(options) {\n    options = options || {};\n    return _.extend({}, standardOptions, options, {\n        customStyleMap: readStyleMap(options.styleMap),\n        readStyleMap: function() {\n            var styleMap = this.customStyleMap;\n            if (this.includeEmbeddedStyleMap) {\n                styleMap = styleMap.concat(readStyleMap(this.embeddedStyleMap));\n            }\n            if (this.includeDefaultStyleMap) {\n                styleMap = styleMap.concat(defaultStyleMap);\n            }\n            return styleMap;\n        }\n    });\n}\n\nfunction readStyleMap(styleMap) {\n    if (!styleMap) {\n        return [];\n    } else if (_.isString(styleMap)) {\n        return styleMap.split(\"\\n\")\n            .map(function(line) {\n                return line.trim();\n            })\n            .filter(function(line) {\n                return line !== \"\" && line.charAt(0) !== \"#\";\n            });\n    } else {\n        return styleMap;\n    }\n}\n\nfunction identity(value) {\n    return value;\n}\n","var promises = require(\"../lib/promises\");\nvar zipfile = require(\"../lib/zipfile\");\n\nexports.openZip = openZip;\n\nfunction openZip(options) {\n    if (options.arrayBuffer) {\n        return promises.resolve(zipfile.openArrayBuffer(options.arrayBuffer));\n    } else {\n        return promises.reject(new Error(\"Could not find file in options\"));\n    }\n}\n","var htmlPaths = require(\"./styles/html-paths\");\nvar Html = require(\"./html\");\n\n\nexports.element = element;\n\nfunction element(name) {\n    return function(html) {\n        return Html.elementWithTag(htmlPaths.element(name), [html]);\n    };\n}\n","var _ = require(\"underscore\");\n\nvar docxReader = require(\"./docx/docx-reader\");\nvar docxStyleMap = require(\"./docx/style-map\");\nvar DocumentConverter = require(\"./document-to-html\").DocumentConverter;\nvar convertElementToRawText = require(\"./raw-text\").convertElementToRawText;\nvar readStyle = require(\"./style-reader\").readStyle;\nvar readOptions = require(\"./options-reader\").readOptions;\nvar unzip = require(\"./unzip\");\nvar Result = require(\"./results\").Result;\n\nexports.convertToHtml = convertToHtml;\nexports.convertToMarkdown = convertToMarkdown;\nexports.convert = convert;\nexports.extractRawText = extractRawText;\nexports.images = require(\"./images\");\nexports.transforms = require(\"./transforms\");\nexports.underline = require(\"./underline\");\nexports.embedStyleMap = embedStyleMap;\nexports.readEmbeddedStyleMap = readEmbeddedStyleMap;\n\nfunction convertToHtml(input, options) {\n    return convert(input, options);\n}\n\nfunction convertToMarkdown(input, options) {\n    var markdownOptions = Object.create(options || {});\n    markdownOptions.outputFormat = \"markdown\";\n    return convert(input, markdownOptions);\n}\n\nfunction convert(input, options) {\n    options = readOptions(options);\n\n    return unzip.openZip(input)\n        .tap(function(docxFile) {\n            return docxStyleMap.readStyleMap(docxFile).then(function(styleMap) {\n                options.embeddedStyleMap = styleMap;\n            });\n        })\n        .then(function(docxFile) {\n            return docxReader.read(docxFile, input, options)\n                .then(function(documentResult) {\n                    return documentResult.map(options.transformDocument);\n                })\n                .then(function(documentResult) {\n                    return convertDocumentToHtml(documentResult, options);\n                });\n        });\n}\n\nfunction readEmbeddedStyleMap(input) {\n    return unzip.openZip(input)\n        .then(docxStyleMap.readStyleMap);\n}\n\nfunction convertDocumentToHtml(documentResult, options) {\n    var styleMapResult = parseStyleMap(options.readStyleMap());\n    var parsedOptions = _.extend({}, options, {\n        styleMap: styleMapResult.value\n    });\n    var documentConverter = new DocumentConverter(parsedOptions);\n\n    return documentResult.flatMapThen(function(document) {\n        return styleMapResult.flatMapThen(function(styleMap) {\n            return documentConverter.convertToHtml(document);\n        });\n    });\n}\n\nfunction parseStyleMap(styleMap) {\n    return Result.combine((styleMap || []).map(readStyle))\n        .map(function(styleMap) {\n            return styleMap.filter(function(styleMapping) {\n                return !!styleMapping;\n            });\n        });\n}\n\n\nfunction extractRawText(input) {\n    return unzip.openZip(input)\n        .then(docxReader.read)\n        .then(function(documentResult) {\n            return documentResult.map(convertElementToRawText);\n        });\n}\n\nfunction embedStyleMap(input, styleMap) {\n    return unzip.openZip(input)\n        .tap(function(docxFile) {\n            return docxStyleMap.writeStyleMap(docxFile, styleMap);\n        })\n        .then(function(docxFile) {\n            return docxFile.toArrayBuffer();\n        })\n        .then(function(arrayBuffer) {\n            return {\n                toArrayBuffer: function() {\n                    return arrayBuffer;\n                },\n                toBuffer: function() {\n                    return Buffer.from(arrayBuffer);\n                }\n            };\n        });\n}\n\nexports.styleMapping = function() {\n    throw new Error('Use a raw string instead of mammoth.styleMapping e.g. \"p[style-name=\\'Title\\'] => h1\" instead of mammoth.styleMapping(\"p[style-name=\\'Title\\'] => h1\")');\n};\n"],"names":["_","require$$0","bluebird","require$$1","promises","defer","func","args","promisedFunc","value","returnValue","resolve","reject","promise","resolveArg","rejectArg","types","documents","Document","children","options","Notes","Paragraph","properties","indent","Run","verticalAlignment","Text","Tab","Checkbox","Hyperlink","NoteReference","notes","note","noteKey","reference","key","Note","commentReference","comment","noteType","id","Image","encoding","arrayBuffer","Table","TableRow","TableCell","Break","breakType","BookmarkStart","results","Result","success","warning","error","messages","funcResult","combineMessages","that","otherResult","values","message","exception","containsMessage","isSameMessage","first","second","base64js","JSZip","zipfile","openArrayBuffer","splitPath","joinPath","zipFile","exists","name","read","array","decoder","write","contents","toArrayBuffer","path","lastIndex","nonEmptyPaths","relevantPaths","nodes","Element","attributes","emptyElement","child","elements","toElementList","elementListPrototype","element","xmldom","dom","parseFromString","string","domParser","level","document","xmldom_1","require$$2","require$$3","reader","readString","Node","xmlString","namespaceMap","convertNode","node","convertElement","convertedName","convertName","convertedChildren","childNode","convertedNode","convertedAttributes","attribute","mappedPrefix","prefix","xmlbuilder","writer","writeString","root","namespaces","uriToPrefix","nodeWriters","writeElement","writeTextNode","writeNode","builder","elementBuilder","mapElementName","longFormMatch","writeDocument","uri","xml","officeXmlReader","readXmlFromZipFile","xmlNamespaceMap","collapseAlternateContent","docxFile","stripUtf8Bom","transforms","paragraph","run","elementsOfType","getDescendantsOfType","getDescendants","transform","elementType","transformElement","type","descendant","descendants","visitDescendants","visit","uris","uriToZipEntryName","replaceFragment","base","fragment","hashIndex","bodyReader","createBodyReader","readNumberingProperties","dingbatToUnicode","require$$4","require$$5","require$$6","BodyReader","complexFieldStack","currentInstrText","deletedParagraphContents","relationships","contentTypes","files","numbering","styles","readXmlElements","readXmlElement","combineResults","handler","xmlElementReaders","ignoreElements","emptyResultWithMessages","emptyResult","readParagraphProperties","readParagraphStyle","style","readParagraphIndent","readRunProperties","readRunStyle","fontSizeString","fontSize","readBooleanElement","readUnderline","readHighlightValue","readBooleanAttributeValue","readStyle","readTableStyle","styleTagName","styleType","findStyleById","styleElement","styleId","undefinedStyleWarning","elementResultWithMessages","readFldChar","complexFieldEnd","parseCurrentInstrText","elementResult","complexFieldSeparate","complexField","currentHyperlinkOptions","topHyperlink","parseInstrText","instrText","fldChar","externalLinkResult","internalLinkResult","checkboxResult","checkboxElement","checkedElement","checked","readInstrText","readSymbol","font","char","unicodeCharacter","noteReferenceReader","noteId","readCommentReference","readChildElements","paragraphPropertiesElement","isDeleted","childrenXml","ReadResult","hyperlinkOptions","relationshipId","anchor","create","targetFrame","href","readTable","readTableRow","readTableCell","contentResult","content","checkbox","isChecked","documentCheckbox","hasCheckbox","replacedContent","text","readDrawingElement","readImageData","propertiesResult","readTableProperties","calculateRowSpans","isHeader","gridSpan","colSpan","cell","readVMerge","val","rows","unexpectedNonRows","row","removeVMergeProperties","unexpectedNonCells","columns","cellIndex","cells","blips","readBlip","blip","altText","isBlank","blipImageFile","findBlipImageFile","readImage","embedRelationshipId","linkRelationshipId","findEmbeddedImageFile","imagePath","imageFile","contentType","image","warnings","supportedImageTypes","numId","levelByStyleId","extra","joinElements","result","identity","documentXmlReader","DocumentXmlReader","convertXmlToDocument","body","relationshipsReader","readRelationships","Relationships","relationship","targetsByRelationshipId","targetsByType","contentTypesReader","readContentTypesFromXml","fallbackContentTypes","extensionDefaults","overrides","overrideContentType","pathParts","extension","fallback","numberingXml","readNumberingXml","Numbering","nums","abstractNums","allLevels","abstractNum","levelsByParagraphStyleId","findLevel","num","findLevelByParagraphStyleId","readAbstractNums","readNums","readAbstractNum","levels","levelWithoutIndex","levelElement","levelIndex","numFmt","isOrdered","paragraphStyleId","numStyleLink","abstractNumId","stylesReader","readStylesXml","Styles","paragraphStyles","characterStyles","tableStyles","numberingStyles","readStyleElement","styleSet","readNumberingStyleElement","readStyleId","styleName","nameElement","notesReader","createReader","this","readNotesXml","isFootnoteElement","readFootnoteElement","footnoteElement","createCommentsReader","readCommentsXml","readCommentElement","readOptionalAttribute","commentsReader","Files","docxReader","findPartPaths","require$$7","require$$8","require$$9","require$$10","require$$11","require$$12","require$$13","input","readContentTypesFromZipFile","readStylesFromZipFile","readNumberingFromZipFile","readXmlFileWithBody","footnotes","endnotes","comments","readPackageRelationships","packageRelationships","mainDocumentPath","findPartPath","xmlFileReader","relationshipsFilename","documentRelationships","findPartRelatedToMainDocument","relationshipType","basePath","fallbackPath","targets","normalisedTargets","target","stripPrefix","validTargets","filename","readRelationshipsFromZipFile","split","styleMap","writeStyleMap","readStyleMap","schema","styleMapPath","styleMapAbsolutePath","updateRelationships","updateContentTypes","relationshipsUri","relationshipElementName","relationshipsContainer","addOrUpdateElement","contentTypesUri","overrideName","typesElement","identifyingAttribute","existingElement","htmlPaths","nonFreshElement","tagName","elementWithTag","freshElement","tag","forceWrite","ast","voidTagNames","isVoidElement","simplify","collapse","removeEmpty","collapseNode","appendChild","collapsers","collapseElement","lastChild","grandChild","flatMap","emptiers","elementEmptier","textEmptier","neverEmpty","simplify_1","html","toStrings","generateElementString","generateTextString","topLevelElement","elementStyles","HtmlPath","elementStyle","index","tagNames","generateNodes","Html","exports","imgElement","imageBuffer","htmlWriter","prettyWriter","simpleWriter","indentedElements","indentationLevel","indentation","stack","start","inText","open","close","startText","isInPre","selfClosing","insideIndentedElement","i","fragments","attributeString","generateAttributeString","escapeHtmlAttribute","escapeHtmlText","append","asString","symmetricMarkdownElement","end","markdownElement","markdownLink","markdownImage","src","markdownList","list","markdownListItem","listItem","bullet","repeatString","htmlToMarkdown","count","markdownWriter","elementStack","createElement","anchorBeforeStart","writeAnchor","escapeMarkdown","markdownWriter_1","writers","images","documentToHtml","DocumentConverter","conversion","DocumentConversion","noteNumber","noteReferences","referencedComments","idPrefix","ignoreEmptyParagraphs","defaultParagraphStyle","convertToHtml","elementToHtml","deferredNodes","walkHtml","deferredValues","deferred","replaceDeferred","convertElements","elementConverters","convertParagraph","htmlPathForParagraph","findStyle","unrecognisedStyleWarning","convertRun","paths","findHtmlPath","findHtmlPathForRunProperty","stylePath","defaultTagName","defaultPath","recoveringConvertImage","convertImage","noteHtmlId","referentHtmlId","noteRefHtmlId","referenceHtmlId","referenceType","referenceId","htmlId","suffix","defaultTablePath","convertTable","convertTableChildren","bodyIndex","headRows","bodyRows","convertTableRow","convertTableCell","convertCommentReference","label","commentAuthorLabel","convertComment","referencedComment","convertBreak","htmlPathForBreak","noteReference","notesNodes","backLink","deferredConversion","deferredId","callback","convertElementToRawText","tail","rawText","documentMatchers","table","Matcher","highlight","BreakMatcher","equalTo","startsWith","HighlightMatcher","isList","operatorEqualTo","operatorStartsWith","lop","RegexTokeniser","tokeniser","tokenise","stringPrefix","identifierCharacter","styleReader","readHtmlPath","readDocumentMatcher","parseString","styleRule","createStyleRule","documentMatcherRule","htmlPathRule","documentMatcher","htmlPath","sequence","identifierToConstant","identifier","constant","paragraphRule","runRule","elementTypeRule","styleIdRule","identifierRule","styleNameMatcherRule","stringRule","styleNameRule","listTypeRule","listRule","integerRule","listType","levelNumber","createMatcherSuffixesRule","rules","matcherSuffix","matcherSuffixes","suffixes","matcherOptions","paragraphOrRun","createMatcher","bold","italic","underline","strikethrough","allCaps","smallCaps","color","breakMatcher","capture","whitespaceRule","freshRule","option","separatorRule","tagNamesRule","styleElementRule","attributeOrClassRule","attributesList","fresh","separator","decodeEscapeSequences","escapeSequences","match","code","attributeRule","classRule","className","rule","tokens","parser","parseResult","describeFailure","describeError","optionsReader","readOptions","defaultStyleMap","standardOptions","line","unzip","openZip","docxStyleMap","lib","convertToMarkdown","convert","extractRawText","embedStyleMap","readEmbeddedStyleMap","markdownOptions","documentResult","convertDocumentToHtml","styleMapResult","parseStyleMap","parsedOptions","documentConverter","styleMapping"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39]}