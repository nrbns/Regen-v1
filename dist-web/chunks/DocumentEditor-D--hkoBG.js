import{r as l,j as e,t as U,X as z,s as O,F as y,U as R,g as X,al as I,D as B,h as C,u as $}from"./vendor-react-gmX1Lmvt.js";import{t as r}from"./core-ai-yFIunLTZ.js";import"./vendor-react-dom-Bkb6jJ_S.js";import"./vendor-Vl2WtvH-.js";import"./vendor-zustand-BWsgwsXr.js";import"./mode-manager.ts-DwguZmJt.js";import"./core-memory-DmK-uh9X.js";function W({isOpen:n,onAccept:p,onReject:o,fileName:u}){const[i,g]=l.useState(!1);return n?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-lg p-6 max-w-md w-full mx-4 shadow-xl",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[e.jsx("div",{className:"rounded-full bg-yellow-500/20 p-2",children:e.jsx(U,{className:"h-5 w-5 text-yellow-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-1",children:"Cloud Processing Consent"}),e.jsxs("p",{className:"text-sm text-slate-400",children:["You're about to process ",e.jsx("span",{className:"font-medium text-slate-300",children:u})," using a cloud AI service."]})]}),e.jsx("button",{onClick:o,className:"text-slate-400 hover:text-slate-300 transition-colors",children:e.jsx(z,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsx("div",{className:"bg-slate-800/50 rounded-lg p-4 space-y-2",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(O,{className:"h-4 w-4 text-blue-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-slate-300",children:[e.jsx("p",{className:"font-medium mb-1",children:"What this means:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-slate-400",children:[e.jsx("li",{children:"Your document will be sent to an external AI service (OpenAI/Anthropic)"}),e.jsx("li",{children:"Files are encrypted during transmission"}),e.jsx("li",{children:"Files are automatically deleted after processing"}),e.jsx("li",{children:"No data is stored permanently by the service"})]})]})]})}),e.jsx("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-3",children:e.jsxs("p",{className:"text-xs text-red-300",children:[e.jsx("strong",{children:"Warning:"})," Do not upload sensitive or confidential documents if you're concerned about privacy. Use local processing (Ollama) for maximum privacy."]})})]}),e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("input",{type:"checkbox",id:"consent-understood",checked:i,onChange:d=>g(d.target.checked),className:"w-4 h-4 rounded border-slate-700 bg-slate-800"}),e.jsx("label",{htmlFor:"consent-understood",className:"text-sm text-slate-300 cursor-pointer",children:"I understand and consent to cloud processing of this document"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:o,className:"flex-1 px-4 py-2 bg-slate-800 hover:bg-slate-700 rounded-lg text-white font-medium transition-colors",children:"Cancel"}),e.jsx("button",{onClick:p,disabled:!i,className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-slate-700 disabled:cursor-not-allowed rounded-lg text-white font-medium transition-colors",children:"Accept & Continue"})]})]})}):null}function G(){const[n,p]=l.useState(null),[o,u]=l.useState("rewrite");l.useEffect(()=>{const s=a=>{a.detail?.task&&(u(a.detail.task),r.info(`Task set to: ${a.detail.task}`))};return window.addEventListener("doc-command",s),()=>{window.removeEventListener("doc-command",s)}},[]);const[i,g]=l.useState("preserve"),[d,k]=l.useState("en"),[m,v]=l.useState(!1),[N,w]=l.useState(!1),[t,j]=l.useState(null),[f,F]=l.useState(!1),[D,h]=l.useState(!1),L=l.useCallback(s=>{const a=s.target.files?.[0];if(a){if(!["application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/pdf","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/plain","text/markdown"].includes(a.type)&&!a.name.match(/\.(docx|pdf|xlsx|txt|md)$/i)){r.error("Unsupported file type. Please upload DOCX, PDF, XLSX, TXT, or MD files.");return}if(a.size>100*1024*1024){r.error("File size must be less than 100MB");return}p(a),j(null)}},[]),S=l.useCallback(async()=>{if(!n){r.error("Please select a file first");return}if(m){h(!0);return}await b()},[n,o,i,d,m]),b=l.useCallback(async()=>{if(n){w(!0),j(null),h(!1);try{const s=new FormData;s.append("file",n),s.append("task",o),s.append("style",i),s.append("language",d),s.append("cloudLLM",m.toString()),s.append("preserveFormatting","true");const a=await fetch("/api/doc/edit",{method:"POST",body:s});if(!a.ok){const c=await a.json();throw new Error(c.message||"Document processing failed")}const x=await a.json();j(x),r.success("Document processed successfully!")}catch(s){console.error("[DocumentEditor] Edit failed:",s),r.error(s instanceof Error?s.message:"Failed to process document")}finally{w(!1)}}},[n,o,i,d,m]),E=l.useCallback(()=>{h(!1),b()},[b]),P=l.useCallback(()=>{h(!1),v(!1),r.info("Switched to local processing. Processing may be slower.")},[]),M=l.useCallback(async()=>{if(t)try{const s=await fetch(t.downloadUrl);if(!s.ok)throw new Error("Download failed");const a=await s.blob(),x=window.URL.createObjectURL(a),c=document.createElement("a");c.href=x,c.download=`edited_${t.originalName}`,document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(x),r.success("File downloaded!")}catch{r.error("Failed to download file")}},[t]),T={high:"text-green-400",medium:"text-yellow-400",low:"text-red-400"},A={high:$,medium:C,low:C};return e.jsxs("div",{className:"flex flex-col h-full bg-slate-950 text-white",children:[e.jsxs("div",{className:"border-b border-slate-800 p-4",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Document Auto-Edit"}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"AI-powered document editing: rewrite, grammar, summarize, translate, and more"})]}),e.jsx("div",{className:"flex-1 overflow-auto p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"border border-slate-800 rounded-lg p-6 bg-slate-900/50",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Upload Document"}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("label",{className:"flex-1 cursor-pointer",children:[e.jsx("input",{type:"file",accept:".docx,.pdf,.xlsx,.txt,.md",onChange:L,className:"hidden"}),e.jsx("div",{className:"border-2 border-dashed border-slate-700 rounded-lg p-8 text-center hover:border-slate-600 transition-colors",children:n?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(y,{className:"h-8 w-8 text-blue-400"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-medium",children:n.name}),e.jsxs("p",{className:"text-sm text-slate-400",children:[(n.size/1024).toFixed(1)," KB"]})]})]}):e.jsxs("div",{children:[e.jsx(R,{className:"h-12 w-12 mx-auto mb-2 text-slate-500"}),e.jsx("p",{className:"text-slate-400",children:"Click to upload or drag and drop"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"DOCX, PDF, XLSX, TXT, MD (max 100MB)"})]})})]})})]}),n&&e.jsxs("div",{className:"border border-slate-800 rounded-lg p-6 bg-slate-900/50 space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Edit Options"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Edit Task"}),e.jsxs("select",{value:o,onChange:s=>u(s.target.value),className:"w-full px-3 py-2 bg-slate-800 border border-slate-700 rounded-lg text-white",children:[e.jsx("option",{value:"rewrite",children:"Rewrite"}),e.jsx("option",{value:"grammar",children:"Fix Grammar"}),e.jsx("option",{value:"summarize",children:"Summarize"}),e.jsx("option",{value:"expand",children:"Expand"}),e.jsx("option",{value:"translate",children:"Translate"}),e.jsx("option",{value:"formal",children:"Make Formal"}),e.jsx("option",{value:"casual",children:"Make Casual"}),e.jsx("option",{value:"concise",children:"Make Concise"}),e.jsx("option",{value:"bulletize",children:"Convert to Bullets"}),e.jsx("option",{value:"normalize",children:"Normalize (Excel)"})]})]}),o==="rewrite"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Style"}),e.jsxs("select",{value:i,onChange:s=>g(s.target.value),className:"w-full px-3 py-2 bg-slate-800 border border-slate-700 rounded-lg text-white",children:[e.jsx("option",{value:"preserve",children:"Preserve Original"}),e.jsx("option",{value:"formal",children:"Formal"}),e.jsx("option",{value:"casual",children:"Casual"}),e.jsx("option",{value:"concise",children:"Concise"}),e.jsx("option",{value:"professional",children:"Professional"})]})]}),o==="translate"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Target Language"}),e.jsxs("select",{value:d,onChange:s=>k(s.target.value),className:"w-full px-3 py-2 bg-slate-800 border border-slate-700 rounded-lg text-white",children:[e.jsx("option",{value:"en",children:"English"}),e.jsx("option",{value:"hi",children:"Hindi"}),e.jsx("option",{value:"es",children:"Spanish"}),e.jsx("option",{value:"fr",children:"French"}),e.jsx("option",{value:"de",children:"German"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"cloudLLM",checked:m,onChange:s=>v(s.target.checked),className:"w-4 h-4 rounded border-slate-700 bg-slate-800"}),e.jsx("label",{htmlFor:"cloudLLM",className:"text-sm",children:"Use Cloud LLM (requires consent - faster, but data sent to external API)"})]}),e.jsx("button",{onClick:S,disabled:N,className:"w-full px-4 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-slate-700 disabled:cursor-not-allowed rounded-lg font-medium flex items-center justify-center gap-2 transition-colors",children:N?e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"h-5 w-5 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"h-5 w-5"}),"Process Document"]})})]}),t&&e.jsxs("div",{className:"border border-slate-800 rounded-lg p-6 bg-slate-900/50 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Results"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>F(!f),className:"px-3 py-1.5 text-sm bg-slate-800 hover:bg-slate-700 rounded-lg flex items-center gap-2",children:[e.jsx(I,{className:"h-4 w-4"}),f?"Hide":"Show"," Preview"]}),e.jsxs("button",{onClick:M,className:"px-3 py-1.5 text-sm bg-green-600 hover:bg-green-700 rounded-lg flex items-center gap-2",children:[e.jsx(B,{className:"h-4 w-4"}),"Download"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-slate-400",children:"Confidence:"}),(()=>{const s=A[t.confidence];return e.jsxs("div",{className:`flex items-center gap-1 ${T[t.confidence]}`,children:[e.jsx(s,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium capitalize",children:t.confidence})]})})()]}),t.metadata&&e.jsxs("div",{className:"text-sm text-slate-400 space-y-1",children:[t.metadata.model&&e.jsxs("p",{children:["Model: ",t.metadata.model]}),t.metadata.processingTime&&e.jsxs("p",{children:["Processing Time: ",(t.metadata.processingTime/1e3).toFixed(1),"s"]}),t.metadata.wordCount&&e.jsxs("p",{children:["Word Count: ",t.metadata.wordCount]})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-slate-400 mb-2",children:["Changes: ",t.changes.length," modification(s)"]}),f&&t.changes.length>0&&e.jsxs("div",{className:"mt-4 space-y-2 max-h-96 overflow-auto",children:[t.changes.slice(0,10).map((s,a)=>e.jsxs("div",{className:"p-3 bg-slate-800 rounded-lg text-sm space-y-1",children:[s.original&&e.jsxs("div",{children:[e.jsx("span",{className:"text-red-400",children:"- "}),e.jsx("span",{className:"text-slate-300 line-through",children:s.original})]}),s.edited&&e.jsxs("div",{children:[e.jsx("span",{className:"text-green-400",children:"+ "}),e.jsx("span",{className:"text-slate-200",children:s.edited})]})]},a)),t.changes.length>10&&e.jsxs("p",{className:"text-xs text-slate-500 text-center",children:["... and ",t.changes.length-10," more changes"]})]})]})]})]})}),e.jsx(W,{isOpen:D,onAccept:E,onReject:P,fileName:n?.name||"document"})]})}function V(){return e.jsx(G,{})}export{V as default};
//# sourceMappingURL=DocumentEditor-D--hkoBG.js.map
