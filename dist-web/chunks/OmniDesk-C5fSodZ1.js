import{r as d,j as e,S as ee,ap as Ke,P as Ve,X as Ye,g as Te,Z as Je,o as ye,m as ve,G as Xe,a2 as Ze,aI as et,aJ as tt,E as st,A as at,x as rt,aE as De,aF as nt,a0 as Le,$ as lt,ai as it,F as ot,at as ct,B as dt,aK as ut,aL as pt,aM as xt,aN as mt,O as ht,ae as bt,aO as ft,aP as gt,u as yt,w as Se}from"./vendor-react-gmX1Lmvt.js";import{h as ie,l as oe,v as vt,w as fe,a as xe,b as Ae,f as ge,i as C,m as ue,u as Ie}from"./core-ai-yFIunLTZ.js";import{i as $e}from"../assets/index-D9cF9G1U.js";import{A as we,m as v}from"./vendor-framer-motion-DDE19Uim.js";import{c as Ue}from"./vendor-zustand-BWsgwsXr.js";import{f as pe}from"./vendor-utils-5Vdoy44w.js";var wt=Object.defineProperty,Nt=(i,s,r)=>s in i?wt(i,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[s]=r,K=(i,s,r)=>Nt(i,typeof s!="symbol"?s+"":s,r);const jt="ws://localhost:4000/ws",kt="http://localhost:4000/api/query",St="http://localhost:4000/api/ask";class Ne{constructor(s=jt){K(this,"url"),K(this,"ws",null),K(this,"listeners",new Map),K(this,"backoff",1e3),K(this,"errorLogged",!1),K(this,"isConnecting",!1),K(this,"backendOnline",fe()),K(this,"unsubscribeBackend"),this.url=s,this.unsubscribeBackend=vt(l=>{if(this.backendOnline=l,!l&&this.ws){try{(this.ws.readyState===WebSocket.OPEN||this.ws.readyState===WebSocket.CONNECTING)&&this.ws.close()}catch{}this.ws=null}l&&this.connect()}),!(!ie()&&!oe())&&this.backendOnline&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.connect()},{timeout:2e3}):setTimeout(()=>{this.connect()},1e3))}connect(){if(!(!ie()&&!oe())&&!(this.isConnecting||!this.backendOnline)){this.isConnecting=!0;try{this.ws=new WebSocket(this.url),this.ws.addEventListener("error",r=>{r.stopPropagation(),r.preventDefault()},{once:!0}),this.ws.onopen=()=>{this.backoff=1e3,this.isConnecting=!1,this.errorLogged=!1},this.ws.onmessage=r=>{try{const l=JSON.parse(r.data);l?.id&&this.listeners.has(l.id)&&this.listeners.get(l.id)?.(l),window.dispatchEvent(new CustomEvent("redix:message",{detail:l}))}catch{}},this.ws.onclose=()=>{this.isConnecting=!1,!(!ie()&&!oe())&&(window.setTimeout(()=>this.connect(),this.backoff),this.backoff=Math.min(this.backoff*1.5,3e4))},this.ws.onerror=r=>{this.isConnecting=!1,this.ws&&this.ws.readyState===WebSocket.OPEN&&this.ws.close(),r.stopPropagation(),r.preventDefault()}}catch{this.isConnecting=!1,this.errorLogged}}}send(s){if(!fe()){s.id&&this.listeners.has(s.id)&&(this.listeners.get(s.id)?.({id:s.id,type:"error",payload:{message:"Backend offline"}}),this.listeners.delete(s.id));return}if(this.ws&&this.ws.readyState===WebSocket.OPEN)this.ws.send(JSON.stringify(s));else{const r=s.payload??{};fetch(kt,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:r.query,sessionId:r.sessionId,options:r.options})}).then(async l=>{if(!l.ok)throw new Error(`HTTP ${l.status}`);const o=await l.json();s.id&&this.listeners.has(s.id)&&(this.listeners.get(s.id)?.({id:s.id,type:"final_result",payload:o}),this.listeners.delete(s.id))}).catch(l=>{s.id&&this.listeners.has(s.id)&&(this.listeners.get(s.id)?.({id:s.id,type:"error",payload:{message:l.message}}),this.listeners.delete(s.id))})}}startHttpStream(s,r,l,o,u){const p=new URL(St,window.location.origin);p.searchParams.set("q",r),p.searchParams.set("sessionId",l);const S=c=>{if(!c)return{};try{return JSON.parse(c)}catch{return{}}};if(!fe())return u({id:s,type:"error",payload:{message:"Backend offline"}}),{id:s,cancel:()=>{}};const f=new EventSource(p.toString()),A=c=>{u({id:s,type:"ack",payload:S(c.data)})},y=c=>{u({id:s,type:"partial_result",payload:S(c.data)})},T=c=>{const g=S(c.data).item;u({id:s,type:"partial_result",payload:{items:g?[g]:[]}})},$=c=>{u({id:s,type:"final_result",payload:S(c.data)}),I()},E=c=>{u({id:s,type:"error",payload:S(c.data)}),I()},R=()=>{I()},I=()=>{f.removeEventListener("ack",A),f.removeEventListener("update",y),f.removeEventListener("token",T),f.removeEventListener("result",$),f.removeEventListener("error",E),f.removeEventListener("done",R),f.close()};return f.addEventListener("ack",A),f.addEventListener("update",y),f.addEventListener("token",T),f.addEventListener("result",$),f.addEventListener("error",E),f.addEventListener("done",R),f.onerror=()=>{u({id:s,type:"error",payload:{message:"sse-disconnected"}}),I()},{id:s,cancel:()=>{I()}}}request(s,r,l={},o){const u=crypto.randomUUID();return!this.ws||this.ws.readyState!==WebSocket.OPEN?this.startHttpStream(u,s,r,l,o):(this.listeners.set(u,o),this.send({id:u,type:"start_query",payload:{query:s,sessionId:r,options:{stream:!0,...l}}}),{id:u,cancel:()=>{this.listeners.delete(u),this.send({id:u,type:"cancel",payload:{taskId:l.taskId}})}})}}let J=null;const It=()=>(J||(!ie()&&!oe()?(J=new Ne,J.ws=null,J.connect=()=>{},J.isConnecting=!1):J=new Ne),J),Ct=(()=>{if(!ie()&&!oe()){const s=new Ne;return s.ws=null,s.connect=()=>{},s.isConnecting=!1,s}return It()})();function Et(i,s){const r=Ct.request(i,s.sessionId,{},l=>{const o=l;switch(l.type){case"partial_result":s.onPartial?.(o);break;case"final_result":s.onFinal?.(o);break;case"error":s.onError?.(o),r.cancel();break}});return r}function Rt({query:i,isOpen:s,onClose:r}){const[l,o]=d.useState(""),[u,p]=d.useState(!1),[S,f]=d.useState(null),[A,y]=d.useState(!1),T=d.useRef(null),$=d.useRef(`redix-ai-${crypto.randomUUID()}`),E=d.useRef(null);d.useEffect(()=>{E.current&&u&&E.current.scrollIntoView({behavior:"smooth"})},[l,u]),d.useEffect(()=>{if(!(!s||!i.trim()))return T.current?.cancel(),o(""),f(null),p(!0),T.current=Et(i,{sessionId:$.current,onPartial:I=>{const c=I.payload;if(c.text)o(j=>j+c.text);else if(c.content)o(j=>j+c.content);else if(c.items&&Array.isArray(c.items)){const j=c.items.map(g=>g.text||g.content||g.snippet||"").join(`

`);j&&o(g=>g.includes(j)?g:g+(g?`

`:"")+j)}},onFinal:I=>{p(!1);const c=I.payload;if(c.text)o(j=>j+c.text);else if(c.content)o(j=>j+c.content);else if(c.items&&Array.isArray(c.items)){const j=c.items.map(g=>g.text||g.content||g.snippet||"").join(`

`);j&&!l.includes(j)&&o(g=>g+(g?`

`:"")+j)}},onError:I=>{p(!1);const c=I.payload?.message||"Failed to get AI response";f(c),console.error("[AIResponsePane] Redix error:",I)}}),()=>{T.current?.cancel(),T.current=null}},[i,s]);const R=d.useCallback(async()=>{if(l)try{await navigator.clipboard.writeText(l),y(!0),setTimeout(()=>y(!1),2e3)}catch(I){console.error("[AIResponsePane] Failed to copy:",I)}},[l]);return s?e.jsx(we,{children:e.jsxs(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},transition:{duration:.2},className:"fixed bottom-20 left-1/2 -translate-x-1/2 z-50 w-full max-w-4xl mx-4 rounded-2xl border border-slate-700/70 bg-slate-950/95 backdrop-blur-xl shadow-2xl",style:{maxHeight:"60vh"},children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-800/60",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-emerald-500/20",children:e.jsx(ee,{size:16,className:"text-emerald-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-100",children:"AI Response"}),e.jsx("p",{className:"text-xs text-gray-400 truncate max-w-md",children:i})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[l&&e.jsx("button",{type:"button",onClick:R,className:"p-2 rounded-lg text-gray-400 hover:text-gray-200 hover:bg-slate-800/60 transition-colors",title:"Copy response",children:A?e.jsx(Ke,{size:16}):e.jsx(Ve,{size:16})}),e.jsx("button",{type:"button",onClick:r,className:"p-2 rounded-lg text-gray-400 hover:text-gray-200 hover:bg-slate-800/60 transition-colors",title:"Close",children:e.jsx(Ye,{size:16})})]})]}),e.jsxs("div",{className:"px-6 py-4 overflow-y-auto",style:{maxHeight:"calc(60vh - 80px)"},children:[u&&!l&&e.jsxs("div",{className:"flex items-center gap-3 text-gray-400",children:[e.jsx(Te,{size:16,className:"animate-spin text-emerald-400"}),e.jsx("span",{className:"text-sm",children:"Streaming response from Redix..."})]}),S&&e.jsxs("div",{className:"rounded-lg border border-red-500/40 bg-red-500/10 px-4 py-3 text-sm text-red-200",children:[e.jsx("p",{className:"font-medium",children:"Error"}),e.jsx("p",{className:"mt-1 text-xs text-red-300/80",children:S})]}),l&&e.jsxs(v.div,{initial:{opacity:0},animate:{opacity:1},className:"prose prose-invert prose-sm max-w-none text-gray-200",children:[e.jsxs("div",{className:"whitespace-pre-wrap break-words",children:[l,u&&e.jsx("span",{className:"inline-block w-2 h-4 ml-1 bg-emerald-400 animate-pulse"})]}),e.jsx("div",{ref:E})]}),!l&&!u&&!S&&e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx(ee,{size:32,className:"mx-auto mb-3 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Waiting for AI response..."})]})]})]})}):null}const Ce={normal:"Performance Mode","battery-saver":"Battery Saver Mode",extreme:"Regen Mode"},Ee={normal:null,"battery-saver":"+0.8hr battery",extreme:"+1.8hr battery"},Re={normal:"text-gray-400","battery-saver":"text-emerald-300",extreme:"text-amber-300"},Pt={batteryPct:null,charging:null,ramMb:0,cpuLoad1:0,activeTabs:0,carbonIntensity:null,carbonRegion:null},Me="ob:ecoHistory:v1";function Tt(){if(typeof window>"u")return[];try{const i=window.localStorage.getItem(Me);if(!i)return[];const s=JSON.parse(i);return Array.isArray(s)?s.map(r=>({timestamp:typeof r.timestamp=="number"?r.timestamp:Date.now(),mode:r.mode??"normal",batteryPct:typeof r.batteryPct=="number"?r.batteryPct:null,carbonIntensity:typeof r.carbonIntensity=="number"||r.carbonIntensity===null?r.carbonIntensity:void 0,cpuLoad:typeof r.cpuLoad=="number"?r.cpuLoad:0,activeTabs:typeof r.activeTabs=="number"?r.activeTabs:0})).slice(-120):[]}catch(i){return console.warn("[efficiencyStore] Failed to load history",i),[]}}function Dt(i){if(!(typeof window>"u"))try{window.localStorage.setItem(Me,JSON.stringify(i))}catch(s){console.warn("[efficiencyStore] Failed to persist history",s)}}const Lt=Tt(),le=Ue((i,s)=>({mode:"normal",label:Ce.normal,badge:Ee.normal,colorClass:Re.normal,lastUpdated:null,snapshot:Pt,history:Lt,setEvent:r=>{const l={timestamp:r.timestamp,mode:r.mode,batteryPct:r.snapshot.batteryPct,carbonIntensity:r.snapshot.carbonIntensity,cpuLoad:r.snapshot.cpuLoad1,activeTabs:r.snapshot.activeTabs};let o=s().history;o=[...o,l].slice(-120),Dt(o);const u=r.mode;i({mode:u,label:r.label??Ce[u],badge:r.badge??Ee[u],colorClass:Re[u],lastUpdated:r.timestamp,snapshot:r.snapshot,history:o})}})),_e=Ue(i=>({events:[],pushEvent:s=>i(r=>{const l=s.timestamp??Date.now(),o=s.id??`ws-${l}-${Math.random().toString(36).slice(2,8)}`;return{events:[...r.events,{id:o,timestamp:l,workspaceId:s.workspaceId??null,type:s.type,message:s.message,payload:s.payload}].slice(-100)}}),clear:s=>i(r=>s?{events:r.events.filter(l=>l.workspaceId!==s)}:{events:[]})}));function Pe(i={}){const s=typeof xe?.getState=="function"?xe.getState():null;if(!s)return null;const{url:r="about:blank",title:l,activate:o=!0,mode:u="normal"}=i,p=Array.isArray(s.tabs)?s.tabs:[],S=typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():`local-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,f=p.map(y=>({...y,active:o?!1:!!y.active})),A={id:S,title:l||r,url:r,active:o,mode:u};f.push(A),s.setAll(f);try{$e.emit("tabs:updated",f)}catch{}return A}function At(){const[i,s]=d.useState(""),[r,l]=d.useState(!1),[o,u]=d.useState("Discover"),[p,S]=d.useState([]),[f,A]=d.useState([]),[y,T]=d.useState(null),[$,E]=d.useState(!0),[R,I]=d.useState(!0),{activeId:c,tabs:j}=xe(),{setMode:g}=Ae(),F=d.useRef(null),X=d.useCallback(async()=>{try{E(!0);const h=[{symbol:"NIFTY",yahooSymbol:"^NSEI"},{symbol:"SENSEX",yahooSymbol:"^BSESN"},{symbol:"Gold",yahooSymbol:"GC=F"},{symbol:"Silver",yahooSymbol:"SI=F"},{symbol:"USD/INR",yahooSymbol:"INR=X"}].map(async({symbol:_,yahooSymbol:Y})=>{try{if(ge())return{NIFTY:{symbol:"NIFTY",value:26202.95,change:-13.1,changePercent:-.05},SENSEX:{symbol:"SENSEX",value:85706.67,change:-17.14,changePercent:-.02},Gold:{symbol:"Gold",value:4254.9,change:52.5,changePercent:1.25},Silver:{symbol:"Silver",value:57.16,change:3.55,changePercent:6.63},"USD/INR":{symbol:"USD/INR",value:89.352,change:.009,changePercent:.01}}[_]||null;if(typeof window<"u"&&window.__TAURI_INTERNALS__)try{const w=await C.trade.getQuote(Y);if(w&&w.last){const re=w.last,z=w.ask&&w.bid?(w.ask-w.bid)/2:0,U=w.ask&&w.bid&&w.last?(w.ask-w.bid)/w.last*100:0;return{symbol:_,value:re,change:z,changePercent:U}}}catch{}const G=await fetch(`http://127.0.0.1:4000/api/trade/quote?symbol=${encodeURIComponent(Y)}`,{headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"}});if(G.ok){const w=await G.json();if(w.price){const re=w.change||0,z=w.changePercent||0;return{symbol:_,value:w.price,change:re,changePercent:z}}}}catch(Z){ge()||console.error(`[NewTab] Failed to fetch ${_}:`,Z)}return{NIFTY:{symbol:"NIFTY",value:26202.95,change:-13.1,changePercent:-.05},SENSEX:{symbol:"SENSEX",value:85706.67,change:-17.14,changePercent:-.02},Gold:{symbol:"Gold",value:4254.9,change:52.5,changePercent:1.25},Silver:{symbol:"Silver",value:57.16,change:3.55,changePercent:6.63},"USD/INR":{symbol:"USD/INR",value:89.352,change:.009,changePercent:.01}}[_]||null}),D=(await Promise.all(h)).filter(_=>_!==null);S(D)}catch(a){console.error("[NewTab] Market data fetch failed:",a),S([{symbol:"NIFTY",value:26202.95,change:-13.1,changePercent:-.05},{symbol:"SENSEX",value:85706.67,change:-17.14,changePercent:-.02},{symbol:"Gold",value:4254.9,change:52.5,changePercent:1.25},{symbol:"Silver",value:57.16,change:3.55,changePercent:6.63},{symbol:"USD/INR",value:89.352,change:.009,changePercent:.01}])}finally{E(!1)}},[]),B=d.useCallback(async()=>{try{if(I(!0),!ge()&&typeof window<"u"&&window.__TAURI_INTERNALS__)try{const a=await C.research.queryEnhanced({query:"trending news India",maxSources:5}).catch(()=>null);if(a&&a.sources&&a.sources.length>0){const h=a.sources.slice(0,5).map((P,D)=>({id:`news-${D}`,title:P.title||"News article",source:P.url?new URL(P.url).hostname:"News",time:`${Math.floor(Math.random()*24)}h`,trending:D<2}));A(h),I(!1);return}}catch{}A([{id:"1",title:"E-Passports Launched In India: What Are Digital Passports?",source:"The Daily Jagran",time:"5h",trending:!0},{id:"2",title:"India's Updated Quake Map Warns Entire Himalayan Arc",source:"TOI The Times of India",time:"22h"},{id:"3",title:"AI-Powered Research Tools Transform Education",source:"Tech News",time:"3h",trending:!0}])}catch(a){console.error("[NewTab] News fetch failed:",a)}finally{I(!1)}},[]),ce=d.useCallback(async()=>{try{T({temp:18,condition:"Partly Cloudy",location:"Medchal",airQuality:"Satisfactory"})}catch(a){console.error("[NewTab] Weather fetch failed:",a),T({temp:18,condition:"Partly Cloudy",location:"Medchal",airQuality:"Satisfactory"})}},[]);d.useEffect(()=>{F.current?.focus(),X(),B(),ce()},[X,B,ce]),d.useEffect(()=>{const a=setInterval(()=>{X()},3e4),h=setInterval(()=>{B()},3e5);return()=>{clearInterval(a),clearInterval(h)}},[X,B]);const te=d.useCallback(async a=>{const h=a.trim();if(!(!h||r)){l(!0);try{const D=/^https?:\/\//i.test(h)||/^[a-z0-9]+(\.[a-z0-9]+)+/i.test(h)?h.startsWith("http")?h:`https://${h}`:`https://www.google.com/search?q=${encodeURIComponent(h)}`,_=c&&(await C.tabs.list().catch(()=>[])).find(Y=>Y.id===c)||null;_&&(_.url==="about:blank"||!_.url)?await C.tabs.navigate(_.id,D):await C.tabs.create(D),s("")}catch(P){console.error("[NewTab] Search failed:",P)}finally{l(!1)}}},[c,r]),O=a=>{a.preventDefault(),te(i)},se=j.filter(a=>a.url&&a.url!=="about:blank"&&a.id!==c).slice(-6).reverse(),ae=[{id:"research",label:"Research",icon:ee,color:"from-purple-500 to-pink-500",action:()=>g("Research"),description:"AI-powered research with citations"},{id:"trade",label:"Trade",icon:ve,color:"from-green-500 to-emerald-500",action:()=>g("Trade"),description:"Real-time market analysis"},{id:"browse",label:"Browse",icon:Xe,color:"from-blue-500 to-cyan-500",action:()=>g("Browse"),description:"Standard web browsing"},{id:"docs",label:"Docs",icon:Ze,color:"from-orange-500 to-red-500",action:()=>g("Docs"),description:"Open document processing mode"},{id:"work",label:"Work",icon:et,color:"from-indigo-500 to-purple-500",action:async()=>{await C.tabs.create("about:blank")},description:"Start a new work session"},{id:"games",label:"Games",icon:tt,color:"from-pink-500 to-rose-500",action:async()=>{await C.tabs.create("https://www.google.com/search?q=online+games")},description:"Browse online games"}],V=["Discover","News","Markets","Research","Trade"];return e.jsxs("div",{className:"absolute inset-0 flex min-h-screen w-full flex-col overflow-hidden bg-gradient-to-br from-slate-50 via-white to-slate-50 dark:from-slate-950 dark:via-slate-900 dark:to-slate-950",children:[e.jsx("div",{className:"sticky top-0 z-30 border-b border-slate-200 bg-white/80 backdrop-blur-xl dark:border-slate-800 dark:bg-slate-900/80",children:e.jsx("div",{className:"mx-auto max-w-7xl px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 shadow-lg",children:e.jsx(Je,{size:20,className:"text-white"})}),e.jsx("span",{className:"bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-xl font-bold text-transparent",children:"Regen"})]}),e.jsx("div",{className:"hidden items-center gap-1 md:flex",children:V.map(a=>e.jsx("button",{onClick:()=>u(a),className:`rounded-lg px-4 py-2 text-sm font-medium transition-all ${o===a?"bg-blue-500 text-white shadow-md":"text-slate-600 hover:bg-slate-100 dark:text-slate-400 dark:hover:bg-slate-800"}`,children:a},a))}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("button",{className:"rounded-lg p-2 transition-colors hover:bg-slate-100 dark:hover:bg-slate-800",children:e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Personalize"})})})]})})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"mx-auto max-w-7xl px-6 py-8",children:[e.jsx(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"mb-12",children:e.jsx("div",{className:"mx-auto max-w-3xl",children:e.jsx("form",{onSubmit:O,className:"relative",children:e.jsxs("div",{className:"group relative",children:[e.jsx(ye,{size:24,className:"absolute left-6 top-1/2 z-10 -translate-y-1/2 text-slate-400 dark:text-slate-500"}),e.jsx("input",{id:"newtab-search-input",name:"newtab-search-query",ref:F,type:"text",value:i,onChange:a=>s(a.target.value),onKeyDown:a=>{a.key==="Enter"?(a.preventDefault(),te(i)):a.key==="Escape"&&(s(""),F.current?.blur())},placeholder:"Search the web or type a URL",className:"w-full rounded-2xl border-2 border-slate-200 bg-white py-5 pl-16 pr-32 text-lg text-slate-900 shadow-lg transition-all placeholder:text-slate-400 focus:border-blue-500 focus:outline-none focus:ring-4 focus:ring-blue-500/10 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-100 dark:placeholder:text-slate-500 dark:focus:border-blue-400 dark:focus:ring-blue-400/10",autoFocus:!0,"aria-label":"Search the web or type a URL","aria-describedby":"search-hint",role:"searchbox"}),e.jsx("span",{id:"search-hint",className:"sr-only",children:"Press Enter to search, Escape to clear"}),e.jsx("div",{className:"absolute right-4 top-1/2 flex -translate-y-1/2 items-center gap-2",children:e.jsxs("button",{type:"button",onClick:()=>g("Research"),className:"flex items-center gap-2 rounded-lg bg-gradient-to-r from-purple-500 to-pink-500 px-4 py-2 text-sm font-semibold text-white transition-all hover:shadow-lg",children:[e.jsx(ee,{size:16}),"AI Mode"]})})]})})})}),e.jsxs("div",{className:"grid grid-cols-1 gap-8 lg:grid-cols-3",children:[e.jsxs("div",{className:"space-y-6 lg:col-span-2",children:[e.jsxs(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},children:[e.jsx("h2",{className:"mb-4 text-sm font-semibold uppercase tracking-wide text-slate-700 dark:text-slate-300",children:"Quick Access"}),e.jsx("div",{className:"grid grid-cols-3 gap-4 sm:grid-cols-6",children:ae.map((a,h)=>{const P=a.icon;return e.jsxs(v.button,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.3,delay:.2+h*.05},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:a.action,className:"group relative flex flex-col items-center gap-2 rounded-xl border border-slate-200 bg-white p-4 transition-all hover:border-blue-500 hover:shadow-lg dark:border-slate-700 dark:bg-slate-800 dark:hover:border-blue-400",title:a.description||a.label,"aria-label":a.description?`${a.label}: ${a.description}`:a.label,children:[e.jsx("div",{className:`h-12 w-12 rounded-xl bg-gradient-to-br ${a.color} flex items-center justify-center shadow-md transition-shadow group-hover:shadow-lg`,children:e.jsx(P,{size:24,className:"text-white"})}),e.jsx("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:a.label})]},a.id)})})]}),e.jsxs(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.3},children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-sm font-semibold uppercase tracking-wide text-slate-700 dark:text-slate-300",children:"Trending News"}),e.jsx("button",{className:"text-xs text-blue-600 hover:underline dark:text-blue-400",children:"See all"})]}),e.jsx("div",{className:"space-y-4",children:f.length>0?f.map((a,h)=>e.jsx(v.article,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4,delay:.4+h*.1},onClick:async()=>{try{const P=`https://www.google.com/search?q=${encodeURIComponent(a.title)}`;await C.tabs.create(P)}catch(P){console.error("[NewTab] Failed to open article:",P)}},onKeyDown:async P=>{if(P.key==="Enter"||P.key===" "){P.preventDefault();try{const D=`https://www.google.com/search?q=${encodeURIComponent(a.title)}`;await C.tabs.create(D)}catch(D){console.error("[NewTab] Failed to open article:",D)}}},className:"group relative cursor-pointer rounded-2xl border border-slate-200 bg-white p-6 transition-all hover:border-blue-500 hover:shadow-xl focus:outline-none focus:ring-2 focus:ring-blue-500/50 dark:border-slate-700 dark:bg-slate-800 dark:hover:border-blue-400",tabIndex:0,role:"button","aria-label":`Open article: ${a.title}`,children:e.jsx("div",{className:"flex items-start gap-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[a.trending&&e.jsx("span",{className:"rounded-full bg-red-500 px-2 py-1 text-xs font-semibold text-white",children:"Trending"}),e.jsxs("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:[a.source," Â· ",a.time]})]}),e.jsx("h3",{className:"mb-2 text-lg font-semibold text-slate-900 transition-colors group-hover:text-blue-600 dark:text-slate-100 dark:group-hover:text-blue-400",children:a.title}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-500 dark:text-slate-400",children:[e.jsxs("button",{className:"flex items-center gap-1 hover:text-blue-600 dark:hover:text-blue-400",children:[e.jsx("span",{children:"12"}),e.jsx("span",{children:"ðŸ‘"})]}),e.jsx("button",{className:"flex items-center gap-1 hover:text-blue-600 dark:hover:text-blue-400",children:e.jsx("span",{children:"Comment"})}),e.jsx("button",{className:"flex items-center gap-1 hover:text-blue-600 dark:hover:text-blue-400",children:e.jsx("span",{children:"Share"})})]})]})})},a.id)):R?Array.from({length:3}).map((a,h)=>e.jsx("div",{className:"animate-pulse rounded-2xl border border-slate-200 bg-white p-6 dark:border-slate-700 dark:bg-slate-800",children:e.jsx("div",{className:"flex items-start gap-4",children:e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsx("div",{className:"h-4 w-1/4 rounded bg-slate-200 dark:bg-slate-700"}),e.jsx("div",{className:"h-5 w-3/4 rounded bg-slate-200 dark:bg-slate-700"}),e.jsx("div",{className:"h-4 w-1/2 rounded bg-slate-200 dark:bg-slate-700"})]})})},`news-skeleton-${h}`)):e.jsx("div",{className:"py-8 text-center text-sm text-slate-500 dark:text-slate-400",children:"No news available"})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},className:"rounded-2xl border border-slate-200 bg-white p-6 shadow-lg dark:border-slate-700 dark:bg-slate-800",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Markets"}),e.jsxs("div",{className:"flex items-center gap-2",children:[$&&e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-blue-500 border-t-transparent"}),e.jsxs("button",{onClick:()=>{g("Trade")},className:"flex items-center gap-1 text-xs text-blue-600 hover:underline dark:text-blue-400",children:["See market",e.jsx(st,{size:12})]})]})]}),e.jsx("div",{className:"space-y-3",children:p.length>0?p.map(a=>{const h=a.changePercent>=0;return e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-100 py-2 last:border-0 dark:border-slate-700",children:[e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-slate-100",children:a.symbol})}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-slate-100",children:a.value.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}),e.jsxs("div",{className:`flex items-center justify-end gap-1 text-xs ${h?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:[h?e.jsx(at,{size:12}):e.jsx(rt,{size:12}),e.jsxs("span",{children:[Math.abs(a.changePercent).toFixed(2),"% (",h?"+":"",a.change.toFixed(2),")"]})]})]})]},a.symbol)}):$?Array.from({length:5}).map((a,h)=>e.jsxs("div",{className:"flex animate-pulse items-center justify-between border-b border-slate-100 py-2 last:border-0 dark:border-slate-700",children:[e.jsx("div",{className:"h-4 w-20 rounded bg-slate-200 dark:bg-slate-700"}),e.jsx("div",{className:"h-4 w-24 rounded bg-slate-200 dark:bg-slate-700"})]},`market-skeleton-${h}`)):e.jsx("div",{className:"py-8 text-center text-sm text-slate-500 dark:text-slate-400",children:"No market data available"})})]}),y&&e.jsxs(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.3},className:"rounded-2xl bg-gradient-to-br from-blue-500 to-cyan-500 p-6 text-white shadow-xl",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-1 text-lg font-semibold",children:y.location}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(De,{size:20}),e.jsxs("span",{className:"text-3xl font-bold",children:[y.temp,"Â°C"]})]})]}),e.jsx(nt,{size:32,className:"text-yellow-200"})]}),e.jsxs("div",{className:"border-t border-white/20 pt-4",children:[e.jsxs("p",{className:"mb-3 text-sm text-white/90",children:[y.airQuality," air quality tomorrow"]}),e.jsx("div",{className:"flex gap-2",children:["Hourly","Daily","Air quality"].map((a,h)=>e.jsx("button",{className:`rounded-lg px-3 py-1 text-xs font-medium transition-all ${h===1?"bg-white/20 text-white":"text-white/70 hover:bg-white/10 hover:text-white"}`,children:a},a))})]})]}),se.length>0&&e.jsxs(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},className:"rounded-2xl border border-slate-200 bg-white p-6 shadow-lg dark:border-slate-700 dark:bg-slate-800",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx(Le,{size:16,className:"text-slate-500 dark:text-slate-400"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Recent"})]}),e.jsx("div",{className:"space-y-2",children:se.map(a=>e.jsxs("button",{onClick:async()=>{await C.tabs.activate({id:a.id})},className:"group w-full rounded-lg px-3 py-2 text-left transition-colors hover:bg-slate-100 dark:hover:bg-slate-700",children:[e.jsx("div",{className:"truncate text-sm font-medium text-slate-900 group-hover:text-blue-600 dark:text-slate-100 dark:group-hover:text-blue-400",children:a.title||new URL(a.url||"").hostname}),e.jsx("div",{className:"truncate text-xs text-slate-500 dark:text-slate-400",children:new URL(a.url||"").hostname})]},a.id))})]})]})]})]})}),e.jsx("div",{className:"sticky bottom-6 left-0 right-0 z-20 flex justify-end px-6",children:e.jsx(v.button,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.5},className:"flex items-center gap-2 rounded-lg bg-blue-500 px-4 py-2 text-sm font-semibold text-white shadow-lg transition-all hover:bg-blue-600 hover:shadow-xl",children:e.jsx("span",{children:"Customize Chrome"})})})]})}const $t={as:"as-IN",bn:"bn-IN",brx:"brx-IN",doi:"doi-IN",gom:"gom-IN",gu:"gu-IN",hi:"hi-IN",kn:"kn-IN",ks:"ks-IN",mai:"mai-IN",ml:"ml-IN",mni:"mni-IN",mr:"mr-IN",ne:"ne-NP",or:"or-IN",pa:"pa-IN",sa:"sa-IN",sat:"sat-IN",sd:"sd-PK",ta:"ta-IN",te:"te-IN",ur:"ur-PK",en:"en-US",es:"es-ES",fr:"fr-FR",de:"de-DE",zh:"zh-CN",ja:"ja-JP",ko:"ko-KR",ru:"ru-RU",pt:"pt-PT",ar:"ar-SA"};function Ut(i){return!i||i==="auto"?"en-US":$t[i]||i.includes("-")?i:`${i}-${i.toUpperCase()}`}const Mt=["bing","yahoo","startpage","ecosia"];function je(i,s,r,l=!0){const o=encodeURIComponent(s),u=Ut(r),p=u.split("-")[0];if(l&&!Mt.includes(i)&&(i==="duckduckgo"||i==="google"))return`https://www.bing.com/search?q=${o}&setlang=${p}`;switch(i){case"duckduckgo":return`https://duckduckgo.com/?q=${o}&kl=${u}&hl=${p}`;case"bing":return`https://www.bing.com/search?q=${o}&setlang=${p}`;case"yahoo":return`https://search.yahoo.com/search?p=${o}&lang=${p}`;case"startpage":return`https://www.startpage.com/sp/search?query=${o}&language=${p}`;case"ecosia":return`https://www.ecosia.org/search?q=${o}&language=${p}`;default:return l?`https://www.bing.com/search?q=${o}&setlang=${p}`:`https://www.google.com/search?q=${o}&hl=${p}&gl=${u.split("-")[1]||"US"}`}}function _t(i){const s=i.trim().toLowerCase();if(/^[a-z][a-z0-9+.-]*:/.test(s))return!0;if(/\s/.test(s))return!1;if(/^([a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?\.)+[a-z]{2,}(\/.*)?$/i.test(s))try{const o=new URL(`https://${s}`);return o.hostname.includes(".")&&o.hostname.split(".").length>=2}catch{return!1}return!!(/^(\d{1,3}\.){3}\d{1,3}(:\d+)?(\/.*)?$/.test(s)||s.startsWith("localhost")||s.startsWith("127.0.0.1")||/^(about|file|data|blob|javascript):/i.test(s))}function zt(i,s="google",r,l=!0){const o=i.trim();if(!o)return"about:blank";if(_t(o)){try{const p=new URL(o);if(p.protocol==="http:"||p.protocol==="https:")return p.toString()}catch{}try{return new URL(`https://${o}`).toString()}catch{}}return je(s==="all"?l?"bing":"google":s,o,r,l)}const Vt=Object.freeze(Object.defineProperty({__proto__:null,buildSearchUrl:je,normalizeInputToUrlOrSearch:zt},Symbol.toStringTag,{value:"Module"})),Wt=["@live explain quantum computing basics","graph the AI ethics landscape","summarize today's markets","compare battery life of M-series laptops","find regenerative design principles"];function Ot(i,s){return je("duckduckgo",i,s)}function Ft(){const[i,s]=d.useState([]),[r,l]=d.useState([]),[o,u]=d.useState(!0),[p,S]=d.useState(!0),f=_e(y=>y.pushEvent),A=d.useCallback(async()=>{if(!window.ipc||typeof window.ipc.invoke!="function")return!1;u(!0),S(!0);try{const T=(await C.workspaceV2.list())?.workspaces||[];s(T.slice(0,4)),u(!1)}catch{s([]),u(!1)}try{const y=await C.sessions.list(),E=(Array.isArray(y)?y:[]).slice(0,3).map(R=>({id:R.id,type:R.name?.includes("Research")?"Research":"Browse",title:R.name||"Untitled Session",url:R.lastUrl||"about:blank",timestamp:R.updatedAt||R.createdAt||Date.now()-36e5,sessionId:R.id})).filter(R=>R.type==="Research");E.length>0?l(E):l([{type:"Research",title:"Quantum Computing Research",url:"about:blank",timestamp:Date.now()-36e5}]),S(!1)}catch{l([{type:"Research",title:"Quantum Computing Research",url:"about:blank",timestamp:Date.now()-36e5}]),S(!1)}return!0},[]);return d.useEffect(()=>{let y=!1;const T=()=>{y||A().then(R=>{!R&&!y&&setTimeout(T,500)})},$=setTimeout(T,350),E=$e.on("workspace:updated",()=>{f({type:"workspace:updated",message:"Workspace metadata refreshed"}),y||A()});return()=>{y=!0,clearTimeout($),E()}},[A]),{recentWorkspaces:i,continueSessions:r,reload:A,loadingWorkspaces:o,loadingSessions:p}}function Yt({variant:i="overlay",forceShow:s=!1,useChromeStyle:r=!1}){const{tabs:l,activeId:o}=xe(),{setMode:u}=Ae(),p=lt(),{recentWorkspaces:S,continueSessions:f,reload:A,loadingWorkspaces:y,loadingSessions:T}=Ft(),[$,E]=d.useState(""),[R,I]=d.useState(!1),[c,j]=d.useState(!1),[g,F]=d.useState(!1),[X,B]=d.useState(""),ce=le(t=>t.label),te=le(t=>t.badge),O=le(t=>t.snapshot),se=le(t=>t.lastUpdated),ae=le(t=>t.history),V=_e(t=>t.pushEvent),a=ue(t=>t.status),h=ue(t=>t.lastGoal),P=ue(t=>t.events),D=ue(t=>t.transcript),_=Ie(t=>t.appearance.chromeNewTabPage??!0),Y=Ie(t=>t.language||"auto"),q=d.useMemo(()=>{const t=P.slice(-3).reverse(),n=t.length>0?t[0].timestamp:null,m=D.split(`
`).map(x=>x.trim()).filter(Boolean),N={idle:{label:"Idle",tone:"border-slate-700/60 bg-slate-800/60 text-slate-300"},connecting:{label:"Connecting",tone:"border-blue-500/40 bg-blue-500/15 text-blue-100"},live:{label:"Streaming",tone:"border-emerald-500/40 bg-emerald-500/15 text-emerald-100"},complete:{label:"Complete",tone:"border-purple-500/40 bg-purple-500/15 text-purple-100"},error:{label:"Error",tone:"border-rose-500/40 bg-rose-500/15 text-rose-100"}},M=N[a]??N.idle,b=t.map(x=>{switch(x.type){case"start":return{...x,label:"Run started",detail:x.content??"Agent boot sequence initiated.",variant:"border-blue-400/40 bg-blue-500/10 text-blue-100"};case"step":return{...x,label:`Step ${x.step??""}`.trim(),detail:x.content??x.status??"Executing tool callâ€¦",variant:"border-purple-400/40 bg-purple-500/10 text-purple-100"};case"log":return{...x,label:"Log update",detail:x.content??"Log appended.",variant:"border-slate-400/40 bg-slate-500/10 text-slate-100"};case"consent":return{...x,label:x.approved?"Consent granted":"Consent requested",detail:x.content??`Risk ${x.risk??"medium"} Â· ${x.approved?"approved":"pending"}`,variant:x.approved?"border-emerald-400/40 bg-emerald-500/10 text-emerald-100":"border-amber-400/40 bg-amber-500/10 text-amber-100"};case"done":return{...x,label:"Run complete",detail:x.content??"Outputs finalised.",variant:"border-emerald-400/40 bg-emerald-500/10 text-emerald-100"};case"error":return{...x,label:"Run error",detail:x.content??"Check diagnostics for details.",variant:"border-rose-400/40 bg-rose-500/10 text-rose-100"};default:return{...x,label:x.type,detail:x.content??"Event received.",variant:"border-slate-400/40 bg-slate-500/10 text-slate-100"}}}),L=b.map(x=>x.detail).filter(Boolean).slice(0,2),k=L.length>0?L:m.slice(-2);return{latestEvents:t,timeline:b,snippet:k,lastUpdated:n,statusTone:M}},[P,D,a]),Z=d.useMemo(()=>D.trim().length>0,[D]),[G,w]=d.useState("idle"),re=d.useCallback(async()=>{if(!Z||typeof navigator>"u"||!navigator.clipboard){w("error");return}try{w("copying"),await navigator.clipboard.writeText(D.trim()),w("copied")}catch(t){console.warn("[OmniDesk] Failed to copy transcript",t),w("error")}},[D,Z]);d.useEffect(()=>{if(G!=="copied")return;const t=window.setTimeout(()=>w("idle"),2e3);return()=>window.clearTimeout(t)},[G]);const z=d.useMemo(()=>{const t=typeof O.batteryPct=="number"?Math.max(0,Math.min(100,Math.round(O.batteryPct))):null,n=typeof O.carbonIntensity=="number"?Math.max(0,Math.round(O.carbonIntensity)):null,m=Number.isFinite(O.cpuLoad1)?Math.max(0,Math.min(100,Math.round(O.cpuLoad1))):0,N=O.activeTabs??0,M=(()=>{const L=t!==null?t*.4:35,k=100-m,x=n!==null?Math.max(0,220-n)/220*100:50,W=Math.max(0,12-N)/12*100,be=.35*L+.25*k+.25*x+.15*W;return Math.round(Math.max(5,Math.min(98,be)))})(),b=[{id:"battery",label:t!==null?`${t}% battery reserve`:"Gathering battery telemetry",description:t!==null&&t>=60?"Great reserve for deep work.":"Stay plugged in to build reserve.",achieved:t!==null&&t>=60,icon:it},{id:"carbon",label:n!==null?`${n} gCOâ‚‚/kWh grid intensity`:"Estimating regional carbon mix",description:n!==null&&n<=180?"Low-carbon window â€” ideal for heavy tasks.":"Carbon intensity elevated. Schedule net-heavy work later.",achieved:n!==null&&n<=180,icon:De},{id:"tabs",label:`${N} active tabs`,description:N<=6?"Lean session profile â€” memory savings unlocked.":"Consider Hibernate to free resources.",achieved:N<=6,icon:ee}];return{batteryPctValue:t,carbonIntensityValue:n,cpuLoad:m,activeTabs:N,ecoScore:M,achievements:b}},[O]),U=d.useMemo(()=>{const t=ae.slice(-24),n=t.map(b=>typeof b.batteryPct=="number"?b.batteryPct:null).filter(b=>b!==null),m=t.map(b=>typeof b.carbonIntensity=="number"?b.carbonIntensity:null).filter(b=>b!==null),N=b=>{if(b.length<2)return{delta:0,direction:"flat"};const L=b[b.length-1],k=Math.max(0,b.length-6),x=b[k],W=L-x;return{delta:W,direction:W>1?"up":W<-1?"down":"flat"}},M=b=>{if(b.length<2)return"";const L=Math.min(...b),x=Math.max(...b)-L||1;return b.map((W,be)=>{const He=be/Math.max(b.length-1,1)*100,Qe=100-(W-L)/x*80-10;return`${He.toFixed(2)},${Qe.toFixed(2)}`}).join(" ")};return{battery:{series:n,path:M(n),trend:N(n)},carbon:{series:m,path:M(m),trend:N(m)}}},[ae]),ze={idle:"Agent idle",connecting:"Connecting to Redixâ€¦",live:"Streaming answer in real time",complete:"Last run completed",error:"Run encountered an issue"},H=d.useMemo(()=>{const n=2*Math.PI*46,m=Math.max(0,Math.min(100,z.ecoScore)),N=n-m/100*n;return{radius:46,circumference:n,offset:N,clampedScore:m}},[z.ecoScore]),We=[{icon:ee,label:"Ask Agent",action:async()=>{p("/agent")},color:"from-blue-500 to-cyan-500",description:"Open the agent console to start a guided workflow."},{icon:ye,label:"Search Topic",action:async()=>{u("Research"),await C.tabs.create("about:blank")},color:"from-purple-500 to-pink-500",description:"Launch AI-powered research with citations-first results."},{icon:ot,label:"Research Notes",action:async()=>{u("Research"),await C.tabs.create("about:blank")},color:"from-green-500 to-emerald-500",description:"Capture structured notes that sync with your highlights."},{icon:ct,label:"Run Playbook",action:()=>{p("/playbooks")},color:"from-orange-500 to-red-500",description:"Automate multi-step workflows with reusable recipes."}],me=d.useMemo(()=>{const t=z.batteryPctValue!==null?`${z.batteryPctValue}%`:"â€”",n=z.carbonIntensityValue!==null?`${z.carbonIntensityValue} gCOâ‚‚/kWh`:"Syncingâ€¦",m=`${z.activeTabs}`;return{batteryPct:t,carbonIntensity:n,activeTabs:m}},[z]),ke=async t=>{try{let n=t.url||"about:blank";if(t.sessionId)try{await C.sessions.setActive({sessionId:t.sessionId}),await new Promise(M=>setTimeout(M,200));const N=await C.tabs.list();if(N.length>0){!N.find(b=>b.active)&&N[0]&&await C.tabs.activate({id:N[0].id});return}(!n||n==="about:blank")&&(n="about:blank")}catch(N){console.warn("Failed to set active session:",N)}if(u("Research"),!await C.tabs.create(n))throw new Error("Failed to create tab");await new Promise(N=>setTimeout(N,100))}catch(n){console.error("Failed to continue session:",n);try{await C.tabs.create("about:blank"),V({type:"workspace:resume-session",workspaceId:t.sessionId??null,message:`Started fallback tab for session "${t.title}"`})}catch(m){console.error("Failed to create fallback tab:",m)}}},ne=d.useCallback(async t=>{const n=t.trim();if(!n){console.warn("[OmniDesk] Empty search query, ignoring");return}if(c){console.warn("[OmniDesk] Search already in progress, ignoring");return}if(j(!0),console.log("[OmniDesk] Launching search:",n),n.trim().startsWith("@live")||n.trim().startsWith("@ask")||n.trim().startsWith("@redix")){const k=n.trim().replace(/^@(live|ask|redix)\s*/i,"");B(k||n),F(!0),j(!1);return}/^(what|why|how|when|where|who|explain|summarize|compare|find)/i.test(n.trim())&&n.trim().length>10&&(B(n),F(!0));const M=l.find(k=>k.id===o),b=M?.url==="about:blank"||!M?.url||M?.url?.startsWith("about:"),L=Ot(n,Y!=="auto"?Y:void 0);u("Research");try{if(b&&M)try{console.log("[OmniDesk] Navigating existing tab:",M.id,"to:",L),await C.tabs.navigate(M.id,L),E(""),console.log("[OmniDesk] Navigation successful");return}catch(W){console.warn("[OmniDesk] Failed to navigate existing tab, creating new one:",W)}console.log("[OmniDesk] Creating new tab with URL:",L);const k=await C.tabs.create(L);(k&&typeof k=="object"&&"success"in k?k.success!==!1:!!k)?console.log("[OmniDesk] Tab created successfully:",k):(console.warn("[OmniDesk] Tab creation failed, using fallback"),Pe({url:L,title:`Search: ${n}`}),V({type:"workspace:launch-fallback",message:"IPC unavailable, opened search in fallback tab."}),typeof window<"u"&&window.open(L,"_blank","noopener,noreferrer")),E("")}catch(k){console.error("[OmniDesk] Search launch error:",k);const x=k instanceof Error?k.message:String(k);try{Pe({url:L,title:`Search: ${n}`})}catch(W){console.error("[OmniDesk] Fallback tab creation failed:",W),typeof window<"u"&&window.open(L,"_blank","noopener,noreferrer")}V({type:"workspace:launch-error",message:"Encountered an error launching the flow. Using fallback tab.",payload:{error:x}})}finally{j(!1)}},[V,u,l,o,c]),Q=l.find(t=>t.id===o),he=Q?.url==="about:blank"||!Q?.url||Q?.url?.startsWith("about:")||Q?.url?.startsWith("ob://newtab")||Q?.url?.startsWith("ob://home"),de=s||l.length===0||!Q||he;if(!de)return null;if(_!==!1)return e.jsx(At,{});const Oe=i==="overlay"?"absolute inset-0 z-20 flex h-full w-full overflow-auto bg-gradient-to-br from-[#131722] via-[#171B2A] to-[#10131C] px-6 py-8":i==="split"?"flex h-full w-full overflow-auto bg-gradient-to-br from-[#131722] via-[#171B2A] to-[#10131C] px-6 py-8":"flex h-full w-full overflow-auto bg-gradient-to-br from-[#0F121C] via-[#131827] to-[#0F121C] px-6 py-8",Fe={minHeight:"100%",width:"100%",position:i==="overlay"?"absolute":"relative",zIndex:i==="overlay"?20:1,pointerEvents:de?"auto":"none"},Be=async()=>{I(!0);try{await A(),V({type:"workspace:manual-refresh",message:"Dashboard refreshed"})}finally{I(!1)}},qe=d.useMemo(()=>Array.from({length:2}),[]),Ge=d.useMemo(()=>Array.from({length:3}),[]);return d.useEffect(()=>{typeof window<"u"&&window.IS_DEV!==void 0&&console.log("[OmniDesk] Rendering dashboard:",{shouldShowDashboard:de,forceShow:s,tabsLength:l.length,activeTab:Q,isAboutBlank:he,variant:i})},[de,s,l.length,Q,he,i]),e.jsxs("div",{className:Oe,"data-onboarding":"dashboard",style:Fe,children:[e.jsxs("div",{className:"mx-auto flex h-full w-full max-w-6xl flex-col gap-6 xl:flex-row",style:{minHeight:"100%"},children:[e.jsxs("div",{className:"flex-1 space-y-6",children:[e.jsxs(v.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.4},className:"rounded-3xl border border-slate-800/70 bg-slate-900/70 px-6 py-7 shadow-2xl shadow-black/30",children:[e.jsx("p",{className:"text-xs font-medium uppercase tracking-[0.32em] text-slate-400",children:"Regenerative Command Center"}),e.jsx("h1",{className:"mt-3 text-3xl font-bold leading-tight text-slate-50 sm:text-4xl lg:text-5xl",children:"Guide your next deep work session with Regen & Redix"}),e.jsx("p",{className:"mt-3 max-w-2xl text-base leading-relaxed text-slate-300",children:"Spin up an agent, resume an exploration, or launch a new search. Your flow state starts here."}),e.jsxs("form",{className:"mt-6 space-y-3",onSubmit:t=>{t.preventDefault(),ne($)},children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row",children:[e.jsxs("div",{className:"flex min-h-[52px] flex-1 items-center gap-3 rounded-2xl border border-slate-700/60 bg-slate-800/70 px-4 py-3 text-slate-200 focus-within:border-blue-500/60",children:[e.jsx(ye,{size:18,className:"text-blue-400"}),e.jsx("input",{value:$,onChange:t=>E(t.target.value),onKeyDown:t=>{t.key==="Enter"&&(t.preventDefault(),ne($))},onClick:t=>{t.stopPropagation()},placeholder:"Search the open web, knowledge base, or ask Redixâ€¦",className:"flex-1 bg-transparent text-sm outline-none placeholder:text-slate-500",style:{pointerEvents:"auto",zIndex:10},autoFocus:!1,tabIndex:0,"aria-label":"Search the open web, knowledge base, or ask Redix","aria-describedby":"search-hint",role:"searchbox"}),e.jsx("span",{id:"search-hint",className:"sr-only",children:"Press Enter to search or launch flow. Use @live or @ask prefix for AI queries."})]}),e.jsx("button",{type:"submit",onClick:t=>{t.preventDefault(),t.stopPropagation(),ne($)},disabled:c||!$.trim(),className:"inline-flex cursor-pointer items-center justify-center gap-2 rounded-2xl border border-blue-500/60 bg-blue-500/20 px-5 py-3 text-sm font-semibold text-blue-100 shadow-[0_10px_40px_-20px_rgba(59,130,246,0.8)] transition hover:border-blue-400 hover:bg-blue-500/30 focus:outline-none focus:ring-2 focus:ring-blue-500/50 disabled:cursor-not-allowed disabled:opacity-60",style:{pointerEvents:"auto",zIndex:10},"aria-label":c?"Launching search":"Launch search flow","aria-busy":c,children:c?e.jsxs(e.Fragment,{children:[e.jsx(Te,{size:16,className:"animate-spin"}),e.jsx("span",{children:"Launching..."})]}):"Launch Flow"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 text-xs text-slate-400",children:Wt.map(t=>e.jsx("button",{type:"button",onClick:n=>{n.preventDefault(),n.stopPropagation(),!c&&(E(t),ne(t))},disabled:c,onKeyDown:n=>{(n.key==="Enter"||n.key===" ")&&(n.preventDefault(),n.stopPropagation(),E(t),ne(t))},className:"cursor-pointer rounded-full border border-slate-700/60 bg-slate-800/60 px-3 py-1.5 transition hover:border-blue-500/50 hover:bg-slate-800/80 hover:text-blue-200 focus:outline-none focus:ring-2 focus:ring-blue-500/50 disabled:cursor-not-allowed disabled:opacity-50",style:{pointerEvents:"auto",zIndex:10},"aria-label":`Suggested search: ${t}`,tabIndex:0,children:t},t))})]})]}),e.jsx(v.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1,duration:.4},className:"grid gap-3 sm:grid-cols-2 xl:grid-cols-3",children:We.map(t=>{const n=t.icon;return e.jsxs(v.button,{onClick:m=>{m.preventDefault(),m.stopPropagation(),!c&&t.action()},onKeyDown:m=>{if(m.key==="Enter"||m.key===" "){if(m.preventDefault(),m.stopPropagation(),c)return;t.action()}},disabled:c,whileHover:c?{}:{y:-4,scale:1.02},whileTap:c?{}:{scale:.96},transition:{type:"spring",stiffness:400,damping:17},className:`group flex h-full cursor-pointer flex-col justify-between gap-4 rounded-2xl border border-slate-800/70 bg-slate-900/60 px-5 py-6 text-left shadow-[0_12px_40px_-24px_rgba(15,23,42,0.9)] transition hover:border-slate-700/70 hover:bg-slate-900/80 focus:outline-none focus:ring-2 focus:ring-blue-500/50 ${c?"cursor-not-allowed opacity-60":""}`,style:{pointerEvents:"auto",zIndex:10},"aria-label":t.description?`${t.label}: ${t.description}`:t.label,tabIndex:0,children:[e.jsx("span",{className:`inline-flex h-11 w-11 items-center justify-center rounded-xl bg-gradient-to-br ${t.color} text-white shadow-[0_15px_30px_-20px_currentColor]`,children:e.jsx(n,{className:"h-5 w-5"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-100 group-hover:text-white",children:t.label}),t.description?e.jsx("p",{className:"text-xs leading-snug text-slate-400 group-hover:text-slate-300",children:t.description}):null]})]},t.label)})}),e.jsxs(v.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.16,duration:.4},className:"rounded-3xl border border-violet-500/30 bg-violet-500/10 px-6 py-5 text-violet-100 shadow-[0_45px_120px_-60px_rgba(139,92,246,0.6)]",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold",children:[e.jsx("span",{className:"inline-flex h-9 w-9 items-center justify-center rounded-xl border border-violet-400/40 bg-violet-500/20",children:e.jsx(dt,{size:16})}),"Live Redix Pulse"]}),e.jsxs("span",{className:`inline-flex items-center gap-2 rounded-full px-3 py-1 text-[11px] ${q.statusTone.tone}`,children:[e.jsx("span",{className:"h-2 w-2 rounded-full bg-current"}),ze[a]]})]}),e.jsxs("div",{className:"mt-4 space-y-3 text-sm text-purple-100/90",children:[h?e.jsxs("div",{className:"rounded-2xl border border-violet-400/30 bg-violet-500/10 px-4 py-3 text-xs text-purple-100/80",children:[e.jsx("span",{className:"text-[11px] uppercase tracking-[0.28em] text-purple-200/70",children:"Last goal"}),e.jsx("p",{className:"mt-2 text-sm text-purple-100",children:h})]}):null,e.jsxs("div",{className:"rounded-2xl border border-violet-400/20 bg-violet-500/10 px-4 py-4",children:[e.jsx("span",{className:"text-[11px] uppercase tracking-[0.3em] text-purple-200/70",children:"Preview"}),e.jsx("div",{className:"mt-2 text-xs text-purple-100/80",children:e.jsx(we,{mode:"popLayout",children:q.snippet.length>0?q.snippet.map((t,n)=>e.jsx(v.p,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},exit:{opacity:0,y:-6},transition:{duration:.25},className:"leading-relaxed",children:t},`${t}-${n}`)):e.jsx(v.p,{initial:{opacity:.6},animate:{opacity:1},className:"text-purple-200/70",children:"No live transcript yet. Kick off a prompt to watch the agent stream."})})})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-[11px]",children:[e.jsxs("button",{type:"button",onClick:re,disabled:!Z||G==="copying",className:"inline-flex items-center gap-1 rounded-full border border-violet-400/40 bg-violet-500/15 px-3 py-1 font-medium text-purple-100 transition hover:border-violet-300/60 hover:bg-violet-500/25 disabled:cursor-not-allowed disabled:opacity-60",children:[e.jsx(ut,{size:12}),G==="copied"?"Copied!":G==="copying"?"Copyingâ€¦":"Copy transcript"]}),e.jsxs("button",{type:"button",onClick:()=>p("/agent"),className:"inline-flex items-center gap-1 rounded-full border border-violet-400/40 bg-violet-500/15 px-3 py-1 font-medium text-purple-100 transition hover:border-violet-300/60 hover:bg-violet-500/25",children:[e.jsx(pt,{size:12}),"View run log"]}),e.jsxs("button",{type:"button",onClick:()=>p("/agent"),className:"inline-flex items-center gap-1 rounded-full border border-violet-400/40 bg-violet-500/15 px-3 py-1 font-medium text-purple-100 transition hover:border-violet-300/60 hover:bg-violet-500/25",children:[e.jsx(xt,{size:12}),"Launch prompt"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-[11px] uppercase tracking-[0.28em] text-purple-200/70",children:"Timeline"}),e.jsx("div",{className:"mt-2 space-y-2",children:e.jsx(we,{initial:!1,children:q.timeline.length>0?q.timeline.map(t=>e.jsxs(v.div,{initial:{opacity:0,x:8},animate:{opacity:1,x:0},exit:{opacity:0,x:-8},transition:{duration:.2},className:`flex items-center justify-between rounded-xl px-3 py-2 text-[11px] ${t.variant}`,children:[e.jsx("span",{className:"capitalize",children:t.label}),e.jsx("span",{className:"text-purple-300/70",children:pe(t.timestamp,{addSuffix:!0})})]},t.id)):e.jsx(v.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},className:"rounded-xl border border-dashed border-violet-400/30 px-4 py-3 text-[11px] text-purple-200/70",children:"No agent events yet â€” run a plan or quick prompt to populate this stream."})})})]})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap justify-between gap-2 text-xs",children:[e.jsx("div",{className:"text-purple-200/60",children:q.lastUpdated?`Updated ${pe(q.lastUpdated,{addSuffix:!0})}`:"Awaiting first signal"}),e.jsx("button",{type:"button",onClick:()=>p("/agent"),className:"inline-flex items-center gap-2 rounded-full border border-violet-400/40 bg-violet-500/20 px-3 py-1.5 text-xs font-medium text-purple-100 hover:border-violet-300/60 hover:bg-violet-500/30",children:"Open agent console"})]})]}),e.jsx(v.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2,duration:.4},className:"rounded-3xl border border-slate-800/60 bg-slate-900/60 px-6 py-5 shadow-lg",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm text-slate-400",children:[e.jsx(mt,{size:16,className:"text-slate-300"}),e.jsx("span",{children:"Pro tip:"}),e.jsx("span",{className:"text-slate-300",children:"Drag any research tab into Redix MindMap to instantly connect ideas."})]})})]}),e.jsxs("aside",{className:"w-full flex-shrink-0 space-y-4 xl:w-[360px]",children:[e.jsxs(v.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},transition:{duration:.4},className:"rounded-2xl border border-slate-800/70 bg-slate-900/70 p-5 shadow-lg",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between text-sm font-semibold text-slate-300",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Le,{size:16}),"Continue Session"]}),e.jsx("button",{onClick:Be,className:"rounded-full border border-slate-700/60 p-1.5 text-slate-400 transition hover:border-slate-500/60 hover:text-slate-200",title:"Refresh",children:e.jsx(ht,{size:14,className:R?"animate-spin":""})})]}),e.jsx("div",{className:"space-y-3",children:T?qe.map((t,n)=>e.jsxs(v.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{delay:n*.1,duration:.3},className:"h-[86px] w-full rounded-xl border border-slate-800/60 bg-slate-900/40 p-4",children:[e.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[e.jsx("div",{className:"h-5 w-16 animate-pulse rounded-full bg-slate-800/60"}),e.jsx("div",{className:"h-4 w-20 animate-pulse rounded-full bg-slate-800/60"})]}),e.jsx("div",{className:"h-5 w-3/4 animate-pulse rounded bg-slate-800/60"})]},`session-skeleton-${n}`)):f.length>0?f.map((t,n)=>e.jsxs("button",{onClick:m=>{m.preventDefault(),m.stopPropagation(),ke(t)},onKeyDown:m=>{(m.key==="Enter"||m.key===" ")&&(m.preventDefault(),m.stopPropagation(),ke(t))},className:"group w-full cursor-pointer rounded-xl border border-slate-800/60 bg-slate-900/60 px-4 py-3 text-left transition hover:border-slate-600/60 hover:bg-slate-900 focus:outline-none focus:ring-2 focus:ring-blue-500/50",style:{pointerEvents:"auto",zIndex:10},children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[e.jsx("span",{className:`rounded-full px-2 py-0.5 text-[11px] ${t.type==="Research"?"bg-purple-500/20 text-purple-300":t.type==="Trade"?"bg-emerald-500/20 text-emerald-300":"bg-blue-500/20 text-blue-200"}`,children:t.type}),e.jsx("span",{children:pe(t.timestamp,{addSuffix:!0})})]}),e.jsx("div",{className:"mt-2 text-sm font-medium text-slate-100 group-hover:text-white",children:t.title})]},n)):e.jsx("div",{className:"rounded-xl border border-dashed border-slate-700/60 px-4 py-6 text-center text-xs text-slate-500",children:"Weâ€™ll keep your auto-snapshots here for quick handoffs."})})]}),e.jsxs(v.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},transition:{delay:.1,duration:.4},className:"rounded-2xl border border-slate-800/70 bg-slate-900/70 p-5 shadow-lg",children:[e.jsxs("div",{className:"mb-3 flex items-center gap-2 text-sm font-semibold text-slate-300",children:[e.jsx(bt,{size:16}),"Recent Workspaces"]}),e.jsx("div",{className:"space-y-2",children:y?Ge.map((t,n)=>e.jsx(v.div,{initial:{opacity:0,x:-8},animate:{opacity:1,x:0},transition:{delay:n*.08,duration:.3},className:"flex h-14 w-full items-center rounded-xl border border-slate-800/60 bg-slate-900/40 p-3",children:e.jsx("div",{className:"h-4 w-2/3 animate-pulse rounded bg-slate-800/60"})},`workspace-skeleton-${n}`)):S.length>0?S.map(t=>e.jsxs("button",{onClick:n=>{n.preventDefault(),n.stopPropagation(),p(`/w/${t.id}`)},onKeyDown:n=>{(n.key==="Enter"||n.key===" ")&&(n.preventDefault(),n.stopPropagation(),p(`/w/${t.id}`))},className:"flex w-full cursor-pointer items-center justify-between rounded-xl border border-slate-800/60 bg-slate-900/60 px-4 py-3 text-left text-sm text-slate-200 transition hover:border-slate-600/70 hover:text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50",style:{pointerEvents:"auto",zIndex:10},children:[e.jsx("span",{className:"truncate",children:t.name}),e.jsx("span",{className:"text-xs text-slate-500",children:"Open"})]},t.id)):e.jsx("div",{className:"rounded-xl border border-dashed border-slate-700/60 px-4 py-6 text-center text-xs text-slate-500",children:"Create a workspace to keep your Redix graph evolving."})})]}),e.jsxs(v.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},transition:{delay:.2,duration:.4},className:"overflow-hidden rounded-2xl border border-emerald-500/30 bg-gradient-to-br from-emerald-950/80 via-emerald-900/70 to-emerald-950/90 p-5 text-emerald-100 shadow-lg shadow-emerald-900/50",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold",children:[e.jsx("span",{className:"inline-flex h-9 w-9 items-center justify-center rounded-xl border border-emerald-400/40 bg-emerald-500/10",children:e.jsx(ft,{size:16})}),"Eco Scoreboard"]}),e.jsxs("div",{className:"text-right text-xs text-emerald-200/70",children:[e.jsx("div",{className:"uppercase tracking-[0.3em] text-emerald-300/60",children:"Eco score"}),e.jsx("div",{className:"text-xl font-semibold text-emerald-100",children:H.clampedScore})]})]}),e.jsxs("div",{className:"mt-5 grid gap-5 md:grid-cols-[150px,1fr]",children:[e.jsxs("div",{className:"relative mx-auto flex h-36 w-36 items-center justify-center",children:[e.jsxs("svg",{width:"150",height:"150",viewBox:"0 0 150 150",className:"absolute inset-0 text-emerald-500/40",children:[e.jsx("circle",{cx:"75",cy:"75",r:H.radius,stroke:"currentColor",strokeWidth:"10",fill:"none",className:"opacity-30"}),e.jsx(v.circle,{cx:"75",cy:"75",r:H.radius,stroke:"url(#ecoGradient)",strokeWidth:"10",strokeLinecap:"round",fill:"none",strokeDasharray:H.circumference,strokeDashoffset:H.offset,initial:{strokeDashoffset:H.circumference},animate:{strokeDashoffset:H.offset},transition:{duration:.8,ease:"easeOut"},transform:"rotate(-90 75 75)"}),e.jsx("defs",{children:e.jsxs("linearGradient",{id:"ecoGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#34d399"}),e.jsx("stop",{offset:"100%",stopColor:"#22d3ee"})]})})]}),e.jsxs("div",{className:"relative z-10 text-center",children:[e.jsx(gt,{size:28,className:"mx-auto text-emerald-300"}),e.jsx("div",{className:"mt-2 text-3xl font-semibold text-emerald-50",children:H.clampedScore}),e.jsx("div",{className:"text-[11px] uppercase tracking-[0.28em] text-emerald-200/70",children:"Regenerative"})]})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3 rounded-2xl border border-emerald-400/20 bg-emerald-500/5 p-4 text-xs text-emerald-100/80",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] uppercase tracking-[0.28em] text-emerald-200/70",children:"Battery"}),e.jsx("p",{className:"mt-2 text-lg font-semibold text-emerald-50",children:me.batteryPct})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] uppercase tracking-[0.28em] text-emerald-200/70",children:"Carbon"}),e.jsx("p",{className:"mt-2 text-sm font-semibold leading-tight text-emerald-50",children:me.carbonIntensity})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] uppercase tracking-[0.28em] text-emerald-200/70",children:"Active Tabs"}),e.jsx("p",{className:"mt-2 text-lg font-semibold text-emerald-50",children:me.activeTabs})]})]}),e.jsx("div",{className:"space-y-2",children:z.achievements.map(t=>{const n=t.icon;return e.jsxs("div",{className:"flex items-start gap-3 rounded-2xl border border-emerald-400/20 bg-emerald-500/10 px-4 py-3 text-xs text-emerald-100/80",children:[e.jsx("span",{className:`mt-0.5 inline-flex h-7 w-7 items-center justify-center rounded-xl border ${t.achieved?"border-emerald-400/60 bg-emerald-500/20 text-emerald-200":"border-emerald-400/20 bg-emerald-500/5 text-emerald-200/60"}`,children:t.achieved?e.jsx(yt,{size:14}):e.jsx(n,{size:14})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-emerald-100",children:t.label}),e.jsx("div",{className:"mt-1 text-[11px] text-emerald-200/70",children:t.description})]})]},t.id)})}),e.jsxs("div",{className:"rounded-2xl border border-emerald-400/20 bg-emerald-500/10 px-4 py-4 text-xs text-emerald-100/80",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"font-semibold text-emerald-100",children:"Trends"}),e.jsxs("span",{className:"text-[11px] uppercase tracking-[0.28em] text-emerald-200/70",children:["Last ",Math.min(ae.length,24)," samples"]})]}),e.jsxs("div",{className:"mt-3 grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-emerald-100",children:["Battery",U.battery.trend.direction==="up"?e.jsx(ve,{size:12,className:"text-emerald-300"}):U.battery.trend.direction==="down"?e.jsx(Se,{size:12,className:"text-amber-300"}):null,e.jsxs("span",{className:"text-[11px] text-emerald-200/70",children:[U.battery.trend.delta>0?`+${U.battery.trend.delta.toFixed(1)}`:U.battery.trend.delta.toFixed(1),"%"]})]}),e.jsx("div",{className:"relative h-16 overflow-hidden rounded-xl border border-emerald-400/20 bg-emerald-500/10",children:U.battery.path?e.jsx("svg",{viewBox:"0 0 100 100",className:"absolute inset-0 h-full w-full text-emerald-300",children:e.jsx("polyline",{fill:"none",stroke:"currentColor",strokeWidth:"3",points:U.battery.path})}):e.jsx("div",{className:"flex h-full items-center justify-center text-[11px] text-emerald-200/60",children:"Not enough data"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-emerald-100",children:["Carbon",U.carbon.trend.direction==="down"?e.jsx(Se,{size:12,className:"text-emerald-300"}):U.carbon.trend.direction==="up"?e.jsx(ve,{size:12,className:"text-amber-300"}):null,e.jsxs("span",{className:"text-[11px] text-emerald-200/70",children:[U.carbon.trend.delta>0?`+${U.carbon.trend.delta.toFixed(0)}`:U.carbon.trend.delta.toFixed(0)," ","g"]})]}),e.jsx("div",{className:"relative h-16 overflow-hidden rounded-xl border border-emerald-400/20 bg-emerald-500/10",children:U.carbon.path?e.jsx("svg",{viewBox:"0 0 100 100",className:"absolute inset-0 h-full w-full text-emerald-200",children:e.jsx("polyline",{fill:"none",stroke:"currentColor",strokeWidth:"3",points:U.carbon.path})}):e.jsx("div",{className:"flex h-full items-center justify-center text-[11px] text-emerald-200/60",children:"Awaiting carbon samples"})})]})]})]})]})]}),se&&e.jsxs("p",{className:"mt-5 text-[11px] text-emerald-100/60",children:["Updated ",pe(se,{addSuffix:!0})]}),e.jsxs("p",{className:"mt-1 text-[11px] text-emerald-100/70",children:[ce,te?` â€¢ ${te}`:""]})]})]})]}),e.jsx(Rt,{query:X,isOpen:g,onClose:()=>{F(!1),B("")}})]})}export{Yt as O,zt as n,Vt as s,le as u};
//# sourceMappingURL=OmniDesk-C5fSodZ1.js.map
