import{r as d,j as e,X as S,a3 as w}from"./vendor-react-gmX1Lmvt.js";import{a as C,b as T,K as N,L as R,i as u,M as k}from"./core-ai-yFIunLTZ.js";import{l as s,t as x}from"./mode-research-BclgCwOH.js";import{A as I,m as A}from"./vendor-framer-motion-DDE19Uim.js";import{f as F}from"./vendor-utils-5Vdoy44w.js";import"./vendor-react-dom-Bkb6jJ_S.js";import"./vendor-Vl2WtvH-.js";import"./vendor-zustand-BWsgwsXr.js";import"./mode-manager.ts-DwguZmJt.js";import"./core-memory-DmK-uh9X.js";import"./mode-docs-FcsoolLb.js";import"./vendor-pdf-ejcqEZLU.js";import"./vendor-mammoth-BPQIafDs.js";function J(){const[f,c]=d.useState(!1),[r,g]=d.useState(null),[n,p]=d.useState(!1),l=C(),h=T();d.useEffect(()=>{const t=N();t&&t.tabCount>0&&(g(t),c(!0),s.info("Session restore modal: session found",t))},[]);const y=async()=>{p(!0);try{const t=R();if(!t){s.error("Session restore: no session data found");return}if(s.info("Restoring session",{tabCount:t.tabs.length,mode:t.mode}),t.mode&&await h.setMode(t.mode),t.tabs.length>0){const v=l.tabs;for(const a of v)try{await u.tabs.close({id:a.id})}catch(o){s.warn("Failed to close tab during restore",o)}for(const a of t.tabs)try{const o=a.url||"about:blank",i=await u.tabs.create(o),m=typeof i=="object"&&i&&"id"in i?i.id:typeof i=="string"?i:null;m&&typeof m=="string"&&l.updateTab(m,{title:a.title,appMode:a.appMode,url:a.url})}catch(o){s.warn("Failed to restore tab",o)}if(t.activeTabId&&l.tabs.find(o=>o.id===t.activeTabId))try{l.setActive(t.activeTabId),await u.tabs.activate({id:t.activeTabId}).catch(()=>{})}catch{}}s.info("Session restored successfully"),x("auth_session_restored",{tabCount:t.tabs.length,mode:t.mode}),c(!1)}catch(t){s.error("Failed to restore session",t)}finally{p(!1)}},b=()=>{k(),c(!1),s.info("Session restore dismissed"),x("auth_session_restored",{action:"dismissed",tabCount:r?.tabCount||0})};if(!f||!r)return null;const j=r.savedAt?F(new Date(r.savedAt),{addSuffix:!0}):"recently";return e.jsx(I,{children:f&&e.jsx("div",{className:"fixed inset-0 z-[10000] flex items-center justify-center bg-black/60 backdrop-blur-sm",onClick:t=>{t.target===t.currentTarget&&b()},children:e.jsx(A.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"mx-4 w-full max-w-md rounded-xl border border-slate-700 bg-slate-900 shadow-2xl",onClick:t=>t.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-4 flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-1 text-lg font-semibold text-gray-100",children:"Restore your last browsing session?"}),e.jsxs("p",{className:"text-sm text-gray-400",children:["Last saved ",j," â€¢ ",r.tabCount," tab",r.tabCount===1?"":"s"]})]}),e.jsx("button",{type:"button",onClick:t=>{t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),setTimeout(()=>{b()},0)},className:"text-gray-400 transition-colors hover:text-gray-200","aria-label":"Dismiss",style:{pointerEvents:"auto",zIndex:10001},children:e.jsx(S,{size:20})})]}),e.jsxs("div",{className:"mt-6 flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{n||y()},disabled:n,className:"flex flex-1 items-center justify-center gap-2 rounded-lg border border-blue-500/60 bg-blue-600/20 px-4 py-2.5 text-sm font-medium text-blue-100 transition-colors hover:bg-blue-600/30 disabled:cursor-not-allowed disabled:opacity-50",children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-blue-400 border-t-transparent"}),"Restoring..."]}):e.jsxs(e.Fragment,{children:[e.jsx(w,{size:16}),"Restore"]})}),e.jsx("button",{type:"button",onClick:()=>{n||b()},disabled:n,className:"flex-1 rounded-lg border border-slate-700 bg-slate-800/60 px-4 py-2.5 text-sm text-slate-300 transition-colors hover:bg-slate-700/80 disabled:opacity-50",children:"Start Fresh"})]})]})})})})}export{J as default};
//# sourceMappingURL=SessionRestoreModal-DsxID4E8.js.map
