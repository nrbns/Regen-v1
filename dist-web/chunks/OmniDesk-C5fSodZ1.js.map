{"version":3,"file":"OmniDesk-C5fSodZ1.js","sources":["../../src/services/redixWs.ts","../../src/services/redixClient.ts","../../src/components/AIResponsePane.tsx","../../src/state/efficiencyStore.ts","../../src/state/workspaceEventsStore.ts","../../src/lib/tabFallback.ts","../../src/components/ChromeNewTabPage.tsx","../../src/lib/search.ts","../../src/components/OmniDesk.tsx"],"sourcesContent":["import { isBackendAvailable, onBackendStatusChange } from '../lib/backend-status';\nimport { isElectronRuntime, isTauriRuntime } from '../lib/env';\n\nconst DEFAULT_WS_URL = import.meta.env.VITE_REDIX_WS_URL || 'ws://localhost:4000/ws';\nconst DEFAULT_HTTP_URL = import.meta.env.VITE_REDIX_HTTP_URL || 'http://localhost:4000/api/query';\nconst DEFAULT_SSE_URL = import.meta.env.VITE_REDIX_SSE_URL || 'http://localhost:4000/api/ask';\n\nexport type RedixMessage = {\n  id?: string;\n  type: string;\n  payload?: Record<string, unknown>;\n};\n\ntype Listener = (message: RedixMessage) => void;\n\ntype RequestOptions = {\n  stream?: boolean;\n  taskId?: string;\n};\n\nexport class RedixWS {\n  url: string;\n  ws: WebSocket | null = null;\n  listeners: Map<string, Listener> = new Map();\n  backoff = 1000;\n  private errorLogged = false;\n  private isConnecting = false;\n  private backendOnline = isBackendAvailable();\n  private unsubscribeBackend?: () => void;\n\n  constructor(url: string = DEFAULT_WS_URL) {\n    this.url = url;\n    this.unsubscribeBackend = onBackendStatusChange(status => {\n      this.backendOnline = status;\n      if (!status && this.ws) {\n        try {\n          // Only close if WebSocket is in a valid state to prevent browser errors\n          if (\n            this.ws.readyState === WebSocket.OPEN ||\n            this.ws.readyState === WebSocket.CONNECTING\n          ) {\n            this.ws.close();\n          }\n        } catch {\n          // ignore - WebSocket errors are expected if server isn't running\n        }\n        this.ws = null;\n      }\n      if (status) {\n        this.connect();\n      }\n    });\n\n    // Skip WebSocket connections in web mode - no backend available\n    const isWebMode = !isElectronRuntime() && !isTauriRuntime();\n    if (isWebMode) {\n      return; // Don't attempt connection in web mode\n    }\n\n    // Defer connection attempt to avoid blocking initial render\n    // Only connect if Redix is enabled\n    if (\n      this.backendOnline &&\n      import.meta.env.VITE_DISABLE_REDIX !== 'true' &&\n      import.meta.env.DISABLE_REDIX !== 'true'\n    ) {\n      // Use requestIdleCallback or setTimeout to defer connection\n      if ('requestIdleCallback' in window) {\n        requestIdleCallback(\n          () => {\n            this.connect();\n          },\n          { timeout: 2000 }\n        );\n      } else {\n        setTimeout(() => {\n          this.connect();\n        }, 1000);\n      }\n    }\n  }\n\n  connect(): void {\n    // Skip WebSocket connections in web mode - no backend available\n    const isWebMode = !isElectronRuntime() && !isTauriRuntime();\n    if (isWebMode) {\n      return; // Don't attempt connection in web mode\n    }\n\n    if (this.isConnecting || !this.backendOnline) return;\n\n    // Check if Redix is disabled via environment variable\n    if (import.meta.env.VITE_DISABLE_REDIX === 'true' || import.meta.env.DISABLE_REDIX === 'true') {\n      return; // Don't attempt connection if Redix is disabled\n    }\n\n    this.isConnecting = true;\n\n    try {\n      // Suppress WebSocket connection errors in console by catching them early\n      this.ws = new WebSocket(this.url);\n\n      // Immediately suppress error events to prevent console spam\n      this.ws.addEventListener(\n        'error',\n        event => {\n          event.stopPropagation();\n          event.preventDefault();\n          // Don't log - Redix is optional\n        },\n        { once: true }\n      );\n\n      this.ws.onopen = () => {\n        this.backoff = 1000;\n        this.isConnecting = false;\n        this.errorLogged = false; // Reset error flag on successful connection\n        if (import.meta.env.DEV) {\n          console.log('[RedixWS] Connected to', this.url);\n        }\n      };\n\n      this.ws.onmessage = (event: MessageEvent<string>) => {\n        try {\n          const message: RedixMessage = JSON.parse(event.data);\n          if (message?.id && this.listeners.has(message.id)) {\n            const listener = this.listeners.get(message.id);\n            listener?.(message);\n          }\n          window.dispatchEvent(new CustomEvent('redix:message', { detail: message }));\n        } catch (error) {\n          // Silently handle parse errors - don't spam console\n          if (import.meta.env.DEV) {\n            console.warn('[RedixWS] failed to parse message', error);\n          }\n        }\n      };\n\n      this.ws.onclose = () => {\n        this.isConnecting = false;\n\n        // Don't retry in web mode - no backend available\n        const isWebMode = !isElectronRuntime() && !isTauriRuntime();\n        if (isWebMode) {\n          return; // Don't retry in web mode\n        }\n\n        // Only retry if not explicitly disabled\n        if (\n          import.meta.env.VITE_DISABLE_REDIX !== 'true' &&\n          import.meta.env.DISABLE_REDIX !== 'true'\n        ) {\n          window.setTimeout(() => this.connect(), this.backoff);\n          this.backoff = Math.min(this.backoff * 1.5, 30_000);\n        }\n      };\n\n      this.ws.onerror = event => {\n        this.isConnecting = false;\n        if (this.ws && this.ws.readyState === WebSocket.OPEN) {\n          this.ws.close();\n        }\n        // Completely suppress WebSocket errors - Redix is optional\n        event.stopPropagation();\n        event.preventDefault();\n        // Don't log at all - Redix WebSocket errors are expected if server isn't running\n        // The browser console will still show the error, but we prevent it from propagating\n      };\n    } catch {\n      this.isConnecting = false;\n      // Suppress connection errors - Redix is optional\n      if (!this.errorLogged && import.meta.env.DEV) {\n        this.errorLogged = true;\n        console.debug(\n          '[RedixWS] WebSocket connection unavailable - Redix is optional and will gracefully degrade.'\n        );\n      }\n    }\n  }\n\n  send(message: RedixMessage): void {\n    if (!isBackendAvailable()) {\n      if (message.id && this.listeners.has(message.id)) {\n        const listener = this.listeners.get(message.id);\n        listener?.({\n          id: message.id,\n          type: 'error',\n          payload: { message: 'Backend offline' },\n        });\n        this.listeners.delete(message.id);\n      }\n      return;\n    }\n\n    if (this.ws && this.ws.readyState === WebSocket.OPEN) {\n      this.ws.send(JSON.stringify(message));\n    } else {\n      const payload = message.payload ?? {};\n      fetch(DEFAULT_HTTP_URL, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          query: (payload as Record<string, unknown>).query,\n          sessionId: (payload as Record<string, unknown>).sessionId,\n          options: (payload as Record<string, unknown>).options,\n        }),\n      })\n        .then(async res => {\n          if (!res.ok) {\n            throw new Error(`HTTP ${res.status}`);\n          }\n          const data = await res.json();\n          if (message.id && this.listeners.has(message.id)) {\n            const listener = this.listeners.get(message.id);\n            listener?.({\n              id: message.id,\n              type: 'final_result',\n              payload: data,\n            });\n            this.listeners.delete(message.id);\n          }\n        })\n        .catch(error => {\n          if (message.id && this.listeners.has(message.id)) {\n            const listener = this.listeners.get(message.id);\n            listener?.({\n              id: message.id,\n              type: 'error',\n              payload: { message: error.message },\n            });\n            this.listeners.delete(message.id);\n          }\n        });\n    }\n  }\n\n  private startHttpStream(\n    id: string,\n    query: string,\n    sessionId: string,\n    options: RequestOptions,\n    onMessage: Listener\n  ): { id: string; cancel: () => void } {\n    const url = new URL(DEFAULT_SSE_URL, window.location.origin);\n    url.searchParams.set('q', query);\n    url.searchParams.set('sessionId', sessionId);\n\n    const safeParse = (data: string | null) => {\n      if (!data) return {};\n      try {\n        return JSON.parse(data);\n      } catch {\n        return {};\n      }\n    };\n\n    if (!isBackendAvailable()) {\n      onMessage({\n        id,\n        type: 'error',\n        payload: { message: 'Backend offline' },\n      });\n      return {\n        id,\n        cancel: () => undefined,\n      };\n    }\n\n    const eventSource = new EventSource(url.toString());\n\n    const handleAck = (event: MessageEvent<string>) => {\n      onMessage({ id, type: 'ack', payload: safeParse(event.data) });\n    };\n    const handleUpdate = (event: MessageEvent<string>) => {\n      onMessage({ id, type: 'partial_result', payload: safeParse(event.data) });\n    };\n    const handleToken = (event: MessageEvent<string>) => {\n      const data = safeParse(event.data);\n      const item = (data as Record<string, unknown>).item;\n      const items = item ? [item] : [];\n      onMessage({ id, type: 'partial_result', payload: { items } });\n    };\n    const handleResult = (event: MessageEvent<string>) => {\n      onMessage({ id, type: 'final_result', payload: safeParse(event.data) });\n      cleanup();\n    };\n    const handleError = (event: MessageEvent<string>) => {\n      onMessage({ id, type: 'error', payload: safeParse(event.data) });\n      cleanup();\n    };\n    const handleDone = () => {\n      cleanup();\n    };\n\n    const cleanup = () => {\n      eventSource.removeEventListener('ack', handleAck as EventListener);\n      eventSource.removeEventListener('update', handleUpdate as EventListener);\n      eventSource.removeEventListener('token', handleToken as EventListener);\n      eventSource.removeEventListener('result', handleResult as EventListener);\n      eventSource.removeEventListener('error', handleError as EventListener);\n      eventSource.removeEventListener('done', handleDone as EventListener);\n      eventSource.close();\n    };\n\n    eventSource.addEventListener('ack', handleAck as EventListener);\n    eventSource.addEventListener('update', handleUpdate as EventListener);\n    eventSource.addEventListener('token', handleToken as EventListener);\n    eventSource.addEventListener('result', handleResult as EventListener);\n    eventSource.addEventListener('error', handleError as EventListener);\n    eventSource.addEventListener('done', handleDone as EventListener);\n\n    eventSource.onerror = () => {\n      onMessage({ id, type: 'error', payload: { message: 'sse-disconnected' } });\n      cleanup();\n    };\n\n    return {\n      id,\n      cancel: () => {\n        cleanup();\n      },\n    };\n  }\n\n  request(\n    query: string,\n    sessionId: string,\n    options: RequestOptions = {},\n    onMessage: Listener\n  ): { id: string; cancel: () => void } {\n    const id = crypto.randomUUID();\n    if (!this.ws || this.ws.readyState !== WebSocket.OPEN) {\n      return this.startHttpStream(id, query, sessionId, options, onMessage);\n    }\n\n    this.listeners.set(id, onMessage);\n    this.send({\n      id,\n      type: 'start_query',\n      payload: { query, sessionId, options: { stream: true, ...options } },\n    });\n    return {\n      id,\n      cancel: () => {\n        this.listeners.delete(id);\n        this.send({ id, type: 'cancel', payload: { taskId: options.taskId } });\n      },\n    };\n  }\n}\n\n// Only create WebSocket connection if Redix is enabled\n// This prevents connection errors when Redix server is not running\nlet _redixWSInstance: RedixWS | null = null;\n\n// Lazy initialization - only connect when actually needed\nexport const getRedixWS = (): RedixWS => {\n  if (!_redixWSInstance) {\n    // Skip WebSocket connections in web mode - no backend available\n    const isWebMode = !isElectronRuntime() && !isTauriRuntime();\n\n    if (\n      isWebMode ||\n      import.meta.env.VITE_DISABLE_REDIX === 'true' ||\n      import.meta.env.DISABLE_REDIX === 'true'\n    ) {\n      // Create a stub that falls back to HTTP\n      _redixWSInstance = new RedixWS();\n      // Don't attempt connection\n      (_redixWSInstance as any).ws = null;\n      (_redixWSInstance as any).connect = () => {}; // No-op\n      (_redixWSInstance as any).isConnecting = false;\n    } else {\n      _redixWSInstance = new RedixWS();\n    }\n  }\n  return _redixWSInstance;\n};\n\n// Export singleton for backward compatibility - lazy load to avoid immediate connection attempts\nexport const redixWS = (() => {\n  // Don't create instance immediately in web mode\n  const isWebMode = !isElectronRuntime() && !isTauriRuntime();\n  if (isWebMode) {\n    // Return a stub that never connects\n    const stub = new RedixWS();\n    (stub as any).ws = null;\n    (stub as any).connect = () => {}; // No-op\n    (stub as any).isConnecting = false;\n    return stub;\n  }\n  return getRedixWS();\n})();\n","import { redixWS } from './redixWs';\r\n\r\ntype RedixMessage =\r\n  | { id: string; type: 'ack'; payload: { taskId: string } }\r\n  | { id: string; type: 'partial_result'; payload: { items: any[]; progress?: number } }\r\n  | { id: string; type: 'final_result'; payload: { items: any[]; progress?: number; taskId?: string } }\r\n  | { id: string; type: 'error'; payload: { message: string } }\r\n  | { type: string; payload: any };\r\n\r\ntype RequestOptions = {\r\n  sessionId: string;\r\n  onPartial?: (message: RedixMessage) => void;\r\n  onFinal?: (message: RedixMessage) => void;\r\n  onError?: (message: RedixMessage) => void;\r\n};\r\n\r\nexport function requestRedix(query: string, options: RequestOptions) {\r\n  const controller = redixWS.request(\r\n    query,\r\n    options.sessionId,\r\n    {},\r\n    (message) => {\r\n      const typed = message as RedixMessage;\r\n      switch (message.type) {\r\n        case 'partial_result':\r\n          options.onPartial?.(typed);\r\n          break;\r\n        case 'final_result':\r\n          options.onFinal?.(typed);\r\n          break;\r\n        case 'error':\r\n          options.onError?.(typed);\r\n          controller.cancel();\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n    },\r\n  );\r\n\r\n  return controller;\r\n}\r\n\r\n","/**\r\n * AIResponsePane - Streaming AI response display for search queries\r\n * Shows token-by-token streaming responses from Redix\r\n */\r\n\r\nimport { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { X, Sparkles, Loader2, Copy, Check } from 'lucide-react';\r\nimport { requestRedix } from '../services/redixClient';\r\n\r\ninterface AIResponsePaneProps {\r\n  query: string;\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n}\r\n\r\nexport function AIResponsePane({ query, isOpen, onClose }: AIResponsePaneProps) {\r\n  const [response, setResponse] = useState<string>('');\r\n  const [isStreaming, setIsStreaming] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [copied, setCopied] = useState(false);\r\n  const controllerRef = useRef<{ id: string; cancel: () => void } | null>(null);\r\n  const sessionIdRef = useRef<string>(`redix-ai-${crypto.randomUUID()}`);\r\n  const responseEndRef = useRef<HTMLDivElement>(null);\r\n\r\n  // Auto-scroll to bottom as response streams\r\n  useEffect(() => {\r\n    if (responseEndRef.current && isStreaming) {\r\n      responseEndRef.current.scrollIntoView({ behavior: 'smooth' });\r\n    }\r\n  }, [response, isStreaming]);\r\n\r\n  // Stream AI response when query changes and pane is open\r\n  useEffect(() => {\r\n    if (!isOpen || !query.trim()) {\r\n      return;\r\n    }\r\n\r\n    // Cancel any existing request\r\n    controllerRef.current?.cancel();\r\n    setResponse('');\r\n    setError(null);\r\n    setIsStreaming(true);\r\n\r\n    // Start streaming request\r\n    controllerRef.current = requestRedix(query, {\r\n      sessionId: sessionIdRef.current,\r\n      onPartial: (message) => {\r\n        // Handle token-by-token streaming\r\n        const payload = message.payload as any;\r\n        \r\n        // Check for text tokens in the response\r\n        if (payload.text) {\r\n          setResponse((prev) => prev + payload.text);\r\n        } else if (payload.content) {\r\n          setResponse((prev) => prev + payload.content);\r\n        } else if (payload.items && Array.isArray(payload.items)) {\r\n          // Handle structured results\r\n          const textContent = payload.items\r\n            .map((item: any) => item.text || item.content || item.snippet || '')\r\n            .join('\\n\\n');\r\n          if (textContent) {\r\n            setResponse((prev) => {\r\n              // Avoid duplicates\r\n              if (!prev.includes(textContent)) {\r\n                return prev + (prev ? '\\n\\n' : '') + textContent;\r\n              }\r\n              return prev;\r\n            });\r\n          }\r\n        }\r\n      },\r\n      onFinal: (message) => {\r\n        setIsStreaming(false);\r\n        const payload = message.payload as any;\r\n        \r\n        // Final response might contain complete text\r\n        if (payload.text) {\r\n          setResponse((prev) => prev + payload.text);\r\n        } else if (payload.content) {\r\n          setResponse((prev) => prev + payload.content);\r\n        } else if (payload.items && Array.isArray(payload.items)) {\r\n          const textContent = payload.items\r\n            .map((item: any) => item.text || item.content || item.snippet || '')\r\n            .join('\\n\\n');\r\n          if (textContent && !response.includes(textContent)) {\r\n            setResponse((prev) => prev + (prev ? '\\n\\n' : '') + textContent);\r\n          }\r\n        }\r\n      },\r\n      onError: (message) => {\r\n        setIsStreaming(false);\r\n        const errorMsg = (message.payload as any)?.message || 'Failed to get AI response';\r\n        setError(errorMsg);\r\n        console.error('[AIResponsePane] Redix error:', message);\r\n      },\r\n    });\r\n\r\n    return () => {\r\n      controllerRef.current?.cancel();\r\n      controllerRef.current = null;\r\n    };\r\n  }, [query, isOpen]);\r\n\r\n  const handleCopy = useCallback(async () => {\r\n    if (!response) return;\r\n    \r\n    try {\r\n      await navigator.clipboard.writeText(response);\r\n      setCopied(true);\r\n      setTimeout(() => setCopied(false), 2000);\r\n    } catch (error) {\r\n      console.error('[AIResponsePane] Failed to copy:', error);\r\n    }\r\n  }, [response]);\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <AnimatePresence>\r\n      <motion.div\r\n        initial={{ opacity: 0, y: 20 }}\r\n        animate={{ opacity: 1, y: 0 }}\r\n        exit={{ opacity: 0, y: 20 }}\r\n        transition={{ duration: 0.2 }}\r\n        className=\"fixed bottom-20 left-1/2 -translate-x-1/2 z-50 w-full max-w-4xl mx-4 rounded-2xl border border-slate-700/70 bg-slate-950/95 backdrop-blur-xl shadow-2xl\"\r\n        style={{ maxHeight: '60vh' }}\r\n      >\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between px-6 py-4 border-b border-slate-800/60\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <div className=\"flex items-center justify-center w-8 h-8 rounded-full bg-emerald-500/20\">\r\n              <Sparkles size={16} className=\"text-emerald-400\" />\r\n            </div>\r\n            <div>\r\n              <h3 className=\"text-sm font-semibold text-gray-100\">AI Response</h3>\r\n              <p className=\"text-xs text-gray-400 truncate max-w-md\">{query}</p>\r\n            </div>\r\n          </div>\r\n          <div className=\"flex items-center gap-2\">\r\n            {response && (\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleCopy}\r\n                className=\"p-2 rounded-lg text-gray-400 hover:text-gray-200 hover:bg-slate-800/60 transition-colors\"\r\n                title=\"Copy response\"\r\n              >\r\n                {copied ? <Check size={16} /> : <Copy size={16} />}\r\n              </button>\r\n            )}\r\n            <button\r\n              type=\"button\"\r\n              onClick={onClose}\r\n              className=\"p-2 rounded-lg text-gray-400 hover:text-gray-200 hover:bg-slate-800/60 transition-colors\"\r\n              title=\"Close\"\r\n            >\r\n              <X size={16} />\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Content */}\r\n        <div className=\"px-6 py-4 overflow-y-auto\" style={{ maxHeight: 'calc(60vh - 80px)' }}>\r\n          {isStreaming && !response && (\r\n            <div className=\"flex items-center gap-3 text-gray-400\">\r\n              <Loader2 size={16} className=\"animate-spin text-emerald-400\" />\r\n              <span className=\"text-sm\">Streaming response from Redix...</span>\r\n            </div>\r\n          )}\r\n\r\n          {error && (\r\n            <div className=\"rounded-lg border border-red-500/40 bg-red-500/10 px-4 py-3 text-sm text-red-200\">\r\n              <p className=\"font-medium\">Error</p>\r\n              <p className=\"mt-1 text-xs text-red-300/80\">{error}</p>\r\n            </div>\r\n          )}\r\n\r\n          {response && (\r\n            <motion.div\r\n              initial={{ opacity: 0 }}\r\n              animate={{ opacity: 1 }}\r\n              className=\"prose prose-invert prose-sm max-w-none text-gray-200\"\r\n            >\r\n              <div className=\"whitespace-pre-wrap break-words\">\r\n                {response}\r\n                {isStreaming && (\r\n                  <span className=\"inline-block w-2 h-4 ml-1 bg-emerald-400 animate-pulse\" />\r\n                )}\r\n              </div>\r\n              <div ref={responseEndRef} />\r\n            </motion.div>\r\n          )}\r\n\r\n          {!response && !isStreaming && !error && (\r\n            <div className=\"text-center py-8 text-gray-400\">\r\n              <Sparkles size={32} className=\"mx-auto mb-3 opacity-50\" />\r\n              <p className=\"text-sm\">Waiting for AI response...</p>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </motion.div>\r\n    </AnimatePresence>\r\n  );\r\n}\r\n\r\n","import { create } from 'zustand';\r\n\r\nexport type EfficiencyMode = 'normal' | 'battery-saver' | 'extreme';\r\n\r\nconst MODE_LABELS: Record<EfficiencyMode, string> = {\r\n  normal: 'Performance Mode',\r\n  'battery-saver': 'Battery Saver Mode',\r\n  extreme: 'Regen Mode',\r\n};\r\n\r\nconst MODE_BADGES: Record<EfficiencyMode, string | null> = {\r\n  normal: null,\r\n  'battery-saver': '+0.8hr battery',\r\n  extreme: '+1.8hr battery',\r\n};\r\n\r\nconst MODE_COLORS: Record<EfficiencyMode, string> = {\r\n  normal: 'text-gray-400',\r\n  'battery-saver': 'text-emerald-300',\r\n  extreme: 'text-amber-300',\r\n};\r\n\r\ntype Snapshot = {\r\n  batteryPct: number | null;\r\n  charging: boolean | null;\r\n  ramMb: number;\r\n  cpuLoad1: number;\r\n  activeTabs: number;\r\n  carbonIntensity?: number | null;\r\n  carbonRegion?: string | null;\r\n};\r\n\r\nexport type EfficiencySample = {\r\n  timestamp: number;\r\n  mode: EfficiencyMode;\r\n  batteryPct: number | null;\r\n  carbonIntensity: number | null | undefined;\r\n  cpuLoad: number;\r\n  activeTabs: number;\r\n};\r\n\r\ntype EfficiencyState = {\r\n  mode: EfficiencyMode;\r\n  label: string;\r\n  badge: string | null;\r\n  colorClass: string;\r\n  lastUpdated: number | null;\r\n  snapshot: Snapshot;\r\n  history: EfficiencySample[];\r\n  setEvent: (event: {\r\n    mode: EfficiencyMode;\r\n    label?: string | null;\r\n    badge?: string | null;\r\n    timestamp: number;\r\n    snapshot: Snapshot;\r\n  }) => void;\r\n};\r\n\r\nconst defaultSnapshot: Snapshot = {\r\n  batteryPct: null,\r\n  charging: null,\r\n  ramMb: 0,\r\n  cpuLoad1: 0,\r\n  activeTabs: 0,\r\n  carbonIntensity: null,\r\n  carbonRegion: null,\r\n};\r\n\r\nconst HISTORY_KEY = 'ob:ecoHistory:v1';\r\n\r\nfunction loadHistory(): EfficiencySample[] {\r\n  if (typeof window === 'undefined') return [];\r\n  try {\r\n    const raw = window.localStorage.getItem(HISTORY_KEY);\r\n    if (!raw) return [];\r\n    const parsed = JSON.parse(raw);\r\n    if (!Array.isArray(parsed)) return [];\r\n    return parsed\r\n      .map((item) => ({\r\n        timestamp: typeof item.timestamp === 'number' ? item.timestamp : Date.now(),\r\n        mode: (item.mode as EfficiencyMode) ?? 'normal',\r\n        batteryPct: typeof item.batteryPct === 'number' ? item.batteryPct : null,\r\n        carbonIntensity:\r\n          typeof item.carbonIntensity === 'number' || item.carbonIntensity === null\r\n            ? item.carbonIntensity\r\n            : undefined,\r\n        cpuLoad: typeof item.cpuLoad === 'number' ? item.cpuLoad : 0,\r\n        activeTabs: typeof item.activeTabs === 'number' ? item.activeTabs : 0,\r\n      }))\r\n      .slice(-120);\r\n  } catch (error) {\r\n    console.warn('[efficiencyStore] Failed to load history', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nfunction saveHistory(history: EfficiencySample[]) {\r\n  if (typeof window === 'undefined') return;\r\n  try {\r\n    window.localStorage.setItem(HISTORY_KEY, JSON.stringify(history));\r\n  } catch (error) {\r\n    console.warn('[efficiencyStore] Failed to persist history', error);\r\n  }\r\n}\r\n\r\nconst initialHistory = loadHistory();\r\n\r\nexport const useEfficiencyStore = create<EfficiencyState>((set, get) => ({\r\n  mode: 'normal',\r\n  label: MODE_LABELS.normal,\r\n  badge: MODE_BADGES.normal,\r\n  colorClass: MODE_COLORS.normal,\r\n  lastUpdated: null,\r\n  snapshot: defaultSnapshot,\r\n  history: initialHistory,\r\n  setEvent: (event) => {\r\n    const sample: EfficiencySample = {\r\n      timestamp: event.timestamp,\r\n      mode: event.mode,\r\n      batteryPct: event.snapshot.batteryPct,\r\n      carbonIntensity: event.snapshot.carbonIntensity,\r\n      cpuLoad: event.snapshot.cpuLoad1,\r\n      activeTabs: event.snapshot.activeTabs,\r\n    };\r\n    let nextHistory = get().history;\r\n    nextHistory = [...nextHistory, sample].slice(-120);\r\n    saveHistory(nextHistory);\r\n    const nextMode = event.mode;\r\n    set({\r\n      mode: nextMode,\r\n      label: event.label ?? MODE_LABELS[nextMode],\r\n      badge: event.badge ?? MODE_BADGES[nextMode],\r\n      colorClass: MODE_COLORS[nextMode],\r\n      lastUpdated: event.timestamp,\r\n      snapshot: event.snapshot,\r\n      history: nextHistory,\r\n    });\r\n  },\r\n}));\r\n","import { create } from 'zustand';\r\n\r\nexport interface WorkspaceEvent {\r\n  id: string;\r\n  workspaceId?: string | null;\r\n  type: string;\r\n  message?: string;\r\n  payload?: unknown;\r\n  timestamp: number;\r\n}\r\n\r\ninterface WorkspaceEventsState {\r\n  events: WorkspaceEvent[];\r\n  pushEvent: (event: Omit<WorkspaceEvent, 'id' | 'timestamp'> & { id?: string; timestamp?: number }) => void;\r\n  clear: (workspaceId?: string | null) => void;\r\n}\r\n\r\nexport const useWorkspaceEventsStore = create<WorkspaceEventsState>((set) => ({\r\n  events: [],\r\n  pushEvent: (event) =>\r\n    set((state) => {\r\n      const timestamp = event.timestamp ?? Date.now();\r\n      const id = event.id ?? `ws-${timestamp}-${Math.random().toString(36).slice(2, 8)}`;\r\n      return {\r\n        events: [\r\n          ...state.events,\r\n          {\r\n            id,\r\n            timestamp,\r\n            workspaceId: event.workspaceId ?? null,\r\n            type: event.type,\r\n            message: event.message,\r\n            payload: event.payload,\r\n          },\r\n        ].slice(-100),\r\n      };\r\n    }),\r\n  clear: (workspaceId) =>\r\n    set((state) => {\r\n      if (!workspaceId) {\r\n        return { events: [] };\r\n      }\r\n      return { events: state.events.filter((event) => event.workspaceId !== workspaceId) };\r\n    }),\r\n}));\r\n","import { useTabsStore } from '../state/tabsStore';\r\nimport { ipcEvents } from './ipc-events';\r\n\r\ntype FallbackOptions = {\r\n  url?: string;\r\n  title?: string;\r\n  activate?: boolean;\r\n  mode?: 'normal' | 'ghost' | 'private';\r\n};\r\n\r\nexport function createFallbackTab(options: FallbackOptions = {}) {\r\n  const store = typeof useTabsStore?.getState === 'function' ? useTabsStore.getState() : null;\r\n  if (!store) {\r\n    return null;\r\n  }\r\n\r\n  const {\r\n    url = 'about:blank',\r\n    title,\r\n    activate = true,\r\n    mode = 'normal',\r\n  } = options;\r\n\r\n  const existingTabs = Array.isArray(store.tabs) ? store.tabs : [];\r\n  const id =\r\n    typeof crypto !== 'undefined' && typeof crypto.randomUUID === 'function'\r\n      ? crypto.randomUUID()\r\n      : `local-${Date.now()}-${Math.random().toString(36).slice(2, 8)}`;\r\n\r\n  const nextTabs = existingTabs.map((tab) => ({\r\n    ...tab,\r\n    active: activate ? false : Boolean(tab.active),\r\n  }));\r\n\r\n  const newTab = {\r\n    id,\r\n    title: title || url,\r\n    url,\r\n    active: activate,\r\n    mode,\r\n  };\r\n\r\n  nextTabs.push(newTab);\r\n\r\n  // Update the zustand store\r\n  store.setAll(nextTabs);\r\n\r\n  // Emit the update so any listeners (e.g., TabStrip) stay in sync\r\n  try {\r\n    ipcEvents.emit('tabs:updated', nextTabs);\r\n  } catch {\r\n    // Ignore emit errors in non-Electron contexts\r\n  }\r\n\r\n  return newTab;\r\n}\r\n\r\n\r\n","/**\n * NewTabPage - Premium new tab experience for RegenBrowser\n * Combines clean design with rich content: search, news, markets, weather, shortcuts\n */\n\nimport { useState, useCallback, useEffect, useRef } from 'react';\nimport {\n  Search,\n  Sparkles,\n  TrendingUp,\n  Globe,\n  Zap,\n  Clock,\n  Cloud,\n  Sun,\n  ArrowUp,\n  ArrowDown,\n  ExternalLink,\n  BookOpen,\n  Briefcase,\n  Gamepad2,\n} from 'lucide-react';\nimport { ipc } from '../lib/ipc-typed';\nimport { useTabsStore } from '../state/tabsStore';\nimport { useAppStore } from '../state/appStore';\nimport { motion } from 'framer-motion';\nimport { isWebMode } from '../lib/env';\n\ninterface MarketData {\n  symbol: string;\n  value: number;\n  change: number;\n  changePercent: number;\n}\n\ninterface NewsItem {\n  id: string;\n  title: string;\n  source: string;\n  time: string;\n  image?: string;\n  trending?: boolean;\n}\n\nexport function ChromeNewTabPage() {\n  const [searchQuery, setSearchQuery] = useState('');\n  const [isSearching, setIsSearching] = useState(false);\n  const [activeCategory, setActiveCategory] = useState('Discover');\n  const [marketData, setMarketData] = useState<MarketData[]>([]);\n  const [newsItems, setNewsItems] = useState<NewsItem[]>([]);\n  const [weatherData, setWeatherData] = useState<{\n    temp: number;\n    condition: string;\n    location: string;\n    airQuality: string;\n  } | null>(null);\n  const [isLoadingMarkets, setIsLoadingMarkets] = useState(true);\n  const [isLoadingNews, setIsLoadingNews] = useState(true);\n  const { activeId, tabs } = useTabsStore();\n  const { setMode } = useAppStore();\n  const inputRef = useRef<HTMLInputElement>(null);\n\n  // Real-time market data fetching\n  const fetchMarketData = useCallback(async () => {\n    try {\n      setIsLoadingMarkets(true);\n      const symbols = [\n        { symbol: 'NIFTY', yahooSymbol: '^NSEI' },\n        { symbol: 'SENSEX', yahooSymbol: '^BSESN' },\n        { symbol: 'Gold', yahooSymbol: 'GC=F' },\n        { symbol: 'Silver', yahooSymbol: 'SI=F' },\n        { symbol: 'USD/INR', yahooSymbol: 'INR=X' },\n      ];\n\n      const marketPromises = symbols.map(async ({ symbol, yahooSymbol }) => {\n        try {\n          // Skip backend calls in web mode\n          if (isWebMode()) {\n            // Return fallback data immediately in web mode\n            const fallbacks: Record<string, MarketData> = {\n              NIFTY: { symbol: 'NIFTY', value: 26202.95, change: -13.1, changePercent: -0.05 },\n              SENSEX: { symbol: 'SENSEX', value: 85706.67, change: -17.14, changePercent: -0.02 },\n              Gold: { symbol: 'Gold', value: 4254.9, change: 52.5, changePercent: 1.25 },\n              Silver: { symbol: 'Silver', value: 57.16, change: 3.55, changePercent: 6.63 },\n              'USD/INR': { symbol: 'USD/INR', value: 89.352, change: 0.009, changePercent: 0.01 },\n            };\n            return fallbacks[symbol] || null;\n          }\n\n          // Try Tauri IPC first\n          if (typeof window !== 'undefined' && (window as any).__TAURI_INTERNALS__) {\n            try {\n              const result = await ipc.trade.getQuote(yahooSymbol);\n              if (result && result.last) {\n                // Use last price, calculate change from bid/ask if available\n                const price = result.last;\n                const change = result.ask && result.bid ? (result.ask - result.bid) / 2 : 0;\n                const changePercent =\n                  result.ask && result.bid && result.last\n                    ? ((result.ask - result.bid) / result.last) * 100\n                    : 0;\n                return {\n                  symbol,\n                  value: price,\n                  change,\n                  changePercent,\n                };\n              }\n            } catch {\n              // IPC failed, try HTTP fallback\n            }\n          }\n\n          // Fallback to HTTP API\n          const API_BASE_URL = import.meta.env.VITE_API_BASE_URL || 'http://127.0.0.1:4000';\n          const response = await fetch(\n            `${API_BASE_URL}/api/trade/quote?symbol=${encodeURIComponent(yahooSymbol)}`,\n            {\n              headers: {\n                'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36',\n              },\n            }\n          );\n\n          if (response.ok) {\n            const data = await response.json();\n            if (data.price) {\n              const change = data.change || 0;\n              const changePercent = data.changePercent || 0;\n              return {\n                symbol,\n                value: data.price,\n                change,\n                changePercent,\n              };\n            }\n          }\n        } catch (error) {\n          // Suppress errors in web mode - they're expected\n          if (!isWebMode()) {\n            console.error(`[NewTab] Failed to fetch ${symbol}:`, error);\n          }\n        }\n\n        // Fallback to mock data if API fails\n        const fallbacks: Record<string, MarketData> = {\n          NIFTY: { symbol: 'NIFTY', value: 26202.95, change: -13.1, changePercent: -0.05 },\n          SENSEX: { symbol: 'SENSEX', value: 85706.67, change: -17.14, changePercent: -0.02 },\n          Gold: { symbol: 'Gold', value: 4254.9, change: 52.5, changePercent: 1.25 },\n          Silver: { symbol: 'Silver', value: 57.16, change: 3.55, changePercent: 6.63 },\n          'USD/INR': { symbol: 'USD/INR', value: 89.352, change: 0.009, changePercent: 0.01 },\n        };\n        return fallbacks[symbol] || null;\n      });\n\n      const results = await Promise.all(marketPromises);\n      const validResults = results.filter((r): r is MarketData => r !== null);\n      setMarketData(validResults);\n    } catch (error) {\n      console.error('[NewTab] Market data fetch failed:', error);\n      // Set fallback data\n      setMarketData([\n        { symbol: 'NIFTY', value: 26202.95, change: -13.1, changePercent: -0.05 },\n        { symbol: 'SENSEX', value: 85706.67, change: -17.14, changePercent: -0.02 },\n        { symbol: 'Gold', value: 4254.9, change: 52.5, changePercent: 1.25 },\n        { symbol: 'Silver', value: 57.16, change: 3.55, changePercent: 6.63 },\n        { symbol: 'USD/INR', value: 89.352, change: 0.009, changePercent: 0.01 },\n      ]);\n    } finally {\n      setIsLoadingMarkets(false);\n    }\n  }, []);\n\n  // Fetch news data\n  const fetchNews = useCallback(async () => {\n    try {\n      setIsLoadingNews(true);\n      // Skip backend calls in web mode\n      if (!isWebMode()) {\n        // Try research API for news\n        if (typeof window !== 'undefined' && (window as any).__TAURI_INTERNALS__) {\n          try {\n            // Use research queryEnhanced if available, otherwise skip\n            const result = await ipc.research\n              .queryEnhanced({\n                query: 'trending news India',\n                maxSources: 5,\n              })\n              .catch(() => null);\n            if (result && result.sources && result.sources.length > 0) {\n              const news = result.sources.slice(0, 5).map((item: any, index: number) => ({\n                id: `news-${index}`,\n                title: item.title || 'News article',\n                source: item.url ? new URL(item.url).hostname : 'News',\n                time: `${Math.floor(Math.random() * 24)}h`,\n                trending: index < 2,\n              }));\n              setNewsItems(news);\n              setIsLoadingNews(false);\n              return;\n            }\n          } catch {\n            // Suppress errors - fallback to mock data\n          }\n        }\n      }\n\n      // Fallback to mock data\n      setNewsItems([\n        {\n          id: '1',\n          title: 'E-Passports Launched In India: What Are Digital Passports?',\n          source: 'The Daily Jagran',\n          time: '5h',\n          trending: true,\n        },\n        {\n          id: '2',\n          title: \"India's Updated Quake Map Warns Entire Himalayan Arc\",\n          source: 'TOI The Times of India',\n          time: '22h',\n        },\n        {\n          id: '3',\n          title: 'AI-Powered Research Tools Transform Education',\n          source: 'Tech News',\n          time: '3h',\n          trending: true,\n        },\n      ]);\n    } catch (error) {\n      console.error('[NewTab] News fetch failed:', error);\n    } finally {\n      setIsLoadingNews(false);\n    }\n  }, []);\n\n  // Fetch weather data\n  const fetchWeather = useCallback(async () => {\n    try {\n      // Use a weather API (OpenWeatherMap, WeatherAPI, etc.)\n      // For now, set mock data\n      setWeatherData({\n        temp: 18,\n        condition: 'Partly Cloudy',\n        location: 'Medchal',\n        airQuality: 'Satisfactory',\n      });\n    } catch (error) {\n      console.error('[NewTab] Weather fetch failed:', error);\n      setWeatherData({\n        temp: 18,\n        condition: 'Partly Cloudy',\n        location: 'Medchal',\n        airQuality: 'Satisfactory',\n      });\n    }\n  }, []);\n\n  // Initial data fetch\n  useEffect(() => {\n    inputRef.current?.focus();\n    void fetchMarketData();\n    void fetchNews();\n    void fetchWeather();\n  }, [fetchMarketData, fetchNews, fetchWeather]);\n\n  // Real-time updates: Poll market data every 30 seconds\n  useEffect(() => {\n    const marketInterval = setInterval(() => {\n      void fetchMarketData();\n    }, 30000); // 30 seconds\n\n    const newsInterval = setInterval(() => {\n      void fetchNews();\n    }, 300000); // 5 minutes\n\n    return () => {\n      clearInterval(marketInterval);\n      clearInterval(newsInterval);\n    };\n  }, [fetchMarketData, fetchNews]);\n\n  const handleSearch = useCallback(\n    async (query: string) => {\n      const trimmedQuery = query.trim();\n      if (!trimmedQuery || isSearching) return;\n\n      setIsSearching(true);\n      try {\n        const isUrl =\n          /^https?:\\/\\//i.test(trimmedQuery) || /^[a-z0-9]+(\\.[a-z0-9]+)+/i.test(trimmedQuery);\n\n        const targetUrl = isUrl\n          ? trimmedQuery.startsWith('http')\n            ? trimmedQuery\n            : `https://${trimmedQuery}`\n          : `https://www.google.com/search?q=${encodeURIComponent(trimmedQuery)}`;\n\n        const activeTab = activeId\n          ? (await ipc.tabs.list().catch(() => [])).find(t => t.id === activeId) || null\n          : null;\n\n        if (activeTab && (activeTab.url === 'about:blank' || !activeTab.url)) {\n          await ipc.tabs.navigate(activeTab.id, targetUrl);\n        } else {\n          await ipc.tabs.create(targetUrl);\n        }\n        setSearchQuery('');\n      } catch (error) {\n        console.error('[NewTab] Search failed:', error);\n      } finally {\n        setIsSearching(false);\n      }\n    },\n    [activeId, isSearching]\n  );\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    void handleSearch(searchQuery);\n  };\n\n  const recentTabs = tabs\n    .filter(t => t.url && t.url !== 'about:blank' && t.id !== activeId)\n    .slice(-6)\n    .reverse();\n\n  const quickAccess = [\n    {\n      id: 'research',\n      label: 'Research',\n      icon: Sparkles,\n      color: 'from-purple-500 to-pink-500',\n      action: () => setMode('Research'),\n      description: 'AI-powered research with citations',\n    },\n    {\n      id: 'trade',\n      label: 'Trade',\n      icon: TrendingUp,\n      color: 'from-green-500 to-emerald-500',\n      action: () => setMode('Trade'),\n      description: 'Real-time market analysis',\n    },\n    {\n      id: 'browse',\n      label: 'Browse',\n      icon: Globe,\n      color: 'from-blue-500 to-cyan-500',\n      action: () => setMode('Browse'),\n      description: 'Standard web browsing',\n    },\n    {\n      id: 'docs',\n      label: 'Docs',\n      icon: BookOpen,\n      color: 'from-orange-500 to-red-500',\n      action: () => setMode('Docs'),\n      description: 'Open document processing mode',\n    },\n    {\n      id: 'work',\n      label: 'Work',\n      icon: Briefcase,\n      color: 'from-indigo-500 to-purple-500',\n      action: async () => {\n        await ipc.tabs.create('about:blank');\n      },\n      description: 'Start a new work session',\n    },\n    {\n      id: 'games',\n      label: 'Games',\n      icon: Gamepad2,\n      color: 'from-pink-500 to-rose-500',\n      action: async () => {\n        await ipc.tabs.create('https://www.google.com/search?q=online+games');\n      },\n      description: 'Browse online games',\n    },\n  ];\n\n  const categories = ['Discover', 'News', 'Markets', 'Research', 'Trade'];\n\n  return (\n    <div className=\"absolute inset-0 flex min-h-screen w-full flex-col overflow-hidden bg-gradient-to-br from-slate-50 via-white to-slate-50 dark:from-slate-950 dark:via-slate-900 dark:to-slate-950\">\n      {/* Top Navigation Bar */}\n      <div className=\"sticky top-0 z-30 border-b border-slate-200 bg-white/80 backdrop-blur-xl dark:border-slate-800 dark:bg-slate-900/80\">\n        <div className=\"mx-auto max-w-7xl px-6 py-4\">\n          <div className=\"flex items-center justify-between\">\n            {/* Logo */}\n            <div className=\"flex items-center gap-3\">\n              <div className=\"flex h-10 w-10 items-center justify-center rounded-xl bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 shadow-lg\">\n                <Zap size={20} className=\"text-white\" />\n              </div>\n              <span className=\"bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-xl font-bold text-transparent\">\n                Regen\n              </span>\n            </div>\n\n            {/* Category Tabs */}\n            <div className=\"hidden items-center gap-1 md:flex\">\n              {categories.map(category => (\n                <button\n                  key={category}\n                  onClick={() => setActiveCategory(category)}\n                  className={`rounded-lg px-4 py-2 text-sm font-medium transition-all ${\n                    activeCategory === category\n                      ? 'bg-blue-500 text-white shadow-md'\n                      : 'text-slate-600 hover:bg-slate-100 dark:text-slate-400 dark:hover:bg-slate-800'\n                  }`}\n                >\n                  {category}\n                </button>\n              ))}\n            </div>\n\n            {/* Right Actions */}\n            <div className=\"flex items-center gap-3\">\n              <button className=\"rounded-lg p-2 transition-colors hover:bg-slate-100 dark:hover:bg-slate-800\">\n                <span className=\"text-sm text-slate-600 dark:text-slate-400\">Personalize</span>\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Main Content */}\n      <div className=\"flex-1 overflow-y-auto\">\n        <div className=\"mx-auto max-w-7xl px-6 py-8\">\n          {/* Search Bar Section */}\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.5 }}\n            className=\"mb-12\"\n          >\n            <div className=\"mx-auto max-w-3xl\">\n              <form onSubmit={handleSubmit} className=\"relative\">\n                <div className=\"group relative\">\n                  <Search\n                    size={24}\n                    className=\"absolute left-6 top-1/2 z-10 -translate-y-1/2 text-slate-400 dark:text-slate-500\"\n                  />\n                  <input\n                    id=\"newtab-search-input\"\n                    name=\"newtab-search-query\"\n                    ref={inputRef}\n                    type=\"text\"\n                    value={searchQuery}\n                    onChange={e => setSearchQuery(e.target.value)}\n                    onKeyDown={e => {\n                      if (e.key === 'Enter') {\n                        e.preventDefault();\n                        void handleSearch(searchQuery);\n                      } else if (e.key === 'Escape') {\n                        setSearchQuery('');\n                        inputRef.current?.blur();\n                      }\n                    }}\n                    placeholder=\"Search the web or type a URL\"\n                    className=\"w-full rounded-2xl border-2 border-slate-200 bg-white py-5 pl-16 pr-32 text-lg text-slate-900 shadow-lg transition-all placeholder:text-slate-400 focus:border-blue-500 focus:outline-none focus:ring-4 focus:ring-blue-500/10 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-100 dark:placeholder:text-slate-500 dark:focus:border-blue-400 dark:focus:ring-blue-400/10\"\n                    autoFocus\n                    aria-label=\"Search the web or type a URL\"\n                    aria-describedby=\"search-hint\"\n                    role=\"searchbox\"\n                  />\n                  <span id=\"search-hint\" className=\"sr-only\">\n                    Press Enter to search, Escape to clear\n                  </span>\n                  <div className=\"absolute right-4 top-1/2 flex -translate-y-1/2 items-center gap-2\">\n                    <button\n                      type=\"button\"\n                      onClick={() => setMode('Research')}\n                      className=\"flex items-center gap-2 rounded-lg bg-gradient-to-r from-purple-500 to-pink-500 px-4 py-2 text-sm font-semibold text-white transition-all hover:shadow-lg\"\n                    >\n                      <Sparkles size={16} />\n                      AI Mode\n                    </button>\n                  </div>\n                </div>\n              </form>\n            </div>\n          </motion.div>\n\n          {/* Two Column Layout */}\n          <div className=\"grid grid-cols-1 gap-8 lg:grid-cols-3\">\n            {/* Left Column - Main Content */}\n            <div className=\"space-y-6 lg:col-span-2\">\n              {/* Quick Access Shortcuts */}\n              <motion.div\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ duration: 0.5, delay: 0.1 }}\n              >\n                <h2 className=\"mb-4 text-sm font-semibold uppercase tracking-wide text-slate-700 dark:text-slate-300\">\n                  Quick Access\n                </h2>\n                <div className=\"grid grid-cols-3 gap-4 sm:grid-cols-6\">\n                  {quickAccess.map((item, index) => {\n                    const Icon = item.icon;\n                    return (\n                      <motion.button\n                        key={item.id}\n                        initial={{ opacity: 0, scale: 0.9 }}\n                        animate={{ opacity: 1, scale: 1 }}\n                        transition={{ duration: 0.3, delay: 0.2 + index * 0.05 }}\n                        whileHover={{ scale: 1.05 }}\n                        whileTap={{ scale: 0.95 }}\n                        onClick={item.action}\n                        className=\"group relative flex flex-col items-center gap-2 rounded-xl border border-slate-200 bg-white p-4 transition-all hover:border-blue-500 hover:shadow-lg dark:border-slate-700 dark:bg-slate-800 dark:hover:border-blue-400\"\n                        title={item.description || item.label}\n                        aria-label={\n                          item.description ? `${item.label}: ${item.description}` : item.label\n                        }\n                      >\n                        <div\n                          className={`h-12 w-12 rounded-xl bg-gradient-to-br ${item.color} flex items-center justify-center shadow-md transition-shadow group-hover:shadow-lg`}\n                        >\n                          <Icon size={24} className=\"text-white\" />\n                        </div>\n                        <span className=\"text-xs font-medium text-slate-700 dark:text-slate-300\">\n                          {item.label}\n                        </span>\n                      </motion.button>\n                    );\n                  })}\n                </div>\n              </motion.div>\n\n              {/* News Section */}\n              <motion.div\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ duration: 0.5, delay: 0.3 }}\n              >\n                <div className=\"mb-4 flex items-center justify-between\">\n                  <h2 className=\"text-sm font-semibold uppercase tracking-wide text-slate-700 dark:text-slate-300\">\n                    Trending News\n                  </h2>\n                  <button className=\"text-xs text-blue-600 hover:underline dark:text-blue-400\">\n                    See all\n                  </button>\n                </div>\n                <div className=\"space-y-4\">\n                  {newsItems.length > 0 ? (\n                    newsItems.map((item, index) => (\n                      <motion.article\n                        key={item.id}\n                        initial={{ opacity: 0, x: -20 }}\n                        animate={{ opacity: 1, x: 0 }}\n                        transition={{ duration: 0.4, delay: 0.4 + index * 0.1 }}\n                        onClick={async () => {\n                          // Open article in new tab\n                          try {\n                            const articleUrl = `https://www.google.com/search?q=${encodeURIComponent(item.title)}`;\n                            await ipc.tabs.create(articleUrl);\n                          } catch (error) {\n                            console.error('[NewTab] Failed to open article:', error);\n                          }\n                        }}\n                        onKeyDown={async e => {\n                          if (e.key === 'Enter' || e.key === ' ') {\n                            e.preventDefault();\n                            try {\n                              const articleUrl = `https://www.google.com/search?q=${encodeURIComponent(item.title)}`;\n                              await ipc.tabs.create(articleUrl);\n                            } catch (error) {\n                              console.error('[NewTab] Failed to open article:', error);\n                            }\n                          }\n                        }}\n                        className=\"group relative cursor-pointer rounded-2xl border border-slate-200 bg-white p-6 transition-all hover:border-blue-500 hover:shadow-xl focus:outline-none focus:ring-2 focus:ring-blue-500/50 dark:border-slate-700 dark:bg-slate-800 dark:hover:border-blue-400\"\n                        tabIndex={0}\n                        role=\"button\"\n                        aria-label={`Open article: ${item.title}`}\n                      >\n                        <div className=\"flex items-start gap-4\">\n                          <div className=\"flex-1\">\n                            <div className=\"mb-2 flex items-center gap-2\">\n                              {item.trending && (\n                                <span className=\"rounded-full bg-red-500 px-2 py-1 text-xs font-semibold text-white\">\n                                  Trending\n                                </span>\n                              )}\n                              <span className=\"text-xs text-slate-500 dark:text-slate-400\">\n                                {item.source}  {item.time}\n                              </span>\n                            </div>\n                            <h3 className=\"mb-2 text-lg font-semibold text-slate-900 transition-colors group-hover:text-blue-600 dark:text-slate-100 dark:group-hover:text-blue-400\">\n                              {item.title}\n                            </h3>\n                            <div className=\"flex items-center gap-4 text-xs text-slate-500 dark:text-slate-400\">\n                              <button className=\"flex items-center gap-1 hover:text-blue-600 dark:hover:text-blue-400\">\n                                <span>12</span>\n                                <span></span>\n                              </button>\n                              <button className=\"flex items-center gap-1 hover:text-blue-600 dark:hover:text-blue-400\">\n                                <span>Comment</span>\n                              </button>\n                              <button className=\"flex items-center gap-1 hover:text-blue-600 dark:hover:text-blue-400\">\n                                <span>Share</span>\n                              </button>\n                            </div>\n                          </div>\n                        </div>\n                      </motion.article>\n                    ))\n                  ) : isLoadingNews ? (\n                    // Skeleton loaders for news\n                    Array.from({ length: 3 }).map((_, idx) => (\n                      <div\n                        key={`news-skeleton-${idx}`}\n                        className=\"animate-pulse rounded-2xl border border-slate-200 bg-white p-6 dark:border-slate-700 dark:bg-slate-800\"\n                      >\n                        <div className=\"flex items-start gap-4\">\n                          <div className=\"flex-1 space-y-3\">\n                            <div className=\"h-4 w-1/4 rounded bg-slate-200 dark:bg-slate-700\" />\n                            <div className=\"h-5 w-3/4 rounded bg-slate-200 dark:bg-slate-700\" />\n                            <div className=\"h-4 w-1/2 rounded bg-slate-200 dark:bg-slate-700\" />\n                          </div>\n                        </div>\n                      </div>\n                    ))\n                  ) : (\n                    <div className=\"py-8 text-center text-sm text-slate-500 dark:text-slate-400\">\n                      No news available\n                    </div>\n                  )}\n                </div>\n              </motion.div>\n            </div>\n\n            {/* Right Column - Widgets */}\n            <div className=\"space-y-6\">\n              {/* Market Data Widget */}\n              <motion.div\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ duration: 0.5, delay: 0.2 }}\n                className=\"rounded-2xl border border-slate-200 bg-white p-6 shadow-lg dark:border-slate-700 dark:bg-slate-800\"\n              >\n                <div className=\"mb-4 flex items-center justify-between\">\n                  <h3 className=\"text-lg font-semibold text-slate-900 dark:text-slate-100\">\n                    Markets\n                  </h3>\n                  <div className=\"flex items-center gap-2\">\n                    {isLoadingMarkets && (\n                      <div className=\"h-4 w-4 animate-spin rounded-full border-2 border-blue-500 border-t-transparent\" />\n                    )}\n                    <button\n                      onClick={() => {\n                        setMode('Trade');\n                      }}\n                      className=\"flex items-center gap-1 text-xs text-blue-600 hover:underline dark:text-blue-400\"\n                    >\n                      See market\n                      <ExternalLink size={12} />\n                    </button>\n                  </div>\n                </div>\n                <div className=\"space-y-3\">\n                  {marketData.length > 0 ? (\n                    marketData.map(market => {\n                      const isPositive = market.changePercent >= 0;\n                      return (\n                        <div\n                          key={market.symbol}\n                          className=\"flex items-center justify-between border-b border-slate-100 py-2 last:border-0 dark:border-slate-700\"\n                        >\n                          <div className=\"flex-1\">\n                            <div className=\"text-sm font-semibold text-slate-900 dark:text-slate-100\">\n                              {market.symbol}\n                            </div>\n                          </div>\n                          <div className=\"text-right\">\n                            <div className=\"text-sm font-semibold text-slate-900 dark:text-slate-100\">\n                              {market.value.toLocaleString('en-IN', {\n                                minimumFractionDigits: 2,\n                                maximumFractionDigits: 2,\n                              })}\n                            </div>\n                            <div\n                              className={`flex items-center justify-end gap-1 text-xs ${\n                                isPositive\n                                  ? 'text-green-600 dark:text-green-400'\n                                  : 'text-red-600 dark:text-red-400'\n                              }`}\n                            >\n                              {isPositive ? <ArrowUp size={12} /> : <ArrowDown size={12} />}\n                              <span>\n                                {Math.abs(market.changePercent).toFixed(2)}% (\n                                {isPositive ? '+' : ''}\n                                {market.change.toFixed(2)})\n                              </span>\n                            </div>\n                          </div>\n                        </div>\n                      );\n                    })\n                  ) : isLoadingMarkets ? (\n                    // Skeleton loaders for markets\n                    Array.from({ length: 5 }).map((_, idx) => (\n                      <div\n                        key={`market-skeleton-${idx}`}\n                        className=\"flex animate-pulse items-center justify-between border-b border-slate-100 py-2 last:border-0 dark:border-slate-700\"\n                      >\n                        <div className=\"h-4 w-20 rounded bg-slate-200 dark:bg-slate-700\" />\n                        <div className=\"h-4 w-24 rounded bg-slate-200 dark:bg-slate-700\" />\n                      </div>\n                    ))\n                  ) : (\n                    <div className=\"py-8 text-center text-sm text-slate-500 dark:text-slate-400\">\n                      No market data available\n                    </div>\n                  )}\n                </div>\n              </motion.div>\n\n              {/* Weather Widget */}\n              {weatherData && (\n                <motion.div\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ duration: 0.5, delay: 0.3 }}\n                  className=\"rounded-2xl bg-gradient-to-br from-blue-500 to-cyan-500 p-6 text-white shadow-xl\"\n                >\n                  <div className=\"mb-4 flex items-center justify-between\">\n                    <div>\n                      <h3 className=\"mb-1 text-lg font-semibold\">{weatherData.location}</h3>\n                      <div className=\"flex items-center gap-2\">\n                        <Cloud size={20} />\n                        <span className=\"text-3xl font-bold\">{weatherData.temp}C</span>\n                      </div>\n                    </div>\n                    <Sun size={32} className=\"text-yellow-200\" />\n                  </div>\n                  <div className=\"border-t border-white/20 pt-4\">\n                    <p className=\"mb-3 text-sm text-white/90\">\n                      {weatherData.airQuality} air quality tomorrow\n                    </p>\n                    <div className=\"flex gap-2\">\n                      {['Hourly', 'Daily', 'Air quality'].map((tab, index) => (\n                        <button\n                          key={tab}\n                          className={`rounded-lg px-3 py-1 text-xs font-medium transition-all ${\n                            index === 1\n                              ? 'bg-white/20 text-white'\n                              : 'text-white/70 hover:bg-white/10 hover:text-white'\n                          }`}\n                        >\n                          {tab}\n                        </button>\n                      ))}\n                    </div>\n                  </div>\n                </motion.div>\n              )}\n\n              {/* Recent Tabs */}\n              {recentTabs.length > 0 && (\n                <motion.div\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ duration: 0.5, delay: 0.4 }}\n                  className=\"rounded-2xl border border-slate-200 bg-white p-6 shadow-lg dark:border-slate-700 dark:bg-slate-800\"\n                >\n                  <div className=\"mb-4 flex items-center gap-2\">\n                    <Clock size={16} className=\"text-slate-500 dark:text-slate-400\" />\n                    <h3 className=\"text-lg font-semibold text-slate-900 dark:text-slate-100\">\n                      Recent\n                    </h3>\n                  </div>\n                  <div className=\"space-y-2\">\n                    {recentTabs.map(tab => (\n                      <button\n                        key={tab.id}\n                        onClick={async () => {\n                          await ipc.tabs.activate({ id: tab.id });\n                        }}\n                        className=\"group w-full rounded-lg px-3 py-2 text-left transition-colors hover:bg-slate-100 dark:hover:bg-slate-700\"\n                      >\n                        <div className=\"truncate text-sm font-medium text-slate-900 group-hover:text-blue-600 dark:text-slate-100 dark:group-hover:text-blue-400\">\n                          {tab.title || new URL(tab.url || '').hostname}\n                        </div>\n                        <div className=\"truncate text-xs text-slate-500 dark:text-slate-400\">\n                          {new URL(tab.url || '').hostname}\n                        </div>\n                      </button>\n                    ))}\n                  </div>\n                </motion.div>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Bottom Customize Button */}\n      <div className=\"sticky bottom-6 left-0 right-0 z-20 flex justify-end px-6\">\n        <motion.button\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.5, delay: 0.5 }}\n          className=\"flex items-center gap-2 rounded-lg bg-blue-500 px-4 py-2 text-sm font-semibold text-white shadow-lg transition-all hover:bg-blue-600 hover:shadow-xl\"\n        >\n          <span>Customize Chrome</span>\n        </motion.button>\n      </div>\n    </div>\n  );\n}\n","const LANGUAGE_LOCALE_MAP: Record<string, string> = {\r\n  // 22 Indic languages (Bhashini supported)\r\n  as: 'as-IN', // Assamese\r\n  bn: 'bn-IN', // Bengali\r\n  brx: 'brx-IN', // Bodo\r\n  doi: 'doi-IN', // Dogri\r\n  gom: 'gom-IN', // Konkani\r\n  gu: 'gu-IN', // Gujarati\r\n  hi: 'hi-IN', // Hindi\r\n  kn: 'kn-IN', // Kannada\r\n  ks: 'ks-IN', // Kashmiri\r\n  mai: 'mai-IN', // Maithili\r\n  ml: 'ml-IN', // Malayalam\r\n  mni: 'mni-IN', // Manipuri\r\n  mr: 'mr-IN', // Marathi\r\n  ne: 'ne-NP', // Nepali\r\n  or: 'or-IN', // Odia\r\n  pa: 'pa-IN', // Punjabi\r\n  sa: 'sa-IN', // Sanskrit\r\n  sat: 'sat-IN', // Santali\r\n  sd: 'sd-PK', // Sindhi\r\n  ta: 'ta-IN', // Tamil\r\n  te: 'te-IN', // Telugu\r\n  ur: 'ur-PK', // Urdu\r\n  // Other languages\r\n  en: 'en-US',\r\n  es: 'es-ES',\r\n  fr: 'fr-FR',\r\n  de: 'de-DE',\r\n  zh: 'zh-CN',\r\n  ja: 'ja-JP',\r\n  ko: 'ko-KR',\r\n  ru: 'ru-RU',\r\n  pt: 'pt-PT',\r\n  ar: 'ar-SA',\r\n};\r\n\r\nfunction getLocaleFromLanguage(lang?: string): string {\r\n  if (!lang || lang === 'auto') return 'en-US';\r\n  return LANGUAGE_LOCALE_MAP[lang] || lang.includes('-') ? lang : `${lang}-${lang.toUpperCase()}`;\r\n}\r\n\r\n// Search engines that allow iframe embedding (no X-Frame-Options blocking)\r\nconst IFRAME_FRIENDLY_PROVIDERS = ['bing', 'yahoo', 'startpage', 'ecosia'];\r\n\r\nexport function buildSearchUrl(\r\n  provider: 'google' | 'duckduckgo' | 'bing' | 'yahoo' | 'startpage' | 'ecosia',\r\n  q: string,\r\n  language?: string,\r\n  preferIframeFriendly: boolean = true\r\n) {\r\n  const enc = encodeURIComponent(q);\r\n  const locale = getLocaleFromLanguage(language);\r\n  const langCode = locale.split('-')[0];\r\n\r\n  // If iframe-friendly is preferred and current provider blocks iframes, use fallback\r\n  if (preferIframeFriendly && !IFRAME_FRIENDLY_PROVIDERS.includes(provider)) {\r\n    // DuckDuckGo and Google block iframes - use Bing as fallback\r\n    if (provider === 'duckduckgo' || provider === 'google') {\r\n      return `https://www.bing.com/search?q=${enc}&setlang=${langCode}`;\r\n    }\r\n  }\r\n\r\n  switch (provider) {\r\n    case 'duckduckgo':\r\n      return `https://duckduckgo.com/?q=${enc}&kl=${locale}&hl=${langCode}`;\r\n    case 'bing':\r\n      return `https://www.bing.com/search?q=${enc}&setlang=${langCode}`;\r\n    case 'yahoo':\r\n      return `https://search.yahoo.com/search?p=${enc}&lang=${langCode}`;\r\n    case 'startpage':\r\n      return `https://www.startpage.com/sp/search?query=${enc}&language=${langCode}`;\r\n    case 'ecosia':\r\n      return `https://www.ecosia.org/search?q=${enc}&language=${langCode}`;\r\n    default:\r\n      // Google blocks iframes - use Bing for iframe compatibility\r\n      if (preferIframeFriendly) {\r\n        return `https://www.bing.com/search?q=${enc}&setlang=${langCode}`;\r\n      }\r\n      return `https://www.google.com/search?q=${enc}&hl=${langCode}&gl=${locale.split('-')[1] || 'US'}`;\r\n  }\r\n}\r\n\r\n/**\r\n * Check if a string is likely a URL\r\n */\r\nfunction isLikelyUrl(input: string): boolean {\r\n  const trimmed = input.trim().toLowerCase();\r\n\r\n  // Has protocol\r\n  if (/^[a-z][a-z0-9+.-]*:/.test(trimmed)) {\r\n    return true;\r\n  }\r\n\r\n  // Has spaces - definitely not a URL\r\n  if (/\\s/.test(trimmed)) {\r\n    return false;\r\n  }\r\n\r\n  // Looks like a domain (has TLD)\r\n  const domainPattern = /^([a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?\\.)+[a-z]{2,}(\\/.*)?$/i;\r\n  if (domainPattern.test(trimmed)) {\r\n    // Check if it's a valid domain format\r\n    try {\r\n      const testUrl = new URL(`https://${trimmed}`);\r\n      // Valid domain-like structure\r\n      return testUrl.hostname.includes('.') && testUrl.hostname.split('.').length >= 2;\r\n    } catch {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  // IP address pattern\r\n  const ipPattern = /^(\\d{1,3}\\.){3}\\d{1,3}(:\\d+)?(\\/.*)?$/;\r\n  if (ipPattern.test(trimmed)) {\r\n    return true;\r\n  }\r\n\r\n  // Localhost\r\n  if (trimmed.startsWith('localhost') || trimmed.startsWith('127.0.0.1')) {\r\n    return true;\r\n  }\r\n\r\n  // Special protocols\r\n  if (/^(about|file|data|blob|javascript):/i.test(trimmed)) {\r\n    return true;\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\n/**\r\n * Normalize input to URL or search query\r\n * Enhanced to properly detect non-URLs and convert to Google search in language\r\n */\r\nexport function normalizeInputToUrlOrSearch(\r\n  input: string,\r\n  provider: 'google' | 'duckduckgo' | 'bing' | 'yahoo' | 'all' = 'google',\r\n  language?: string,\r\n  preferIframeFriendly: boolean = true\r\n): string {\r\n  const trimmed = input.trim();\r\n  if (!trimmed) {\r\n    return 'about:blank';\r\n  }\r\n\r\n  // Check if it's likely a URL\r\n  if (isLikelyUrl(trimmed)) {\r\n    // Try parsing as-is URL\r\n    try {\r\n      const url = new URL(trimmed);\r\n      if (url.protocol === 'http:' || url.protocol === 'https:') {\r\n        return url.toString();\r\n      }\r\n    } catch {\r\n      // Not a valid URL with protocol\r\n    }\r\n\r\n    // Try with https:// prefix\r\n    try {\r\n      const url = new URL(`https://${trimmed}`);\r\n      return url.toString();\r\n    } catch {\r\n      // Not a valid URL even with https://\r\n    }\r\n  }\r\n\r\n  // Not a URL - convert to search\r\n  // Default to Bing if provider is 'all' and iframe-friendly is preferred (Bing allows iframes)\r\n  const searchProvider = provider === 'all' ? (preferIframeFriendly ? 'bing' : 'google') : provider;\r\n  return buildSearchUrl(searchProvider, trimmed, language, preferIframeFriendly);\r\n}\r\n","/**\r\n * OmniDesk - Central dashboard for empty state (no tabs open)\r\n * Think: ChatGPT home + Arc Spaces + Obsidian Quick Launch\r\n */\r\n\r\nimport { useState, useEffect, useCallback, useMemo } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { formatDistanceToNow } from 'date-fns';\r\nimport {\r\n  Sparkles,\r\n  Search,\r\n  FileText,\r\n  Workflow,\r\n  Clock,\r\n  Pin,\r\n  RefreshCw,\r\n  Leaf,\r\n  Compass,\r\n  Bot,\r\n  GaugeCircle,\r\n  BatteryCharging,\r\n  Cloud,\r\n  CheckCircle2,\r\n  TrendingUp,\r\n  TrendingDown,\r\n  ClipboardCopy,\r\n  FileSearch,\r\n  Sparkle,\r\n  Loader2,\r\n} from 'lucide-react';\r\nimport { useTabsStore } from '../state/tabsStore';\r\nimport { useAppStore } from '../state/appStore';\r\nimport { ipc } from '../lib/ipc-typed';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { ipcEvents } from '../lib/ipc-events';\r\nimport { AIResponsePane } from './AIResponsePane';\r\nimport { useEfficiencyStore } from '../state/efficiencyStore';\r\nimport { useWorkspaceEventsStore } from '../state/workspaceEventsStore';\r\nimport { useAgentStreamStore, type StreamStatus } from '../state/agentStreamStore';\r\nimport { createFallbackTab } from '../lib/tabFallback';\r\nimport { ChromeNewTabPage } from './ChromeNewTabPage';\r\nimport { useSettingsStore } from '../state/settingsStore';\r\n// import { CardSkeleton, ListSkeleton } from './common/Skeleton'; // Reserved for future use\r\n\r\ntype OmniDeskVariant = 'overlay' | 'split';\r\n\r\ninterface OmniDeskProps {\r\n  variant?: OmniDeskVariant;\r\n  forceShow?: boolean;\r\n  useChromeStyle?: boolean;\r\n}\r\n\r\ntype ContinueSession = {\r\n  id?: string;\r\n  type: string;\r\n  title: string;\r\n  url?: string;\r\n  timestamp: number;\r\n  sessionId?: string;\r\n};\r\n\r\ntype Workspace = {\r\n  id: string;\r\n  name: string;\r\n};\r\n\r\n// SEARCH_ENDPOINT removed - using buildSearchUrlWithLang from search.ts instead\r\n\r\nconst suggestedPrompts = [\r\n  '@live explain quantum computing basics',\r\n  'graph the AI ethics landscape',\r\n  \"summarize today's markets\",\r\n  'compare battery life of M-series laptops',\r\n  'find regenerative design principles',\r\n];\r\n\r\n// Use language-aware search from search.ts\r\nimport { buildSearchUrl as buildSearchUrlWithLang } from '../lib/search';\r\n\r\nfunction buildSearchUrl(query: string, language?: string) {\r\n  return buildSearchUrlWithLang('duckduckgo', query, language);\r\n}\r\n\r\nfunction useDashboardData() {\r\n  const [recentWorkspaces, setRecentWorkspaces] = useState<Workspace[]>([]);\r\n  const [continueSessions, setContinueSessions] = useState<ContinueSession[]>([]);\r\n  const [loadingWorkspaces, setLoadingWorkspaces] = useState(true);\r\n  const [loadingSessions, setLoadingSessions] = useState(true);\r\n  const pushWorkspaceEvent = useWorkspaceEventsStore(state => state.pushEvent);\r\n\r\n  const loadData = useCallback(async () => {\r\n    if (!window.ipc || typeof window.ipc.invoke !== 'function') {\r\n      return false;\r\n    }\r\n\r\n    setLoadingWorkspaces(true);\r\n    setLoadingSessions(true);\r\n\r\n    try {\r\n      const workspaceResult = await ipc.workspaceV2.list();\r\n      const workspaces = (workspaceResult as any)?.workspaces || [];\r\n      setRecentWorkspaces(workspaces.slice(0, 4));\r\n      setLoadingWorkspaces(false);\r\n    } catch {\r\n      setRecentWorkspaces([]);\r\n      setLoadingWorkspaces(false);\r\n    }\r\n\r\n    try {\r\n      const sessionsResult = await ipc.sessions.list();\r\n      const sessions = Array.isArray(sessionsResult) ? (sessionsResult as any[]) : [];\r\n      const continueItems: ContinueSession[] = sessions.slice(0, 3).map((session: any) => ({\r\n        id: session.id,\r\n        type: session.name?.includes('Research') ? 'Research' : 'Browse',\r\n        title: session.name || 'Untitled Session',\r\n        url: session.lastUrl || 'about:blank',\r\n        timestamp: session.updatedAt || session.createdAt || Date.now() - 3600000,\r\n        sessionId: session.id,\r\n      }));\r\n\r\n      const researchSessions = continueItems.filter(item => item.type === 'Research');\r\n\r\n      if (researchSessions.length > 0) {\r\n        setContinueSessions(researchSessions);\r\n      } else {\r\n        setContinueSessions([\r\n          {\r\n            type: 'Research',\r\n            title: 'Quantum Computing Research',\r\n            url: 'about:blank',\r\n            timestamp: Date.now() - 3600000,\r\n          },\r\n        ]);\r\n      }\r\n      setLoadingSessions(false);\r\n    } catch {\r\n      setContinueSessions([\r\n        {\r\n          type: 'Research',\r\n          title: 'Quantum Computing Research',\r\n          url: 'about:blank',\r\n          timestamp: Date.now() - 3600000,\r\n        },\r\n      ]);\r\n      setLoadingSessions(false);\r\n    }\r\n\r\n    return true;\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    let cancelled = false;\r\n\r\n    const kickOff = () => {\r\n      if (cancelled) return;\r\n      loadData().then(ready => {\r\n        if (!ready && !cancelled) {\r\n          setTimeout(kickOff, 500);\r\n        }\r\n      });\r\n    };\r\n\r\n    const initial = setTimeout(kickOff, 350);\r\n    const unsubscribeWorkspace = ipcEvents.on('workspace:updated', () => {\r\n      pushWorkspaceEvent({\r\n        type: 'workspace:updated',\r\n        message: 'Workspace metadata refreshed',\r\n      });\r\n      if (!cancelled) {\r\n        void loadData();\r\n      }\r\n    });\r\n\r\n    return () => {\r\n      cancelled = true;\r\n      clearTimeout(initial);\r\n      unsubscribeWorkspace();\r\n    };\r\n  }, [loadData]);\r\n\r\n  return {\r\n    recentWorkspaces,\r\n    continueSessions,\r\n    reload: loadData,\r\n    loadingWorkspaces,\r\n    loadingSessions,\r\n  };\r\n}\r\n\r\nexport function OmniDesk({\r\n  variant = 'overlay',\r\n  forceShow = false,\r\n  useChromeStyle: _useChromeStyle = false,\r\n}: OmniDeskProps) {\r\n  const { tabs, activeId } = useTabsStore();\r\n  const { setMode } = useAppStore();\r\n  const navigate = useNavigate();\r\n  const { recentWorkspaces, continueSessions, reload, loadingWorkspaces, loadingSessions } =\r\n    useDashboardData();\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [refreshing, setRefreshing] = useState(false);\r\n  const [searchLoading, setSearchLoading] = useState(false);\r\n  const [aiResponseOpen, setAiResponseOpen] = useState(false);\r\n  const [aiQuery, setAiQuery] = useState('');\r\n  const efficiencyLabel = useEfficiencyStore(state => state.label);\r\n  const efficiencyBadge = useEfficiencyStore(state => state.badge);\r\n  const efficiencySnapshot = useEfficiencyStore(state => state.snapshot);\r\n  const efficiencyUpdated = useEfficiencyStore(state => state.lastUpdated);\r\n  const efficiencyHistory = useEfficiencyStore(state => state.history);\r\n  const pushWorkspaceEvent = useWorkspaceEventsStore(state => state.pushEvent);\r\n  const agentStatus = useAgentStreamStore(state => state.status);\r\n  const agentLastGoal = useAgentStreamStore(state => state.lastGoal);\r\n  const agentEvents = useAgentStreamStore(state => state.events);\r\n  const agentTranscript = useAgentStreamStore(state => state.transcript);\r\n\r\n  // Check if Chrome-style new tab page is enabled (default to true)\r\n  const chromeStyleEnabled = useSettingsStore(state => state.appearance.chromeNewTabPage ?? true);\r\n  const language = useSettingsStore(state => state.language || 'auto');\r\n\r\n  const agentPreview = useMemo(() => {\r\n    const latestEvents = agentEvents.slice(-3).reverse();\r\n    const lastUpdated = latestEvents.length > 0 ? latestEvents[0].timestamp : null;\r\n    const transcriptLines = agentTranscript\r\n      .split('\\n')\r\n      .map(line => line.trim())\r\n      .filter(Boolean);\r\n    const statusPalette: Record<string, { label: string; tone: string }> = {\r\n      idle: { label: 'Idle', tone: 'border-slate-700/60 bg-slate-800/60 text-slate-300' },\r\n      connecting: { label: 'Connecting', tone: 'border-blue-500/40 bg-blue-500/15 text-blue-100' },\r\n      live: {\r\n        label: 'Streaming',\r\n        tone: 'border-emerald-500/40 bg-emerald-500/15 text-emerald-100',\r\n      },\r\n      complete: {\r\n        label: 'Complete',\r\n        tone: 'border-purple-500/40 bg-purple-500/15 text-purple-100',\r\n      },\r\n      error: { label: 'Error', tone: 'border-rose-500/40 bg-rose-500/15 text-rose-100' },\r\n    };\r\n    const statusTone = statusPalette[agentStatus] ?? statusPalette.idle;\r\n\r\n    const timeline = latestEvents.map(event => {\r\n      switch (event.type) {\r\n        case 'start':\r\n          return {\r\n            ...event,\r\n            label: 'Run started',\r\n            detail: event.content ?? 'Agent boot sequence initiated.',\r\n            variant: 'border-blue-400/40 bg-blue-500/10 text-blue-100',\r\n          };\r\n        case 'step':\r\n          return {\r\n            ...event,\r\n            label: `Step ${event.step ?? ''}`.trim(),\r\n            detail: event.content ?? event.status ?? 'Executing tool call',\r\n            variant: 'border-purple-400/40 bg-purple-500/10 text-purple-100',\r\n          };\r\n        case 'log':\r\n          return {\r\n            ...event,\r\n            label: 'Log update',\r\n            detail: event.content ?? 'Log appended.',\r\n            variant: 'border-slate-400/40 bg-slate-500/10 text-slate-100',\r\n          };\r\n        case 'consent':\r\n          return {\r\n            ...event,\r\n            label: event.approved ? 'Consent granted' : 'Consent requested',\r\n            detail:\r\n              event.content ??\r\n              `Risk ${event.risk ?? 'medium'}  ${event.approved ? 'approved' : 'pending'}`,\r\n            variant: event.approved\r\n              ? 'border-emerald-400/40 bg-emerald-500/10 text-emerald-100'\r\n              : 'border-amber-400/40 bg-amber-500/10 text-amber-100',\r\n          };\r\n        case 'done':\r\n          return {\r\n            ...event,\r\n            label: 'Run complete',\r\n            detail: event.content ?? 'Outputs finalised.',\r\n            variant: 'border-emerald-400/40 bg-emerald-500/10 text-emerald-100',\r\n          };\r\n        case 'error':\r\n          return {\r\n            ...event,\r\n            label: 'Run error',\r\n            detail: event.content ?? 'Check diagnostics for details.',\r\n            variant: 'border-rose-400/40 bg-rose-500/10 text-rose-100',\r\n          };\r\n        default:\r\n          return {\r\n            ...event,\r\n            label: event.type,\r\n            detail: event.content ?? 'Event received.',\r\n            variant: 'border-slate-400/40 bg-slate-500/10 text-slate-100',\r\n          };\r\n      }\r\n    });\r\n\r\n    const snippetSource = timeline\r\n      .map(entry => entry.detail)\r\n      .filter(Boolean)\r\n      .slice(0, 2);\r\n    const snippet = snippetSource.length > 0 ? snippetSource : transcriptLines.slice(-2);\r\n\r\n    return {\r\n      latestEvents,\r\n      timeline,\r\n      snippet,\r\n      lastUpdated,\r\n      statusTone,\r\n    };\r\n  }, [agentEvents, agentTranscript, agentStatus]);\r\n\r\n  const hasTranscript = useMemo(() => agentTranscript.trim().length > 0, [agentTranscript]);\r\n  const [copyStatus, setCopyStatus] = useState<'idle' | 'copying' | 'copied' | 'error'>('idle');\r\n\r\n  const handleCopyTranscript = useCallback(async () => {\r\n    if (!hasTranscript || typeof navigator === 'undefined' || !navigator.clipboard) {\r\n      setCopyStatus('error');\r\n      return;\r\n    }\r\n    try {\r\n      setCopyStatus('copying');\r\n      await navigator.clipboard.writeText(agentTranscript.trim());\r\n      setCopyStatus('copied');\r\n    } catch (error) {\r\n      console.warn('[OmniDesk] Failed to copy transcript', error);\r\n      setCopyStatus('error');\r\n    }\r\n  }, [agentTranscript, hasTranscript]);\r\n\r\n  useEffect(() => {\r\n    if (copyStatus !== 'copied') return;\r\n    const timeout = window.setTimeout(() => setCopyStatus('idle'), 2000);\r\n    return () => window.clearTimeout(timeout);\r\n  }, [copyStatus]);\r\n\r\n  const ecoMetrics = useMemo(() => {\r\n    const batteryPctValue =\r\n      typeof efficiencySnapshot.batteryPct === 'number'\r\n        ? Math.max(0, Math.min(100, Math.round(efficiencySnapshot.batteryPct)))\r\n        : null;\r\n    const carbonIntensityValue =\r\n      typeof efficiencySnapshot.carbonIntensity === 'number'\r\n        ? Math.max(0, Math.round(efficiencySnapshot.carbonIntensity))\r\n        : null;\r\n    const cpuLoad = Number.isFinite(efficiencySnapshot.cpuLoad1)\r\n      ? Math.max(0, Math.min(100, Math.round(efficiencySnapshot.cpuLoad1)))\r\n      : 0;\r\n    const activeTabs = efficiencySnapshot.activeTabs ?? 0;\r\n    const ecoScore = (() => {\r\n      const batteryComponent = batteryPctValue !== null ? batteryPctValue * 0.4 : 35;\r\n      const cpuComponent = 100 - cpuLoad;\r\n      const carbonComponent =\r\n        carbonIntensityValue !== null ? (Math.max(0, 220 - carbonIntensityValue) / 220) * 100 : 50;\r\n      const tabComponent = (Math.max(0, 12 - activeTabs) / 12) * 100;\r\n      const raw =\r\n        0.35 * batteryComponent +\r\n        0.25 * cpuComponent +\r\n        0.25 * carbonComponent +\r\n        0.15 * tabComponent;\r\n      return Math.round(Math.max(5, Math.min(98, raw)));\r\n    })();\r\n\r\n    const achievements = [\r\n      {\r\n        id: 'battery',\r\n        label:\r\n          batteryPctValue !== null\r\n            ? `${batteryPctValue}% battery reserve`\r\n            : 'Gathering battery telemetry',\r\n        description:\r\n          batteryPctValue !== null && batteryPctValue >= 60\r\n            ? 'Great reserve for deep work.'\r\n            : 'Stay plugged in to build reserve.',\r\n        achieved: batteryPctValue !== null && batteryPctValue >= 60,\r\n        icon: BatteryCharging,\r\n      },\r\n      {\r\n        id: 'carbon',\r\n        label:\r\n          carbonIntensityValue !== null\r\n            ? `${carbonIntensityValue} gCO/kWh grid intensity`\r\n            : 'Estimating regional carbon mix',\r\n        description:\r\n          carbonIntensityValue !== null && carbonIntensityValue <= 180\r\n            ? 'Low-carbon window  ideal for heavy tasks.'\r\n            : 'Carbon intensity elevated. Schedule net-heavy work later.',\r\n        achieved: carbonIntensityValue !== null && carbonIntensityValue <= 180,\r\n        icon: Cloud,\r\n      },\r\n      {\r\n        id: 'tabs',\r\n        label: `${activeTabs} active tabs`,\r\n        description:\r\n          activeTabs <= 6\r\n            ? 'Lean session profile  memory savings unlocked.'\r\n            : 'Consider Hibernate to free resources.',\r\n        achieved: activeTabs <= 6,\r\n        icon: Sparkles,\r\n      },\r\n    ] as const;\r\n\r\n    return {\r\n      batteryPctValue,\r\n      carbonIntensityValue,\r\n      cpuLoad,\r\n      activeTabs,\r\n      ecoScore,\r\n      achievements,\r\n    };\r\n  }, [efficiencySnapshot]);\r\n\r\n  const ecoHistoryInsights = useMemo(() => {\r\n    const recent = efficiencyHistory.slice(-24);\r\n    const batterySeries = recent\r\n      .map(sample => (typeof sample.batteryPct === 'number' ? sample.batteryPct : null))\r\n      .filter((value): value is number => value !== null);\r\n    const carbonSeries = recent\r\n      .map(sample => (typeof sample.carbonIntensity === 'number' ? sample.carbonIntensity : null))\r\n      .filter((value): value is number => value !== null);\r\n\r\n    const computeTrend = (series: number[]) => {\r\n      if (series.length < 2) return { delta: 0, direction: 'flat' as const };\r\n      const last = series[series.length - 1];\r\n      const baseIndex = Math.max(0, series.length - 6);\r\n      const previous = series[baseIndex];\r\n      const delta = last - previous;\r\n      return {\r\n        delta,\r\n        direction: delta > 1 ? ('up' as const) : delta < -1 ? ('down' as const) : ('flat' as const),\r\n      };\r\n    };\r\n\r\n    const computeSparkline = (series: number[]) => {\r\n      if (series.length < 2) return '';\r\n      const min = Math.min(...series);\r\n      const max = Math.max(...series);\r\n      const range = max - min || 1;\r\n      return series\r\n        .map((value, index) => {\r\n          const x = (index / Math.max(series.length - 1, 1)) * 100;\r\n          const normalized = 100 - ((value - min) / range) * 80 - 10;\r\n          return `${x.toFixed(2)},${normalized.toFixed(2)}`;\r\n        })\r\n        .join(' ');\r\n    };\r\n\r\n    return {\r\n      battery: {\r\n        series: batterySeries,\r\n        path: computeSparkline(batterySeries),\r\n        trend: computeTrend(batterySeries),\r\n      },\r\n      carbon: {\r\n        series: carbonSeries,\r\n        path: computeSparkline(carbonSeries),\r\n        trend: computeTrend(carbonSeries),\r\n      },\r\n    };\r\n  }, [efficiencyHistory]);\r\n\r\n  const agentStatusLabels: Record<StreamStatus, string> = {\r\n    idle: 'Agent idle',\r\n    connecting: 'Connecting to Redix',\r\n    live: 'Streaming answer in real time',\r\n    complete: 'Last run completed',\r\n    error: 'Run encountered an issue',\r\n  };\r\n\r\n  const ecoGauge = useMemo(() => {\r\n    const radius = 46;\r\n    const circumference = 2 * Math.PI * radius;\r\n    const clampedScore = Math.max(0, Math.min(100, ecoMetrics.ecoScore));\r\n    const offset = circumference - (clampedScore / 100) * circumference;\r\n    return { radius, circumference, offset, clampedScore };\r\n  }, [ecoMetrics.ecoScore]);\r\n\r\n  const quickActions = [\r\n    {\r\n      icon: Sparkles,\r\n      label: 'Ask Agent',\r\n      action: async () => {\r\n        navigate('/agent');\r\n      },\r\n      color: 'from-blue-500 to-cyan-500',\r\n      description: 'Open the agent console to start a guided workflow.',\r\n    },\r\n    {\r\n      icon: Search,\r\n      label: 'Search Topic',\r\n      action: async () => {\r\n        // Switch to research mode and open search\r\n        setMode('Research');\r\n        await ipc.tabs.create('about:blank');\r\n      },\r\n      color: 'from-purple-500 to-pink-500',\r\n      description: 'Launch AI-powered research with citations-first results.',\r\n    },\r\n    {\r\n      icon: FileText,\r\n      label: 'Research Notes',\r\n      action: async () => {\r\n        setMode('Research');\r\n        await ipc.tabs.create('about:blank');\r\n      },\r\n      color: 'from-green-500 to-emerald-500',\r\n      description: 'Capture structured notes that sync with your highlights.',\r\n    },\r\n    {\r\n      icon: Workflow,\r\n      label: 'Run Playbook',\r\n      action: () => {\r\n        navigate('/playbooks');\r\n      },\r\n      color: 'from-orange-500 to-red-500',\r\n      description: 'Automate multi-step workflows with reusable recipes.',\r\n    },\r\n  ];\r\n\r\n  const ecoStats = useMemo(() => {\r\n    const batteryPct = ecoMetrics.batteryPctValue !== null ? `${ecoMetrics.batteryPctValue}%` : '';\r\n    const carbonIntensity =\r\n      ecoMetrics.carbonIntensityValue !== null\r\n        ? `${ecoMetrics.carbonIntensityValue} gCO/kWh`\r\n        : 'Syncing';\r\n    const activeTabs = `${ecoMetrics.activeTabs}`;\r\n    return { batteryPct, carbonIntensity, activeTabs };\r\n  }, [ecoMetrics]);\r\n\r\n  const handleContinueSession = async (session: any) => {\r\n    try {\r\n      let urlToLoad = session.url || 'about:blank';\r\n\r\n      // Switch to the session first if it has a sessionId\r\n      if (session.sessionId) {\r\n        try {\r\n          await ipc.sessions.setActive({ sessionId: session.sessionId });\r\n\r\n          // Wait a bit for session to switch\r\n          await new Promise(resolve => setTimeout(resolve, 200));\r\n\r\n          // Check if session has tabs already\r\n          const tabs = await ipc.tabs.list();\r\n          if (tabs.length > 0) {\r\n            // Session has tabs, they should be visible now\r\n            // Activate the first tab if none is active\r\n            const activeTab = tabs.find(t => t.active);\r\n            if (!activeTab && tabs[0]) {\r\n              await ipc.tabs.activate({ id: tabs[0].id });\r\n            }\r\n            return; // Tabs exist, don't create new one\r\n          }\r\n\r\n          // No tabs in session, create one with the session URL or default\r\n          if (!urlToLoad || urlToLoad === 'about:blank') {\r\n            // Try to get last visited URL from session or use default\r\n            urlToLoad = 'about:blank';\r\n          }\r\n        } catch (error) {\r\n          console.warn('Failed to set active session:', error);\r\n          // Continue with creating a tab\r\n        }\r\n      }\r\n\r\n      // Research-only alpha: always ensure Research mode is active\r\n      setMode('Research');\r\n\r\n      // Create tab with the URL\r\n      const result = await ipc.tabs.create(urlToLoad);\r\n      if (!result) {\r\n        throw new Error('Failed to create tab');\r\n      }\r\n\r\n      // Wait a bit for tab to be created and activated\r\n      await new Promise(resolve => setTimeout(resolve, 100));\r\n    } catch (error) {\r\n      console.error('Failed to continue session:', error);\r\n      // Last resort: create a blank tab\r\n      try {\r\n        await ipc.tabs.create('about:blank');\r\n        pushWorkspaceEvent({\r\n          type: 'workspace:resume-session',\r\n          workspaceId: session.sessionId ?? null,\r\n          message: `Started fallback tab for session \"${session.title}\"`,\r\n        });\r\n      } catch (e) {\r\n        console.error('Failed to create fallback tab:', e);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleSearchLaunch = useCallback(\r\n    async (value: string) => {\r\n      const query = value.trim();\r\n      if (!query) {\r\n        console.warn('[OmniDesk] Empty search query, ignoring');\r\n        return;\r\n      }\r\n\r\n      if (searchLoading) {\r\n        console.warn('[OmniDesk] Search already in progress, ignoring');\r\n        return;\r\n      }\r\n\r\n      setSearchLoading(true);\r\n      console.log('[OmniDesk] Launching search:', query);\r\n\r\n      // Check if query starts with @live, @ask, or @redix for AI streaming\r\n      const isAIQuery =\r\n        query.trim().startsWith('@live') ||\r\n        query.trim().startsWith('@ask') ||\r\n        query.trim().startsWith('@redix');\r\n\r\n      if (isAIQuery) {\r\n        // Show AI response pane for streaming queries\r\n        // Remove the @ prefix for the actual query\r\n        const cleanQuery = query.trim().replace(/^@(live|ask|redix)\\s*/i, '');\r\n        setAiQuery(cleanQuery || query);\r\n        setAiResponseOpen(true);\r\n        setSearchLoading(false);\r\n        return;\r\n      }\r\n\r\n      // Also check if query is a general question (starts with question words)\r\n      const isQuestion = /^(what|why|how|when|where|who|explain|summarize|compare|find)/i.test(\r\n        query.trim()\r\n      );\r\n      if (isQuestion && query.trim().length > 10) {\r\n        // Show AI response pane for question-like queries\r\n        setAiQuery(query);\r\n        setAiResponseOpen(true);\r\n        // Don't return - also open search results\r\n      }\r\n\r\n      // Use the active tab if it's about:blank, otherwise create a new tab\r\n      const activeTab = tabs.find(tab => tab.id === activeId);\r\n      const isAboutBlank =\r\n        activeTab?.url === 'about:blank' || !activeTab?.url || activeTab?.url?.startsWith('about:');\r\n\r\n      const targetUrl = buildSearchUrl(query, language !== 'auto' ? language : undefined);\r\n      setMode('Research');\r\n\r\n      try {\r\n        if (isAboutBlank && activeTab) {\r\n          // Navigate the existing tab instead of creating a new one\r\n          try {\r\n            console.log('[OmniDesk] Navigating existing tab:', activeTab.id, 'to:', targetUrl);\r\n            await ipc.tabs.navigate(activeTab.id, targetUrl);\r\n            setSearchQuery('');\r\n            console.log('[OmniDesk] Navigation successful');\r\n            return;\r\n          } catch (navError) {\r\n            // If navigation fails, fall through to create new tab\r\n            console.warn('[OmniDesk] Failed to navigate existing tab, creating new one:', navError);\r\n          }\r\n        }\r\n\r\n        // Create a new tab with the search URL\r\n        console.log('[OmniDesk] Creating new tab with URL:', targetUrl);\r\n        const result = await ipc.tabs.create(targetUrl);\r\n        const success =\r\n          result && typeof result === 'object' && 'success' in result\r\n            ? result.success !== false\r\n            : Boolean(result);\r\n        if (!success) {\r\n          console.warn('[OmniDesk] Tab creation failed, using fallback');\r\n          createFallbackTab({ url: targetUrl, title: `Search: ${query}` });\r\n          pushWorkspaceEvent({\r\n            type: 'workspace:launch-fallback',\r\n            message: 'IPC unavailable, opened search in fallback tab.',\r\n          });\r\n          if (typeof window !== 'undefined') {\r\n            window.open(targetUrl, '_blank', 'noopener,noreferrer');\r\n          }\r\n        } else {\r\n          console.log('[OmniDesk] Tab created successfully:', result);\r\n        }\r\n        setSearchQuery('');\r\n      } catch (error) {\r\n        console.error('[OmniDesk] Search launch error:', error);\r\n        const errorMessage = error instanceof Error ? error.message : String(error);\r\n\r\n        // Try fallback tab creation\r\n        try {\r\n          createFallbackTab({ url: targetUrl, title: `Search: ${query}` });\r\n        } catch (fallbackError) {\r\n          console.error('[OmniDesk] Fallback tab creation failed:', fallbackError);\r\n          // Last resort: open in external browser\r\n          if (typeof window !== 'undefined') {\r\n            window.open(targetUrl, '_blank', 'noopener,noreferrer');\r\n          }\r\n        }\r\n\r\n        pushWorkspaceEvent({\r\n          type: 'workspace:launch-error',\r\n          message: 'Encountered an error launching the flow. Using fallback tab.',\r\n          payload: { error: errorMessage },\r\n        });\r\n      } finally {\r\n        setSearchLoading(false);\r\n      }\r\n    },\r\n    [pushWorkspaceEvent, setMode, tabs, activeId, searchLoading]\r\n  );\r\n\r\n  // Show dashboard if forced, no tabs, or active tab is about:blank (search page)\r\n  const activeTabForDisplay = tabs.find(tab => tab.id === activeId);\r\n  const isAboutBlankDisplay =\r\n    activeTabForDisplay?.url === 'about:blank' ||\r\n    !activeTabForDisplay?.url ||\r\n    activeTabForDisplay?.url?.startsWith('about:') ||\r\n    activeTabForDisplay?.url?.startsWith('ob://newtab') ||\r\n    activeTabForDisplay?.url?.startsWith('ob://home');\r\n  const shouldShowDashboard =\r\n    forceShow || tabs.length === 0 || !activeTabForDisplay || isAboutBlankDisplay;\r\n\r\n  if (!shouldShowDashboard) return null;\r\n\r\n  // Show Chrome-style new tab page by default (replacing OmniDesk)\r\n  // Only show OmniDesk if explicitly disabled\r\n  if (chromeStyleEnabled !== false) {\r\n    return <ChromeNewTabPage />;\r\n  }\r\n\r\n  const containerClass =\r\n    variant === 'overlay'\r\n      ? 'absolute inset-0 z-20 flex h-full w-full overflow-auto bg-gradient-to-br from-[#131722] via-[#171B2A] to-[#10131C] px-6 py-8'\r\n      : variant === 'split'\r\n        ? 'flex h-full w-full overflow-auto bg-gradient-to-br from-[#131722] via-[#171B2A] to-[#10131C] px-6 py-8'\r\n        : 'flex h-full w-full overflow-auto bg-gradient-to-br from-[#0F121C] via-[#131827] to-[#0F121C] px-6 py-8';\r\n\r\n  // Ensure container is properly sized and visible\r\n  // Note: z-index 20 is below TabStrip (z-50) to ensure tabs are always clickable\r\n  const containerStyle = {\r\n    minHeight: '100%',\r\n    width: '100%',\r\n    position: variant === 'overlay' ? ('absolute' as const) : ('relative' as const),\r\n    zIndex: variant === 'overlay' ? 20 : 1,\r\n    pointerEvents: shouldShowDashboard ? ('auto' as const) : ('none' as const), // Only allow pointer events when visible\r\n  };\r\n\r\n  const handleManualRefresh = async () => {\r\n    setRefreshing(true);\r\n    try {\r\n      await reload();\r\n      pushWorkspaceEvent({ type: 'workspace:manual-refresh', message: 'Dashboard refreshed' });\r\n    } finally {\r\n      setRefreshing(false);\r\n    }\r\n  };\r\n\r\n  const sessionSkeletons = useMemo(() => Array.from({ length: 2 }), []);\r\n  const workspaceSkeletons = useMemo(() => Array.from({ length: 3 }), []);\r\n\r\n  // Debug: Log when dashboard should show (only in dev)\r\n  useEffect(() => {\r\n    if (typeof window !== 'undefined' && (window as any).IS_DEV !== undefined) {\r\n      console.log('[OmniDesk] Rendering dashboard:', {\r\n        shouldShowDashboard,\r\n        forceShow,\r\n        tabsLength: tabs.length,\r\n        activeTab: activeTabForDisplay,\r\n        isAboutBlank: isAboutBlankDisplay,\r\n        variant,\r\n      });\r\n    }\r\n  }, [\r\n    shouldShowDashboard,\r\n    forceShow,\r\n    tabs.length,\r\n    activeTabForDisplay,\r\n    isAboutBlankDisplay,\r\n    variant,\r\n  ]);\r\n\r\n  return (\r\n    <div className={containerClass} data-onboarding=\"dashboard\" style={containerStyle}>\r\n      <div\r\n        className=\"mx-auto flex h-full w-full max-w-6xl flex-col gap-6 xl:flex-row\"\r\n        style={{ minHeight: '100%' }}\r\n      >\r\n        <div className=\"flex-1 space-y-6\">\r\n          <motion.div\r\n            initial={{ opacity: 0, y: -10 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            transition={{ duration: 0.4 }}\r\n            className=\"rounded-3xl border border-slate-800/70 bg-slate-900/70 px-6 py-7 shadow-2xl shadow-black/30\"\r\n          >\r\n            <p className=\"text-xs font-medium uppercase tracking-[0.32em] text-slate-400\">\r\n              Regenerative Command Center\r\n            </p>\r\n            <h1 className=\"mt-3 text-3xl font-bold leading-tight text-slate-50 sm:text-4xl lg:text-5xl\">\r\n              Guide your next deep work session with Regen & Redix\r\n            </h1>\r\n            <p className=\"mt-3 max-w-2xl text-base leading-relaxed text-slate-300\">\r\n              Spin up an agent, resume an exploration, or launch a new search. Your flow state\r\n              starts here.\r\n            </p>\r\n\r\n            <form\r\n              className=\"mt-6 space-y-3\"\r\n              onSubmit={event => {\r\n                event.preventDefault();\r\n                void handleSearchLaunch(searchQuery);\r\n              }}\r\n            >\r\n              <div className=\"flex flex-col gap-3 sm:flex-row\">\r\n                <div className=\"flex min-h-[52px] flex-1 items-center gap-3 rounded-2xl border border-slate-700/60 bg-slate-800/70 px-4 py-3 text-slate-200 focus-within:border-blue-500/60\">\r\n                  <Search size={18} className=\"text-blue-400\" />\r\n                  <input\r\n                    value={searchQuery}\r\n                    onChange={event => setSearchQuery(event.target.value)}\r\n                    onKeyDown={e => {\r\n                      if (e.key === 'Enter') {\r\n                        e.preventDefault();\r\n                        void handleSearchLaunch(searchQuery);\r\n                      }\r\n                    }}\r\n                    onClick={e => {\r\n                      e.stopPropagation();\r\n                    }}\r\n                    placeholder=\"Search the open web, knowledge base, or ask Redix\"\r\n                    className=\"flex-1 bg-transparent text-sm outline-none placeholder:text-slate-500\"\r\n                    style={{ pointerEvents: 'auto', zIndex: 10 }}\r\n                    autoFocus={false}\r\n                    tabIndex={0}\r\n                    aria-label=\"Search the open web, knowledge base, or ask Redix\"\r\n                    aria-describedby=\"search-hint\"\r\n                    role=\"searchbox\"\r\n                  />\r\n                  <span id=\"search-hint\" className=\"sr-only\">\r\n                    Press Enter to search or launch flow. Use @live or @ask prefix for AI queries.\r\n                  </span>\r\n                </div>\r\n                <button\r\n                  type=\"submit\"\r\n                  onClick={e => {\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                    void handleSearchLaunch(searchQuery);\r\n                  }}\r\n                  disabled={searchLoading || !searchQuery.trim()}\r\n                  className=\"inline-flex cursor-pointer items-center justify-center gap-2 rounded-2xl border border-blue-500/60 bg-blue-500/20 px-5 py-3 text-sm font-semibold text-blue-100 shadow-[0_10px_40px_-20px_rgba(59,130,246,0.8)] transition hover:border-blue-400 hover:bg-blue-500/30 focus:outline-none focus:ring-2 focus:ring-blue-500/50 disabled:cursor-not-allowed disabled:opacity-60\"\r\n                  style={{ pointerEvents: 'auto', zIndex: 10 }}\r\n                  aria-label={searchLoading ? 'Launching search' : 'Launch search flow'}\r\n                  aria-busy={searchLoading}\r\n                >\r\n                  {searchLoading ? (\r\n                    <>\r\n                      <Loader2 size={16} className=\"animate-spin\" />\r\n                      <span>Launching...</span>\r\n                    </>\r\n                  ) : (\r\n                    'Launch Flow'\r\n                  )}\r\n                </button>\r\n              </div>\r\n              <div className=\"flex flex-wrap gap-2 text-xs text-slate-400\">\r\n                {suggestedPrompts.map(prompt => (\r\n                  <button\r\n                    key={prompt}\r\n                    type=\"button\"\r\n                    onClick={e => {\r\n                      e.preventDefault();\r\n                      e.stopPropagation();\r\n                      if (searchLoading) return;\r\n                      setSearchQuery(prompt);\r\n                      void handleSearchLaunch(prompt);\r\n                    }}\r\n                    disabled={searchLoading}\r\n                    onKeyDown={e => {\r\n                      if (e.key === 'Enter' || e.key === ' ') {\r\n                        e.preventDefault();\r\n                        e.stopPropagation();\r\n                        setSearchQuery(prompt);\r\n                        void handleSearchLaunch(prompt);\r\n                      }\r\n                    }}\r\n                    className=\"cursor-pointer rounded-full border border-slate-700/60 bg-slate-800/60 px-3 py-1.5 transition hover:border-blue-500/50 hover:bg-slate-800/80 hover:text-blue-200 focus:outline-none focus:ring-2 focus:ring-blue-500/50 disabled:cursor-not-allowed disabled:opacity-50\"\r\n                    style={{ pointerEvents: 'auto', zIndex: 10 }}\r\n                    aria-label={`Suggested search: ${prompt}`}\r\n                    tabIndex={0}\r\n                  >\r\n                    {prompt}\r\n                  </button>\r\n                ))}\r\n              </div>\r\n            </form>\r\n          </motion.div>\r\n\r\n          <motion.div\r\n            initial={{ opacity: 0, y: 10 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            transition={{ delay: 0.1, duration: 0.4 }}\r\n            className=\"grid gap-3 sm:grid-cols-2 xl:grid-cols-3\"\r\n          >\r\n            {quickActions.map(action => {\r\n              const Icon = action.icon;\r\n              return (\r\n                <motion.button\r\n                  key={action.label}\r\n                  onClick={e => {\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                    if (searchLoading) return;\r\n                    void action.action();\r\n                  }}\r\n                  onKeyDown={e => {\r\n                    if (e.key === 'Enter' || e.key === ' ') {\r\n                      e.preventDefault();\r\n                      e.stopPropagation();\r\n                      if (searchLoading) return;\r\n                      void action.action();\r\n                    }\r\n                  }}\r\n                  disabled={searchLoading}\r\n                  whileHover={searchLoading ? {} : { y: -4, scale: 1.02 }}\r\n                  whileTap={searchLoading ? {} : { scale: 0.96 }}\r\n                  transition={{ type: 'spring', stiffness: 400, damping: 17 }}\r\n                  className={`group flex h-full cursor-pointer flex-col justify-between gap-4 rounded-2xl border border-slate-800/70 bg-slate-900/60 px-5 py-6 text-left shadow-[0_12px_40px_-24px_rgba(15,23,42,0.9)] transition hover:border-slate-700/70 hover:bg-slate-900/80 focus:outline-none focus:ring-2 focus:ring-blue-500/50 ${searchLoading ? 'cursor-not-allowed opacity-60' : ''}`}\r\n                  style={{ pointerEvents: 'auto', zIndex: 10 }}\r\n                  aria-label={\r\n                    action.description ? `${action.label}: ${action.description}` : action.label\r\n                  }\r\n                  tabIndex={0}\r\n                >\r\n                  <span\r\n                    className={`inline-flex h-11 w-11 items-center justify-center rounded-xl bg-gradient-to-br ${action.color} text-white shadow-[0_15px_30px_-20px_currentColor]`}\r\n                  >\r\n                    <Icon className=\"h-5 w-5\" />\r\n                  </span>\r\n                  <div className=\"space-y-1\">\r\n                    <div className=\"text-sm font-semibold text-slate-100 group-hover:text-white\">\r\n                      {action.label}\r\n                    </div>\r\n                    {action.description ? (\r\n                      <p className=\"text-xs leading-snug text-slate-400 group-hover:text-slate-300\">\r\n                        {action.description}\r\n                      </p>\r\n                    ) : null}\r\n                  </div>\r\n                </motion.button>\r\n              );\r\n            })}\r\n          </motion.div>\r\n\r\n          <motion.div\r\n            initial={{ opacity: 0, y: 10 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            transition={{ delay: 0.16, duration: 0.4 }}\r\n            className=\"rounded-3xl border border-violet-500/30 bg-violet-500/10 px-6 py-5 text-violet-100 shadow-[0_45px_120px_-60px_rgba(139,92,246,0.6)]\"\r\n          >\r\n            <div className=\"flex flex-wrap items-center justify-between gap-3\">\r\n              <div className=\"flex items-center gap-2 text-sm font-semibold\">\r\n                <span className=\"inline-flex h-9 w-9 items-center justify-center rounded-xl border border-violet-400/40 bg-violet-500/20\">\r\n                  <Bot size={16} />\r\n                </span>\r\n                Live Redix Pulse\r\n              </div>\r\n              <span\r\n                className={`inline-flex items-center gap-2 rounded-full px-3 py-1 text-[11px] ${agentPreview.statusTone.tone}`}\r\n              >\r\n                <span className=\"h-2 w-2 rounded-full bg-current\" />\r\n                {agentStatusLabels[agentStatus]}\r\n              </span>\r\n            </div>\r\n\r\n            <div className=\"mt-4 space-y-3 text-sm text-purple-100/90\">\r\n              {agentLastGoal ? (\r\n                <div className=\"rounded-2xl border border-violet-400/30 bg-violet-500/10 px-4 py-3 text-xs text-purple-100/80\">\r\n                  <span className=\"text-[11px] uppercase tracking-[0.28em] text-purple-200/70\">\r\n                    Last goal\r\n                  </span>\r\n                  <p className=\"mt-2 text-sm text-purple-100\">{agentLastGoal}</p>\r\n                </div>\r\n              ) : null}\r\n\r\n              <div className=\"rounded-2xl border border-violet-400/20 bg-violet-500/10 px-4 py-4\">\r\n                <span className=\"text-[11px] uppercase tracking-[0.3em] text-purple-200/70\">\r\n                  Preview\r\n                </span>\r\n                <div className=\"mt-2 text-xs text-purple-100/80\">\r\n                  <AnimatePresence mode=\"popLayout\">\r\n                    {agentPreview.snippet.length > 0 ? (\r\n                      agentPreview.snippet.map((line, index) => (\r\n                        <motion.p\r\n                          key={`${line}-${index}`}\r\n                          initial={{ opacity: 0, y: 6 }}\r\n                          animate={{ opacity: 1, y: 0 }}\r\n                          exit={{ opacity: 0, y: -6 }}\r\n                          transition={{ duration: 0.25 }}\r\n                          className=\"leading-relaxed\"\r\n                        >\r\n                          {line}\r\n                        </motion.p>\r\n                      ))\r\n                    ) : (\r\n                      <motion.p\r\n                        initial={{ opacity: 0.6 }}\r\n                        animate={{ opacity: 1 }}\r\n                        className=\"text-purple-200/70\"\r\n                      >\r\n                        No live transcript yet. Kick off a prompt to watch the agent stream.\r\n                      </motion.p>\r\n                    )}\r\n                  </AnimatePresence>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"flex flex-wrap gap-2 text-[11px]\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={handleCopyTranscript}\r\n                  disabled={!hasTranscript || copyStatus === 'copying'}\r\n                  className=\"inline-flex items-center gap-1 rounded-full border border-violet-400/40 bg-violet-500/15 px-3 py-1 font-medium text-purple-100 transition hover:border-violet-300/60 hover:bg-violet-500/25 disabled:cursor-not-allowed disabled:opacity-60\"\r\n                >\r\n                  <ClipboardCopy size={12} />\r\n                  {copyStatus === 'copied'\r\n                    ? 'Copied!'\r\n                    : copyStatus === 'copying'\r\n                      ? 'Copying'\r\n                      : 'Copy transcript'}\r\n                </button>\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => navigate('/agent')}\r\n                  className=\"inline-flex items-center gap-1 rounded-full border border-violet-400/40 bg-violet-500/15 px-3 py-1 font-medium text-purple-100 transition hover:border-violet-300/60 hover:bg-violet-500/25\"\r\n                >\r\n                  <FileSearch size={12} />\r\n                  View run log\r\n                </button>\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => navigate('/agent')}\r\n                  className=\"inline-flex items-center gap-1 rounded-full border border-violet-400/40 bg-violet-500/15 px-3 py-1 font-medium text-purple-100 transition hover:border-violet-300/60 hover:bg-violet-500/25\"\r\n                >\r\n                  <Sparkle size={12} />\r\n                  Launch prompt\r\n                </button>\r\n              </div>\r\n\r\n              <div>\r\n                <span className=\"text-[11px] uppercase tracking-[0.28em] text-purple-200/70\">\r\n                  Timeline\r\n                </span>\r\n                <div className=\"mt-2 space-y-2\">\r\n                  <AnimatePresence initial={false}>\r\n                    {agentPreview.timeline.length > 0 ? (\r\n                      agentPreview.timeline.map(event => (\r\n                        <motion.div\r\n                          key={event.id}\r\n                          initial={{ opacity: 0, x: 8 }}\r\n                          animate={{ opacity: 1, x: 0 }}\r\n                          exit={{ opacity: 0, x: -8 }}\r\n                          transition={{ duration: 0.2 }}\r\n                          className={`flex items-center justify-between rounded-xl px-3 py-2 text-[11px] ${event.variant}`}\r\n                        >\r\n                          <span className=\"capitalize\">{event.label}</span>\r\n                          <span className=\"text-purple-300/70\">\r\n                            {formatDistanceToNow(event.timestamp, { addSuffix: true })}\r\n                          </span>\r\n                        </motion.div>\r\n                      ))\r\n                    ) : (\r\n                      <motion.div\r\n                        initial={{ opacity: 0, y: 8 }}\r\n                        animate={{ opacity: 1, y: 0 }}\r\n                        exit={{ opacity: 0, y: -8 }}\r\n                        className=\"rounded-xl border border-dashed border-violet-400/30 px-4 py-3 text-[11px] text-purple-200/70\"\r\n                      >\r\n                        No agent events yet  run a plan or quick prompt to populate this stream.\r\n                      </motion.div>\r\n                    )}\r\n                  </AnimatePresence>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"mt-4 flex flex-wrap justify-between gap-2 text-xs\">\r\n              <div className=\"text-purple-200/60\">\r\n                {agentPreview.lastUpdated\r\n                  ? `Updated ${formatDistanceToNow(agentPreview.lastUpdated, { addSuffix: true })}`\r\n                  : 'Awaiting first signal'}\r\n              </div>\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => navigate('/agent')}\r\n                className=\"inline-flex items-center gap-2 rounded-full border border-violet-400/40 bg-violet-500/20 px-3 py-1.5 text-xs font-medium text-purple-100 hover:border-violet-300/60 hover:bg-violet-500/30\"\r\n              >\r\n                Open agent console\r\n              </button>\r\n            </div>\r\n          </motion.div>\r\n\r\n          <motion.div\r\n            initial={{ opacity: 0, y: 10 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            transition={{ delay: 0.2, duration: 0.4 }}\r\n            className=\"rounded-3xl border border-slate-800/60 bg-slate-900/60 px-6 py-5 shadow-lg\"\r\n          >\r\n            <div className=\"flex flex-wrap items-center gap-3 text-sm text-slate-400\">\r\n              <Compass size={16} className=\"text-slate-300\" />\r\n              <span>Pro tip:</span>\r\n              <span className=\"text-slate-300\">\r\n                Drag any research tab into Redix MindMap to instantly connect ideas.\r\n              </span>\r\n            </div>\r\n          </motion.div>\r\n        </div>\r\n\r\n        <aside className=\"w-full flex-shrink-0 space-y-4 xl:w-[360px]\">\r\n          <motion.div\r\n            initial={{ opacity: 0, x: 10 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ duration: 0.4 }}\r\n            className=\"rounded-2xl border border-slate-800/70 bg-slate-900/70 p-5 shadow-lg\"\r\n          >\r\n            <div className=\"mb-3 flex items-center justify-between text-sm font-semibold text-slate-300\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <Clock size={16} />\r\n                Continue Session\r\n              </div>\r\n              <button\r\n                onClick={handleManualRefresh}\r\n                className=\"rounded-full border border-slate-700/60 p-1.5 text-slate-400 transition hover:border-slate-500/60 hover:text-slate-200\"\r\n                title=\"Refresh\"\r\n              >\r\n                <RefreshCw size={14} className={refreshing ? 'animate-spin' : ''} />\r\n              </button>\r\n            </div>\r\n            <div className=\"space-y-3\">\r\n              {loadingSessions ? (\r\n                sessionSkeletons.map((_, idx) => (\r\n                  <motion.div\r\n                    key={`session-skeleton-${idx}`}\r\n                    initial={{ opacity: 0, y: 8 }}\r\n                    animate={{ opacity: 1, y: 0 }}\r\n                    transition={{ delay: idx * 0.1, duration: 0.3 }}\r\n                    className=\"h-[86px] w-full rounded-xl border border-slate-800/60 bg-slate-900/40 p-4\"\r\n                  >\r\n                    <div className=\"mb-2 flex items-center gap-2\">\r\n                      <div className=\"h-5 w-16 animate-pulse rounded-full bg-slate-800/60\" />\r\n                      <div className=\"h-4 w-20 animate-pulse rounded-full bg-slate-800/60\" />\r\n                    </div>\r\n                    <div className=\"h-5 w-3/4 animate-pulse rounded bg-slate-800/60\" />\r\n                  </motion.div>\r\n                ))\r\n              ) : continueSessions.length > 0 ? (\r\n                continueSessions.map((session, idx) => (\r\n                  <button\r\n                    key={idx}\r\n                    onClick={e => {\r\n                      e.preventDefault();\r\n                      e.stopPropagation();\r\n                      void handleContinueSession(session);\r\n                    }}\r\n                    onKeyDown={e => {\r\n                      if (e.key === 'Enter' || e.key === ' ') {\r\n                        e.preventDefault();\r\n                        e.stopPropagation();\r\n                        void handleContinueSession(session);\r\n                      }\r\n                    }}\r\n                    className=\"group w-full cursor-pointer rounded-xl border border-slate-800/60 bg-slate-900/60 px-4 py-3 text-left transition hover:border-slate-600/60 hover:bg-slate-900 focus:outline-none focus:ring-2 focus:ring-blue-500/50\"\r\n                    style={{ pointerEvents: 'auto', zIndex: 10 }}\r\n                  >\r\n                    <div className=\"flex items-center gap-2 text-xs text-slate-400\">\r\n                      <span\r\n                        className={`rounded-full px-2 py-0.5 text-[11px] ${\r\n                          session.type === 'Research'\r\n                            ? 'bg-purple-500/20 text-purple-300'\r\n                            : session.type === 'Trade'\r\n                              ? 'bg-emerald-500/20 text-emerald-300'\r\n                              : 'bg-blue-500/20 text-blue-200'\r\n                        }`}\r\n                      >\r\n                        {session.type}\r\n                      </span>\r\n                      <span>{formatDistanceToNow(session.timestamp, { addSuffix: true })}</span>\r\n                    </div>\r\n                    <div className=\"mt-2 text-sm font-medium text-slate-100 group-hover:text-white\">\r\n                      {session.title}\r\n                    </div>\r\n                  </button>\r\n                ))\r\n              ) : (\r\n                <div className=\"rounded-xl border border-dashed border-slate-700/60 px-4 py-6 text-center text-xs text-slate-500\">\r\n                  Well keep your auto-snapshots here for quick handoffs.\r\n                </div>\r\n              )}\r\n            </div>\r\n          </motion.div>\r\n\r\n          <motion.div\r\n            initial={{ opacity: 0, x: 10 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.1, duration: 0.4 }}\r\n            className=\"rounded-2xl border border-slate-800/70 bg-slate-900/70 p-5 shadow-lg\"\r\n          >\r\n            <div className=\"mb-3 flex items-center gap-2 text-sm font-semibold text-slate-300\">\r\n              <Pin size={16} />\r\n              Recent Workspaces\r\n            </div>\r\n            <div className=\"space-y-2\">\r\n              {loadingWorkspaces ? (\r\n                workspaceSkeletons.map((_, idx) => (\r\n                  <motion.div\r\n                    key={`workspace-skeleton-${idx}`}\r\n                    initial={{ opacity: 0, x: -8 }}\r\n                    animate={{ opacity: 1, x: 0 }}\r\n                    transition={{ delay: idx * 0.08, duration: 0.3 }}\r\n                    className=\"flex h-14 w-full items-center rounded-xl border border-slate-800/60 bg-slate-900/40 p-3\"\r\n                  >\r\n                    <div className=\"h-4 w-2/3 animate-pulse rounded bg-slate-800/60\" />\r\n                  </motion.div>\r\n                ))\r\n              ) : recentWorkspaces.length > 0 ? (\r\n                recentWorkspaces.map(workspace => (\r\n                  <button\r\n                    key={workspace.id}\r\n                    onClick={e => {\r\n                      e.preventDefault();\r\n                      e.stopPropagation();\r\n                      navigate(`/w/${workspace.id}`);\r\n                    }}\r\n                    onKeyDown={e => {\r\n                      if (e.key === 'Enter' || e.key === ' ') {\r\n                        e.preventDefault();\r\n                        e.stopPropagation();\r\n                        navigate(`/w/${workspace.id}`);\r\n                      }\r\n                    }}\r\n                    className=\"flex w-full cursor-pointer items-center justify-between rounded-xl border border-slate-800/60 bg-slate-900/60 px-4 py-3 text-left text-sm text-slate-200 transition hover:border-slate-600/70 hover:text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50\"\r\n                    style={{ pointerEvents: 'auto', zIndex: 10 }}\r\n                  >\r\n                    <span className=\"truncate\">{workspace.name}</span>\r\n                    <span className=\"text-xs text-slate-500\">Open</span>\r\n                  </button>\r\n                ))\r\n              ) : (\r\n                <div className=\"rounded-xl border border-dashed border-slate-700/60 px-4 py-6 text-center text-xs text-slate-500\">\r\n                  Create a workspace to keep your Redix graph evolving.\r\n                </div>\r\n              )}\r\n            </div>\r\n          </motion.div>\r\n\r\n          <motion.div\r\n            initial={{ opacity: 0, x: 10 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.2, duration: 0.4 }}\r\n            className=\"overflow-hidden rounded-2xl border border-emerald-500/30 bg-gradient-to-br from-emerald-950/80 via-emerald-900/70 to-emerald-950/90 p-5 text-emerald-100 shadow-lg shadow-emerald-900/50\"\r\n          >\r\n            <div className=\"flex items-center justify-between gap-3\">\r\n              <div className=\"flex items-center gap-2 text-sm font-semibold\">\r\n                <span className=\"inline-flex h-9 w-9 items-center justify-center rounded-xl border border-emerald-400/40 bg-emerald-500/10\">\r\n                  <Leaf size={16} />\r\n                </span>\r\n                Eco Scoreboard\r\n              </div>\r\n              <div className=\"text-right text-xs text-emerald-200/70\">\r\n                <div className=\"uppercase tracking-[0.3em] text-emerald-300/60\">Eco score</div>\r\n                <div className=\"text-xl font-semibold text-emerald-100\">\r\n                  {ecoGauge.clampedScore}\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"mt-5 grid gap-5 md:grid-cols-[150px,1fr]\">\r\n              <div className=\"relative mx-auto flex h-36 w-36 items-center justify-center\">\r\n                <svg\r\n                  width=\"150\"\r\n                  height=\"150\"\r\n                  viewBox=\"0 0 150 150\"\r\n                  className=\"absolute inset-0 text-emerald-500/40\"\r\n                >\r\n                  <circle\r\n                    cx=\"75\"\r\n                    cy=\"75\"\r\n                    r={ecoGauge.radius}\r\n                    stroke=\"currentColor\"\r\n                    strokeWidth=\"10\"\r\n                    fill=\"none\"\r\n                    className=\"opacity-30\"\r\n                  />\r\n                  <motion.circle\r\n                    cx=\"75\"\r\n                    cy=\"75\"\r\n                    r={ecoGauge.radius}\r\n                    stroke=\"url(#ecoGradient)\"\r\n                    strokeWidth=\"10\"\r\n                    strokeLinecap=\"round\"\r\n                    fill=\"none\"\r\n                    strokeDasharray={ecoGauge.circumference}\r\n                    strokeDashoffset={ecoGauge.offset}\r\n                    initial={{ strokeDashoffset: ecoGauge.circumference }}\r\n                    animate={{ strokeDashoffset: ecoGauge.offset }}\r\n                    transition={{ duration: 0.8, ease: 'easeOut' }}\r\n                    transform=\"rotate(-90 75 75)\"\r\n                  />\r\n                  <defs>\r\n                    <linearGradient id=\"ecoGradient\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\r\n                      <stop offset=\"0%\" stopColor=\"#34d399\" />\r\n                      <stop offset=\"100%\" stopColor=\"#22d3ee\" />\r\n                    </linearGradient>\r\n                  </defs>\r\n                </svg>\r\n                <div className=\"relative z-10 text-center\">\r\n                  <GaugeCircle size={28} className=\"mx-auto text-emerald-300\" />\r\n                  <div className=\"mt-2 text-3xl font-semibold text-emerald-50\">\r\n                    {ecoGauge.clampedScore}\r\n                  </div>\r\n                  <div className=\"text-[11px] uppercase tracking-[0.28em] text-emerald-200/70\">\r\n                    Regenerative\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"space-y-5\">\r\n                <div className=\"grid grid-cols-3 gap-3 rounded-2xl border border-emerald-400/20 bg-emerald-500/5 p-4 text-xs text-emerald-100/80\">\r\n                  <div>\r\n                    <p className=\"text-[11px] uppercase tracking-[0.28em] text-emerald-200/70\">\r\n                      Battery\r\n                    </p>\r\n                    <p className=\"mt-2 text-lg font-semibold text-emerald-50\">\r\n                      {ecoStats.batteryPct}\r\n                    </p>\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-[11px] uppercase tracking-[0.28em] text-emerald-200/70\">\r\n                      Carbon\r\n                    </p>\r\n                    <p className=\"mt-2 text-sm font-semibold leading-tight text-emerald-50\">\r\n                      {ecoStats.carbonIntensity}\r\n                    </p>\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-[11px] uppercase tracking-[0.28em] text-emerald-200/70\">\r\n                      Active Tabs\r\n                    </p>\r\n                    <p className=\"mt-2 text-lg font-semibold text-emerald-50\">\r\n                      {ecoStats.activeTabs}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  {ecoMetrics.achievements.map(achievement => {\r\n                    const Icon = achievement.icon;\r\n                    return (\r\n                      <div\r\n                        key={achievement.id}\r\n                        className=\"flex items-start gap-3 rounded-2xl border border-emerald-400/20 bg-emerald-500/10 px-4 py-3 text-xs text-emerald-100/80\"\r\n                      >\r\n                        <span\r\n                          className={`mt-0.5 inline-flex h-7 w-7 items-center justify-center rounded-xl border ${\r\n                            achievement.achieved\r\n                              ? 'border-emerald-400/60 bg-emerald-500/20 text-emerald-200'\r\n                              : 'border-emerald-400/20 bg-emerald-500/5 text-emerald-200/60'\r\n                          }`}\r\n                        >\r\n                          {achievement.achieved ? <CheckCircle2 size={14} /> : <Icon size={14} />}\r\n                        </span>\r\n                        <div>\r\n                          <div className=\"font-semibold text-emerald-100\">{achievement.label}</div>\r\n                          <div className=\"mt-1 text-[11px] text-emerald-200/70\">\r\n                            {achievement.description}\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    );\r\n                  })}\r\n                </div>\r\n\r\n                <div className=\"rounded-2xl border border-emerald-400/20 bg-emerald-500/10 px-4 py-4 text-xs text-emerald-100/80\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div className=\"font-semibold text-emerald-100\">Trends</div>\r\n                    <span className=\"text-[11px] uppercase tracking-[0.28em] text-emerald-200/70\">\r\n                      Last {Math.min(efficiencyHistory.length, 24)} samples\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"mt-3 grid gap-4 md:grid-cols-2\">\r\n                    <div className=\"space-y-2\">\r\n                      <div className=\"flex items-center gap-2 text-emerald-100\">\r\n                        Battery\r\n                        {ecoHistoryInsights.battery.trend.direction === 'up' ? (\r\n                          <TrendingUp size={12} className=\"text-emerald-300\" />\r\n                        ) : ecoHistoryInsights.battery.trend.direction === 'down' ? (\r\n                          <TrendingDown size={12} className=\"text-amber-300\" />\r\n                        ) : null}\r\n                        <span className=\"text-[11px] text-emerald-200/70\">\r\n                          {ecoHistoryInsights.battery.trend.delta > 0\r\n                            ? `+${ecoHistoryInsights.battery.trend.delta.toFixed(1)}`\r\n                            : ecoHistoryInsights.battery.trend.delta.toFixed(1)}\r\n                          %\r\n                        </span>\r\n                      </div>\r\n                      <div className=\"relative h-16 overflow-hidden rounded-xl border border-emerald-400/20 bg-emerald-500/10\">\r\n                        {ecoHistoryInsights.battery.path ? (\r\n                          <svg\r\n                            viewBox=\"0 0 100 100\"\r\n                            className=\"absolute inset-0 h-full w-full text-emerald-300\"\r\n                          >\r\n                            <polyline\r\n                              fill=\"none\"\r\n                              stroke=\"currentColor\"\r\n                              strokeWidth=\"3\"\r\n                              points={ecoHistoryInsights.battery.path}\r\n                            />\r\n                          </svg>\r\n                        ) : (\r\n                          <div className=\"flex h-full items-center justify-center text-[11px] text-emerald-200/60\">\r\n                            Not enough data\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <div className=\"flex items-center gap-2 text-emerald-100\">\r\n                        Carbon\r\n                        {ecoHistoryInsights.carbon.trend.direction === 'down' ? (\r\n                          <TrendingDown size={12} className=\"text-emerald-300\" />\r\n                        ) : ecoHistoryInsights.carbon.trend.direction === 'up' ? (\r\n                          <TrendingUp size={12} className=\"text-amber-300\" />\r\n                        ) : null}\r\n                        <span className=\"text-[11px] text-emerald-200/70\">\r\n                          {ecoHistoryInsights.carbon.trend.delta > 0\r\n                            ? `+${ecoHistoryInsights.carbon.trend.delta.toFixed(0)}`\r\n                            : ecoHistoryInsights.carbon.trend.delta.toFixed(0)}{' '}\r\n                          g\r\n                        </span>\r\n                      </div>\r\n                      <div className=\"relative h-16 overflow-hidden rounded-xl border border-emerald-400/20 bg-emerald-500/10\">\r\n                        {ecoHistoryInsights.carbon.path ? (\r\n                          <svg\r\n                            viewBox=\"0 0 100 100\"\r\n                            className=\"absolute inset-0 h-full w-full text-emerald-200\"\r\n                          >\r\n                            <polyline\r\n                              fill=\"none\"\r\n                              stroke=\"currentColor\"\r\n                              strokeWidth=\"3\"\r\n                              points={ecoHistoryInsights.carbon.path}\r\n                            />\r\n                          </svg>\r\n                        ) : (\r\n                          <div className=\"flex h-full items-center justify-center text-[11px] text-emerald-200/60\">\r\n                            Awaiting carbon samples\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {efficiencyUpdated && (\r\n              <p className=\"mt-5 text-[11px] text-emerald-100/60\">\r\n                Updated {formatDistanceToNow(efficiencyUpdated, { addSuffix: true })}\r\n              </p>\r\n            )}\r\n            <p className=\"mt-1 text-[11px] text-emerald-100/70\">\r\n              {efficiencyLabel}\r\n              {efficiencyBadge ? `  ${efficiencyBadge}` : ''}\r\n            </p>\r\n          </motion.div>\r\n        </aside>\r\n      </div>\r\n\r\n      {/* AI Response Pane */}\r\n      <AIResponsePane\r\n        query={aiQuery}\r\n        isOpen={aiResponseOpen}\r\n        onClose={() => {\r\n          setAiResponseOpen(false);\r\n          setAiQuery('');\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n"],"names":["DEFAULT_WS_URL","DEFAULT_HTTP_URL","DEFAULT_SSE_URL","RedixWS","url","__publicField","isBackendAvailable","onBackendStatusChange","status","isElectronRuntime","isTauriRuntime","event","message","payload","res","data","error","id","query","sessionId","options","onMessage","safeParse","eventSource","handleAck","handleUpdate","handleToken","item","handleResult","cleanup","handleError","handleDone","_redixWSInstance","getRedixWS","redixWS","stub","requestRedix","controller","typed","AIResponsePane","isOpen","onClose","response","setResponse","useState","isStreaming","setIsStreaming","setError","copied","setCopied","controllerRef","useRef","sessionIdRef","responseEndRef","useEffect","prev","textContent","errorMsg","handleCopy","useCallback","AnimatePresence","jsxs","motion","jsx","Sparkles","Check","Copy","X","Loader2","MODE_LABELS","MODE_BADGES","MODE_COLORS","defaultSnapshot","HISTORY_KEY","loadHistory","raw","parsed","saveHistory","history","initialHistory","useEfficiencyStore","create","set","get","sample","nextHistory","nextMode","useWorkspaceEventsStore","state","timestamp","workspaceId","createFallbackTab","store","useTabsStore","title","activate","mode","existingTabs","nextTabs","tab","newTab","ipcEvents","ChromeNewTabPage","searchQuery","setSearchQuery","isSearching","setIsSearching","activeCategory","setActiveCategory","marketData","setMarketData","newsItems","setNewsItems","weatherData","setWeatherData","isLoadingMarkets","setIsLoadingMarkets","isLoadingNews","setIsLoadingNews","activeId","tabs","setMode","useAppStore","inputRef","fetchMarketData","marketPromises","symbol","yahooSymbol","isWebMode","result","ipc","price","change","changePercent","validResults","r","fetchNews","news","index","fetchWeather","marketInterval","newsInterval","handleSearch","trimmedQuery","targetUrl","activeTab","t","handleSubmit","e","recentTabs","quickAccess","TrendingUp","Globe","BookOpen","Briefcase","Gamepad2","categories","Zap","category","Search","Icon","articleUrl","_","idx","ExternalLink","market","isPositive","ArrowUp","ArrowDown","Cloud","Sun","Clock","LANGUAGE_LOCALE_MAP","getLocaleFromLanguage","lang","IFRAME_FRIENDLY_PROVIDERS","buildSearchUrl","provider","q","language","preferIframeFriendly","enc","locale","langCode","isLikelyUrl","input","trimmed","testUrl","normalizeInputToUrlOrSearch","suggestedPrompts","buildSearchUrlWithLang","useDashboardData","recentWorkspaces","setRecentWorkspaces","continueSessions","setContinueSessions","loadingWorkspaces","setLoadingWorkspaces","loadingSessions","setLoadingSessions","pushWorkspaceEvent","loadData","workspaces","sessionsResult","researchSessions","session","cancelled","kickOff","ready","initial","unsubscribeWorkspace","OmniDesk","variant","forceShow","_useChromeStyle","navigate","useNavigate","reload","refreshing","setRefreshing","searchLoading","setSearchLoading","aiResponseOpen","setAiResponseOpen","aiQuery","setAiQuery","efficiencyLabel","efficiencyBadge","efficiencySnapshot","efficiencyUpdated","efficiencyHistory","agentStatus","useAgentStreamStore","agentLastGoal","agentEvents","agentTranscript","chromeStyleEnabled","useSettingsStore","agentPreview","useMemo","latestEvents","lastUpdated","transcriptLines","line","statusPalette","statusTone","timeline","snippetSource","entry","snippet","hasTranscript","copyStatus","setCopyStatus","handleCopyTranscript","timeout","ecoMetrics","batteryPctValue","carbonIntensityValue","cpuLoad","activeTabs","ecoScore","batteryComponent","cpuComponent","carbonComponent","tabComponent","achievements","BatteryCharging","ecoHistoryInsights","recent","batterySeries","value","carbonSeries","computeTrend","series","last","baseIndex","previous","delta","computeSparkline","min","range","x","normalized","agentStatusLabels","ecoGauge","circumference","clampedScore","offset","quickActions","FileText","Workflow","ecoStats","batteryPct","carbonIntensity","handleContinueSession","urlToLoad","resolve","handleSearchLaunch","cleanQuery","isAboutBlank","navError","errorMessage","fallbackError","activeTabForDisplay","isAboutBlankDisplay","shouldShowDashboard","containerClass","containerStyle","handleManualRefresh","sessionSkeletons","workspaceSkeletons","Fragment","prompt","action","Bot","ClipboardCopy","FileSearch","Sparkle","formatDistanceToNow","Compass","RefreshCw","Pin","workspace","Leaf","GaugeCircle","achievement","CheckCircle2","TrendingDown"],"mappings":"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"}