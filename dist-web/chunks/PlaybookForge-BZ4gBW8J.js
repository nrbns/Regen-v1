import{r as l,j as e,g as x,u as S,v as C,h as T,as as E}from"./vendor-react-gmX1Lmvt.js";import{getAutomationStatus as P,onAutomationStatusUpdate as A,executeAutomation as L}from"./automationBridge-DqKbbR2V.js";import{t as u}from"./core-ai-yFIunLTZ.js";import"./vendor-react-dom-Bkb6jJ_S.js";import"./vendor-Vl2WtvH-.js";import"./vendor-zustand-BWsgwsXr.js";import"./mode-manager.ts-DwguZmJt.js";import"./core-memory-DmK-uh9X.js";const f=[{id:"template-research-btc",title:"Research BTC Price",goal:"Research current Bitcoin price and market analysis",steps:[{skill:"search",args:{query:"Bitcoin BTC current price market analysis",maxResults:5}},{skill:"summarize",args:{sources:"previous",format:"markdown"}}],output:{type:"json",schema:{price:"number",change:"number",analysis:"string"}}},{id:"template-summarize-page",title:"Summarize Current Page",goal:"Extract and summarize content from the current page",steps:[{skill:"extract",args:{source:"current-tab",includeImages:!1}},{skill:"summarize",args:{content:"previous",maxLength:500}}],output:{type:"text"}},{id:"template-screenshot",title:"Take Screenshot",goal:"Capture screenshot of current page",steps:[{skill:"screenshot",args:{fullPage:!0,format:"png"}},{skill:"save",args:{destination:"downloads",filename:"screenshot-{timestamp}.png"}}],output:{type:"file"}},{id:"template-research-nifty",title:"Research Nifty 50",goal:"Get latest Nifty 50 index data and analysis",steps:[{skill:"search",args:{query:"Nifty 50 index current price India stock market",maxResults:5}},{skill:"extract",args:{sources:"previous",fields:["price","change","volume"]}}],output:{type:"json",schema:{index:"string",price:"number",change:"number",volume:"number"}}},{id:"template-translate-page",title:"Translate Current Page",goal:"Translate the current page to Hindi",steps:[{skill:"extract",args:{source:"current-tab"}},{skill:"translate",args:{content:"previous",targetLanguage:"hi"}}],output:{type:"text"}}];function R(r){return f.find(o=>o.id===r)}function F(){return f}const y="omnib_playbooks_v1";function h(){try{return JSON.parse(localStorage.getItem(y)||"[]")}catch{return[]}}function b(r){localStorage.setItem(y,JSON.stringify(r))}function _(){const[r,o]=l.useState(h()),[d,m]=l.useState("New Playbook"),[p,n]=l.useState(""),[a,N]=l.useState(P()),[i,g]=l.useState(!1);l.useEffect(()=>(o(h()),A(N)),[]);const j=async()=>{try{const t=await window.recorder?.getDsl?.(),s=typeof t=="string"?t:JSON.stringify(t,null,2);n(s)}catch(t){console.error("[PlaybookForge] Failed to get DSL from recorder:",t)}},v=()=>{try{const t=[{id:I(),title:d,yaml:p,createdAt:Date.now()},...r];o(t),b(t)}catch(t){console.error("[PlaybookForge] Failed to save item:",t)}},k=async t=>{try{const s=JSON.parse(t.yaml),c={id:t.id,title:t.title,goal:s.goal||"Execute automation",steps:s.steps||[],output:s.output};await L(c)}catch(s){console.error("[PlaybookForge] Failed to run playbook:",s),s instanceof SyntaxError?u.error("Invalid JSON/YAML format"):u.error(`Failed to run playbook: ${s instanceof Error?s.message:String(s)}`)}},w=t=>{const s=R(t);s&&(m(s.title),n(JSON.stringify({goal:s.goal,steps:s.steps,output:s.output},null,2)),g(!1),u.success(`Loaded template: ${s.title}`))};return e.jsxs("div",{className:"grid h-full grid-cols-2 gap-4 p-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-medium",children:"Create Playbook"}),e.jsxs("button",{className:"rounded bg-blue-600 px-2 py-1 text-xs text-white hover:bg-blue-700",onClick:()=>g(!i),children:[i?"Hide":"Show"," Templates"]})]}),i&&e.jsxs("div",{className:"max-h-40 overflow-auto rounded border border-neutral-700 bg-neutral-900 p-2",children:[e.jsx("div",{className:"mb-2 text-xs font-medium text-neutral-400",children:"Sample Templates:"}),F().map(t=>e.jsx("button",{className:"mb-1 block w-full rounded p-1 text-left text-xs hover:bg-neutral-800",onClick:()=>w(t.id),children:t.title},t.id))]}),a&&a.status!=="idle"&&e.jsxs("div",{className:`flex items-center gap-2 rounded p-2 text-xs ${a.status==="running"?"border border-blue-700 bg-blue-900/30":a.status==="success"?"border border-green-700 bg-green-900/30":a.status==="error"?"border border-red-700 bg-red-900/30":"border border-yellow-700 bg-yellow-900/30"}`,children:[a.status==="running"&&e.jsx(x,{className:"h-3 w-3 animate-spin"}),a.status==="success"&&e.jsx(S,{className:"h-3 w-3 text-green-400"}),a.status==="error"&&e.jsx(C,{className:"h-3 w-3 text-red-400"}),a.status==="cancelled"&&e.jsx(T,{className:"h-3 w-3 text-yellow-400"}),e.jsxs("span",{children:[a.status==="running"&&`Running: ${a.playbookId}`,a.status==="success"&&"Completed successfully",a.status==="error"&&`Error: ${a.error}`,a.status==="cancelled"&&"Cancelled"]}),a.progress!==void 0&&e.jsxs("div",{className:"ml-auto text-xs",children:[a.progress,"%"]})]}),e.jsx("input",{className:"rounded bg-neutral-800 px-2 py-1",value:d,onChange:t=>m(t.target.value)}),e.jsx("textarea",{id:"playbook-yaml-editor",name:"playbook-yaml",className:"flex-1 rounded bg-neutral-800 p-2 text-xs",value:p,onChange:t=>n(t.target.value),placeholder:"Paste DSL (JSON/YAML) here"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"rounded bg-neutral-800 px-2 py-1",onClick:j,children:"Load from Recorder"}),e.jsx("button",{className:"rounded bg-indigo-600 px-2 py-1 text-white",onClick:v,children:"Save"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h3",{className:"font-medium",children:"Library"}),e.jsx("div",{className:"space-y-2 overflow-auto",children:r.map(t=>e.jsxs("div",{className:"rounded border border-neutral-800 p-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("div",{className:"font-medium",children:t.title}),e.jsx("div",{className:"text-xs text-neutral-400",children:new Date(t.createdAt).toLocaleString()})]}),e.jsx("pre",{className:"max-h-40 overflow-auto rounded bg-neutral-900 p-2 text-xs",children:t.yaml}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"flex items-center gap-1 rounded bg-indigo-600 px-2 py-1 text-white disabled:opacity-50",onClick:()=>k(t),disabled:a?.status==="running",children:a?.status==="running"&&a.playbookId===t.id?e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"h-3 w-3 animate-spin"}),"Running..."]}):e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"h-3 w-3"}),"Run"]})}),e.jsx("button",{className:"rounded bg-neutral-800 px-2 py-1",onClick:()=>{const s=r.filter(c=>c.id!==t.id);o(s),b(s)},children:"Delete"})]})]},t.id))})]})]})}function I(){return Math.random().toString(36).slice(2)}export{_ as default};
//# sourceMappingURL=PlaybookForge-BZ4gBW8J.js.map
