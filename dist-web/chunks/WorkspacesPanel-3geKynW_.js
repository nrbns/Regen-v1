import{r as p,j as e,am as W,o as R,a8 as _,aX as B,X as $,E as Q,aY as J,T as O,D as K,U as X,aZ as V,ae as D,af as Y,an as Z}from"./vendor-react-gmX1Lmvt.js";import{u as q}from"./bookmarksStore-CAScveEF.js";import{i as g,t as h,a as L,b as T}from"./core-ai-yFIunLTZ.js";import{A as G,m as H}from"./vendor-framer-motion-DDE19Uim.js";import{useWorkspacesStore as k}from"./workspacesStore-BSqEl-CQ.js";import{t as A}from"./mode-research-BclgCwOH.js";import{c as ee}from"../assets/index-D9cF9G1U.js";import{f as se}from"./vendor-utils-5Vdoy44w.js";function be(){const{bookmarks:a,folders:r,removeBookmark:l,updateBookmark:u,getBookmarksByFolder:i,searchBookmarks:o,addFolder:c,removeFolder:b}=q(),[n,j]=p.useState(null),[f,I]=p.useState(""),[m,N]=p.useState(null),[y,w]=p.useState(""),[F,S]=p.useState(!1),C=f?o(f):n?i(n):a,E=t=>{g.tabs.create(t).catch(console.error)},z=t=>{N(t)},s=(t,x)=>{u(t,x),N(null)},d=()=>{y.trim()&&!r.some(t=>t.name===y.trim())&&(c(y.trim()),w(""),S(!1))};return e.jsxs("div",{className:"flex flex-col h-full bg-slate-950 text-gray-200",children:[e.jsxs("div",{className:"p-4 border-b border-gray-800",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(W,{size:20,className:"text-yellow-400"}),e.jsx("h2",{className:"text-lg font-semibold",children:"Bookmarks"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(R,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",value:f,onChange:t=>I(t.target.value),placeholder:"Search bookmarks...",className:"w-full pl-9 pr-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-sm focus:outline-none focus:border-blue-500"})]})]}),e.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e.jsxs("div",{className:"w-48 border-r border-gray-800 p-3 overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase",children:"Folders"}),e.jsx("button",{onClick:()=>S(!0),className:"p-1 hover:bg-gray-800 rounded",title:"Add folder",children:e.jsx(_,{size:14})})]}),F&&e.jsxs("div",{className:"mb-2 flex gap-1",children:[e.jsx("input",{type:"text",value:y,onChange:t=>w(t.target.value),onKeyDown:t=>{t.key==="Enter"&&d(),t.key==="Escape"&&(S(!1),w(""))},placeholder:"Folder name",className:"flex-1 px-2 py-1 bg-gray-900 border border-gray-700 rounded text-xs focus:outline-none",autoFocus:!0}),e.jsx("button",{onClick:d,className:"px-2 py-1 bg-blue-500 hover:bg-blue-600 rounded text-xs",children:"Add"})]}),e.jsxs("button",{onClick:()=>j(null),className:`w-full text-left px-2 py-1.5 rounded text-sm mb-1 ${n===null?"bg-blue-500/20 text-blue-300":"hover:bg-gray-800"}`,children:["All Bookmarks (",a.length,")"]}),r.map(t=>{const x=i(t.id).length;return e.jsxs("div",{className:"flex items-center group",children:[e.jsx("button",{onClick:()=>j(t.id),className:`flex-1 text-left px-2 py-1.5 rounded text-sm ${n===t.id?"bg-blue-500/20 text-blue-300":"hover:bg-gray-800"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{size:14}),e.jsx("span",{className:"flex-1",children:t.name}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",x,")"]})]})}),t.name!=="Favorites"&&t.name!=="Work"&&t.name!=="Personal"&&e.jsx("button",{onClick:()=>b(t.id),className:"p-1 opacity-0 group-hover:opacity-100 hover:bg-red-500/20 rounded",title:"Delete folder",children:e.jsx($,{size:12})})]},t.id)})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:C.length===0?e.jsx("div",{className:"text-center text-gray-400 mt-8",children:f?"No bookmarks found":"No bookmarks yet"}):e.jsx("div",{className:"space-y-2",children:e.jsx(G,{children:C.map(t=>e.jsx(H.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"flex items-center gap-3 p-3 rounded-lg border border-gray-800 bg-gray-900/50 hover:bg-gray-900 group",children:m===t.id?e.jsx(te,{bookmark:t,folders:r.map(x=>x.name),onSave:x=>s(t.id,x),onCancel:()=>N(null)}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(W,{size:20,className:"text-yellow-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-sm truncate",children:t.title}),e.jsx("div",{className:"text-xs text-gray-400 truncate",children:t.url}),t.folder&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[e.jsx(B,{size:10,className:"inline mr-1"}),t.folder]})]}),e.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>E(t.url),className:"p-1.5 hover:bg-gray-800 rounded",title:"Open bookmark",children:e.jsx(Q,{size:14})}),e.jsx("button",{onClick:()=>z(t.id),className:"p-1.5 hover:bg-gray-800 rounded",title:"Edit bookmark",children:e.jsx(J,{size:14})}),e.jsx("button",{onClick:()=>l(t.id),className:"p-1.5 hover:bg-red-500/20 rounded",title:"Delete bookmark",children:e.jsx(O,{size:14})})]})]})},t.id))})})})]})]})}function te({bookmark:a,folders:r,onSave:l,onCancel:u}){const[i,o]=p.useState(a.title),[c,b]=p.useState(a.folder||"");return e.jsxs("div",{className:"flex-1 flex items-center gap-2",children:[e.jsx("input",{type:"text",value:i,onChange:n=>o(n.target.value),className:"flex-1 px-2 py-1 bg-gray-800 border border-gray-700 rounded text-sm focus:outline-none",autoFocus:!0}),e.jsxs("select",{value:c,onChange:n=>b(n.target.value),className:"px-2 py-1 bg-gray-800 border border-gray-700 rounded text-sm focus:outline-none",children:[e.jsx("option",{value:"",children:"No folder"}),r.map(n=>e.jsx("option",{value:n,children:n},n))]}),e.jsx("button",{onClick:()=>l({title:i,folder:c||void 0}),className:"px-3 py-1 bg-blue-500 hover:bg-blue-600 rounded text-sm",children:"Save"}),e.jsx("button",{onClick:u,className:"px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded text-sm",children:"Cancel"})]})}const U=1,M="regen.session";function ae(a,r){const l=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),u=URL.createObjectURL(l),i=document.createElement("a");i.href=u,i.download=r,i.click(),URL.revokeObjectURL(u)}async function re(a){const r=L.getState(),l=[...r.tabs];for(const o of l)try{await g.tabs.close({id:o.id})}catch{}a.mode&&await T.getState().setMode(a.mode);let u=null;for(const o of a.tabs)try{const c=await g.tabs.create(o.url||"about:blank"),b=typeof c=="object"&&c&&"id"in c?c.id:typeof c=="string"?c:null;b&&(u||(u=b),r.updateTab(b,{title:o.title,url:o.url,appMode:o.appMode}))}catch(c){console.warn("[SessionTransfer] Failed to recreate tab",o,c)}const i=a.activeTabId||u;i&&(r.setActive(i),await g.tabs.activate({id:i}).catch(()=>{}))}async function oe(){try{const a=ee(),r={kind:M,version:U,exportedAt:new Date().toISOString(),snapshot:a},l=`regen-session-${new Date().toISOString().replace(/[:]/g,"-").slice(0,19)}.omnisession`;ae(r,l),h.success("Session exported (.omnisession)")}catch(a){console.error("[SessionTransfer] Export failed",a),h.error("Failed to export session")}}async function ne(a){try{const r=await a.text(),l=JSON.parse(r);if(l.kind!==M||l.version!==U)throw new Error("Unsupported session file format");await re(l.snapshot),h.success("Session imported successfully")}catch(r){console.error("[SessionTransfer] Import failed",r),h.error("Failed to import session")}}function he(){const a=k(s=>s.workspaces),r=k(s=>s.add),l=k(s=>s.remove),u=k(s=>s.togglePin),i=k(s=>s.search),[o,c]=p.useState(""),[b,n]=p.useState(!1),[j,f]=p.useState(!1),I=p.useRef(null),m=L(),N=T(s=>s.mode),y=[...a].sort((s,d)=>s.isPinned&&!d.isPinned?-1:!s.isPinned&&d.isPinned?1:d.updatedAt-s.updatedAt),F=(o?i(o):y).filter(s=>(s.mode??"Research")==="Research"),S=async()=>{n(!0);try{const s=prompt("Workspace name:",`Workspace ${new Date().toLocaleDateString()}`);if(!s){n(!1);return}const d=r({name:s,tabs:m.tabs,mode:N,description:`${m.tabs.length} tab${m.tabs.length===1?"":"s"}`});A("workspace_saved",{workspaceId:d,tabCount:m.tabs.length}),h.success("Workspace saved!")}catch(s){console.error("Failed to save workspace",s),h.error("Failed to save workspace")}finally{n(!1)}},C=async s=>{try{const d=[...m.tabs];for(const t of d)try{await g.tabs.close({id:t.id})}catch(x){console.warn("Failed to close tab",x)}for(const t of s.tabs)try{const x=t.url||"about:blank",v=await g.tabs.create(x),P=typeof v=="object"&&v&&"id"in v?v.id:typeof v=="string"?v:null;P&&typeof P=="string"&&m.updateTab(P,{title:t.title,appMode:t.appMode})}catch(x){console.warn("Failed to restore tab",x)}if(s.tabs.length>0&&s.tabs[0]?.id&&s.tabs[0]?.url){const t=m.tabs.find(x=>x.url===s.tabs[0].url);t&&(m.setActive(t.id),await g.tabs.activate({id:t.id}))}await T.getState().setMode("Research"),A("workspace_restored",{workspaceId:s.id}),h.success("Workspace restored!")}catch(d){console.error("Failed to restore workspace",d),h.error("Failed to restore workspace")}},E=s=>{confirm("Delete this workspace?")&&(l(s),A("workspace_deleted",{workspaceId:s}),h.info("Workspace deleted"))},z=async s=>{const d=s.target.files?.[0];if(d){f(!0);try{await ne(d)}catch{}finally{f(!1),s.target.value=""}}};return e.jsxs("div",{className:"flex flex-col h-full bg-slate-900 text-slate-100",children:[e.jsxs("div",{className:"p-4 border-b border-slate-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Workspaces"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:async()=>{await oe()},className:"flex items-center gap-2 rounded-lg border border-slate-700/70 px-3 py-1.5 text-xs text-slate-200 transition hover:border-slate-500/80",children:[e.jsx(K,{size:14}),"Export .omnisession"]}),e.jsxs("label",{className:"flex items-center gap-2 rounded-lg border border-slate-700/70 px-3 py-1.5 text-xs text-slate-200 transition hover:border-slate-500/80 cursor-pointer",children:[e.jsx(X,{size:14}),j?"Importing...":"Import session",e.jsx("input",{ref:I,type:"file",accept:".omnisession,application/json",className:"hidden",onChange:z,disabled:j})]}),e.jsxs("button",{onClick:S,disabled:b||m.tabs.length===0,className:"flex items-center gap-2 px-3 py-1.5 rounded-lg bg-blue-600/20 text-blue-300 hover:bg-blue-600/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:[e.jsx(V,{size:14}),"Save Workspace"]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(R,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search workspaces...",value:o,onChange:s=>c(s.target.value),className:"w-full pl-9 pr-3 py-2 rounded-lg bg-slate-800 border border-slate-700 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/50"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:F.length===0?e.jsxs("div",{className:"text-center text-gray-400 py-12",children:[o?"No workspaces found":"No workspaces yet",e.jsx("p",{className:"text-sm mt-2",children:!o&&"Save your current tabs as a workspace to get started"})]}):e.jsx("div",{className:"space-y-2",children:F.map(s=>e.jsxs("div",{className:"group flex items-start gap-3 p-3 rounded-lg bg-slate-800/50 hover:bg-slate-800 transition-colors",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-medium text-sm text-slate-100",children:s.name}),s.isPinned&&e.jsx(D,{size:12,className:"text-yellow-400 fill-current"})]}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[s.tabs.length," tab",s.tabs.length===1?"":"s"," â€¢"," ",s.mode]}),s.description&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s.description}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:se(new Date(s.updatedAt),{addSuffix:!0})})]}),e.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>u(s.id),className:"p-1.5 rounded hover:bg-slate-700 transition-colors",title:s.isPinned?"Unpin":"Pin",children:s.isPinned?e.jsx(Y,{size:14,className:"text-yellow-400"}):e.jsx(D,{size:14,className:"text-gray-400"})}),e.jsx("button",{onClick:()=>C(s),className:"p-1.5 rounded hover:bg-blue-500/20 text-blue-400 transition-colors",title:"Restore workspace",children:e.jsx(Z,{size:14})}),e.jsx("button",{onClick:()=>E(s.id),className:"p-1.5 rounded hover:bg-red-500/20 text-red-400 transition-colors",title:"Delete workspace",children:e.jsx(O,{size:14})})]})]},s.id))})})]})}export{be as B,he as W,oe as e};
//# sourceMappingURL=WorkspacesPanel-3geKynW_.js.map
