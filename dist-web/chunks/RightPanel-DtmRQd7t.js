const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["chunks/core-ai-yFIunLTZ.js","chunks/vendor-zustand-BWsgwsXr.js","chunks/vendor-react-gmX1Lmvt.js","chunks/vendor-react-dom-Bkb6jJ_S.js","chunks/vendor-Vl2WtvH-.js","chunks/mode-manager.ts-DwguZmJt.js","chunks/core-memory-DmK-uh9X.js"])))=>i.map(i=>d[i]);
import{r as o,j as e,S as I,u as B,v as V,g as P,as as te,ae,af as re,l as K,B as ne,bS as le,E as _,o as O,P as Q,F as H,bD as ie,X as W,ap as oe,p as ce,bT as de,Z as xe,s as me,ak as pe,e as ue,b2 as ge,aO as he,bU as be,au as ye}from"./vendor-react-gmX1Lmvt.js";import{u as R}from"./History-kg0LrAO3.js";import{i as z,a as X,_ as fe}from"./core-ai-yFIunLTZ.js";import{m as A,A as je}from"./vendor-framer-motion-DDE19Uim.js";import{f as F}from"./AppShell-CJtR0Pw4.js";import{P as ve}from"./PrivacyDashboard-B5QYv-jo.js";import{s as E,V as Ne}from"./mode-research-BclgCwOH.js";import{f as we}from"./vendor-utils-5Vdoy44w.js";import"./vendor-react-dom-Bkb6jJ_S.js";import"./vendor-Vl2WtvH-.js";import"../assets/index-D9cF9G1U.js";import"./vendor-zustand-BWsgwsXr.js";import"@tauri-apps/api/core";import"./mode-manager.ts-DwguZmJt.js";import"./core-memory-DmK-uh9X.js";import"./mode-docs-FcsoolLb.js";import"./vendor-pdf-ejcqEZLU.js";import"./vendor-mammoth-BPQIafDs.js";import"./Downloads-CU-ngJEB.js";import"./OmniDesk-C5fSodZ1.js";import"./WorkspacesPanel-3geKynW_.js";import"./bookmarksStore-CAScveEF.js";import"./workspacesStore-BSqEl-CQ.js";import"./tradeStore-CHfkU4NA.js";import"./dataService-HUHZrGu9.js";import"./registry-CG5fPtjR.js";import"./trustDashboardStore-BRaGSCcb.js";function ke(){const[r,g]=o.useState(""),[s,p]=o.useState(null),[a,j]=o.useState(!1),[x,b]=o.useState([]),[u,c]=o.useState(""),w=async()=>{if(r.trim())try{const n=await z.agent.generatePlanFromGoal({goal:r,mode:u||void 0});p(n),b([])}catch(n){console.error("Failed to generate plan:",n),alert(`Failed to generate plan: ${n instanceof Error?n.message:String(n)}`)}},N=async()=>{if(s){j(!0),b([]);try{const n=await z.agent.executePlan({planId:s.id,plan:s});b(n.results||[])}catch(n){console.error("Failed to execute plan:",n),alert(`Failed to execute plan: ${n instanceof Error?n.message:String(n)}`)}finally{j(!1)}}};return e.jsxs("div",{className:"flex flex-col gap-4 p-6 bg-gray-900/50 rounded-lg border border-gray-800",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-5 h-5 text-purple-400"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-100",children:"Agent Planner"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Goal"}),e.jsx("textarea",{value:r,onChange:n=>g(n.target.value),placeholder:"What do you want the agent to accomplish? (e.g., 'Research quantum computing breakthroughs')",className:"px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-gray-100 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500",rows:3}),e.jsx("input",{type:"text",value:u,onChange:n=>c(n.target.value),placeholder:"Mode (optional): research, trade, game, etc.",className:"px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-gray-100 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500"}),e.jsxs("button",{onClick:w,disabled:!r.trim(),className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-700 disabled:cursor-not-allowed text-white rounded-lg transition-colors flex items-center justify-center gap-2",children:[e.jsx(I,{size:16}),"Generate Plan"]})]}),s&&e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300",children:"Generated Plan"}),e.jsxs("div",{className:"text-xs text-gray-500",children:[s.steps.length," steps • ~",s.estimatedDuration||0,"s"]})]}),e.jsx("div",{className:"flex flex-col gap-2",children:s.steps.map((n,d)=>e.jsx(A.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"px-4 py-3 bg-gray-800/50 border border-gray-700 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-purple-600/20 flex items-center justify-center text-purple-400 text-xs font-semibold",children:d+1}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-200",children:n.action}),x.find(l=>l.stepId===n.id)&&(x.find(l=>l.stepId===n.id)?.success?e.jsx(B,{size:14,className:"text-green-400"}):e.jsx(V,{size:14,className:"text-red-400"}))]}),e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:Object.entries(n.args).map(([l,y])=>e.jsxs("span",{className:"mr-2",children:[e.jsxs("span",{className:"text-gray-500",children:[l,":"]})," ",String(y).substring(0,50)]},l))}),n.expectedOutput&&e.jsxs("div",{className:"text-xs text-gray-500 italic",children:["Expected: ",n.expectedOutput]}),x.find(l=>l.stepId===n.id)?.error&&e.jsxs("div",{className:"text-xs text-red-400 mt-1",children:["Error: ",x.find(l=>l.stepId===n.id)?.error]})]})]})},n.id))}),e.jsx("button",{onClick:N,disabled:a,className:"px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-700 disabled:cursor-not-allowed text-white rounded-lg transition-colors flex items-center justify-center gap-2",children:a?e.jsxs(e.Fragment,{children:[e.jsx(P,{size:16,className:"animate-spin"}),"Executing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(te,{size:16}),"Execute Plan"]})})]})]})}var Se={};const U=()=>typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`dock-${Math.random().toString(36).slice(2,10)}`,G=(r,g)=>{const s=r.length+g.length;return Math.max(32,Math.round(s/4))};function Ae(){const[r,g]=o.useState(""),[s,p]=o.useState(!1),[a,j]=o.useState(!0),[x,b]=o.useState([]),u=X(d=>{const l=d.tabs.find(y=>y.id===d.activeId);return l?{url:l.url,title:l.title}:null}),c=x[0],w=o.useMemo(()=>{if(!u?.url)return"general";try{return new URL(u.url).hostname}catch{return"current page"}},[u?.url]),N=async d=>{d.preventDefault();const l=r.trim();if(!l||s)return;if(!u?.url){E("error","Open a tab to provide page context.");return}p(!0);const y=performance.now();let k=null;try{const i=await z.agent.askWithScrape({url:u.url,question:l,task:"qa",waitFor:8});if(i.status==="enqueued"&&i.jobId){k=i.jobId,E("info","Fetching page safely... This may take a few seconds.");const v=setInterval(async()=>{try{const S=Se.AGENT_QUERY_ENDPOINT?.replace("/api/agent/query","")||"http://127.0.0.1:4000",C=await fetch(`${S}/api/agent/result/${k}/qa`,{method:"GET",headers:{"content-type":"application/json"}});if(C.ok){clearInterval(v);const L=await C.json();if(L.status==="complete"&&L.agentResult){const f=L.agentResult,M=f.answer?.trim()||"No answer returned yet.",Z=Array.isArray(f.sources)&&f.sources.length>0?f.sources.map($=>$.url):[u.url],Y=typeof f.model=="string"?f.model:f.model?.name||"agent:auto",J=typeof f.model=="object"&&f.model.tokensUsed?f.model.tokensUsed:G(l,M),ee=Math.round(performance.now()-y),se={id:k||U(),prompt:l,answer:M,timestamp:Date.now(),latencyMs:ee,tokens:J,model:Y,sources:Z,scrape:{status:f.provenance?.status||200,cached:f.provenance?.cached||!1,fetchedAt:f.provenance?.fetchedAt}};b($=>[se,...$].slice(0,5)),g(""),p(!1)}}else if(C.status!==404)throw clearInterval(v),new Error(`Polling failed: ${C.status}`)}catch(S){clearInterval(v),console.error("[AIDockPanel] polling failed",S),E("error","Failed to get result"),p(!1)}},1e3);setTimeout(()=>{clearInterval(v),s&&(p(!1),E("error","Request timed out. Please try again."))},3e4);return}const t=i?.answer?.trim()||"No answer returned yet.",h=Array.isArray(i?.sources)&&i.sources.length>0?i.sources:[u.url],D=typeof i?.model=="string"?i.model:(typeof i?.model=="object"&&i.model!==null&&"name"in i.model?i.model.name:typeof i?.model=="string"?i.model:void 0)||"agent:auto",m=typeof i?.model=="object"&&i.model?.tokensUsed?i.model.tokensUsed:G(l,t),T=Math.round(performance.now()-y),q={id:i?.jobId??U(),prompt:l,answer:t,timestamp:Date.now(),latencyMs:T,tokens:m,model:D,sources:h,scrape:i?.scrape};b(v=>[q,...v].slice(0,5)),g("")}catch(i){console.error("[AIDockPanel] ask failed",i),E("error",i instanceof Error?i.message:"AI Dock request failed")}finally{p(!1)}},n=()=>{c&&g(`Follow up on "${c.prompt}": `)};return e.jsxs("section",{"aria-label":"AI Dock",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-400",children:"AI Dock"}),e.jsxs("p",{className:"text-sm text-gray-300",children:["Ask questions about the ",w]})]}),e.jsxs("button",{type:"button",onClick:()=>j(d=>!d),className:`inline-flex items-center gap-1 rounded-lg border px-2 py-1 text-xs transition ${a?"border-blue-500/60 bg-blue-500/10 text-blue-200":"border-slate-700/60 bg-slate-900/60 text-slate-300 hover:bg-slate-800"}`,children:[a?e.jsx(ae,{size:14}):e.jsx(re,{size:14}),a?"Pinned":"Pin"]})]}),e.jsxs("form",{onSubmit:N,className:"space-y-2",children:[e.jsx("label",{htmlFor:"ai-dock-question",className:"sr-only",children:"Ask the agent a question"}),e.jsx("textarea",{id:"ai-dock-question",value:r,onChange:d=>g(d.target.value),disabled:s,rows:3,placeholder:"Ask Omni about this page, summarize findings, or request an action...",className:"w-full rounded-xl border border-slate-700/70 bg-slate-900/60 px-3 py-2 text-sm text-gray-200 placeholder:text-gray-500 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500/40"}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("span",{children:[r.length," chars"]}),e.jsxs("button",{type:"submit",disabled:!r.trim()||s,className:"inline-flex items-center gap-2 rounded-full bg-blue-600/80 px-3 py-1.5 text-sm font-medium text-white transition hover:bg-blue-600 disabled:opacity-60",children:[s?e.jsx(P,{size:14,className:"animate-spin"}):e.jsx(K,{size:14}),"Ask"]})]})]}),c&&e.jsxs(A.div,{layout:!0,className:"space-y-3 rounded-xl border border-slate-700/70 bg-slate-900/60 p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-200",children:[e.jsx(I,{size:16,className:"text-blue-300"}),"Latest answer"]}),e.jsx("button",{type:"button",onClick:n,className:"text-xs font-medium text-blue-300 hover:text-blue-200",children:"Ask follow-up"})]}),e.jsx("p",{className:"text-sm text-gray-300 whitespace-pre-wrap",children:c.answer}),c.scrape&&e.jsxs("div",{className:"text-xs text-gray-500 flex flex-wrap items-center gap-3",children:[e.jsx("span",{children:c.scrape.cached?"Cached result":"Fresh fetch"}),e.jsxs("span",{children:["HTTP ",c.scrape.status]}),c.scrape.fetchedAt&&e.jsx("span",{children:new Date(c.scrape.fetchedAt).toLocaleTimeString()})]}),e.jsxs("div",{className:"rounded-lg border border-slate-800/70 bg-slate-950/60 p-2 text-xs text-gray-400",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(ne,{size:12})," ",c.model]}),e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(le,{size:12})," ",c.latencyMs," ms"]}),e.jsxs("span",{children:[c.tokens," tokens (est.)"]}),e.jsx("span",{children:new Date(c.timestamp).toLocaleTimeString()})]}),c.sources.length>0&&e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"text-gray-500",children:"Sources:"}),c.sources.map((d,l)=>e.jsxs("button",{type:"button",onClick:()=>window.open(d,"_blank"),className:"inline-flex items-center gap-1 rounded-full border border-slate-800/70 px-2 py-0.5 text-[11px] text-blue-200 hover:border-blue-500/60",children:[e.jsx(_,{size:12}),d.replace(/https?:\/\//,"").slice(0,42)]},`${c.id}-source-${l}`))]})]})]}),x.length>1&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-gray-500",children:"Recent questions"}),e.jsx("div",{className:"space-y-2",children:x.slice(1).map(d=>e.jsxs("button",{type:"button",onClick:()=>g(d.prompt),className:"w-full rounded-xl border border-transparent bg-slate-900/40 p-3 text-left text-sm text-gray-300 transition hover:border-slate-700/70",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsx("span",{children:new Date(d.timestamp).toLocaleTimeString()}),e.jsxs("span",{children:[d.tokens," tokens"]})]}),e.jsx("p",{className:"mt-1 line-clamp-2 text-sm text-gray-200",children:d.prompt})]},d.id))})]})]})}const Ce={navigate:e.jsx(ie,{size:16}),openTab:e.jsx(_,{size:16}),duplicateTab:e.jsx(_,{size:16}),notes:e.jsx(H,{size:16}),research:e.jsx(O,{size:16}),copy:e.jsx(Q,{size:16}),search:e.jsx(O,{size:16})},Ie={navigate:"blue",openTab:"green",duplicateTab:"purple",notes:"amber",research:"indigo",copy:"gray",search:"blue"};function Te({action:r,compact:g=!1}){const[s,p]=o.useState("idle"),a=Ie[r.type],j=r.icon||Ce[r.type],x=async()=>{p("loading");try{await r.onClick(),p("success"),setTimeout(()=>p("idle"),2e3)}catch(c){console.error("[SmartActionButton] Action failed:",c),p("error"),setTimeout(()=>p("idle"),2e3)}},b=()=>{switch(s){case"loading":return e.jsx(P,{size:14,className:"animate-spin"});case"success":return e.jsx(B,{size:14,className:"text-green-400"});case"error":return e.jsx(V,{size:14,className:"text-red-400"});default:return j}},u=()=>{const c=`border-${a}-500/40 bg-${a}-500/15 hover:bg-${a}-500/25 text-${a}-200`;return s==="success"?"border-green-500/40 bg-green-500/15 text-green-200":s==="error"?"border-red-500/40 bg-red-500/15 text-red-200":c};return e.jsxs(A.button,{onClick:x,disabled:s==="loading",whileHover:{scale:s==="idle"?1.02:1},whileTap:{scale:.98},className:`
        flex items-center gap-2 px-3 py-2 rounded-lg border transition-all
        ${u()}
        ${g?"text-xs":"text-sm"}
        ${s==="loading"?"cursor-wait opacity-75":"cursor-pointer"}
        focus:outline-none focus:ring-2 focus:ring-${a}-500/40
      `,title:r.description||r.label,children:[b(),!g&&e.jsx("span",{className:"font-medium",children:r.label}),r.description&&!g&&e.jsx("span",{className:"text-xs opacity-75 truncate max-w-[200px]",children:r.description})]})}function Ee({actions:r,compact:g=!1,className:s=""}){return r.length===0?null:e.jsx("div",{className:`flex flex-wrap gap-2 ${s}`,children:r.map(p=>e.jsx(Te,{action:p,compact:g},p.id))})}function Pe({onClose:r,initialQuery:g=""}){const[s,p]=o.useState(g),[a,j]=o.useState(""),[x,b]=o.useState(!1),[u,c]=o.useState(null),[w,N]=o.useState(!1),[n,d]=o.useState([]),l=o.useRef(null),{activeId:y,tabs:k}=X(),i=k.find(m=>m.id===y);o.useEffect(()=>{l.current&&x&&l.current.scrollIntoView({behavior:"smooth"})},[a,x]),o.useEffect(()=>{if(!a||x){d([]);return}const m=[],T=/https?:\/\/[^\s]+/g;(a.match(T)||[]).slice(0,3).forEach((v,S)=>{m.push({id:`navigate-${S}`,type:"navigate",label:"Open URL",description:v,onClick:async()=>{await z.tabs.create(v)}})}),(s.toLowerCase().includes("research")||s.toLowerCase().includes("find"))&&m.push({id:"research",type:"research",label:"Research This",description:"Start research session",onClick:async()=>{const{useAppStore:v}=await fe(async()=>{const{useAppStore:S}=await import("./core-ai-yFIunLTZ.js").then(C=>C.Q);return{useAppStore:S}},__vite__mapDeps([0,1,2,3,4,5,6]));v.getState().setMode("Research")}}),a.length>0&&m.push({id:"copy",type:"copy",label:"Copy Response",onClick:async()=>{await navigator.clipboard.writeText(a),N(!0),setTimeout(()=>N(!1),2e3)}}),d(m)},[a,s,x]);const t=async()=>{if(!(!s.trim()||x)){c(null),j(""),b(!0),d([]);try{await z.redix.stream(s,{sessionId:`ai-panel-${Date.now()}`},m=>{m.type==="token"&&m.text?j(T=>T+m.text):m.type==="done"?b(!1):m.type==="error"&&(b(!1),c(m.error||"Failed to get AI response"))})}catch(m){console.error("[EnhancedAIPanel] Error:",m),b(!1),c("Failed to get AI response. Please try again.")}}},h=m=>{p(m),setTimeout(()=>{t()},300)},D=m=>{m.key==="Enter"&&!m.shiftKey&&(m.preventDefault(),t())};return e.jsxs("div",{className:"flex flex-col h-full bg-gray-900/95 backdrop-blur-xl",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-800/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-emerald-500/20",children:e.jsx(I,{size:16,className:"text-emerald-400"})}),e.jsx("h3",{className:"text-sm font-semibold text-gray-100",children:"AI Assistant"})]}),r&&e.jsx("button",{onClick:r,className:"p-1.5 rounded-lg text-gray-400 hover:text-gray-200 hover:bg-gray-800/60 transition-colors",children:e.jsx(W,{size:16})})]}),e.jsxs("div",{className:"p-4 border-b border-gray-800/50 space-y-3",children:[e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("textarea",{value:s,onChange:m=>p(m.target.value),onKeyDown:D,placeholder:"Ask AI assistant... (or use voice input)",className:"w-full px-4 py-3 pr-12 bg-gray-800/60 border border-gray-700/50 rounded-lg text-sm text-gray-200 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-emerald-500/40 focus:border-emerald-500/40 resize-none",rows:3,disabled:x}),e.jsx("div",{className:"absolute bottom-3 right-3 flex items-center gap-2",children:s&&e.jsx("button",{onClick:t,disabled:x||!s.trim(),className:"p-1.5 rounded-lg bg-emerald-500/20 hover:bg-emerald-500/30 border border-emerald-500/40 text-emerald-200 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Send (Enter)",children:x?e.jsx(P,{size:14,className:"animate-spin"}):e.jsx(K,{size:14})})})]}),e.jsx("div",{className:"flex flex-col gap-2",children:e.jsx(Ne,{onResult:h,small:!0})})]}),i&&e.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-2 px-2",children:[e.jsx("span",{children:"Context:"}),e.jsx("span",{className:"text-gray-400 truncate",children:i.title||i.url})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[x&&!a&&e.jsxs("div",{className:"flex items-center gap-3 text-gray-400 py-8",children:[e.jsx(P,{size:16,className:"animate-spin text-emerald-400"}),e.jsx("span",{className:"text-sm",children:"AI is thinking..."})]}),u&&e.jsxs("div",{className:"rounded-lg border border-red-500/40 bg-red-500/10 px-4 py-3 text-sm text-red-200",children:[e.jsx("p",{className:"font-medium",children:"Error"}),e.jsx("p",{className:"mt-1 text-xs text-red-300/80",children:u})]}),a&&e.jsxs(A.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"space-y-4",children:[e.jsxs("div",{className:"prose prose-invert prose-sm max-w-none text-gray-200",children:[e.jsxs("div",{className:"whitespace-pre-wrap break-words",children:[a,x&&e.jsx("span",{className:"inline-block w-2 h-4 ml-1 bg-emerald-400 animate-pulse"})]}),e.jsx("div",{ref:l})]}),n.length>0&&e.jsxs("div",{className:"pt-4 border-t border-gray-800/50",children:[e.jsx("div",{className:"text-xs font-semibold text-gray-400 mb-3 uppercase tracking-wide",children:"Quick Actions"}),e.jsx(Ee,{actions:n})]}),a&&e.jsx("div",{className:"flex items-center justify-end pt-2",children:e.jsx("button",{onClick:async()=>{await navigator.clipboard.writeText(a),N(!0),setTimeout(()=>N(!1),2e3)},className:"flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-medium bg-gray-800/60 hover:bg-gray-800 border border-gray-700/50 text-gray-300 hover:text-gray-100 transition-colors",children:w?e.jsxs(e.Fragment,{children:[e.jsx(oe,{size:14}),e.jsx("span",{children:"Copied!"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{size:14}),e.jsx("span",{children:"Copy"})]})})})]}),!a&&!x&&!u&&e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx(I,{size:32,className:"mx-auto mb-3 opacity-50"}),e.jsx("p",{className:"text-sm mb-1",children:"Ask me anything"}),e.jsx("p",{className:"text-xs text-gray-500",children:"I can help with research, explanations, navigation, and more"})]})]})]})}const ze={download:"Download file",form_submit:"Submit form",login:"Login",scrape:"Scrape content",export_data:"Export data",access_clipboard:"Clipboard access",access_camera:"Camera access",access_microphone:"Microphone access",access_filesystem:"Filesystem access",ai_cloud:"Cloud AI usage"},Re=r=>r.revokedAt?{label:"Revoked",tone:"text-red-400 bg-red-500/10 border-red-500/40"}:r.approved?{label:"Approved",tone:"text-emerald-300 bg-emerald-500/10 border-emerald-500/40"}:{label:"Pending",tone:"text-amber-300 bg-amber-500/10 border-amber-500/40"},De=[{id:"planner",icon:I,label:"Planner"},{id:"plan",icon:de,label:"Plan"},{id:"actions",icon:xe,label:"Actions"},{id:"privacy",icon:me,label:"Privacy"},{id:"logs",icon:pe,label:"Logs"},{id:"memory",icon:H,label:"Memory"},{id:"consent",icon:ue,label:"Consent"},{id:"trust",icon:ge,label:"Trust"},{id:"eco",icon:he,label:"Eco"},{id:"identity",icon:be,label:"Identity"},{id:"nexus",icon:ye,label:"Nexus"}];function os({open:r,onClose:g}){const[s,p]=o.useState("planner"),[a,j]=o.useState(null),[x,b]=o.useState([]),[u,c]=o.useState([]),[w,N]=o.useState([]),[n,d]=o.useState(!1),l=o.useRef(null),y=F(t=>t.refresh),k=F(t=>t.records),i=F(t=>t.open);return R("agent:plan",t=>{j(t)},[]),R("agent:step",t=>{b(h=>[...h,t])},[]),R("agent:log",t=>{c(h=>[...h,`${new Date(t.timestamp).toLocaleTimeString()}: ${t.content}`])},[]),R("agent:consent:request",()=>{y()},[y]),o.useEffect(()=>{s==="logs"&&l.current&&l.current.scrollIntoView({behavior:"smooth"})},[u,s]),o.useEffect(()=>{N(k)},[k]),o.useEffect(()=>{r&&s==="consent"&&y()},[r,s,y]),e.jsx(je,{children:r&&e.jsxs(A.aside,{initial:{x:400,opacity:0},animate:{x:0,opacity:1},exit:{x:400,opacity:0},transition:{duration:.3,ease:"easeInOut"},className:"flex w-96 flex-col border-l border-gray-800/50 bg-gray-900/95 shadow-2xl backdrop-blur-xl",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-800/50 p-4",children:[e.jsxs("h2",{className:"flex items-center gap-2 text-lg font-semibold text-gray-200",children:[e.jsx(ce,{size:20,className:"text-blue-400"}),"Agent Console"]}),e.jsx("button",{onClick:g,className:"rounded-lg p-1.5 text-gray-400 transition-colors hover:bg-gray-800/60 hover:text-gray-200",children:e.jsx(W,{size:18})})]}),s==="planner"&&e.jsx("div",{className:"border-b border-gray-800/50",children:e.jsx(Pe,{})}),s!=="planner"&&e.jsx("div",{className:"border-b border-gray-800/50 p-4",children:e.jsx(Ae,{})}),e.jsx("div",{className:"flex overflow-x-auto border-b border-gray-800/50",children:De.map(t=>{const h=t.icon;return e.jsxs("button",{onClick:()=>p(t.id),className:`relative flex min-w-[80px] flex-shrink-0 items-center justify-center gap-2 px-4 py-3 text-sm font-medium transition-colors ${s===t.id?"text-blue-400":"text-gray-500 hover:text-gray-300"} `,children:[e.jsx(h,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:t.label}),s===t.id&&e.jsx(A.div,{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-500",layoutId:"activeTab"})]},t.id)})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[s==="planner"&&e.jsx(ke,{}),s==="plan"&&e.jsx("div",{className:"space-y-4",children:a?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"rounded-lg border border-gray-700/30 bg-gray-800/40 p-4",children:[e.jsxs("div",{className:"mb-2 text-xs text-gray-400",children:["Task: ",a.taskId]}),e.jsx("div",{className:"space-y-2",children:a.steps.map((t,h)=>e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx("div",{className:"flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-600/20 text-xs font-medium text-blue-400",children:h+1}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-gray-200",children:t.description}),t.tool&&e.jsxs("div",{className:"mt-0.5 text-xs text-gray-500",children:["Tool: ",t.tool]})]})]},t.id))})]}),e.jsx("div",{className:"flex items-center justify-between text-xs",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-gray-400",children:["Tokens: ",e.jsx("span",{className:"text-gray-200",children:a.remaining.tokens}),"/",a.budget.tokens]}),e.jsxs("span",{className:"text-gray-400",children:["Time: ",e.jsxs("span",{className:"text-gray-200",children:[a.remaining.seconds,"s"]}),"/",a.budget.seconds,"s"]})]})})]}):e.jsx("div",{className:"py-8 text-center text-xs text-gray-500",children:"No active plan. Create a task to see the agent's reasoning."})}),s==="actions"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"mb-3 text-sm text-gray-400",children:"Tool Calls & Actions"}),x.length>0?e.jsx("div",{className:"space-y-2",children:x.map((t,h)=>e.jsxs(A.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},className:"rounded border border-gray-700/30 bg-gray-800/40 p-3",children:[e.jsxs("div",{className:"mb-1 flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-medium text-gray-300",children:t.type}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(t.timestamp).toLocaleTimeString()})]}),e.jsx("div",{className:"mt-1 whitespace-pre-wrap text-xs text-gray-400",children:t.content})]},h))}):e.jsx("div",{className:"py-8 text-center text-xs text-gray-500",children:"No actions yet"})]}),s==="logs"&&e.jsxs("div",{className:"space-y-1 font-mono text-xs",children:[e.jsx("div",{className:"mb-2 text-sm text-gray-400",children:"Live Log Stream"}),e.jsx("div",{className:"max-h-96 overflow-y-auto rounded bg-gray-950 p-3",children:u.length>0?e.jsxs(e.Fragment,{children:[u.map((t,h)=>e.jsx("div",{className:"py-0.5 text-gray-400",children:t},h)),e.jsx("div",{ref:l})]}):e.jsx("div",{className:"py-8 text-center text-gray-600",children:"No logs yet"})})]}),s==="memory"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"mb-3 text-sm text-gray-400",children:"Session Notes & Data"}),e.jsx("div",{className:"py-8 text-center text-xs text-gray-500",children:"No session data"})]}),s==="consent"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-400",children:[e.jsx("span",{children:"Consent Ledger"}),e.jsx("button",{onClick:()=>void i(),className:"rounded-lg border border-slate-700/60 bg-slate-900/70 px-2 py-1 text-[11px] text-gray-300 hover:bg-slate-900/90",children:"Open dashboard"})]}),w.length>0?e.jsx("div",{className:"space-y-2",children:w.slice(0,6).map(t=>{const h=Re(t);return e.jsxs("div",{className:"space-y-2 rounded-xl border border-slate-700/60 bg-slate-900/60 p-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400",children:[e.jsx("span",{className:"font-medium text-gray-300",children:ze[t.action.type]}),e.jsx("span",{className:`rounded-full border px-2 py-0.5 ${h.tone}`,children:h.label})]}),e.jsx("div",{className:"text-[11px] text-gray-500",children:t.action.description}),e.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-gray-600",children:[e.jsx("span",{children:we(new Date(t.timestamp),{addSuffix:!0})}),t.action.target&&e.jsxs("span",{children:["• ",t.action.target]})]})]},t.id)})}):e.jsx("div",{className:"py-8 text-center text-xs text-gray-500",children:"No consent records yet"})]}),s==="privacy"&&e.jsx(ve,{}),s==="trust"&&e.jsx("div",{className:"py-8 text-center text-xs text-gray-500",children:"Trust panel is not available in this build"}),s==="eco"&&e.jsx("div",{className:"py-8 text-center text-xs text-gray-500",children:"Eco impact panel is not available in this build"}),s==="identity"&&e.jsx("div",{className:"py-8 text-center text-xs text-gray-500",children:"Identity vault panel is not available in this build"}),s==="nexus"&&e.jsx("div",{className:"py-8 text-center text-xs text-gray-500",children:"Extension nexus panel is not available in this build"})]}),e.jsxs("div",{className:"space-y-2 border-t border-gray-800/50 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx("input",{type:"checkbox",id:"dry-run",checked:n,onChange:t=>d(t.target.checked),className:"rounded"}),e.jsx("label",{htmlFor:"dry-run",className:"cursor-pointer",children:"Dry-Run Mode"})]}),a&&e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs",children:[e.jsxs("span",{className:"rounded bg-blue-500/20 px-2 py-1 text-blue-400",children:[a.remaining.tokens," tokens"]}),e.jsxs("span",{className:"rounded bg-green-500/20 px-2 py-1 text-green-400",children:[a.remaining.seconds,"s"]}),e.jsxs("span",{className:"rounded bg-purple-500/20 px-2 py-1 text-purple-400",children:[a.remaining.requests," requests"]})]})]})]})})}export{os as RightPanel};
//# sourceMappingURL=RightPanel-DtmRQd7t.js.map
