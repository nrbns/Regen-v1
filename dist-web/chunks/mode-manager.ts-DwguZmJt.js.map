{"version":3,"mappings":"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","names":["TorDetector","__publicField","indicators","confidence","isTorBrowser","ua","screenWidth","screenHeight","timezone","canvas","gl","debugInfo","vendor","renderer","isTorService","result","torDetectorInstance","getTorDetector","detectTorBrowser","DeviceDetector","capabilities","battery","test","caps","ram","cores","hasWASM","hasTouch","conn","effectiveType","GhostMode","torDetection","originalFetch","args","url","pattern","mutations","mutation","node","element","src","parts","ghostModeInstance","getGhostMode","isGhostModeEnabled","defaultModes","useAppStore","__vitePreload","n","useTradeStore","useModeManager","create","set","get","mode","currentMode","modes","modeDefinition","dispatch","applyPrivacyDefaults","error","definition","state","ghostMode","ipc","ModeManager"],"ignoreList":[],"sources":["../../src/core/tor-detector.ts","../../src/core/device-detector.ts","../../src/core/ghost-mode.ts","../../src/core/modes/manager.ts"],"sourcesContent":["/**\r\n * TorDetector - Tor Browser Detection for Ghost Mode\r\n * \r\n * Detects when running inside Tor Browser and enables maximum security mode.\r\n * This is critical for the \"Ghost Mode\" feature.\r\n * \r\n * Usage:\r\n *   const detector = new TorDetector();\r\n *   const isTor = detector.detectTorBrowser();\r\n *   if (isTor) {\r\n *     enableGhostMode();\r\n *   }\r\n */\r\n\r\nexport interface TorDetectionResult {\r\n  isTorBrowser: boolean;\r\n  confidence: 'high' | 'medium' | 'low';\r\n  indicators: string[];\r\n  canEnableGhostMode: boolean;\r\n}\r\n\r\nexport class TorDetector {\r\n  private cachedResult: TorDetectionResult | null = null;\r\n\r\n  /**\r\n   * Detect if running inside Tor Browser\r\n   */\r\n  detectTorBrowser(): TorDetectionResult {\r\n    if (this.cachedResult) {\r\n      return this.cachedResult;\r\n    }\r\n\r\n    const indicators: string[] = [];\r\n    let confidence: 'high' | 'medium' | 'low' = 'low';\r\n    let isTorBrowser = false;\r\n\r\n    // Indicator 1: User Agent (high confidence)\r\n    const ua = navigator.userAgent;\r\n    if (ua.includes('TorBrowser') || ua.includes('Tor')) {\r\n      indicators.push('user_agent');\r\n      confidence = 'high';\r\n      isTorBrowser = true;\r\n    }\r\n\r\n    // Indicator 2: Plugins (Tor Browser has no plugins)\r\n    if (navigator.plugins.length === 0 && navigator.mimeTypes.length === 0) {\r\n      indicators.push('no_plugins');\r\n      if (confidence === 'low') confidence = 'medium';\r\n      if (!isTorBrowser && indicators.length >= 2) {\r\n        isTorBrowser = true;\r\n      }\r\n    }\r\n\r\n    // Indicator 3: Screen dimensions (Tor Browser has fixed window size)\r\n    const screenWidth = window.screen.width;\r\n    const screenHeight = window.screen.height;\r\n    // Tor Browser typically opens at 1000x700 or similar fixed sizes\r\n    if ((screenWidth === 1000 && screenHeight === 700) ||\r\n        (screenWidth === 1000 && screenHeight === 740)) {\r\n      indicators.push('screen_dimensions');\r\n      if (confidence === 'low') confidence = 'medium';\r\n    }\r\n\r\n    // Indicator 4: Timezone (Tor Browser may report UTC)\r\n    const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;\r\n    if (timezone === 'UTC' || timezone === 'Etc/UTC') {\r\n      indicators.push('timezone_utc');\r\n      if (confidence === 'low') confidence = 'medium';\r\n    }\r\n\r\n    // Indicator 5: WebGL fingerprint (Tor Browser modifies WebGL)\r\n    try {\r\n      const canvas = document.createElement('canvas');\r\n      const gl =\r\n        (canvas.getContext('webgl') as WebGLRenderingContext | null) ||\r\n        (canvas.getContext('experimental-webgl') as WebGLRenderingContext | null);\r\n      if (gl) {\r\n        const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');\r\n        if (debugInfo) {\r\n          const vendor = gl.getParameter((debugInfo as any).UNMASKED_VENDOR_WEBGL);\r\n          const renderer = gl.getParameter((debugInfo as any).UNMASKED_RENDERER_WEBGL);\r\n          // Tor Browser may report generic values\r\n          if (vendor && renderer && (vendor.includes('Mesa') || renderer.includes('Mesa'))) {\r\n            indicators.push('webgl_fingerprint');\r\n            if (confidence === 'low') confidence = 'medium';\r\n          }\r\n        }\r\n      }\r\n    } catch {\r\n      // WebGL not available\r\n    }\r\n\r\n    // Indicator 6: Check for Tor-specific APIs or properties\r\n    // Tor Browser may expose certain properties\r\n    if ((window as any).tor || (navigator as any).tor) {\r\n      indicators.push('tor_api');\r\n      confidence = 'high';\r\n      isTorBrowser = true;\r\n    }\r\n\r\n    // Indicator 7: Check if we can reach Tor check service\r\n    // This is async, so we'll do it separately\r\n    this.checkTorService().then((isTorService) => {\r\n      if (isTorService) {\r\n        indicators.push('tor_service');\r\n        if (confidence !== 'high') confidence = 'high';\r\n        isTorBrowser = true;\r\n        // Update cached result\r\n        this.cachedResult = {\r\n          isTorBrowser: true,\r\n          confidence: 'high',\r\n          indicators: [...indicators],\r\n          canEnableGhostMode: true,\r\n        };\r\n      }\r\n    }).catch(() => {\r\n      // Tor service check failed - not necessarily not Tor\r\n    });\r\n\r\n    // High confidence if user agent matches\r\n    if (confidence === 'high') {\r\n      isTorBrowser = true;\r\n    }\r\n\r\n    // Medium confidence with multiple indicators\r\n    if (confidence === 'medium' && indicators.length >= 3) {\r\n      isTorBrowser = true;\r\n    }\r\n\r\n    const result: TorDetectionResult = {\r\n      isTorBrowser,\r\n      confidence,\r\n      indicators,\r\n      canEnableGhostMode: isTorBrowser && confidence !== 'low',\r\n    };\r\n\r\n    this.cachedResult = result;\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Check Tor service (async)\r\n   */\r\n  private async checkTorService(): Promise<boolean> {\r\n    try {\r\n      // Try to check if we're using Tor (this would need to go through Tor proxy)\r\n      // For now, we'll use a simple heuristic: if we can't detect normal browser features\r\n      // In production, this would make a request through Tor to check.torproject.org\r\n      return false; // Placeholder\r\n    } catch {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check if Ghost Mode can be enabled\r\n   */\r\n  canEnableGhostMode(): boolean {\r\n    const detection = this.detectTorBrowser();\r\n    return detection.canEnableGhostMode;\r\n  }\r\n\r\n  /**\r\n   * Get detection confidence\r\n   */\r\n  getConfidence(): 'high' | 'medium' | 'low' {\r\n    return this.detectTorBrowser().confidence;\r\n  }\r\n\r\n  /**\r\n   * Clear cached result (useful for testing or when environment changes)\r\n   */\r\n  clearCache(): void {\r\n    this.cachedResult = null;\r\n  }\r\n}\r\n\r\n// Singleton instance\r\nlet torDetectorInstance: TorDetector | null = null;\r\n\r\n/**\r\n * Get the global TorDetector instance\r\n */\r\nexport function getTorDetector(): TorDetector {\r\n  if (!torDetectorInstance) {\r\n    torDetectorInstance = new TorDetector();\r\n  }\r\n  return torDetectorInstance;\r\n}\r\n\r\n/**\r\n * Quick Tor detection (convenience function)\r\n */\r\nexport function detectTorBrowser(): TorDetectionResult {\r\n  return getTorDetector().detectTorBrowser();\r\n}\r\n\r\n/**\r\n * Check if Ghost Mode can be enabled\r\n */\r\nexport function canEnableGhostMode(): boolean {\r\n  return getTorDetector().canEnableGhostMode();\r\n}\r\n\r\n","/**\n * DeviceDetector - Capability Detection for Universal Compatibility\n * \n * Detects device capabilities to enable adaptive features:\n * - WASM support (for offline AI)\n * - WebGL support (for graphics)\n * - RAM estimation (for memory management)\n * - CPU cores (for performance optimization)\n * - Low-end device detection (for reduced features)\n * \n * Usage:\n *   const detector = new DeviceDetector();\n *   const caps = detector.detectCapabilities();\n *   if (caps.isLowEnd) {\n *     // Use reduced feature set\n *   }\n */\n\nexport interface DeviceCapabilities {\n  hasWASM: boolean;\n  hasWebGL: boolean;\n  hasWebGL2: boolean;\n  hasServiceWorker: boolean;\n  hasIndexedDB: boolean;\n  hasLocalStorage: boolean;\n  ramEstimate: number; // GB\n  cpuCores: number;\n  isLowEnd: boolean;\n  isMobile: boolean;\n  isTablet: boolean;\n  isDesktop: boolean;\n  userAgent: string;\n  platform: string;\n  screenWidth: number;\n  screenHeight: number;\n  pixelRatio: number;\n  connectionType?: 'slow-2g' | '2g' | '3g' | '4g' | 'wifi' | 'ethernet' | 'unknown';\n  batteryLevel?: number; // 0-1\n  isCharging?: boolean;\n}\n\nexport class DeviceDetector {\n  private cachedCapabilities: DeviceCapabilities | null = null;\n\n  /**\n   * Detect all device capabilities\n   */\n  detectCapabilities(): DeviceCapabilities {\n    if (this.cachedCapabilities) {\n      return this.cachedCapabilities;\n    }\n\n    const capabilities: DeviceCapabilities = {\n      hasWASM: this.detectWASM(),\n      hasWebGL: this.detectWebGL(),\n      hasWebGL2: this.detectWebGL2(),\n      hasServiceWorker: this.detectServiceWorker(),\n      hasIndexedDB: this.detectIndexedDB(),\n      hasLocalStorage: this.detectLocalStorage(),\n      ramEstimate: this.estimateRAM(),\n      cpuCores: this.detectCPUCores(),\n      isLowEnd: false, // Will be calculated below\n      isMobile: this.detectMobile(),\n      isTablet: this.detectTablet(),\n      isDesktop: this.detectDesktop(),\n      userAgent: navigator.userAgent,\n      platform: navigator.platform,\n      screenWidth: window.screen.width,\n      screenHeight: window.screen.height,\n      pixelRatio: window.devicePixelRatio || 1,\n      connectionType: this.detectConnectionType(),\n    };\n\n    // Detect battery status (if available)\n    if ('getBattery' in navigator) {\n      (navigator as any).getBattery().then((battery: any) => {\n        capabilities.batteryLevel = battery.level;\n        capabilities.isCharging = battery.charging;\n      }).catch(() => {\n        // Battery API not available or failed\n      });\n    }\n\n    // Calculate if device is low-end\n    capabilities.isLowEnd = this.isLowEndDevice(capabilities);\n\n    this.cachedCapabilities = capabilities;\n    return capabilities;\n  }\n\n  /**\n   * Detect WebAssembly support\n   */\n  private detectWASM(): boolean {\n    try {\n      return typeof WebAssembly !== 'undefined' && \n             typeof WebAssembly.instantiate === 'function';\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * Detect WebGL support\n   */\n  private detectWebGL(): boolean {\n    try {\n      const canvas = document.createElement('canvas');\n      const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');\n      return !!gl;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * Detect WebGL2 support\n   */\n  private detectWebGL2(): boolean {\n    try {\n      const canvas = document.createElement('canvas');\n      const gl = canvas.getContext('webgl2');\n      return !!gl;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * Detect Service Worker support\n   */\n  private detectServiceWorker(): boolean {\n    return 'serviceWorker' in navigator;\n  }\n\n  /**\n   * Detect IndexedDB support\n   */\n  private detectIndexedDB(): boolean {\n    try {\n      return 'indexedDB' in window && !!window.indexedDB;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * Detect LocalStorage support\n   */\n  private detectLocalStorage(): boolean {\n    try {\n      const test = '__redix_test__';\n      localStorage.setItem(test, test);\n      localStorage.removeItem(test);\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * Estimate RAM (in GB)\n   */\n  private estimateRAM(): number {\n    // Use deviceMemory API if available (Chrome/Edge)\n    if ('deviceMemory' in navigator) {\n      return (navigator as any).deviceMemory || 4;\n    }\n    \n    // Fallback: Estimate based on user agent and platform\n    const ua = navigator.userAgent.toLowerCase();\n    // const platform = navigator.platform.toLowerCase(); // Unused for now\n    \n    // Mobile devices typically have 2-8GB\n    if (this.detectMobile() || this.detectTablet()) {\n      // High-end mobile: 6-8GB\n      if (ua.includes('iphone 1') || ua.includes('iphone 12') || ua.includes('iphone 13') || \n          ua.includes('iphone 14') || ua.includes('iphone 15')) {\n        return 6;\n      }\n      // Mid-range mobile: 4GB\n      if (ua.includes('iphone') || ua.includes('android')) {\n        return 4;\n      }\n      // Low-end mobile: 2GB\n      return 2;\n    }\n    \n    // Desktop: Assume 8GB minimum\n    return 8;\n  }\n\n  /**\n   * Detect CPU cores\n   */\n  private detectCPUCores(): number {\n    return navigator.hardwareConcurrency || 2;\n  }\n\n  /**\n   * Detect if device is low-end\n   */\n  private isLowEndDevice(caps: Partial<DeviceCapabilities>): boolean {\n    const ram = caps.ramEstimate || 4;\n    const cores = caps.cpuCores || 2;\n    const hasWASM = caps.hasWASM !== false;\n    \n    // Low-end criteria:\n    // - Less than 2GB RAM\n    // - Less than 2 CPU cores\n    // - No WASM support\n    // - Mobile device with low RAM\n    if (ram < 2) return true;\n    if (cores < 2) return true;\n    if (!hasWASM && (caps.isMobile || caps.isTablet)) return true;\n    if (ram < 4 && cores < 4 && (caps.isMobile || caps.isTablet)) return true;\n    \n    return false;\n  }\n\n  /**\n   * Detect mobile device\n   */\n  private detectMobile(): boolean {\n    const ua = navigator.userAgent.toLowerCase();\n    return /android|webos|iphone|ipod|blackberry|iemobile|opera mini/i.test(ua) &&\n           !this.detectTablet();\n  }\n\n  /**\n   * Detect tablet device\n   */\n  private detectTablet(): boolean {\n    const ua = navigator.userAgent.toLowerCase();\n    const hasTouch = (navigator.maxTouchPoints ?? 0) > 2;\n    return Boolean(\n      /ipad|android(?!.*mobile)|tablet|playbook|silk/i.test(ua) ||\n      (hasTouch && /MacIntel/.test(navigator.platform))\n    );\n  }\n\n  /**\n   * Detect desktop device\n   */\n  private detectDesktop(): boolean {\n    return !this.detectMobile() && !this.detectTablet();\n  }\n\n  /**\n   * Detect connection type\n   */\n  private detectConnectionType(): DeviceCapabilities['connectionType'] {\n    if ('connection' in navigator) {\n      const conn = (navigator as any).connection || (navigator as any).mozConnection || (navigator as any).webkitConnection;\n      if (conn) {\n        const effectiveType = conn.effectiveType;\n        if (effectiveType === 'slow-2g' || effectiveType === '2g') return '2g';\n        if (effectiveType === '3g') return '3g';\n        if (effectiveType === '4g') return '4g';\n      }\n    }\n    \n    // Fallback: Assume unknown\n    return 'unknown';\n  }\n\n  /**\n   * Get recommended feature set based on capabilities\n   */\n  getRecommendedFeatures(caps?: DeviceCapabilities): {\n    useWASMAI: boolean;\n    useCloudAI: boolean;\n    useDOMPooling: boolean;\n    useServiceWorker: boolean;\n    maxTabs: number;\n    enableAnimations: boolean;\n    enableWebGL: boolean;\n  } {\n    const capabilities = caps || this.detectCapabilities();\n    \n    return {\n      useWASMAI: capabilities.hasWASM && !capabilities.isLowEnd,\n      useCloudAI: !capabilities.isLowEnd && capabilities.ramEstimate >= 4,\n      useDOMPooling: true, // Always use pooling for memory efficiency\n      useServiceWorker: capabilities.hasServiceWorker && !capabilities.isLowEnd,\n      maxTabs: capabilities.isLowEnd ? 3 : capabilities.ramEstimate < 4 ? 5 : 10,\n      enableAnimations: !capabilities.isLowEnd && capabilities.ramEstimate >= 4,\n      enableWebGL: capabilities.hasWebGL && !capabilities.isLowEnd,\n    };\n  }\n\n  /**\n   * Clear cached capabilities (useful for testing or when device state changes)\n   */\n  clearCache(): void {\n    this.cachedCapabilities = null;\n  }\n}\n\n// Singleton instance\nlet deviceDetectorInstance: DeviceDetector | null = null;\n\n/**\n * Get the global DeviceDetector instance\n */\nexport function getDeviceDetector(): DeviceDetector {\n  if (!deviceDetectorInstance) {\n    deviceDetectorInstance = new DeviceDetector();\n  }\n  return deviceDetectorInstance;\n}\n\n/**\n * Quick capability check (convenience function)\n */\nexport function detectDeviceCapabilities(): DeviceCapabilities {\n  return getDeviceDetector().detectCapabilities();\n}\n\n/**\n * Check if device is low-end\n */\nexport function isLowEndDevice(): boolean {\n  return getDeviceDetector().detectCapabilities().isLowEnd;\n}\n\n","/**\n * Ghost Mode - Maximum Security Mode for Tor Browser\n *\n * When enabled, Ghost Mode:\n * - Forces local AI only (no cloud APIs)\n * - Disables all tracking\n * - Uses ephemeral sessions (no storage)\n * - Blocks all external scripts\n * - Renders content as static HTML only\n * - Disables all non-essential features\n *\n * This is the \"world AI security browser\" mode.\n */\n\nimport { TorDetector, detectTorBrowser } from './tor-detector';\nimport { DeviceDetector } from './device-detector';\n\nexport interface GhostModeConfig {\n  enabled: boolean;\n  localAIOnly: boolean;\n  noCloudAPIs: boolean;\n  noStorage: boolean;\n  noScripts: boolean;\n  noTracking: boolean;\n  ephemeralSession: boolean;\n  torDetected: boolean;\n  securityLevel: 'maximum' | 'high' | 'standard';\n}\n\nexport class GhostMode {\n  private config: GhostModeConfig;\n  private torDetector: TorDetector;\n  private deviceDetector: DeviceDetector;\n\n  constructor() {\n    this.torDetector = new TorDetector();\n    this.deviceDetector = new DeviceDetector();\n\n    // Auto-detect Tor and enable Ghost Mode if detected\n    const torDetection = detectTorBrowser();\n    // const deviceCaps = detectDeviceCapabilities(); // Unused for now\n\n    // Don't auto-enable Ghost Mode - let user control it via PrivacySwitch\n    this.config = {\n      enabled: false, // User must manually enable via PrivacySwitch\n      localAIOnly: false, // Allow cloud APIs for functionality\n      noCloudAPIs: false, // Allow cloud APIs for functionality\n      noStorage: false, // Allow storage for functionality (but block tracking)\n      noScripts: false, // Allow scripts for functionality (but block tracking scripts)\n      noTracking: true, // Block all tracking - this is the key feature\n      ephemeralSession: false, // Allow persistence for functionality\n      torDetected: torDetection.isTorBrowser,\n      securityLevel: torDetection.isTorBrowser ? 'maximum' : 'high',\n    };\n\n    // Don't auto-activate - user controls via PrivacySwitch\n    // if (this.config.enabled) {\n    //   this.activateGhostMode();\n    // }\n  }\n\n  /**\n   * Activate Ghost Mode\n   * Blocks tracking while maintaining functionality\n   */\n  private activateGhostMode(): void {\n    // Add Ghost Mode class to document\n    document.documentElement.classList.add('ghost-mode');\n    document.documentElement.setAttribute('data-ghost-mode', 'true');\n\n    // Block tracking scripts and requests\n    this.blockTracking();\n\n    // Note: We don't disable storage or scripts - we only block tracking\n    // This allows websites to function normally while preventing tracking\n\n    console.log('ðŸ”’ Ghost Mode activated - Tracking blocked, functionality preserved');\n    console.log('ðŸ”’ Tor detected:', this.config.torDetected);\n    console.log('ðŸ”’ Tracking blocked:', this.config.noTracking);\n  }\n\n  /**\n   * Block tracking scripts and requests\n   */\n  private blockTracking(): void {\n    // Block known tracking domains via fetch interception\n    const originalFetch = window.fetch;\n    window.fetch = async function (...args) {\n      const url =\n        typeof args[0] === 'string' ? args[0] : args[0] instanceof Request ? args[0].url : '';\n\n      // Block known tracking domains\n      const trackingPatterns = [\n        /doubleclick\\.net/i,\n        /google-analytics\\.com/i,\n        /googletagmanager\\.com/i,\n        /facebook\\.net/i,\n        /facebook\\.com\\/tr/i,\n        /analytics\\./i,\n        /tracking\\./i,\n        /adservice\\./i,\n        /ads\\./i,\n        /advertising\\./i,\n        /adserver\\./i,\n        /pixel\\./i,\n        /beacon\\./i,\n        /tracker\\./i,\n      ];\n\n      if (trackingPatterns.some(pattern => pattern.test(url))) {\n        // Block tracking request\n        if (import.meta.env.DEV) {\n          console.debug('[Ghost Mode] Blocked tracking request:', url);\n        }\n        return Promise.reject(new Error('Tracking blocked by Ghost Mode'));\n      }\n\n      // Allow non-tracking requests\n      return originalFetch.apply(this, args);\n    };\n\n    // Block tracking scripts from loading\n    const observer = new MutationObserver(mutations => {\n      mutations.forEach(mutation => {\n        mutation.addedNodes.forEach(node => {\n          if (node.nodeType === Node.ELEMENT_NODE) {\n            const element = node as HTMLElement;\n\n            // Block tracking scripts\n            if (element.tagName === 'SCRIPT') {\n              const src = (element as HTMLScriptElement).src;\n              if (src) {\n                const trackingPatterns = [\n                  /google-analytics\\.com/i,\n                  /googletagmanager\\.com/i,\n                  /facebook\\.net/i,\n                  /analytics\\./i,\n                  /tracking\\./i,\n                ];\n\n                if (trackingPatterns.some(pattern => pattern.test(src))) {\n                  element.remove();\n                  if (import.meta.env.DEV) {\n                    console.debug('[Ghost Mode] Blocked tracking script:', src);\n                  }\n                }\n              }\n            }\n\n            // Block tracking iframes\n            if (element.tagName === 'IFRAME') {\n              const src = (element as HTMLIFrameElement).src;\n              if (src) {\n                const trackingPatterns = [\n                  /doubleclick\\.net/i,\n                  /google-analytics\\.com/i,\n                  /facebook\\.com/i,\n                  /ads\\./i,\n                ];\n\n                if (trackingPatterns.some(pattern => pattern.test(src))) {\n                  element.remove();\n                  if (import.meta.env.DEV) {\n                    console.debug('[Ghost Mode] Blocked tracking iframe:', src);\n                  }\n                }\n              }\n            }\n          }\n        });\n      });\n    });\n\n    observer.observe(document, {\n      childList: true,\n      subtree: true,\n    });\n  }\n\n  /**\n   * Enable Ghost Mode manually\n   */\n  enable(): void {\n    if (this.config.enabled) {\n      return; // Already enabled\n    }\n\n    // Check if we can enable (need Tor or user consent)\n    const torDetection = detectTorBrowser();\n    if (!torDetection.isTorBrowser) {\n      // Show warning - Ghost Mode is most secure in Tor Browser\n      const confirmed = confirm(\n        'âš ï¸ Ghost Mode is most secure when running inside Tor Browser.\\n\\n' +\n          'Without Tor Browser, some security features may be limited.\\n\\n' +\n          'Enable Ghost Mode anyway?'\n      );\n      if (!confirmed) {\n        return;\n      }\n    }\n\n    this.config.enabled = true;\n    this.config.securityLevel = torDetection.isTorBrowser ? 'maximum' : 'high';\n    this.activateGhostMode();\n  }\n\n  /**\n   * Disable Ghost Mode\n   */\n  disable(): void {\n    if (!this.config.enabled) {\n      return;\n    }\n\n    this.config.enabled = false;\n    this.config.securityLevel = 'standard';\n    document.documentElement.classList.remove('ghost-mode');\n    document.documentElement.removeAttribute('data-ghost-mode');\n\n    console.log('ðŸ”“ Ghost Mode disabled');\n  }\n\n  /**\n   * Check if Ghost Mode is enabled\n   */\n  isEnabled(): boolean {\n    return this.config.enabled;\n  }\n\n  /**\n   * Get Ghost Mode configuration\n   */\n  getConfig(): GhostModeConfig {\n    return { ...this.config };\n  }\n\n  /**\n   * Check if cloud APIs are allowed\n   */\n  canUseCloudAPI(): boolean {\n    return !this.config.enabled || !this.config.noCloudAPIs;\n  }\n\n  /**\n   * Check if storage is allowed\n   */\n  canUseStorage(): boolean {\n    return !this.config.enabled || !this.config.noStorage;\n  }\n\n  /**\n   * Check if scripts are allowed\n   */\n  canUseScripts(): boolean {\n    return !this.config.enabled || !this.config.noScripts;\n  }\n\n  /**\n   * Get security status message\n   */\n  getSecurityStatus(): string {\n    if (!this.config.enabled) {\n      return 'Standard security';\n    }\n\n    const parts: string[] = [];\n\n    if (this.config.torDetected) {\n      parts.push('ðŸ”’ Tor: Active');\n    }\n\n    if (this.config.localAIOnly) {\n      parts.push('ðŸ¤– AI: Local');\n    }\n\n    if (this.config.noTracking) {\n      parts.push('ðŸš« Tracking: Blocked');\n    }\n\n    if (this.config.ephemeralSession) {\n      parts.push('ðŸ’¨ Session: Ephemeral');\n    }\n\n    return parts.join(' | ') || 'Ghost Mode: Active';\n  }\n}\n\n// Singleton instance\nlet ghostModeInstance: GhostMode | null = null;\n\n/**\n * Get the global GhostMode instance\n */\nexport function getGhostMode(): GhostMode {\n  if (!ghostModeInstance) {\n    ghostModeInstance = new GhostMode();\n  }\n  return ghostModeInstance;\n}\n\n/**\n * Check if Ghost Mode is enabled\n */\nexport function isGhostModeEnabled(): boolean {\n  return getGhostMode().isEnabled();\n}\n\n/**\n * Enable Ghost Mode\n */\nexport function enableGhostMode(): void {\n  getGhostMode().enable();\n}\n\n/**\n * Disable Ghost Mode\n */\nexport function disableGhostMode(): void {\n  getGhostMode().disable();\n}\n","import { create } from 'zustand';\r\nimport { dispatch } from '../redix/runtime';\r\nimport { getGhostMode } from '../ghost-mode';\r\nimport { ipc } from '../../lib/ipc-typed';\r\n\r\nexport type ModeId = 'Browse' | 'Research' | 'Trade' | 'Games' | 'Docs' | 'Images' | 'Threats' | 'GraphMind';\r\n\r\nexport interface ModeDefinition {\r\n  id: ModeId;\r\n  name: string;\r\n  icon: string;\r\n  description: string;\r\n  defaultTools?: string[];\r\n  onboarding?: {\r\n    steps?: string[];\r\n    video?: string;\r\n  };\r\n  onActivate?: () => Promise<void> | void;\r\n  onDeactivate?: () => Promise<void> | void;\r\n  privacyDefaults?: {\r\n    ghost?: boolean;\r\n    proxy?: 'tor' | 'vpn' | 'none';\r\n    trackingProtection?: boolean;\r\n  };\r\n  aiContext?: {\r\n    prompt?: string;\r\n    agentId?: string;\r\n  };\r\n}\r\n\r\ninterface ModeManagerState {\r\n  currentMode: ModeId;\r\n  previousMode: ModeId | null;\r\n  modes: Record<ModeId, ModeDefinition>;\r\n  loading: boolean;\r\n  activateMode: (mode: ModeId) => Promise<void>;\r\n  registerMode: (definition: ModeDefinition) => void;\r\n}\r\n\r\nconst defaultModes: Record<ModeId, ModeDefinition> = {\r\n  Browse: {\r\n    id: 'Browse',\r\n    name: 'Browse',\r\n    icon: 'Globe',\r\n    description: 'Default browsing with balanced privacy and performance.',\r\n    privacyDefaults: { ghost: false, proxy: 'none', trackingProtection: true },\r\n    onActivate: async () => {\r\n      // Close all mode-specific panels when returning to Browse mode\r\n      const { useAppStore } = await import('../../state/appStore');\r\n      useAppStore.getState().setResearchPaneOpen(false);\r\n      useAppStore.getState().setMemorySidebarOpen(false);\r\n      const { useTradeStore } = await import('../../state/tradeStore');\r\n      useTradeStore.getState().setSidebarOpen(false);\r\n      if (useAppStore.getState().graphDockOpen) {\r\n        useAppStore.getState().toggleGraphDock();\r\n      }\r\n    },\r\n  },\r\n  Research: {\r\n    id: 'Research',\r\n    name: 'Research',\r\n    icon: 'Search',\r\n    description: 'Deep research workflow with SuperMemory + agents.',\r\n    defaultTools: ['memory', 'agent', 'reader'],\r\n    privacyDefaults: { ghost: false, proxy: 'none', trackingProtection: true },\r\n    aiContext: {\r\n      prompt: 'You are the Research Mode assistant. Provide structured answers with citations and highlight contradictions.',\r\n      agentId: 'research.agent',\r\n    },\r\n    onActivate: async () => {\r\n      // Open Memory Sidebar and Research Pane when Research mode is activated\r\n      const { useAppStore } = await import('../../state/appStore');\r\n      useAppStore.getState().setMemorySidebarOpen(true);\r\n      useAppStore.getState().setResearchPaneOpen(true);\r\n    },\r\n    onDeactivate: async () => {\r\n      // Close Research Pane when leaving Research mode (keep Memory Sidebar open)\r\n      const { useAppStore } = await import('../../state/appStore');\r\n      useAppStore.getState().setResearchPaneOpen(false);\r\n    },\r\n  },\r\n  Trade: {\r\n    id: 'Trade',\r\n    name: 'Trade',\r\n    icon: 'TrendingUp',\r\n    description: 'Market intelligence with live charts, privacy defaults, and data firewalls.',\r\n    defaultTools: ['charts', 'sentiment', 'eco-balance'],\r\n    privacyDefaults: { ghost: true, proxy: 'vpn', trackingProtection: true },\r\n    aiContext: {\r\n      prompt: 'You are the Trade Mode assistant. Provide price action, key levels, risk notes, and market context for trading queries.',\r\n      agentId: 'trade.agent',\r\n    },\r\n    onActivate: async () => {\r\n      // Open TradeSidebar when Trade mode is activated\r\n      const { useTradeStore } = await import('../../state/tradeStore');\r\n      useTradeStore.getState().setSidebarOpen(true);\r\n    },\r\n    onDeactivate: async () => {\r\n      // Close TradeSidebar when leaving Trade mode\r\n      const { useTradeStore } = await import('../../state/tradeStore');\r\n      useTradeStore.getState().setSidebarOpen(false);\r\n    },\r\n  },\r\n  Games: {\r\n    id: 'Games',\r\n    name: 'Games',\r\n    icon: 'Gamepad',\r\n    description: 'Optimized for low-latency streaming and controller input.',\r\n    privacyDefaults: { ghost: false, proxy: 'none', trackingProtection: false },\r\n  },\r\n  Docs: {\r\n    id: 'Docs',\r\n    name: 'Docs',\r\n    icon: 'FileText',\r\n    description: 'Document authoring and summarization.',\r\n    defaultTools: ['editor', 'summarizer'],\r\n    aiContext: {\r\n      prompt: 'You are the Docs Mode assistant. Summarize documents, extract key information, and help with documentation queries.',\r\n      agentId: 'docs.agent',\r\n    },\r\n  },\r\n  Images: {\r\n    id: 'Images',\r\n    name: 'Images',\r\n    icon: 'Image',\r\n    description: 'Visual search and inspiration boards.',\r\n    aiContext: {\r\n      prompt: 'You are the Images Mode assistant. Help users find and analyze images, create inspiration boards, and work with visual content.',\r\n      agentId: 'images.agent',\r\n    },\r\n  },\r\n  Threats: {\r\n    id: 'Threats',\r\n    name: 'Threats',\r\n    icon: 'Shield',\r\n    description: 'Security analysis with network isolation.',\r\n    privacyDefaults: { ghost: true, proxy: 'tor', trackingProtection: true },\r\n    defaultTools: ['threat-intel', 'sandbox'],\r\n    aiContext: {\r\n      prompt: 'You are the Threats Mode assistant. Analyze security threats, provide threat intelligence, and help with security analysis.',\r\n      agentId: 'threats.agent',\r\n    },\r\n  },\r\n  GraphMind: {\r\n    id: 'GraphMind',\r\n    name: 'GraphMind',\r\n    icon: 'GitBranch',\r\n    description: 'Knowledge graph view of SuperMemory and research trails.',\r\n    defaultTools: ['graph'],\r\n    aiContext: {\r\n      prompt: 'You are the GraphMind assistant. Help users explore their knowledge graph by identifying connections, relationships, and patterns in their SuperMemory.',\r\n      agentId: 'graphmind.agent',\r\n    },\r\n    onActivate: async () => {\r\n      // Open Graph Dock when GraphMind mode is activated\r\n      const { useAppStore } = await import('../../state/appStore');\r\n      if (!useAppStore.getState().graphDockOpen) {\r\n        useAppStore.getState().toggleGraphDock();\r\n      }\r\n    },\r\n    onDeactivate: async () => {\r\n      // Close Graph Dock when leaving GraphMind mode\r\n      const { useAppStore } = await import('../../state/appStore');\r\n      if (useAppStore.getState().graphDockOpen) {\r\n        useAppStore.getState().toggleGraphDock();\r\n      }\r\n    },\r\n  },\r\n};\r\n\r\nexport const useModeManager = create<ModeManagerState>((set, get) => ({\r\n  currentMode: 'Browse',\r\n  previousMode: null,\r\n  modes: defaultModes,\r\n  loading: false,\r\n  async activateMode(mode) {\r\n    const { currentMode, modes } = get();\r\n    if (mode === currentMode) return;\r\n    const modeDefinition = modes[mode];\r\n    if (!modeDefinition) return;\r\n\r\n    set({ loading: true });\r\n    dispatch({\r\n      type: 'redix:mode:activating',\r\n      payload: { from: currentMode, to: mode },\r\n      source: 'mode-manager',\r\n    });\r\n\r\n    try {\r\n      await modes[currentMode]?.onDeactivate?.();\r\n      await applyPrivacyDefaults(modeDefinition);\r\n      await modeDefinition.onActivate?.();\r\n\r\n      set({ previousMode: currentMode, currentMode: mode, loading: false });\r\n      dispatch({\r\n        type: 'redix:mode:activated',\r\n        payload: { mode },\r\n        source: 'mode-manager',\r\n      });\r\n    } catch (error) {\r\n      console.error('[ModeManager] Failed to activate mode:', error);\r\n      set({ loading: false });\r\n      dispatch({\r\n        type: 'redix:mode:error',\r\n        payload: { mode, error: error instanceof Error ? error.message : String(error) },\r\n        source: 'mode-manager',\r\n      });\r\n    }\r\n  },\r\n  registerMode(definition) {\r\n    set((state) => ({\r\n      modes: {\r\n        ...state.modes,\r\n        [definition.id]: {\r\n          ...defaultModes[definition.id],\r\n          ...definition,\r\n        },\r\n      },\r\n    }));\r\n  },\r\n}));\r\n\r\nasync function applyPrivacyDefaults(mode: ModeDefinition) {\r\n  const ghostMode = getGhostMode();\r\n  if (mode.privacyDefaults?.ghost) {\r\n    ghostMode.enable();\r\n  } else {\r\n    ghostMode.disable();\r\n  }\r\n\r\n  if (mode.privacyDefaults?.proxy && mode.privacyDefaults.proxy !== 'none') {\r\n    try {\r\n      if (mode.privacyDefaults.proxy === 'tor') {\r\n        await ipc.proxy.set({\r\n          type: 'socks5',\r\n          host: '127.0.0.1',\r\n          port: 9050,\r\n        });\r\n      } else if (mode.privacyDefaults.proxy === 'vpn') {\r\n        await ipc.proxy.set({\r\n          type: 'socks5',\r\n          host: '127.0.0.1',\r\n          port: 1080,\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.warn('[ModeManager] Failed to apply proxy defaults:', error);\r\n    }\r\n  } else {\r\n    try {\r\n      await ipc.proxy.set({ mode: 'direct' });\r\n    } catch (error) {\r\n      console.warn('[ModeManager] Failed to clear proxy:', error);\r\n    }\r\n  }\r\n\r\n  dispatch({\r\n    type: 'redix:mode:privacy',\r\n    payload: { mode: mode.id, defaults: mode.privacyDefaults },\r\n    source: 'mode-manager',\r\n  });\r\n}\r\n\r\nexport const ModeManager = {\r\n  activate: (mode: ModeId) => useModeManager.getState().activateMode(mode),\r\n  register: (definition: ModeDefinition) => useModeManager.getState().registerMode(definition),\r\n  getCurrent: () => useModeManager.getState().modes[useModeManager.getState().currentMode],\r\n};\r\n\r\n"],"file":"mode-manager.ts-DwguZmJt.js"}