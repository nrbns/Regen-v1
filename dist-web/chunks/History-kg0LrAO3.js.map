{"version":3,"file":"History-kg0LrAO3.js","sources":["../../src/lib/use-ipc-event.ts","../../src/routes/History.tsx"],"sourcesContent":["/**\r\n * React hook for IPC events\r\n * Separate file to avoid require() issues in browser\r\n */\r\n\r\nimport { useEffect } from 'react';\r\nimport { ipcEvents } from './ipc-events';\r\n\r\nexport function useIPCEvent<T>(event: string, callback: (data: T) => void, deps: any[] = []) {\r\n  useEffect(() => {\r\n    const unsubscribe = ipcEvents.on<T>(event, callback);\r\n    return unsubscribe;\r\n  }, [event, ...deps]);\r\n}\r\n\r\n","import { useEffect, useState, useMemo, useCallback, useRef, type ReactNode } from 'react';\nimport {\n  Search,\n  Trash2,\n  Clock,\n  Globe,\n  X,\n  ShieldCheck,\n  AlertTriangle,\n  BarChart2,\n  Filter,\n  ExternalLink,\n  Copy,\n  HardDrive,\n  RefreshCw,\n  Loader2,\n} from 'lucide-react';\nimport { motion } from 'framer-motion';\nimport { useNavigate } from 'react-router-dom';\nimport { ipc } from '../lib/ipc-typed';\nimport { useIPCEvent } from '../lib/use-ipc-event';\n\ntype HistoryEntry = {\n  id: string;\n  url: string;\n  title: string;\n  timestamp: number;\n  visitCount?: number;\n  favicon?: string;\n  lastVisitTime?: number;\n};\n\ntype GroupedHistory = {\n  date: string;\n  entries: HistoryEntry[];\n};\n\nexport default function HistoryPage() {\n  const navigate = useNavigate();\n  const [items, setItems] = useState<HistoryEntry[]>([]);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [selectedEntry, setSelectedEntry] = useState<HistoryEntry | null>(null);\n  const [activeFilter, setActiveFilter] = useState<'all' | 'search' | 'secure' | 'insecure'>('all');\n  const [searchResults, setSearchResults] = useState<HistoryEntry[] | null>(null);\n  const [searching, setSearching] = useState(false);\n  const [storageInfo, setStorageInfo] = useState<{\n    usage: number;\n    quota: number;\n    percent: number;\n    updatedAt: number;\n  } | null>(null);\n  const [storageStatus, setStorageStatus] = useState<'idle' | 'loading' | 'error'>('idle');\n  const mountedRef = useRef(true);\n\n  useEffect(() => {\n    return () => {\n      mountedRef.current = false;\n    };\n  }, []);\n\n  // Load history on mount\n  useEffect(() => {\n    const loadHistory = async () => {\n      try {\n        const list = (await ipc.history.list()) as HistoryEntry[];\n        // Ensure we have an array\n        if (Array.isArray(list)) {\n          setItems(list);\n        } else {\n          setItems([]);\n        }\n      } catch (error) {\n        console.error('Failed to load history:', error);\n        setItems([]); // Set empty array on error\n      } finally {\n        setLoading(false);\n      }\n    };\n    loadHistory();\n  }, []);\n\n  // Listen for history updates\n  useIPCEvent(\n    'history:updated',\n    () => {\n      ipc.history\n        .list()\n        .then((list: any) => setItems(list || []))\n        .catch(console.error);\n    },\n    []\n  );\n\n  useEffect(() => {\n    const query = searchQuery.trim();\n    if (query.length < 2) {\n      setSearchResults(null);\n      setSearching(false);\n      return;\n    }\n\n    let cancelled = false;\n    setSearching(true);\n\n    ipc.history\n      .search(query)\n      .then((results: any) => {\n        if (cancelled) return;\n        setSearchResults(Array.isArray(results) ? results : []);\n      })\n      .catch(error => {\n        if (cancelled) return;\n        console.error('History search failed:', error);\n        setSearchResults([]);\n      })\n      .finally(() => {\n        if (!cancelled) {\n          setSearching(false);\n        }\n      });\n\n    return () => {\n      cancelled = true;\n    };\n  }, [searchQuery]);\n\n  const updateStorageEstimate = useCallback(async () => {\n    if (!navigator?.storage?.estimate) {\n      if (mountedRef.current) {\n        setStorageStatus('error');\n      }\n      return;\n    }\n\n    if (mountedRef.current) {\n      setStorageStatus('loading');\n    }\n\n    try {\n      const { usage = 0, quota = 0 } = await navigator.storage.estimate();\n      if (!mountedRef.current) return;\n      const percent = quota > 0 ? (usage / quota) * 100 : 0;\n      setStorageInfo({ usage, quota, percent, updatedAt: Date.now() });\n      setStorageStatus('idle');\n    } catch (error) {\n      console.error('Failed to estimate storage:', error);\n      if (mountedRef.current) {\n        setStorageStatus('error');\n      }\n    }\n  }, []);\n\n  useEffect(() => {\n    updateStorageEstimate();\n    const interval = window.setInterval(updateStorageEstimate, 45000);\n    return () => window.clearInterval(interval);\n  }, [updateStorageEstimate]);\n\n  const handleRefreshStorage = useCallback(() => {\n    void updateStorageEstimate();\n  }, [updateStorageEstimate]);\n\n  const derivedStats = useMemo(() => {\n    const uniqueDomains = new Set<string>();\n    let secureCount = 0;\n    let insecureCount = 0;\n    let searchCount = 0;\n\n    items.forEach(entry => {\n      try {\n        const urlObj = new URL(entry.url);\n        uniqueDomains.add(urlObj.hostname);\n        if (urlObj.protocol === 'https:') {\n          secureCount += 1;\n        } else {\n          insecureCount += 1;\n        }\n        if (detectSearchQuery(entry.url)) {\n          searchCount += 1;\n        }\n      } catch {\n        /* ignore */\n      }\n    });\n\n    return {\n      total: items.length,\n      uniqueDomains: uniqueDomains.size,\n      secureCount,\n      insecureCount,\n      searchCount,\n    };\n  }, [items]);\n\n  // Filter and group history entries\n  const groupedHistory = useMemo<GroupedHistory[]>(() => {\n    const sourceItems = searchResults ?? items;\n    let filtered = sourceItems;\n\n    // Apply search filter\n    if (!searchResults && searchQuery.trim()) {\n      const query = searchQuery.toLowerCase();\n      filtered = sourceItems.filter(\n        entry =>\n          entry.title.toLowerCase().includes(query) || entry.url.toLowerCase().includes(query)\n      );\n    }\n\n    if (activeFilter !== 'all') {\n      filtered = filtered.filter(entry => {\n        switch (activeFilter) {\n          case 'search':\n            return Boolean(detectSearchQuery(entry.url));\n          case 'secure':\n            try {\n              return new URL(entry.url).protocol === 'https:';\n            } catch {\n              return false;\n            }\n          case 'insecure':\n            try {\n              return new URL(entry.url).protocol !== 'https:';\n            } catch {\n              return false;\n            }\n          default:\n            return true;\n        }\n      });\n    }\n\n    // Group by date (Today, Yesterday, This Week, This Month, Older)\n    const groups: { [key: string]: HistoryEntry[] } = {};\n    const now = Date.now();\n    const oneDay = 24 * 60 * 60 * 1000;\n    const oneWeek = 7 * oneDay;\n    const oneMonth = 30 * oneDay;\n\n    filtered.forEach(entry => {\n      const baseTime = entry.lastVisitTime ?? entry.timestamp;\n      const diff = now - baseTime;\n      let groupKey: string;\n\n      if (diff < oneDay) {\n        groupKey = 'Today';\n      } else if (diff < oneDay * 2) {\n        groupKey = 'Yesterday';\n      } else if (diff < oneWeek) {\n        groupKey = 'This Week';\n      } else if (diff < oneMonth) {\n        groupKey = 'This Month';\n      } else {\n        groupKey = 'Older';\n      }\n\n      if (!groups[groupKey]) {\n        groups[groupKey] = [];\n      }\n      groups[groupKey].push(entry);\n    });\n\n    // Convert to array and sort\n    return Object.entries(groups)\n      .map(([date, entries]) => ({\n        date,\n        entries: entries.sort(\n          (a, b) => (b.lastVisitTime ?? b.timestamp) - (a.lastVisitTime ?? a.timestamp)\n        ),\n      }))\n      .sort((a, b) => {\n        const order = ['Today', 'Yesterday', 'This Week', 'This Month', 'Older'];\n        return order.indexOf(a.date) - order.indexOf(b.date);\n      });\n  }, [items, searchResults, searchQuery, activeFilter]);\n\n  const totalResultCount = useMemo(\n    () => groupedHistory.reduce((sum, group) => sum + group.entries.length, 0),\n    [groupedHistory]\n  );\n\n  const handleClearHistory = async () => {\n    if (confirm('Are you sure you want to clear all browsing history?')) {\n      await ipc.history.clear();\n      setItems([]);\n    }\n  };\n\n  const handleDeleteEntry = async (url: string) => {\n    await ipc.history.deleteUrl?.(url);\n    setItems(items.filter(e => e.url !== url));\n    setSelectedEntry(prev => (prev?.url === url ? null : prev));\n  };\n\n  const handleNavigate = async (url: string) => {\n    try {\n      // Create tab with the URL directly - it will be activated automatically\n      const result = await ipc.tabs.create(url);\n      if (result) {\n        // Navigate to home to show the tab in MainView\n        navigate('/');\n      }\n    } catch (error) {\n      console.error('Failed to open history URL:', error);\n      // Fallback: navigate to home and create blank tab\n      navigate('/');\n      setTimeout(() => {\n        ipc.tabs.create('about:blank').catch(console.error);\n      }, 100);\n    }\n  };\n\n  const formatTime = (timestamp: number) => {\n    const diff = Date.now() - timestamp;\n    if (diff < 1000 * 60 * 60 * 24) {\n      return formatRelativeTimeFromNow(timestamp);\n    }\n    const date = new Date(timestamp);\n    return (\n      date.toLocaleDateString() +\n      ' ' +\n      date.toLocaleTimeString([], {\n        hour: '2-digit',\n        minute: '2-digit',\n      })\n    );\n  };\n\n  const getFaviconUrl = (url: string) => {\n    try {\n      const urlObj = new URL(url);\n      return `https://www.google.com/s2/favicons?domain=${urlObj.hostname}&sz=32`;\n    } catch {\n      return undefined;\n    }\n  };\n\n  const detectSearchQuery = (url: string) => {\n    try {\n      const urlObj = new URL(url);\n      const host = urlObj.hostname;\n      const params = urlObj.searchParams;\n\n      if (host.includes('google')) {\n        return params.get('q') || params.get('query');\n      }\n      if (host.includes('duckduckgo')) {\n        return params.get('q');\n      }\n      if (host.includes('bing.com')) {\n        return params.get('q');\n      }\n      if (host.includes('search.yahoo.com')) {\n        return params.get('p');\n      }\n      if (host.includes('youtube.com') || host.includes('youtu.be')) {\n        return params.get('search_query');\n      }\n      if (host.includes('reddit.com')) {\n        return params.get('q');\n      }\n      return null;\n    } catch {\n      return null;\n    }\n  };\n\n  const highlightQuery = (text: string, query: string) => {\n    if (!query) return text;\n    const regex = new RegExp(`(${escapeRegExp(query)})`, 'ig');\n    return text.split(regex).map((part, index) =>\n      regex.test(part) ? (\n        <mark key={index} className=\"rounded-sm bg-blue-500/30 px-0.5 text-blue-100\">\n          {part}\n        </mark>\n      ) : (\n        <span key={index}>{part}</span>\n      )\n    );\n  };\n\n  const escapeRegExp = (value: string) => value.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n\n  if (loading) {\n    return (\n      <div className=\"flex h-full w-full items-center justify-center bg-[#1A1D28]\">\n        <Clock size={24} className=\"animate-spin text-blue-400\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex h-full w-full flex-col bg-[#1A1D28] text-gray-100\">\n      {/* Header */}\n      <div className=\"border-b border-gray-800/50 p-6\">\n        <div className=\"mb-4 flex flex-wrap items-center justify-between gap-3\">\n          <div className=\"flex items-center gap-3\">\n            <h2 className=\"text-2xl font-bold\">History</h2>\n            <span className=\"flex items-center gap-2 text-xs uppercase tracking-[0.28em] text-gray-500\">\n              <BarChart2 size={14} />\n              {derivedStats.total} visits · {derivedStats.uniqueDomains} domains\n            </span>\n          </div>\n          <motion.button\n            onClick={handleClearHistory}\n            whileHover={{ scale: 1.05 }}\n            whileTap={{ scale: 0.95 }}\n            className=\"flex items-center gap-2 rounded-lg border border-gray-700/50 bg-gray-900/60 px-4 py-2 text-gray-300 transition-colors hover:bg-red-600/20 hover:text-red-400\"\n          >\n            <Trash2 size={18} />\n            <span>Clear browsing data</span>\n          </motion.button>\n        </div>\n\n        <div className=\"mb-4 flex flex-wrap items-center gap-2\">\n          <HistoryStatCard\n            label=\"Secure\"\n            value={derivedStats.secureCount}\n            accent=\"text-emerald-300\"\n            helper=\"HTTPS pages\"\n            icon={<ShieldCheck size={16} className=\"text-emerald-300\" />}\n          />\n          <HistoryStatCard\n            label=\"Insecure\"\n            value={derivedStats.insecureCount}\n            accent=\"text-amber-300\"\n            helper=\"HTTP pages\"\n            icon={<AlertTriangle size={16} className=\"text-amber-300\" />}\n          />\n          <HistoryStatCard\n            label=\"Searches\"\n            value={derivedStats.searchCount}\n            accent=\"text-blue-300\"\n            helper=\"Recognised search queries\"\n            icon={<Search size={16} className=\"text-blue-300\" />}\n          />\n          <StorageUsageCard\n            usage={storageInfo?.usage ?? 0}\n            quota={storageInfo?.quota ?? 0}\n            percent={storageInfo?.percent ?? 0}\n            updatedAt={storageInfo?.updatedAt ?? 0}\n            status={storageStatus}\n            onRefresh={handleRefreshStorage}\n          />\n        </div>\n\n        {/* Search bar */}\n        <div className=\"relative\">\n          <Search size={18} className=\"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500\" />\n          <input\n            type=\"text\"\n            value={searchQuery}\n            onChange={e => setSearchQuery(e.target.value)}\n            placeholder=\"Search history\"\n            className=\"h-10 w-full rounded-lg border border-gray-700/50 bg-gray-900/60 pl-10 pr-4 text-gray-200 placeholder-gray-500 focus:border-blue-500/50 focus:outline-none focus:ring-2 focus:ring-blue-500/50\"\n          />\n          {searching && (\n            <Loader2\n              size={16}\n              className={`absolute top-1/2 -translate-y-1/2 animate-spin text-blue-400 ${\n                searchQuery ? 'right-9' : 'right-3'\n              }`}\n            />\n          )}\n          {searchQuery && (\n            <button\n              onClick={() => setSearchQuery('')}\n              className=\"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-300\"\n            >\n              <X size={18} />\n            </button>\n          )}\n        </div>\n        <div className=\"mt-3 flex items-center gap-2 text-xs text-gray-400\">\n          <Filter size={14} />\n          <FilterChip\n            active={activeFilter === 'all'}\n            onClick={() => setActiveFilter('all')}\n            label=\"All\"\n          />\n          <FilterChip\n            active={activeFilter === 'search'}\n            onClick={() => setActiveFilter('search')}\n            label=\"Search\"\n          />\n          <FilterChip\n            active={activeFilter === 'secure'}\n            onClick={() => setActiveFilter('secure')}\n            label=\"Secure\"\n          />\n          <FilterChip\n            active={activeFilter === 'insecure'}\n            onClick={() => setActiveFilter('insecure')}\n            label=\"Insecure\"\n          />\n        </div>\n      </div>\n\n      {/* History list */}\n      <div className=\"grid flex-1 grid-cols-1 gap-4 overflow-y-auto p-6 xl:grid-cols-[2fr_minmax(280px,1fr)]\">\n        <div>\n          {searchResults && (\n            <div className=\"mb-4 flex items-center gap-2 text-xs text-blue-300\">\n              <Search size={14} />\n              <span>\n                Showing {totalResultCount} high-relevance result{totalResultCount === 1 ? '' : 's'}{' '}\n                for “{searchQuery.trim()}”\n              </span>\n            </div>\n          )}\n          {groupedHistory.length === 0 ? (\n            <div className=\"flex h-full flex-col items-center justify-center text-center\">\n              <Globe size={48} className=\"mb-4 text-gray-600\" />\n              <h3 className=\"mb-2 text-lg font-semibold text-gray-300\">\n                {searchQuery ? 'No results found' : 'No history yet'}\n              </h3>\n              <p className=\"text-sm text-gray-500\">\n                {searchQuery ? 'Try a different search term' : 'Pages you visit will appear here'}\n              </p>\n            </div>\n          ) : (\n            <div className=\"space-y-6\">\n              {groupedHistory.map(group => (\n                <div key={group.date}>\n                  <h3 className=\"mb-3 text-sm font-semibold uppercase tracking-wide text-gray-400\">\n                    {group.date}\n                  </h3>\n                  <div className=\"space-y-1\">\n                    {group.entries.map(entry => (\n                      <motion.div\n                        key={entry.id}\n                        initial={{ opacity: 0, y: 10 }}\n                        animate={{ opacity: 1, y: 0 }}\n                        className={`group flex cursor-pointer items-center gap-3 rounded-lg border bg-gray-900/60 p-3 transition-all hover:bg-gray-900/80 ${\n                          selectedEntry?.id === entry.id\n                            ? 'border-blue-500/40 shadow-[0_0_0_1px_rgba(59,130,246,0.35)]'\n                            : 'border-gray-800/50 hover:border-gray-700/50'\n                        }`}\n                        onClick={() => setSelectedEntry(entry)}\n                      >\n                        {/* Favicon */}\n                        <div className=\"flex h-8 w-8 flex-shrink-0 items-center justify-center rounded border border-gray-700/50 bg-gray-800/50\">\n                          {entry.favicon || getFaviconUrl(entry.url) ? (\n                            <img\n                              src={entry.favicon || getFaviconUrl(entry.url)}\n                              alt=\"\"\n                              className=\"h-6 w-6\"\n                              onError={e => {\n                                (e.target as HTMLImageElement).style.display = 'none';\n                              }}\n                            />\n                          ) : (\n                            <Globe size={16} className=\"text-gray-500\" />\n                          )}\n                        </div>\n\n                        {/* Content */}\n                        <div className=\"min-w-0 flex-1\">\n                          <div className=\"mb-1 flex items-center justify-between gap-2\">\n                            <span className=\"truncate font-medium text-gray-200\">\n                              {searchQuery\n                                ? highlightQuery(entry.title || entry.url, searchQuery)\n                                : entry.title || entry.url}\n                            </span>\n                            <span className=\"flex-shrink-0 text-xs text-gray-500\">\n                              {formatTime(entry.lastVisitTime ?? entry.timestamp)}\n                            </span>\n                          </div>\n                          <div className=\"flex items-center justify-between gap-2\">\n                            <span className=\"truncate text-xs text-gray-400\">\n                              {searchQuery ? highlightQuery(entry.url, searchQuery) : entry.url}\n                            </span>\n                            <div className=\"flex flex-shrink-0 items-center gap-2\">\n                              {entry.visitCount && entry.visitCount > 1 && (\n                                <span className=\"text-xs text-gray-500\">\n                                  {entry.visitCount} visits\n                                </span>\n                              )}\n                              {detectSearchQuery(entry.url) && (\n                                <span className=\"rounded-full border border-blue-500/30 bg-blue-500/15 px-2 py-0.5 text-[10px] uppercase tracking-wide text-blue-300\">\n                                  Search\n                                </span>\n                              )}\n                              {(() => {\n                                try {\n                                  const protocol = new URL(entry.url).protocol;\n                                  return (\n                                    <span\n                                      className={`rounded-full border px-2 py-0.5 text-[10px] uppercase tracking-wide ${\n                                        protocol === 'https:'\n                                          ? 'border-emerald-500/30 bg-emerald-500/15 text-emerald-300'\n                                          : 'border-amber-500/30 bg-amber-500/15 text-amber-200'\n                                      }`}\n                                    >\n                                      {protocol === 'https:' ? 'Secure' : 'Insecure'}\n                                    </span>\n                                  );\n                                } catch {\n                                  return null;\n                                }\n                              })()}\n                            </div>\n                          </div>\n                        </div>\n\n                        {/* Delete button */}\n                        <motion.button\n                          onClick={e => {\n                            e.stopPropagation();\n                            handleDeleteEntry(entry.url);\n                          }}\n                          whileHover={{ scale: 1.1 }}\n                          whileTap={{ scale: 0.9 }}\n                          className=\"flex-shrink-0 rounded-lg p-1.5 text-gray-500 opacity-0 transition-all hover:bg-red-600/20 hover:text-red-400 group-hover:opacity-100\"\n                          title=\"Remove from history\"\n                        >\n                          <X size={16} />\n                        </motion.button>\n                      </motion.div>\n                    ))}\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n        <aside className=\"hidden xl:block\">\n          {selectedEntry ? (\n            <HistoryDetailsPanel\n              entry={selectedEntry}\n              detectSearchQuery={detectSearchQuery}\n              formatRelative={formatRelativeTimeFromNow}\n              onOpen={() => handleNavigate(selectedEntry.url)}\n              onCopy={() => {\n                if (navigator?.clipboard?.writeText) {\n                  navigator.clipboard.writeText(selectedEntry.url).catch(console.error);\n                }\n              }}\n              onRemove={() => handleDeleteEntry(selectedEntry.url)}\n            />\n          ) : (\n            <div className=\"sticky top-6 flex min-h-[240px] flex-col items-center justify-center rounded-xl border border-gray-800/60 bg-gray-900/40 p-4 text-sm text-gray-500\">\n              <Globe size={28} className=\"mb-3 text-gray-600\" />\n              <p>Select a history item to see details, cached parameters, and quick actions.</p>\n            </div>\n          )}\n        </aside>\n      </div>\n    </div>\n  );\n}\n\nfunction FilterChip({\n  active,\n  label,\n  onClick,\n}: {\n  active: boolean;\n  label: string;\n  onClick: () => void;\n}) {\n  return (\n    <button\n      type=\"button\"\n      onClick={onClick}\n      className={`flex items-center gap-1 rounded-full border px-2.5 py-1 text-xs transition-colors ${\n        active\n          ? 'border-blue-500/40 bg-blue-500/15 text-blue-200'\n          : 'border-gray-700/60 bg-gray-900/40 text-gray-400 hover:border-gray-600 hover:text-gray-200'\n      }`}\n    >\n      {label}\n    </button>\n  );\n}\n\nfunction HistoryStatCard({\n  label,\n  value,\n  helper,\n  icon,\n  accent,\n}: {\n  label: string;\n  value: number;\n  helper: string;\n  icon: ReactNode;\n  accent: string;\n}) {\n  return (\n    <div className=\"flex items-center gap-3 rounded-lg border border-gray-800/60 bg-gray-900/40 px-3 py-2 text-xs text-gray-400\">\n      <div className=\"flex h-8 w-8 items-center justify-center rounded-md border border-gray-700/50 bg-gray-800/60\">\n        {icon}\n      </div>\n      <div className=\"flex flex-col\">\n        <span className=\"text-[10px] uppercase tracking-[0.24em] text-gray-500\">{label}</span>\n        <span className={`text-base font-semibold ${accent}`}>{value}</span>\n        <span className=\"text-[10px] text-gray-500\">{helper}</span>\n      </div>\n    </div>\n  );\n}\n\nfunction StorageUsageCard({\n  usage,\n  quota,\n  percent,\n  status,\n  updatedAt,\n  onRefresh,\n}: {\n  usage: number;\n  quota: number;\n  percent: number;\n  status: 'idle' | 'loading' | 'error';\n  updatedAt: number;\n  onRefresh: () => void;\n}) {\n  const percentClamped = Number.isFinite(percent) ? Math.max(0, Math.min(100, percent)) : 0;\n  const usageLabel = formatBytesReadable(usage);\n  const quotaLabel = quota > 0 ? formatBytesReadable(quota) : '—';\n  const percentLabel = `${percentClamped >= 10 ? Math.round(percentClamped) : percentClamped.toFixed(1)}%`;\n  const updatedLabel = updatedAt ? formatRelativeTimeFromNow(updatedAt) : 'moments ago';\n\n  return (\n    <div className=\"flex min-w-[200px] flex-col gap-2 rounded-lg border border-gray-800/60 bg-gray-900/40 px-3 py-2 text-xs text-gray-400\">\n      <div className=\"flex items-start justify-between gap-2\">\n        <div className=\"flex items-center gap-3\">\n          <div className=\"flex h-8 w-8 items-center justify-center rounded-md border border-gray-700/50 bg-gray-800/60\">\n            <HardDrive size={16} className=\"text-indigo-300\" />\n          </div>\n          <div className=\"flex flex-col\">\n            <span className=\"text-[10px] uppercase tracking-[0.24em] text-gray-500\">\n              Cache usage\n            </span>\n            <span className=\"text-base font-semibold text-indigo-200\">{usageLabel}</span>\n            <span className=\"text-[10px] text-gray-500\">\n              of {quotaLabel} ({percentLabel})\n            </span>\n          </div>\n        </div>\n        <button\n          type=\"button\"\n          onClick={onRefresh}\n          disabled={status === 'loading'}\n          className=\"rounded-md border border-gray-700/60 p-1.5 text-gray-400 transition-colors hover:border-indigo-400/40 hover:text-indigo-200 disabled:cursor-not-allowed disabled:opacity-60\"\n          title=\"Refresh storage estimate\"\n        >\n          <RefreshCw\n            size={14}\n            className={status === 'loading' ? 'animate-spin text-indigo-200' : 'text-current'}\n          />\n        </button>\n      </div>\n      <div className=\"h-2 w-full overflow-hidden rounded-full bg-gray-800\">\n        <div\n          className=\"h-full bg-gradient-to-r from-indigo-400 to-blue-500 transition-[width] duration-300\"\n          style={{ width: `${percentClamped}%` }}\n          aria-valuenow={percentClamped}\n          aria-valuemin={0}\n          aria-valuemax={100}\n        />\n      </div>\n      <div className=\"text-[10px] text-gray-500\">\n        Updated {status === 'loading' ? '…' : updatedLabel}\n      </div>\n      {status === 'error' && (\n        <div className=\"text-[10px] text-amber-300\">\n          Storage estimate unavailable in this environment.\n        </div>\n      )}\n    </div>\n  );\n}\n\nfunction HistoryDetailsPanel({\n  entry,\n  detectSearchQuery,\n  formatRelative,\n  onOpen,\n  onCopy,\n  onRemove,\n}: {\n  entry: HistoryEntry;\n  detectSearchQuery: (url: string) => string | null;\n  formatRelative: (timestamp: number) => string;\n  onOpen: () => void;\n  onCopy: () => void;\n  onRemove: () => void;\n}) {\n  let parsed: URL | null = null;\n  try {\n    parsed = new URL(entry.url);\n  } catch {\n    parsed = null;\n  }\n\n  const query = parsed ? detectSearchQuery(entry.url) : null;\n  const params = parsed ? Array.from(parsed.searchParams.entries()) : [];\n  const cacheWindowMs =\n    entry.lastVisitTime && entry.lastVisitTime > entry.timestamp\n      ? entry.lastVisitTime - entry.timestamp\n      : 0;\n\n  return (\n    <div className=\"sticky top-6 space-y-4 rounded-xl border border-gray-800/60 bg-gray-900/50 p-4 text-sm text-gray-300 shadow-[0_18px_45px_rgba(15,23,42,0.35)]\">\n      <div className=\"flex items-start justify-between gap-3\">\n        <div>\n          <h4 className=\"text-base font-semibold text-gray-100\">\n            {entry.title || 'Untitled page'}\n          </h4>\n          <p className=\"break-all text-xs text-gray-500\">{entry.url}</p>\n        </div>\n        <div className=\"flex gap-1.5\">\n          <button\n            type=\"button\"\n            onClick={onOpen}\n            className=\"rounded-md border border-blue-500/30 bg-blue-500/15 p-1.5 text-blue-200 transition-colors hover:bg-blue-500/25\"\n            title=\"Open in a new tab\"\n          >\n            <ExternalLink size={14} />\n          </button>\n          <button\n            type=\"button\"\n            onClick={onCopy}\n            className=\"rounded-md border border-gray-700/60 bg-gray-800/60 p-1.5 text-gray-400 transition-colors hover:bg-gray-800 hover:text-gray-100\"\n            title=\"Copy URL\"\n          >\n            <Copy size={14} />\n          </button>\n          <button\n            type=\"button\"\n            onClick={onRemove}\n            className=\"rounded-md border border-red-500/40 bg-red-500/15 p-1.5 text-red-200 transition-colors hover:bg-red-500/25\"\n            title=\"Remove from history\"\n          >\n            <Trash2 size={14} />\n          </button>\n        </div>\n      </div>\n\n      <div className=\"space-y-2 text-xs text-gray-400\">\n        <div className=\"flex items-center gap-2\">\n          <span className=\"text-[10px] uppercase tracking-[0.2em] text-gray-500\">First visit</span>\n          <span className=\"text-gray-300\">{new Date(entry.timestamp).toLocaleString()}</span>\n          <span className=\"text-gray-500\">{formatRelative(entry.timestamp)}</span>\n        </div>\n        {entry.lastVisitTime && (\n          <div className=\"flex flex-wrap items-center gap-2\">\n            <span className=\"text-[10px] uppercase tracking-[0.2em] text-gray-500\">Last visit</span>\n            <span className=\"text-gray-300\">{new Date(entry.lastVisitTime).toLocaleString()}</span>\n            <span className=\"text-gray-500\">{formatRelative(entry.lastVisitTime)}</span>\n          </div>\n        )}\n        {entry.visitCount && (\n          <div className=\"flex items-center gap-2\">\n            <span className=\"text-[10px] uppercase tracking-[0.2em] text-gray-500\">Visits</span>\n            <span className=\"text-gray-300\">{entry.visitCount}</span>\n          </div>\n        )}\n        {cacheWindowMs > 0 && (\n          <div className=\"flex items-center gap-2\">\n            <span className=\"text-[10px] uppercase tracking-[0.2em] text-gray-500\">Cache span</span>\n            <span className=\"text-gray-300\">{formatDurationFromMs(cacheWindowMs)}</span>\n          </div>\n        )}\n        {parsed && (\n          <>\n            <div className=\"flex items-center gap-2\">\n              <span className=\"text-[10px] uppercase tracking-[0.2em] text-gray-500\">Domain</span>\n              <span className=\"text-gray-300\">{parsed.hostname}</span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <span className=\"text-[10px] uppercase tracking-[0.2em] text-gray-500\">Protocol</span>\n              <span\n                className={`rounded-full border px-2 py-0.5 ${\n                  parsed.protocol === 'https:'\n                    ? 'border-emerald-500/30 bg-emerald-500/15 text-emerald-200'\n                    : 'border-amber-500/30 bg-amber-500/15 text-amber-200'\n                }`}\n              >\n                {parsed.protocol.replace(':', '').toUpperCase()}\n              </span>\n            </div>\n          </>\n        )}\n      </div>\n\n      {query && (\n        <div className=\"space-y-1 rounded-lg border border-blue-500/30 bg-blue-500/10 p-3 text-xs text-blue-100\">\n          <div className=\"flex items-center gap-2 font-semibold text-blue-200\">\n            <Search size={14} />\n            Recognised search query\n          </div>\n          <p className=\"text-sm text-blue-100\">{query}</p>\n        </div>\n      )}\n\n      {params.length > 0 && (\n        <div className=\"space-y-2\">\n          <h5 className=\"text-xs uppercase tracking-[0.24em] text-gray-500\">Query Parameters</h5>\n          <div className=\"space-y-1\">\n            {params.map(([key, value]) => (\n              <div\n                key={key}\n                className=\"flex items-start gap-2 rounded-md border border-gray-800/50 bg-gray-900/50 px-2 py-1 text-xs text-gray-400\"\n              >\n                <span className=\"min-w-[80px] font-medium text-gray-300\">{key}</span>\n                <span className=\"break-all text-gray-400\">{value || '—'}</span>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nconst RELATIVE_UNITS: Array<{ unit: Intl.RelativeTimeFormatUnit; ms: number }> = [\n  { unit: 'year', ms: 1000 * 60 * 60 * 24 * 365 },\n  { unit: 'month', ms: 1000 * 60 * 60 * 24 * 30 },\n  { unit: 'week', ms: 1000 * 60 * 60 * 24 * 7 },\n  { unit: 'day', ms: 1000 * 60 * 60 * 24 },\n  { unit: 'hour', ms: 1000 * 60 * 60 },\n  { unit: 'minute', ms: 1000 * 60 },\n  { unit: 'second', ms: 1000 },\n];\n\nconst RELATIVE_TIME_FORMATTER = new Intl.RelativeTimeFormat(undefined, { numeric: 'auto' });\n\nfunction formatRelativeTimeFromNow(timestamp: number): string {\n  const diff = timestamp - Date.now();\n  const absDiff = Math.abs(diff);\n\n  for (const { unit, ms } of RELATIVE_UNITS) {\n    if (absDiff >= ms || unit === 'second') {\n      const value = Math.round(diff / ms);\n      return RELATIVE_TIME_FORMATTER.format(value, unit);\n    }\n  }\n\n  return '';\n}\n\nfunction formatBytesReadable(bytes: number): string {\n  if (!Number.isFinite(bytes) || bytes <= 0) return '0 B';\n  const units = ['B', 'KB', 'MB', 'GB', 'TB'];\n  const exponent = Math.min(units.length - 1, Math.floor(Math.log(bytes) / Math.log(1024)));\n  const value = bytes / Math.pow(1024, exponent);\n  return `${value >= 100 ? Math.round(value) : Math.round(value * 10) / 10} ${units[exponent]}`;\n}\n\nfunction formatDurationFromMs(ms: number): string {\n  if (!Number.isFinite(ms) || ms <= 0) return '—';\n  let remaining = Math.floor(ms / 1000);\n  const units = [\n    { label: 'd', value: 86400 },\n    { label: 'h', value: 3600 },\n    { label: 'm', value: 60 },\n  ];\n  const parts: string[] = [];\n\n  for (const { label, value } of units) {\n    if (remaining >= value) {\n      const amount = Math.floor(remaining / value);\n      remaining -= amount * value;\n      parts.push(`${amount}${label}`);\n    }\n  }\n\n  if (parts.length === 0) {\n    parts.push(`${Math.max(1, remaining)}s`);\n  }\n\n  return parts.join(' ');\n}\n"],"names":["useIPCEvent","event","callback","deps","useEffect","ipcEvents","HistoryPage","navigate","useNavigate","items","setItems","useState","searchQuery","setSearchQuery","loading","setLoading","selectedEntry","setSelectedEntry","activeFilter","setActiveFilter","searchResults","setSearchResults","searching","setSearching","storageInfo","setStorageInfo","storageStatus","setStorageStatus","mountedRef","useRef","list","ipc","error","query","cancelled","results","updateStorageEstimate","useCallback","usage","quota","percent","interval","handleRefreshStorage","derivedStats","useMemo","uniqueDomains","secureCount","insecureCount","searchCount","entry","urlObj","detectSearchQuery","groupedHistory","sourceItems","filtered","groups","now","oneDay","oneWeek","oneMonth","baseTime","diff","groupKey","date","entries","a","b","order","totalResultCount","sum","group","handleClearHistory","handleDeleteEntry","url","e","prev","handleNavigate","formatTime","timestamp","formatRelativeTimeFromNow","getFaviconUrl","host","params","highlightQuery","text","regex","escapeRegExp","part","index","jsx","value","Clock","jsxs","BarChart2","motion","Trash2","HistoryStatCard","ShieldCheck","AlertTriangle","Search","StorageUsageCard","Loader2","X","Filter","FilterChip","Globe","protocol","HistoryDetailsPanel","active","label","onClick","helper","icon","accent","status","updatedAt","onRefresh","percentClamped","usageLabel","formatBytesReadable","quotaLabel","percentLabel","updatedLabel","HardDrive","RefreshCw","formatRelative","onOpen","onCopy","onRemove","parsed","cacheWindowMs","ExternalLink","Copy","formatDurationFromMs","Fragment","key","RELATIVE_UNITS","RELATIVE_TIME_FORMATTER","absDiff","unit","ms","bytes","units","exponent","remaining","parts","amount"],"mappings":"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"}