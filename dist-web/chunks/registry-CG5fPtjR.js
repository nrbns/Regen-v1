import{l as t,f as o,t as a}from"./mode-research-BclgCwOH.js";import"./core-ai-yFIunLTZ.js";import"./vendor-zustand-BWsgwsXr.js";import"./vendor-react-gmX1Lmvt.js";import"./vendor-react-dom-Bkb6jJ_S.js";import"./vendor-Vl2WtvH-.js";import"./mode-manager.ts-DwguZmJt.js";import"./core-memory-DmK-uh9X.js";import"./vendor-utils-5Vdoy44w.js";import"./mode-docs-FcsoolLb.js";import"./vendor-pdf-ejcqEZLU.js";import"./vendor-mammoth-BPQIafDs.js";import"./vendor-framer-motion-DDE19Uim.js";var u=Object.defineProperty,f=(s,e,r)=>e in s?u(s,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[e]=r,g=(s,e,r)=>f(s,typeof e!="symbol"?e+"":e,r);class d{constructor(){g(this,"plugins",new Map),g(this,"panels",new Map)}register(e){if(this.plugins.has(e.id)){t.warn(`[PluginRegistry] Plugin ${e.id} already registered, skipping`);return}if(this.plugins.set(e.id,e),e.registerTools&&e.enabled)try{e.registerTools(o),t.info(`[PluginRegistry] Registered tools from plugin: ${e.id}`)}catch(r){t.error(`[PluginRegistry] Failed to register tools from ${e.id}:`,r)}if(e.registerPanels&&e.enabled)try{const r=e.registerPanels();r.forEach(i=>{this.panels.set(i.id,i)}),t.info(`[PluginRegistry] Registered ${r.length} panels from plugin: ${e.id}`)}catch(r){t.error(`[PluginRegistry] Failed to register panels from ${e.id}:`,r)}t.info(`[PluginRegistry] Registered plugin: ${e.id} v${e.version}`),a("plugin_registered",{pluginId:e.id,version:e.version})}async enable(e){const r=this.plugins.get(e);if(!r)return t.warn(`[PluginRegistry] Plugin not found: ${e}`),!1;if(r.enabled)return!0;try{return r.enabled=!0,r.registerTools&&r.registerTools(o),r.registerPanels&&r.registerPanels().forEach(n=>{this.panels.set(n.id,n)}),r.onEnable&&await r.onEnable(),this.persistPluginState(),t.info(`[PluginRegistry] Enabled plugin: ${e}`),a("plugin_enabled",{pluginId:e}),!0}catch(i){return t.error(`[PluginRegistry] Failed to enable plugin ${e}:`,i),r.enabled=!1,!1}}async disable(e){const r=this.plugins.get(e);if(!r)return t.warn(`[PluginRegistry] Plugin not found: ${e}`),!1;if(!r.enabled)return!0;try{return r.onDisable&&await r.onDisable(),r.enabled=!1,this.persistPluginState(),t.info(`[PluginRegistry] Disabled plugin: ${e}`),a("plugin_disabled",{pluginId:e}),!0}catch(i){return t.error(`[PluginRegistry] Failed to disable plugin ${e}:`,i),!1}}getAll(){return Array.from(this.plugins.values())}getEnabled(){return Array.from(this.plugins.values()).filter(e=>e.enabled)}get(e){return this.plugins.get(e)}getPanelsForMode(e){return Array.from(this.panels.values()).filter(r=>!r.mode||r.mode===e)}getAllPanels(){return Array.from(this.panels.values())}async loadFromFolder(e){t.info(`[PluginRegistry] Loading plugins from: ${e}`)}persistPluginState(){const e=Array.from(this.plugins.values()).map(r=>({id:r.id,enabled:r.enabled}));localStorage.setItem("regen_plugins_state",JSON.stringify(e))}restorePluginState(){try{const e=localStorage.getItem("regen_plugins_state");if(!e)return;JSON.parse(e).forEach(({id:i,enabled:n})=>{const l=this.plugins.get(i);l&&(l.enabled=n)})}catch(e){t.error("[PluginRegistry] Failed to restore plugin state:",e)}}}const S=new d;export{S as pluginRegistry};
//# sourceMappingURL=registry-CG5fPtjR.js.map
