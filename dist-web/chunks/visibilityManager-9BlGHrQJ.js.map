{"version":3,"file":"visibilityManager-9BlGHrQJ.js","sources":["../../src/utils/visibilityManager.ts"],"sourcesContent":["/**\r\n * Visibility Manager - Pause heavy tasks when tab is hidden\r\n * Reduces CPU/battery drain when app is in background\r\n */\r\n\r\ntype VisibilityCallback = () => void;\r\n\r\nclass VisibilityManager {\r\n  private callbacks: Set<VisibilityCallback> = new Set();\r\n  private isVisible: boolean = !document.hidden;\r\n\r\n  constructor() {\r\n    if (typeof document !== 'undefined') {\r\n      document.addEventListener('visibilitychange', this.handleVisibilityChange);\r\n    }\r\n  }\r\n\r\n  private handleVisibilityChange = () => {\r\n    const wasVisible = this.isVisible;\r\n    this.isVisible = !document.hidden;\r\n\r\n    if (wasVisible && !this.isVisible) {\r\n      // Tab became hidden - pause heavy tasks\r\n      this.callbacks.forEach(callback => {\r\n        try {\r\n          callback();\r\n        } catch (error) {\r\n          console.error('[VisibilityManager] Error in callback:', error);\r\n        }\r\n      });\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Register a callback to be called when tab becomes hidden\r\n   */\r\n  onHidden(callback: VisibilityCallback): () => void {\r\n    this.callbacks.add(callback);\r\n    return () => {\r\n      this.callbacks.delete(callback);\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Check if tab is currently visible\r\n   */\r\n  isTabVisible(): boolean {\r\n    return this.isVisible;\r\n  }\r\n\r\n  /**\r\n   * Cleanup\r\n   */\r\n  destroy(): void {\r\n    if (typeof document !== 'undefined') {\r\n      document.removeEventListener('visibilitychange', this.handleVisibilityChange);\r\n    }\r\n    this.callbacks.clear();\r\n  }\r\n}\r\n\r\n// Singleton instance\r\nexport const visibilityManager = new VisibilityManager();\r\n\r\n"],"names":["VisibilityManager","__publicField","wasVisible","callback","error","visibilityManager"],"mappings":"4JAOA,MAAMA,CAAkB,CAItB,aAAc,CAHdC,EAAA,KAAQ,gBAAyC,GAAI,EACrDA,EAAA,KAAQ,YAAqB,CAAC,SAAS,MAAA,EAQvCA,EAAA,KAAQ,yBAAyB,IAAM,CACrC,MAAMC,EAAa,KAAK,UACxB,KAAK,UAAY,CAAC,SAAS,OAEvBA,GAAc,CAAC,KAAK,WAEtB,KAAK,UAAU,QAAQC,GAAY,CACjC,GAAI,CACFA,EAAA,CACF,OAASC,EAAO,CACd,QAAQ,MAAM,yCAA0CA,CAAK,CAC/D,CACF,CAAC,CAEL,CAAA,EAnBM,OAAO,SAAa,KACtB,SAAS,iBAAiB,mBAAoB,KAAK,sBAAsB,CAE7E,CAqBA,SAASD,EAA0C,CACjD,YAAK,UAAU,IAAIA,CAAQ,EACpB,IAAM,CACX,KAAK,UAAU,OAAOA,CAAQ,CAChC,CACF,CAKA,cAAwB,CACtB,OAAO,KAAK,SACd,CAKA,SAAgB,CACV,OAAO,SAAa,KACtB,SAAS,oBAAoB,mBAAoB,KAAK,sBAAsB,EAE9E,KAAK,UAAU,MAAA,CACjB,CACF,CAGO,MAAME,EAAoB,IAAIL"}