{"version":3,"file":"dataService-HUHZrGu9.js","sources":["../../src/core/trade/dataService.ts"],"sourcesContent":["const API_BASE = import.meta.env.VITE_TRADE_API_BASE || 'https://www.alphavantage.co/query';\r\nconst API_KEY = import.meta.env.VITE_TRADE_API_KEY || 'demo';\r\n\r\nexport interface TradeQuote {\r\n  symbol: string;\r\n  price: number;\r\n  change: number;\r\n  changePercent: number;\r\n  previousClose?: number;\r\n  volume?: number;\r\n  updatedAt: number;\r\n  sparkline: number[];\r\n  sentiment?: 'bullish' | 'neutral' | 'bearish';\r\n}\r\n\r\nexport async function fetchTradeQuote(symbol: string): Promise<TradeQuote> {\r\n  try {\r\n    const url = `${API_BASE}?function=GLOBAL_QUOTE&symbol=${encodeURIComponent(symbol)}&apikey=${API_KEY}`;\r\n    const response = await fetch(url);\r\n    if (!response.ok) {\r\n      throw new Error(`Trade API error: ${response.statusText}`);\r\n    }\r\n    const data = await response.json();\r\n    const quote = data['Global Quote'];\r\n    if (!quote) {\r\n      throw new Error('No quote data returned');\r\n    }\r\n\r\n    const price = Number.parseFloat(quote['05. price']);\r\n    const previousClose = Number.parseFloat(quote['08. previous close']);\r\n    const change = Number.parseFloat(quote['09. change']);\r\n    const changePercent = Number.parseFloat((quote['10. change percent'] || '0%').replace('%', ''));\r\n    const volume = Number.parseFloat(quote['06. volume']);\r\n\r\n    return {\r\n      symbol: quote['01. symbol'] || symbol,\r\n      price,\r\n      change,\r\n      changePercent,\r\n      previousClose,\r\n      volume,\r\n      updatedAt: Date.now(),\r\n      sparkline: generateSparkline(price, change),\r\n      sentiment: determineSentiment(changePercent),\r\n    };\r\n  } catch (error) {\r\n    console.warn('[TradeData] Falling back to synthetic quote:', error);\r\n    return createSyntheticQuote(symbol);\r\n  }\r\n}\r\n\r\nfunction generateSparkline(price: number, change: number): number[] {\r\n  const points = 20;\r\n  const base = price - change;\r\n  const spark: number[] = [];\r\n  for (let i = 0; i < points; i++) {\r\n    const noise = (Math.random() - 0.5) * (Math.abs(change) * 0.1);\r\n    spark.push(Math.max(base * 0.9, price + noise - change * ((points - i) / points)));\r\n  }\r\n  return spark;\r\n}\r\n\r\nfunction determineSentiment(changePercent: number): 'bullish' | 'neutral' | 'bearish' {\r\n  if (changePercent > 1) return 'bullish';\r\n  if (changePercent < -1) return 'bearish';\r\n  return 'neutral';\r\n}\r\n\r\nfunction createSyntheticQuote(symbol: string): TradeQuote {\r\n  const price = 100 + Math.random() * 50;\r\n  const changePercent = (Math.random() - 0.5) * 4;\r\n  const change = (price * changePercent) / 100;\r\n  return {\r\n    symbol,\r\n    price,\r\n    change,\r\n    changePercent,\r\n    previousClose: price - change,\r\n    volume: Math.round(1_000_000 + Math.random() * 5_000_000),\r\n    updatedAt: Date.now(),\r\n    sparkline: generateSparkline(price, change),\r\n    sentiment: determineSentiment(changePercent),\r\n  };\r\n}\r\n\r\n"],"names":["API_BASE","API_KEY","fetchTradeQuote","symbol","url","response","quote","price","previousClose","change","changePercent","volume","generateSparkline","determineSentiment","error","createSyntheticQuote","base","spark","i","noise"],"mappings":"AAAA,MAAMA,EAAkD,oCAClDC,EAAgD,OActD,eAAsBC,EAAgBC,EAAqC,CACzE,GAAI,CACF,MAAMC,EAAM,GAAGJ,CAAQ,iCAAiC,mBAAmBG,CAAM,CAAC,WAAWF,CAAO,GAC9FI,EAAW,MAAM,MAAMD,CAAG,EAChC,GAAI,CAACC,EAAS,GACZ,MAAM,IAAI,MAAM,oBAAoBA,EAAS,UAAU,EAAE,EAG3D,MAAMC,GADO,MAAMD,EAAS,KAAA,GACT,cAAc,EACjC,GAAI,CAACC,EACH,MAAM,IAAI,MAAM,wBAAwB,EAG1C,MAAMC,EAAQ,OAAO,WAAWD,EAAM,WAAW,CAAC,EAC5CE,EAAgB,OAAO,WAAWF,EAAM,oBAAoB,CAAC,EAC7DG,EAAS,OAAO,WAAWH,EAAM,YAAY,CAAC,EAC9CI,EAAgB,OAAO,YAAYJ,EAAM,oBAAoB,GAAK,MAAM,QAAQ,IAAK,EAAE,CAAC,EACxFK,EAAS,OAAO,WAAWL,EAAM,YAAY,CAAC,EAEpD,MAAO,CACL,OAAQA,EAAM,YAAY,GAAKH,EAC/B,MAAAI,EACA,OAAAE,EACA,cAAAC,EACA,cAAAF,EACA,OAAAG,EACA,UAAW,KAAK,IAAA,EAChB,UAAWC,EAAkBL,EAAOE,CAAM,EAC1C,UAAWI,EAAmBH,CAAa,CAAA,CAE/C,OAASI,EAAO,CACd,eAAQ,KAAK,+CAAgDA,CAAK,EAC3DC,EAAqBZ,CAAM,CACpC,CACF,CAEA,SAASS,EAAkBL,EAAeE,EAA0B,CAElE,MAAMO,EAAOT,EAAQE,EACfQ,EAAkB,CAAA,EACxB,QAASC,EAAI,EAAGA,EAAI,GAAQA,IAAK,CAC/B,MAAMC,GAAS,KAAK,OAAA,EAAW,KAAQ,KAAK,IAAIV,CAAM,EAAI,IAC1DQ,EAAM,KAAK,KAAK,IAAID,EAAO,GAAKT,EAAQY,EAAQV,IAAW,GAASS,GAAK,GAAO,CAAC,CACnF,CACA,OAAOD,CACT,CAEA,SAASJ,EAAmBH,EAA0D,CACpF,OAAIA,EAAgB,EAAU,UAC1BA,EAAgB,GAAW,UACxB,SACT,CAEA,SAASK,EAAqBZ,EAA4B,CACxD,MAAMI,EAAQ,IAAM,KAAK,OAAA,EAAW,GAC9BG,GAAiB,KAAK,OAAA,EAAW,IAAO,EACxCD,EAAUF,EAAQG,EAAiB,IACzC,MAAO,CACL,OAAAP,EACA,MAAAI,EACA,OAAAE,EACA,cAAAC,EACA,cAAeH,EAAQE,EACvB,OAAQ,KAAK,MAAM,IAAY,KAAK,OAAA,EAAW,GAAS,EACxD,UAAW,KAAK,IAAA,EAChB,UAAWG,EAAkBL,EAAOE,CAAM,EAC1C,UAAWI,EAAmBH,CAAa,CAAA,CAE/C"}