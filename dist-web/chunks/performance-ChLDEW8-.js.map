{"version":3,"file":"performance-ChLDEW8-.js","sources":["../../src/utils/performance.ts"],"sourcesContent":["/**\n * Performance monitoring utilities\n * Tracks startup time, memory usage, and performance metrics\n */\n\ninterface PerformanceMetrics {\n  timeToFirstPaint?: number;\n  timeToInteractive?: number;\n  timeToLoad?: number;\n  memoryUsage?: number;\n}\n\nclass PerformanceMonitor {\n  private startTime: number;\n  private metrics: PerformanceMetrics = {};\n  private observers: PerformanceObserver[] = [];\n\n  constructor() {\n    this.startTime = performance.now();\n    this.init();\n  }\n\n  private init() {\n    // Measure Time to First Paint (TTFP)\n    if (typeof window !== 'undefined' && 'requestIdleCallback' in window) {\n      requestIdleCallback(() => {\n        this.metrics.timeToFirstPaint = performance.now() - this.startTime;\n        this.logMetric('timeToFirstPaint', this.metrics.timeToFirstPaint);\n      });\n    }\n\n    // Measure Time to Interactive (TTI)\n    if (document.readyState === 'complete') {\n      this.measureTTI();\n    } else {\n      window.addEventListener('load', () => this.measureTTI());\n    }\n\n    // Monitor memory usage (if available)\n    if ('memory' in performance) {\n      this.monitorMemory();\n    }\n\n    // Track navigation timing\n    this.trackNavigationTiming();\n  }\n\n  private measureTTI() {\n    // Time to Interactive: when DOM is ready and main thread is idle\n    if (document.readyState === 'complete') {\n      const loadTime = performance.now() - this.startTime;\n      this.metrics.timeToLoad = loadTime;\n      this.logMetric('timeToLoad', loadTime);\n\n      // TTI is typically when all critical resources are loaded\n      if (typeof window !== 'undefined' && 'requestIdleCallback' in window) {\n        requestIdleCallback(() => {\n          this.metrics.timeToInteractive = performance.now() - this.startTime;\n          this.logMetric('timeToInteractive', this.metrics.timeToInteractive);\n        });\n      }\n    }\n  }\n\n  private monitorMemory() {\n    const memory = (performance as any).memory;\n    if (memory) {\n      this.metrics.memoryUsage = memory.usedJSHeapSize;\n\n      // Suppress routine memory logs entirely - they're too noisy\n      // Only warn if memory exceeds 500MB (reasonable threshold for modern browsers)\n      // Modern browsers can easily handle 500MB+ of JS heap memory\n      setInterval(() => {\n        const currentMemory = memory.usedJSHeapSize;\n        // Only warn at 500MB+ (suppress warnings below this threshold)\n        if (currentMemory > 500 * 1024 * 1024) {\n          const memoryMB = (currentMemory / 1024 / 1024).toFixed(2);\n          console.warn(`[Perf] High memory usage: ${memoryMB} MB`);\n        }\n        // Suppress all routine memory logs - not useful for debugging\n      }, 60000);\n    }\n  }\n\n  private trackNavigationTiming() {\n    if ('PerformanceObserver' in window) {\n      try {\n        const observer = new PerformanceObserver(list => {\n          for (const entry of list.getEntries()) {\n            if (entry.entryType === 'navigation') {\n              const navEntry = entry as PerformanceNavigationTiming;\n              console.log('[Perf] Navigation timing:', {\n                domContentLoaded:\n                  navEntry.domContentLoadedEventEnd - navEntry.domContentLoadedEventStart,\n                load: navEntry.loadEventEnd - navEntry.loadEventStart,\n                total: navEntry.loadEventEnd - navEntry.fetchStart,\n              });\n            }\n          }\n        });\n        observer.observe({ entryTypes: ['navigation'] });\n        this.observers.push(observer);\n      } catch {\n        // PerformanceObserver not supported\n      }\n    }\n  }\n\n  private logMetric(name: string, value: number) {\n    console.log(`[Perf] ${name}: ${value.toFixed(2)}ms`);\n\n    // Send to telemetry if available\n    if (typeof window !== 'undefined' && (window as any).ipc) {\n      try {\n        (window as any).ipc.telemetry?.trackPerf?.(name, Math.round(value));\n      } catch {\n        // IPC not available\n      }\n    }\n  }\n\n  getMetrics(): PerformanceMetrics {\n    return { ...this.metrics };\n  }\n\n  cleanup() {\n    this.observers.forEach(observer => observer.disconnect());\n    this.observers = [];\n  }\n}\n\n// Singleton instance\nlet performanceMonitor: PerformanceMonitor | null = null;\n\nexport function initPerformanceMonitoring(): PerformanceMonitor {\n  if (!performanceMonitor) {\n    performanceMonitor = new PerformanceMonitor();\n  }\n  return performanceMonitor;\n}\n\nexport function getPerformanceMetrics(): PerformanceMetrics {\n  return performanceMonitor?.getMetrics() || {};\n}\n"],"names":["PerformanceMonitor","__publicField","loadTime","memory","currentMemory","memoryMB","observer","list","entry","navEntry","name","value","performanceMonitor","initPerformanceMonitoring"],"mappings":"4JAYA,MAAMA,CAAmB,CAKvB,aAAc,CAJdC,EAAA,KAAQ,WAAA,EACRA,EAAA,KAAQ,UAA8B,EAAC,EACvCA,EAAA,KAAQ,YAAmC,EAAC,EAG1C,KAAK,UAAY,YAAY,IAAA,EAC7B,KAAK,KAAA,CACP,CAEQ,MAAO,CAET,OAAO,OAAW,KAAe,wBAAyB,QAC5D,oBAAoB,IAAM,CACxB,KAAK,QAAQ,iBAAmB,YAAY,IAAA,EAAQ,KAAK,UACzD,KAAK,UAAU,mBAAoB,KAAK,QAAQ,gBAAgB,CAClE,CAAC,EAIC,SAAS,aAAe,WAC1B,KAAK,WAAA,EAEL,OAAO,iBAAiB,OAAQ,IAAM,KAAK,YAAY,EAIrD,WAAY,aACd,KAAK,cAAA,EAIP,KAAK,sBAAA,CACP,CAEQ,YAAa,CAEnB,GAAI,SAAS,aAAe,WAAY,CACtC,MAAMC,EAAW,YAAY,IAAA,EAAQ,KAAK,UAC1C,KAAK,QAAQ,WAAaA,EAC1B,KAAK,UAAU,aAAcA,CAAQ,EAGjC,OAAO,OAAW,KAAe,wBAAyB,QAC5D,oBAAoB,IAAM,CACxB,KAAK,QAAQ,kBAAoB,YAAY,IAAA,EAAQ,KAAK,UAC1D,KAAK,UAAU,oBAAqB,KAAK,QAAQ,iBAAiB,CACpE,CAAC,CAEL,CACF,CAEQ,eAAgB,CACtB,MAAMC,EAAU,YAAoB,OAChCA,IACF,KAAK,QAAQ,YAAcA,EAAO,eAKlC,YAAY,IAAM,CAChB,MAAMC,EAAgBD,EAAO,eAE7B,GAAIC,EAAgB,IAAM,KAAO,KAAM,CACrC,MAAMC,GAAYD,EAAgB,KAAO,MAAM,QAAQ,CAAC,EACxD,QAAQ,KAAK,6BAA6BC,CAAQ,KAAK,CACzD,CAEF,EAAG,GAAK,EAEZ,CAEQ,uBAAwB,CAC9B,GAAI,wBAAyB,OAC3B,GAAI,CACF,MAAMC,EAAW,IAAI,oBAAoBC,GAAQ,CAC/C,UAAWC,KAASD,EAAK,aACvB,GAAIC,EAAM,YAAc,aAAc,CACpC,MAAMC,EAAWD,EACjB,QAAQ,IAAI,4BAA6B,CACvC,iBACEC,EAAS,yBAA2BA,EAAS,2BAC/C,KAAMA,EAAS,aAAeA,EAAS,eACvC,MAAOA,EAAS,aAAeA,EAAS,UAAA,CACzC,CACH,CAEJ,CAAC,EACDH,EAAS,QAAQ,CAAE,WAAY,CAAC,YAAY,EAAG,EAC/C,KAAK,UAAU,KAAKA,CAAQ,CAC9B,MAAQ,CAER,CAEJ,CAEQ,UAAUI,EAAcC,EAAe,CAI7C,GAHA,QAAQ,IAAI,UAAUD,CAAI,KAAKC,EAAM,QAAQ,CAAC,CAAC,IAAI,EAG/C,OAAO,OAAW,KAAgB,OAAe,IACnD,GAAI,CACD,OAAe,IAAI,WAAW,YAAYD,EAAM,KAAK,MAAMC,CAAK,CAAC,CACpE,MAAQ,CAER,CAEJ,CAEA,YAAiC,CAC/B,MAAO,CAAE,GAAG,KAAK,OAAA,CACnB,CAEA,SAAU,CACR,KAAK,UAAU,QAAQL,GAAYA,EAAS,YAAY,EACxD,KAAK,UAAY,CAAA,CACnB,CACF,CAGA,IAAIM,EAAgD,KAE7C,SAASC,GAAgD,CAC9D,OAAKD,IACHA,EAAqB,IAAIZ,GAEpBY,CACT"}