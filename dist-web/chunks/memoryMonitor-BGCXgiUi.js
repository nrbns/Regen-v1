const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["chunks/core-ai-yFIunLTZ.js","chunks/vendor-zustand-BWsgwsXr.js","chunks/vendor-react-gmX1Lmvt.js","chunks/vendor-react-dom-Bkb6jJ_S.js","chunks/vendor-Vl2WtvH-.js","chunks/mode-manager.ts-DwguZmJt.js","chunks/core-memory-DmK-uh9X.js"])))=>i.map(i=>d[i]);
import{_ as m}from"./core-ai-yFIunLTZ.js";import"./vendor-zustand-BWsgwsXr.js";import"./vendor-react-gmX1Lmvt.js";import"./vendor-react-dom-Bkb6jJ_S.js";import"./vendor-Vl2WtvH-.js";import"./mode-manager.ts-DwguZmJt.js";import"./core-memory-DmK-uh9X.js";const d=.8,f=.9,y=2.5,M=5e3;let c=null;function T(){if(typeof process>"u"||!process.memoryUsage){if(typeof performance<"u"&&performance.memory){const r=performance.memory,s=r.jsHeapSizeLimit||r.totalJSHeapSize,i=r.usedJSHeapSize;return{heapUsed:i,heapTotal:s,external:0,rss:i,percentage:s>0?i/s:0}}return null}const e=process.memoryUsage(),n=e.heapTotal+e.external,t=e.heapUsed+e.external;return{heapUsed:e.heapUsed,heapTotal:e.heapTotal,external:e.external,rss:e.rss,percentage:n>0?t/n:0}}function E(e,n){c&&g(),c=setInterval(()=>{const t=T();if(!t)return;const r=t.rss/(1024*1024*1024);r>y||t.percentage>=f?(console.warn(`[MemoryMonitor] Critical memory: ${r.toFixed(2)}GB (${(t.percentage*100).toFixed(1)}%)`),n?.()):t.percentage>=d&&(console.warn(`[MemoryMonitor] Low memory: ${r.toFixed(2)}GB (${(t.percentage*100).toFixed(1)}%)`),e?.())},M)}function g(){c&&(clearInterval(c),c=null)}async function A(){try{const{useTabsStore:e}=await m(async()=>{const{useTabsStore:o}=await import("./core-ai-yFIunLTZ.js").then(a=>a.S);return{useTabsStore:o}},__vite__mapDeps([0,1,2,3,4,5,6])),n=e.getState(),t=n.tabs,r=n.activeId,s=t.filter(o=>o.id!==r&&!o.pinned&&!o.sleeping);if(s.length===0)return 0;const i=s.sort((o,a)=>(o.lastActiveAt||0)-(a.lastActiveAt||0)).slice(0,3);let l=0;for(const o of i)try{const{useTabsStore:a}=await m(async()=>{const{useTabsStore:p}=await import("./core-ai-yFIunLTZ.js").then(u=>u.S);return{useTabsStore:p}},__vite__mapDeps([0,1,2,3,4,5,6]));a.getState().updateTab(o.id,{sleeping:!0}),l++}catch(a){console.warn(`[MemoryMonitor] Failed to unload tab ${o.id}:`,a)}return console.log(`[MemoryMonitor] Unloaded ${l} tabs to free memory`),l}catch(e){return console.error("[MemoryMonitor] Failed to unload tabs:",e),0}}export{T as getMemoryUsage,E as startMemoryMonitoring,g as stopMemoryMonitoring,A as unloadInactiveTabs};
//# sourceMappingURL=memoryMonitor-BGCXgiUi.js.map
