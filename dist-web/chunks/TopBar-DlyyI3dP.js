const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["chunks/core-ai-yFIunLTZ.js","chunks/vendor-zustand-BWsgwsXr.js","chunks/vendor-react-gmX1Lmvt.js","chunks/vendor-react-dom-Bkb6jJ_S.js","chunks/vendor-Vl2WtvH-.js","chunks/mode-manager.ts-DwguZmJt.js","chunks/core-memory-DmK-uh9X.js","chunks/embeddingCache-B2jk-Emn.js","assets/index-D9cF9G1U.js","chunks/mode-research-BclgCwOH.js","chunks/vendor-utils-5Vdoy44w.js","chunks/mode-docs-FcsoolLb.js","chunks/vendor-pdf-ejcqEZLU.js","chunks/vendor-mammoth-BPQIafDs.js","chunks/vendor-framer-motion-DDE19Uim.js","assets/index-D7i95XKH.css"])))=>i.map(i=>d[i]);
import{r as reactExports,N as React,j as jsxRuntimeExports,G as Globe,o as Search,m as TrendingUp,i as Code,bl as Ellipsis,bm as Bell,g as LoaderCircle,E as ExternalLink,ap as Check,$ as useNavigate,bn as Settings2,bo as MonitorCog,bp as SunMedium,ag as Moon,aW as Keyboard,S as Sparkles,X,F as FileText,a2 as BookOpen,bq as Wrench,br as Clipboard,D as Download,aX as Folder,P as Copy,l as Send,a8 as Plus,e as Shield,s as Lock,T as Trash2,al as Eye,aU as Palette,Z as Zap,as as Play,bs as PanelRight,bt as Columns2,aE as Cloud,c as ChevronDown,O as RefreshCw,u as CircleCheck,aT as User,bu as LogOut,am as Star,bf as Loader,bh as CircleCheckBig,h as CircleAlert,v as CircleX,at as Workflow,bv as MessageSquare,bw as CircleHelp}from"./vendor-react-gmX1Lmvt.js";import{b as useAppStore,_ as __vitePreload,u as useSettingsStore,t as toast,a as useTabsStore,f as isWebMode,l as isTauriRuntime}from"./core-ai-yFIunLTZ.js";import{s as showToast,c as cn,t as track,a as useDebounce}from"./mode-research-BclgCwOH.js";import{b as useTokens,c as useSystemStatus,W as WorkflowMarketplace}from"./AppShell-CJtR0Pw4.js";import{m as motion,A as AnimatePresence}from"./vendor-framer-motion-DDE19Uim.js";import{u as useTheme,d as applyPerformanceMode,g as getQueryPrefetcher}from"../assets/index-D9cF9G1U.js";import{u as useBookmarksStore}from"./bookmarksStore-CAScveEF.js";import{invoke}from"@tauri-apps/api/core";import"./vendor-react-dom-Bkb6jJ_S.js";import"./vendor-Vl2WtvH-.js";import"./vendor-zustand-BWsgwsXr.js";import"./mode-manager.ts-DwguZmJt.js";import"./core-memory-DmK-uh9X.js";import"./vendor-utils-5Vdoy44w.js";import"./mode-docs-FcsoolLb.js";import"./vendor-pdf-ejcqEZLU.js";import"./vendor-mammoth-BPQIafDs.js";import"./History-kg0LrAO3.js";import"./Downloads-CU-ngJEB.js";import"./OmniDesk-C5fSodZ1.js";import"./WorkspacesPanel-3geKynW_.js";import"./workspacesStore-BSqEl-CQ.js";import"./tradeStore-CHfkU4NA.js";import"./dataService-HUHZrGu9.js";import"./registry-CG5fPtjR.js";import"./trustDashboardStore-BRaGSCcb.js";const omnixMode={getAvailable:async()=>[{id:"browse",label:"Browse",tools:["tabs","bookmarks","history","extensions"],themeHints:{primary:"blue"}},{id:"research",label:"Research",tools:["memory","search","citations","notes"],themeHints:{primary:"purple"}},{id:"trade",label:"Trade",tools:["charts","orders","portfolio","alerts"],themeHints:{primary:"green"}},{id:"dev",label:"Dev",tools:["console","network","elements","sources"],themeHints:{primary:"orange"}}],shift:async t=>(await new Promise(r=>setTimeout(r,300)),{sessionId:`session-${Date.now()}`,appliedModules:["ui","tools","theme"],success:!0}),preview:async t=>(await new Promise(e=>setTimeout(e,100)),{config:{themeHints:{primary:"blue"}},changes:["UI theme updated","Tools panel changed","Permissions updated"]})};function useModeShift(){const{mode:t,setMode:e}=useAppStore(),[s,r]=reactExports.useState(!1),[a,f]=reactExports.useState(null),d=reactExports.useCallback(async(l,o={})=>{if(s)return null;const i={browse:"Browse",research:"Research",trade:"Trade",dev:"Browse"}[l];if(!i)return showToast("error",`Invalid mode: ${l}`),null;if(t===i&&!o.preview)return null;r(!0);try{if(o.preview)return await omnixMode.preview(l),f(l),{sessionId:"",appliedModules:[],success:!0};o.snapshot&&console.log("[ModeShift] Snapshotting current state...");const j=await omnixMode.shift({to:l,snapshot:o.snapshot});return j.success?(await e(i),showToast("success",`Switched to ${i} mode`)):showToast("error",j.error||"Failed to switch mode"),j}catch(j){return console.error("[ModeShift] Error:",j),showToast("error","Failed to switch mode"),{sessionId:"",appliedModules:[],success:!1,error:j instanceof Error?j.message:"Unknown error"}}finally{r(!1),f(null)}},[t,e,s]),h=reactExports.useCallback(async()=>omnixMode.getAvailable(),[]),g=reactExports.useCallback(()=>{f(null)},[]);return{currentMode:t,isShifting:s,previewMode:a,shiftMode:d,getAvailableModes:h,clearPreview:g}}const MODE_CONFIG=[{id:"browse",label:"Browse",icon:Globe,shortcut:"1"},{id:"research",label:"Research",icon:Search,shortcut:"2"},{id:"trade",label:"Trade",icon:TrendingUp,shortcut:"3"},{id:"dev",label:"Dev",icon:Code,shortcut:"4",comingSoon:!0}];function ModeTabs({className:t,compact:e,onModeChange:s}){const r=useTokens(),{currentMode:a,isShifting:f}=useModeShift(),d=useAppStore(i=>i.setMode),[h,g]=reactExports.useState(null),l=reactExports.useRef({browse:null,research:null,trade:null,dev:null}),o=a==="Browse"?"browse":a==="Research"?"research":a==="Trade"?"trade":"browse",m=React.useCallback(async i=>{if(i===o||f)return;const c={browse:"Browse",research:"Research",trade:"Trade",dev:"Browse"}[i];c&&(await d(c),s&&s(i))},[o,f,d,s]);return reactExports.useEffect(()=>{const i=j=>{if(j.altKey||j.ctrlKey||j.metaKey)return;const c=MODE_CONFIG.find(x=>x.shortcut===j.key);c&&(j.preventDefault(),m(c.id))};return window.addEventListener("keydown",i),()=>window.removeEventListener("keydown",i)},[m]),jsxRuntimeExports.jsxs("div",{className:`flex items-center gap-1 ${t||""}`,role:"tablist","aria-label":"Mode selection",children:[MODE_CONFIG.map(i=>{const j=i.icon,c=o===i.id,x=h===i.id,b=i.comingSoon;return b&&!c?null:jsxRuntimeExports.jsxs("button",{ref:y=>{l.current[i.id]=y},onClick:async y=>{if(y.preventDefault(),y.stopPropagation(),y.nativeEvent?.stopImmediatePropagation&&y.nativeEvent.stopImmediatePropagation(),b){const{toast:w}=await __vitePreload(async()=>{const{toast:p}=await import("./core-ai-yFIunLTZ.js").then(u=>u.P);return{toast:p}},__vite__mapDeps([0,1,2,3,4,5,6]));w.info(`${i.label} mode is coming soon!`);return}await m(i.id)},onMouseDown:y=>{y.stopPropagation()},onMouseEnter:()=>{g(i.id)},onMouseLeave:()=>{g(null)},disabled:f||b,className:`
              relative flex items-center gap-2 px-3 py-2 rounded-lg
              transition-all duration-200
              focus:outline-none focus:ring-2 focus:ring-[var(--color-primary-500)] focus:ring-offset-1
              ${c?"bg-[var(--color-primary-600)] text-white shadow-md":"bg-[var(--surface-elevated)] text-[var(--text-secondary)] hover:bg-[var(--surface-hover)]"}
              ${f?"opacity-50 cursor-wait":b?"opacity-60 cursor-not-allowed":"cursor-pointer"}
              ${e?"px-2 py-1.5":""}
            `,style:{fontSize:e?r.fontSize.xs:r.fontSize.sm},role:"tab","aria-selected":c,"aria-controls":`mode-${i.id}`,title:b?`${i.label} (Coming Soon)`:`${i.label} (Alt+${i.shortcut})`,children:[jsxRuntimeExports.jsx(j,{size:e?16:18,className:c?"text-white":"text-[var(--text-muted)]"}),!e&&jsxRuntimeExports.jsxs("span",{className:"font-medium",children:[i.label,b&&jsxRuntimeExports.jsx("span",{className:"ml-1 text-xs opacity-70",children:"(Soon)"})]}),c&&jsxRuntimeExports.jsx(motion.div,{layoutId:"mode-indicator",className:"absolute inset-0 rounded-lg bg-[var(--color-primary-500)]/20",initial:!1,transition:{type:"spring",stiffness:500,damping:30}}),x&&!c&&jsxRuntimeExports.jsx(motion.div,{className:"absolute inset-0 rounded-lg bg-[var(--surface-hover)]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}})]},i.id)}),jsxRuntimeExports.jsx("button",{className:`
          flex items-center gap-2 px-3 py-2 rounded-lg
          bg-[var(--surface-elevated)] text-[var(--text-secondary)]
          hover:bg-[var(--surface-hover)] transition-colors
          focus:outline-none focus:ring-2 focus:ring-[var(--color-primary-500)] focus:ring-offset-1
          ${e?"px-2 py-1.5":""}
        `,style:{fontSize:e?r.fontSize.xs:r.fontSize.sm},"aria-label":"More modes",title:"More modes",children:jsxRuntimeExports.jsx(Ellipsis,{size:e?16:18})}),f&&jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"ml-2 text-[var(--text-muted)] text-xs",children:"Switching..."})]})}const widthMap={sm:"max-w-screen-sm",md:"max-w-screen-md",lg:"max-w-screen-lg",xl:"max-w-screen-xl","2xl":"max-w-[var(--layout-page-width)]"},Container=reactExports.forwardRef(({width:t="2xl",padded:e=!0,bleed:s=!1,className:r,...a},f)=>{const d=t==="full"?"w-full":widthMap[t];return jsxRuntimeExports.jsx("div",{...a,ref:f,className:cn("mx-auto w-full",d,e&&"px-[var(--layout-page-padding)]",s&&"!px-0",r)})});Container.displayName="Container";const paddingMap={none:"",sm:"px-3 py-2",md:"px-4 py-3"},ScrollContainer=reactExports.forwardRef(({padding:t="md",className:e,...s},r)=>jsxRuntimeExports.jsx("div",{...s,ref:r,className:cn("flex-1 overflow-y-auto",paddingMap[t],e)}));ScrollContainer.displayName="ScrollContainer";function formatRelativeTime(t){const e=new Date(t);if(Number.isNaN(e.getTime()))return"";const s=Date.now()-e.getTime(),r=Math.round(s/6e4);if(r<1)return"just now";if(r<60)return`${r}m ago`;const a=Math.round(r/60);return a<24?`${a}h ago`:`${Math.round(a/24)}d ago`}const MAX_NOTIFICATIONS=50;function NotificationsMenu(){const[t,e]=reactExports.useState(!1),[s,r]=reactExports.useState(!0),[a,f]=reactExports.useState([]),[d,h]=reactExports.useState(0),[g,l]=reactExports.useState(-1),o=reactExports.useRef(null),m=reactExports.useRef(null),i=reactExports.useRef([]),j=reactExports.useRef(null),c=reactExports.useMemo(()=>d>0?`${d} unread notifications`:"No unread notifications",[d]),x=reactExports.useCallback(()=>{e(!1),l(-1),o.current?.focus()},[]),b=reactExports.useCallback(async()=>{try{if(typeof window<"u"&&window.ipc)f([]),h(0);else{const n=await fetch("/api/notifications?limit=10");if(!n.ok){r(!1);return}const v=n.headers.get("content-type");if(!v||!v.includes("application/json")){r(!1);return}const E=await n.json();f(E.notifications??[]),h(E.unreadCount??0)}}catch{}finally{r(!1)}},[]);reactExports.useEffect(()=>{b()},[b]),reactExports.useEffect(()=>{if(!(typeof window<"u"&&window.ipc))try{const n=new EventSource("/ws/notifications");return j.current=n,n.addEventListener("notification",v=>{try{const E=JSON.parse(v.data);E?.payload&&(f(R=>[E.payload,...R].slice(0,MAX_NOTIFICATIONS)),h(R=>R+1))}catch{}}),n.onerror=()=>{n.close(),j.current=null},()=>{n.close(),j.current=null}}catch{}},[]),reactExports.useEffect(()=>{function u(n){if(!t)return;const v=n.target;!m.current?.contains(v)&&!o.current?.contains(v)&&x()}return window.addEventListener("pointerdown",u),()=>window.removeEventListener("pointerdown",u)},[x,t]),reactExports.useEffect(()=>{if(!t)return;function u(n){if(n.key==="Escape"){n.preventDefault(),x();return}a.length&&(n.key==="ArrowDown"?(n.preventDefault(),l(v=>Math.min(a.length-1,v+1))):n.key==="ArrowUp"?(n.preventDefault(),l(v=>Math.max(0,v-1))):n.key.toLowerCase()==="m"&&g>=0&&(n.preventDefault(),y(a[g].id)))}return window.addEventListener("keydown",u),()=>window.removeEventListener("keydown",u)},[x,g,a,t]),reactExports.useEffect(()=>{if(g<0)return;i.current[g]?.focus()},[g]);const y=reactExports.useCallback(async u=>{try{const n=await fetch(`/api/notifications/${u}/read`,{method:"POST"});if(!n.ok)throw new Error(`Failed to mark notification as read (${n.status})`);f(v=>v.map(E=>E.id===u?{...E,read:!0}:E)),h(v=>Math.max(0,v-1))}catch(n){console.error("[NotificationsMenu] Failed to mark notification as read",n)}},[]),w=reactExports.useCallback(async()=>{try{if(!(await fetch("/api/notifications/mark-all-read",{method:"POST"})).ok)throw new Error("Failed to mark all notifications as read");f(n=>n.map(v=>({...v,read:!0}))),h(0)}catch(u){console.error("[NotificationsMenu] Failed to mark all read",u)}},[]),p=reactExports.useCallback(async u=>{u.url&&window.open(u.url,"_blank","noopener,noreferrer"),u.read||await y(u.id)},[y]);return jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsxs("button",{ref:o,type:"button","aria-label":"Notifications","aria-haspopup":"menu","aria-expanded":t,className:"relative rounded-lg p-2 text-[var(--text-secondary)] transition-colors hover:text-[var(--text-primary)] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-[var(--color-primary-500)]",onClick:()=>{e(u=>!u),t||l(a.length?0:-1)},children:[jsxRuntimeExports.jsx(Bell,{className:"h-5 w-5","aria-hidden":!0}),d>0&&jsxRuntimeExports.jsx("span",{className:"absolute -top-0.5 -right-0.5 inline-flex min-w-[1.25rem] items-center justify-center rounded-full bg-[var(--color-primary-500)] px-1 text-[0.65rem] font-semibold text-white","aria-live":"polite",children:d>99?"99+":d}),jsxRuntimeExports.jsx("span",{className:"sr-only",children:c})]}),t&&jsxRuntimeExports.jsxs("div",{ref:m,role:"menu","aria-label":"Notifications",className:"absolute right-0 z-50 mt-3 w-[360px] max-w-[90vw] rounded-2xl border border-[var(--surface-border)] bg-[var(--surface-panel)] shadow-2xl focus-visible:outline-none",tabIndex:-1,children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between border-b border-[var(--surface-border)] px-4 py-3",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-semibold text-[var(--text-primary)]",children:"Notifications"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-[var(--text-muted)]",children:c})]}),jsxRuntimeExports.jsx("button",{type:"button",className:"text-xs font-medium text-[var(--color-primary-500)] hover:text-[var(--color-primary-400)]",onClick:()=>void w(),children:"Mark all as read"})]}),jsxRuntimeExports.jsxs("div",{className:"max-h-[360px] overflow-y-auto px-2 py-2","aria-live":"polite",children:[s&&jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-2 py-8 text-sm text-[var(--text-muted)]",children:[jsxRuntimeExports.jsx(LoaderCircle,{className:"h-4 w-4 animate-spin"}),"Loading notifications…"]}),!s&&a.length===0&&jsxRuntimeExports.jsx("div",{className:"py-8 text-center text-sm text-[var(--text-muted)]",children:"You’re all caught up."}),a.map((u,n)=>{const v=Array.isArray(u.meta?.tags)?u.meta?.tags:null;return jsxRuntimeExports.jsxs("div",{ref:E=>{i.current[n]=E},role:"menuitem",tabIndex:0,className:`group flex cursor-pointer gap-3 rounded-xl px-3 py-3 transition-colors focus:outline-none focus:ring-2 focus:ring-[var(--color-primary-500)] focus:ring-offset-2 ${u.read?"bg-transparent hover:bg-[var(--surface-hover)]":"bg-[var(--surface-elevated)]"}`,onClick:()=>void p(u),onKeyDown:E=>{E.key==="Enter"||E.key===" "?(E.preventDefault(),p(u)):E.key.toLowerCase()==="m"&&(E.preventDefault(),y(u.id))},children:[jsxRuntimeExports.jsx("div",{className:"mt-1 flex h-9 w-9 flex-shrink-0 items-center justify-center rounded-full bg-[var(--surface-hover)] text-xs font-semibold uppercase text-[var(--color-primary-400)]",children:u.type.slice(0,2)}),jsxRuntimeExports.jsxs("div",{className:"min-w-0 flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("p",{className:`truncate text-sm font-semibold ${u.read?"text-[var(--text-secondary)]":"text-[var(--text-primary)]"}`,children:u.title}),jsxRuntimeExports.jsx("span",{className:"text-xs text-[var(--text-muted)]",children:formatRelativeTime(u.timestamp)})]}),u.body&&jsxRuntimeExports.jsx("p",{className:"mt-1 line-clamp-2 text-xs text-[var(--text-muted)]","aria-live":"polite",children:u.body}),v&&jsxRuntimeExports.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:v.map(E=>jsxRuntimeExports.jsx("span",{className:"rounded-full bg-[var(--surface-hover)] px-2 py-0.5 text-[0.65rem] text-[var(--text-muted)]",children:E},E))})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center gap-2",children:[u.url&&jsxRuntimeExports.jsx("button",{type:"button","aria-label":"Open notification",className:"rounded-md p-1 text-[var(--text-muted)] transition-colors hover:text-[var(--text-primary)]",onClick:E=>{E.stopPropagation(),p(u)},children:jsxRuntimeExports.jsx(ExternalLink,{className:"h-4 w-4"})}),!u.read&&jsxRuntimeExports.jsx("button",{type:"button","aria-label":"Mark as read",className:"rounded-md p-1 text-[var(--text-muted)] transition-colors hover:text-[var(--text-primary)]",onClick:E=>{E.stopPropagation(),y(u.id)},children:jsxRuntimeExports.jsx(Check,{className:"h-4 w-4"})})]})]},u.id)})]})]})]})}function SettingsMenu(){const t=useTokens(),{setPreference:e}=useTheme(),s=useNavigate(),r=useSettingsStore(),[a,f]=reactExports.useState(!1),[d,h]=reactExports.useState(!1),g=reactExports.useRef(null),l=reactExports.useRef(null),o=r.appearance.theme==="system"?"system":r.appearance.theme==="light"?"light":"dark",m=r.privacy.trackerProtection&&r.privacy.adBlockEnabled,i=r.appearance.compactUI,j=reactExports.useCallback(()=>{f(!1),g.current?.focus()},[]);reactExports.useEffect(()=>{if(!a)return;function p(u){const n=u.target;!l.current?.contains(n)&&!g.current?.contains(n)&&j()}return window.addEventListener("pointerdown",p),()=>window.removeEventListener("pointerdown",p)},[j,a]),reactExports.useEffect(()=>{if(!a)return;function p(u){u.key==="Escape"&&(u.preventDefault(),j())}return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[j,a]);const c=reactExports.useCallback(p=>{h(!0);const u=p==="system"?"system":p;r.updateAppearance({theme:u}),e(p),h(!1)},[e,r]),x=reactExports.useCallback(()=>{h(!0);const p=!m;r.updatePrivacy({trackerProtection:p,adBlockEnabled:p,blockThirdPartyCookies:p,doNotTrack:p}),setTimeout(()=>h(!1),200)},[m,r]),b=reactExports.useCallback(()=>{h(!0);const p=!i;r.updateAppearance({compactUI:p}),applyPerformanceMode(p),setTimeout(()=>h(!1),200)},[i,r]),y=reactExports.useCallback(()=>{j(),s("/settings?tab=shortcuts")},[j,s]),w=reactExports.useCallback(()=>{j(),s("/settings")},[j,s]);return jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("button",{ref:g,type:"button","aria-label":"Settings menu","aria-haspopup":"menu","aria-expanded":a,className:"rounded-lg p-2 text-[var(--text-secondary)] transition-colors hover:text-[var(--text-primary)] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[var(--color-primary-500)] focus-visible:ring-offset-2",onClick:p=>{p.stopPropagation(),p.nativeEvent?.stopImmediatePropagation&&p.nativeEvent.stopImmediatePropagation(),f(u=>!u)},onMouseDown:p=>{p.stopPropagation(),p.nativeEvent?.stopImmediatePropagation&&p.nativeEvent.stopImmediatePropagation()},children:jsxRuntimeExports.jsx(Settings2,{className:"h-5 w-5","aria-hidden":!0})}),a&&jsxRuntimeExports.jsxs("div",{ref:l,role:"menu","aria-label":"Settings",className:"absolute right-0 z-50 mt-3 w-64 rounded-2xl border border-[var(--surface-border)] bg-[var(--surface-panel)] shadow-2xl",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between border-b border-[var(--surface-border)] px-4 py-3",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-semibold text-[var(--text-primary)]",children:"Quick settings"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-[var(--text-muted)]",children:d?"Saving…":"Applies everywhere"})]}),d&&jsxRuntimeExports.jsx("span",{className:"text-xs text-[var(--text-muted)]",children:"…"})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4 px-4 py-4",style:{fontSize:t.fontSize.sm},children:[jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("p",{className:"mb-2 text-xs font-semibold uppercase tracking-[0.25em] text-[var(--text-muted)]",children:"Theme"}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{key:"system",label:"Auto",icon:MonitorCog},{key:"light",label:"Light",icon:SunMedium},{key:"dark",label:"Dark",icon:Moon}].map(({key:p,label:u,icon:n})=>jsxRuntimeExports.jsxs("button",{type:"button",onClick:v=>{v.stopImmediatePropagation(),v.stopPropagation(),c(p)},onMouseDown:v=>{v.stopImmediatePropagation(),v.stopPropagation()},className:`flex flex-col items-center gap-1 rounded-xl border px-2 py-2 text-xs transition ${o===p?"bg-[var(--color-primary-500)]/10 border-[var(--color-primary-500)] text-[var(--text-primary)]":"border-[var(--surface-border)] bg-[var(--surface-elevated)] text-[var(--text-secondary)] hover:border-[var(--surface-border-strong)]"}`,style:{zIndex:10011,isolation:"isolate"},children:[jsxRuntimeExports.jsx(n,{className:"h-4 w-4"}),u]},p))})]}),jsxRuntimeExports.jsxs("section",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("label",{className:"flex items-center justify-between rounded-xl border border-[var(--surface-border)] bg-[var(--surface-elevated)] px-3 py-2 text-sm",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"font-medium text-[var(--text-primary)]",children:"Privacy mode"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-[var(--text-muted)]",children:"Block trackers & ads"})]}),jsxRuntimeExports.jsx("button",{type:"button",onClick:p=>{p.stopImmediatePropagation(),p.stopPropagation(),x()},onMouseDown:p=>{p.stopImmediatePropagation(),p.stopPropagation()},className:`relative inline-flex h-6 w-11 items-center rounded-full transition ${m?"bg-[var(--color-primary-500)]":"bg-[var(--surface-border)]"}`,style:{zIndex:10011,isolation:"isolate"},children:jsxRuntimeExports.jsx("span",{className:`inline-block h-5 w-5 transform rounded-full bg-white transition ${m?"translate-x-5":"translate-x-1"}`})})]}),jsxRuntimeExports.jsxs("label",{className:"flex items-center justify-between rounded-xl border border-[var(--surface-border)] bg-[var(--surface-elevated)] px-3 py-2 text-sm",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"font-medium text-[var(--text-primary)]",children:"Performance boost"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-[var(--text-muted)]",children:"Aggressive cache + reduced effects"})]}),jsxRuntimeExports.jsx("button",{type:"button",onClick:p=>{p.stopImmediatePropagation(),p.stopPropagation(),b()},onMouseDown:p=>{p.stopImmediatePropagation(),p.stopPropagation()},className:`relative inline-flex h-6 w-11 items-center rounded-full transition ${i?"bg-[var(--color-primary-500)]":"bg-[var(--surface-border)]"}`,style:{zIndex:10011,isolation:"isolate"},children:jsxRuntimeExports.jsx("span",{className:`inline-block h-5 w-5 transform rounded-full bg-white transition ${i?"translate-x-5":"translate-x-1"}`})})]})]}),jsxRuntimeExports.jsxs("section",{className:"space-y-2 border-t border-[var(--surface-border)] pt-3",children:[jsxRuntimeExports.jsxs("button",{type:"button",onClick:p=>{p.stopImmediatePropagation(),p.stopPropagation(),y()},onMouseDown:p=>{p.stopImmediatePropagation(),p.stopPropagation()},className:"flex w-full items-center gap-2 rounded-lg px-2 py-2 text-left text-sm text-[var(--text-primary)] transition hover:bg-[var(--surface-hover)]",style:{zIndex:10011,isolation:"isolate"},children:[jsxRuntimeExports.jsx(Keyboard,{className:"h-4 w-4 text-[var(--color-primary-400)]"}),"Keyboard shortcuts"]}),jsxRuntimeExports.jsxs("button",{type:"button",className:"flex w-full items-center gap-2 rounded-lg px-2 py-2 text-left text-sm text-[var(--text-primary)] transition hover:bg-[var(--surface-hover)]",onClick:p=>{p.stopImmediatePropagation(),p.stopPropagation(),w()},onMouseDown:p=>{p.stopImmediatePropagation(),p.stopPropagation()},style:{zIndex:10011,isolation:"isolate"},children:[jsxRuntimeExports.jsx(Settings2,{className:"h-4 w-4 text-[var(--text-muted)]"}),"Open full settings"]})]})]})]})]})}function EnhancedRegenSidebar(){const[t,e]=reactExports.useState("chat"),[s]=reactExports.useState([]),[r,a]=reactExports.useState(""),[f]=reactExports.useState(!1),[d,h]=reactExports.useState([]),[g,l]=reactExports.useState(null),[o,m]=reactExports.useState(""),[i,j]=reactExports.useState(""),[c,x]=reactExports.useState([]),[b,y]=reactExports.useState([]),[w]=reactExports.useState([]);reactExports.useEffect(()=>{const n=localStorage.getItem("regen-notes");n&&h(JSON.parse(n));const v=localStorage.getItem("regen-research");v&&x(JSON.parse(v));const E=localStorage.getItem("regen-clipboard");E&&y(JSON.parse(E));const S=setInterval(()=>{navigator.clipboard.readText().then(N=>{if(N&&N.length>0){const C={id:`clip-${Date.now()}`,text:N,timestamp:Date.now(),type:N.startsWith("http")?"url":N.includes("function")||N.includes("const")?"code":"text"};y(I=>{const k=[C,...I].slice(0,50);return localStorage.setItem("regen-clipboard",JSON.stringify(k)),k})}}).catch(()=>{})},2e3);return()=>clearInterval(S)},[]);const p=()=>{if(!o.trim()&&!i.trim())return;const n=g||{id:`note-${Date.now()}`,title:o||"Untitled",content:i,createdAt:Date.now(),updatedAt:Date.now()};g&&(n.title=o||n.title,n.content=i,n.updatedAt=Date.now());const v=g?d.map(E=>E.id===n.id?n:E):[n,...d];h(v),localStorage.setItem("regen-notes",JSON.stringify(v)),l(null),m(""),j(""),toast.success("Note saved")},u=async n=>{await navigator.clipboard.writeText(n),toast.success("Copied to clipboard")};return jsxRuntimeExports.jsxs("div",{className:"flex flex-col h-full bg-gray-900 border-l border-gray-700",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Sparkles,{className:"w-5 h-5 text-purple-400"}),jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-gray-200",children:"Regen"})]}),jsxRuntimeExports.jsx("button",{onClick:async()=>{const{useAppStore:n}=await __vitePreload(async()=>{const{useAppStore:v}=await import("./core-ai-yFIunLTZ.js").then(E=>E.Q);return{useAppStore:v}},__vite__mapDeps([0,1,2,3,4,5,6]));n.getState().setRegenSidebarOpen(!1)},className:"text-gray-400 hover:text-gray-300 transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsx("div",{className:"flex gap-1 p-2 border-b border-gray-700 overflow-x-auto",children:[{id:"chat",icon:Sparkles,label:"Chat"},{id:"notes",icon:FileText,label:"Notes"},{id:"research",icon:BookOpen,label:"Research"},{id:"tools",icon:Wrench,label:"Tools"},{id:"clipboard",icon:Clipboard,label:"Clipboard"},{id:"downloads",icon:Download,label:"Downloads"},{id:"files",icon:Folder,label:"Files"}].map(n=>{const v=n.icon;return jsxRuntimeExports.jsxs("button",{onClick:()=>e(n.id),className:`flex items-center gap-1 px-3 py-2 rounded-lg text-sm transition-colors whitespace-nowrap ${t===n.id?"bg-purple-600 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700"}`,children:[jsxRuntimeExports.jsx(v,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"hidden md:inline",children:n.label})]},n.id)})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 overflow-y-auto",children:[t==="chat"&&jsxRuntimeExports.jsxs("div",{className:"p-4 space-y-4",children:[s.length===0&&jsxRuntimeExports.jsxs("div",{className:"text-center text-gray-400 mt-8",children:[jsxRuntimeExports.jsx(Sparkles,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),jsxRuntimeExports.jsx("p",{className:"text-sm",children:"Ask me anything"})]}),s.map(n=>jsxRuntimeExports.jsx("div",{className:`flex ${n.role==="user"?"justify-end":"justify-start"}`,children:jsxRuntimeExports.jsx("div",{className:`max-w-[80%] rounded-lg px-4 py-2 ${n.role==="user"?"bg-blue-600 text-white":"bg-gray-800 text-gray-200"}`,children:jsxRuntimeExports.jsx("p",{className:"text-sm whitespace-pre-wrap",children:n.content})})},n.id)),f&&jsxRuntimeExports.jsx("div",{className:"flex justify-start",children:jsxRuntimeExports.jsx("div",{className:"bg-gray-800 rounded-lg px-4 py-2",children:jsxRuntimeExports.jsx(LoaderCircle,{className:"w-4 h-4 animate-spin text-gray-400"})})})]}),t==="notes"&&jsxRuntimeExports.jsxs("div",{className:"flex flex-col h-full",children:[jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:d.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center text-gray-400 mt-8",children:[jsxRuntimeExports.jsx(FileText,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),jsxRuntimeExports.jsx("p",{className:"text-sm",children:"No notes yet"})]}):jsxRuntimeExports.jsx("div",{className:"space-y-2",children:d.map(n=>jsxRuntimeExports.jsxs("div",{onClick:()=>{l(n),m(n.title),j(n.content)},className:"p-3 bg-gray-800 rounded-lg cursor-pointer hover:bg-gray-700 transition-colors",children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold text-white mb-1",children:n.title}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-400 line-clamp-2",children:n.content}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 mt-2",children:new Date(n.updatedAt).toLocaleDateString()})]},n.id))})}),jsxRuntimeExports.jsxs("div",{className:"p-4 border-t border-gray-700 space-y-2",children:[jsxRuntimeExports.jsx("input",{type:"text",value:o,onChange:n=>m(n.target.value),placeholder:"Note title...",className:"w-full bg-gray-800 text-white rounded-lg px-3 py-2 text-sm"}),jsxRuntimeExports.jsx("textarea",{value:i,onChange:n=>j(n.target.value),placeholder:"Write your note...",className:"w-full bg-gray-800 text-white rounded-lg px-3 py-2 text-sm min-h-[100px]"}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsxs("button",{onClick:p,className:"flex-1 bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg text-sm",children:[g?"Update":"Save"," Note"]}),g&&jsxRuntimeExports.jsx("button",{onClick:()=>{l(null),m(""),j("")},className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm",children:"Cancel"})]})]})]}),t==="research"&&jsxRuntimeExports.jsx("div",{className:"p-4",children:c.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center text-gray-400 mt-8",children:[jsxRuntimeExports.jsx(BookOpen,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),jsxRuntimeExports.jsx("p",{className:"text-sm",children:"No saved research yet"})]}):jsxRuntimeExports.jsx("div",{className:"space-y-3",children:c.map(n=>jsxRuntimeExports.jsxs("div",{className:"p-4 bg-gray-800 rounded-lg",children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold text-white mb-2",children:n.query}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-300 mb-2",children:n.summary}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:n.sources.map((v,E)=>jsxRuntimeExports.jsxs("a",{href:v,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-400 hover:underline",children:["Source ",E+1]},E))})]},n.id))})}),t==="clipboard"&&jsxRuntimeExports.jsx("div",{className:"p-4",children:b.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center text-gray-400 mt-8",children:[jsxRuntimeExports.jsx(Clipboard,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),jsxRuntimeExports.jsx("p",{className:"text-sm",children:"Clipboard history will appear here"})]}):jsxRuntimeExports.jsx("div",{className:"space-y-2",children:b.map(n=>jsxRuntimeExports.jsxs("div",{className:"p-3 bg-gray-800 rounded-lg hover:bg-gray-700 transition-colors",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between gap-2",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-300 flex-1 line-clamp-3",children:n.text}),jsxRuntimeExports.jsx("button",{onClick:()=>u(n.text),className:"text-gray-400 hover:text-white transition-colors",children:jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4"})})]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 mt-2",children:new Date(n.timestamp).toLocaleTimeString()})]},n.id))})}),t==="downloads"&&jsxRuntimeExports.jsx("div",{className:"p-4",children:w.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center text-gray-400 mt-8",children:[jsxRuntimeExports.jsx(Download,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),jsxRuntimeExports.jsx("p",{className:"text-sm",children:"No downloads yet"})]}):jsxRuntimeExports.jsx("div",{className:"space-y-2",children:w.map(n=>jsxRuntimeExports.jsxs("div",{className:"p-3 bg-gray-800 rounded-lg",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-white",children:n.filename}),jsxRuntimeExports.jsx("span",{className:`text-xs px-2 py-1 rounded ${n.status==="completed"?"bg-green-600":n.status==="failed"?"bg-red-600":"bg-blue-600"}`,children:n.status})]}),n.status==="downloading"&&jsxRuntimeExports.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:jsxRuntimeExports.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all",style:{width:`${n.progress}%`}})})]},n.id))})}),t==="tools"&&jsxRuntimeExports.jsxs("div",{className:"p-4 space-y-3",children:[jsxRuntimeExports.jsx(QuickToolButton,{icon:Search,label:"Quick Search",onClick:()=>{e("chat"),a("/search ")}}),jsxRuntimeExports.jsx(QuickToolButton,{icon:FileText,label:"New Note",onClick:()=>{e("notes"),m(""),j("")}}),jsxRuntimeExports.jsx(QuickToolButton,{icon:Clipboard,label:"Paste Latest",onClick:async()=>{const n=await navigator.clipboard.readText();n&&(e("chat"),a(n))}})]}),t==="files"&&jsxRuntimeExports.jsx("div",{className:"p-4",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-400",children:"File explorer coming soon"})})]}),t==="chat"&&jsxRuntimeExports.jsx("div",{className:"p-4 border-t border-gray-700",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("input",{type:"text",value:r,onChange:n=>a(n.target.value),onKeyPress:n=>{n.key==="Enter"&&!n.shiftKey&&n.preventDefault()},placeholder:"Ask Regen anything...",className:"flex-1 bg-gray-800 text-gray-200 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500"}),jsxRuntimeExports.jsx("button",{className:"p-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:jsxRuntimeExports.jsx(Send,{className:"w-5 h-5"})})]})})]})}function QuickToolButton({icon:t,label:e,onClick:s}){return jsxRuntimeExports.jsxs("button",{onClick:s,className:"w-full flex items-center gap-3 p-3 bg-gray-800 rounded-lg hover:bg-gray-700 transition-colors",children:[jsxRuntimeExports.jsx(t,{className:"w-5 h-5 text-purple-400"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-white",children:e})]})}function SplitView(){const[t,e]=reactExports.useState("single"),[s,r]=reactExports.useState([{id:"pane-1",tabId:null,width:100}]),{tabs:a,activeId:f,setActive:d}=useTabsStore(),h=reactExports.useRef(null),[g,l]=reactExports.useState(null),o=()=>{t==="single"?(e("split-2"),r([{id:"pane-1",tabId:f||null,width:50},{id:"pane-2",tabId:null,width:50}])):t==="split-2"&&(e("split-3"),r([{id:"pane-1",tabId:s[0].tabId,width:33.33},{id:"pane-2",tabId:s[1].tabId,width:33.33},{id:"pane-3",tabId:null,width:33.34}]))},m=c=>{if(s.length===1)return;const x=s.filter(w=>w.id!==c),b=x.reduce((w,p)=>w+p.width,0),y=x.map(w=>({...w,width:w.width/b*100}));r(y),e(y.length===1?"single":y.length===2?"split-2":"split-3")},i=(c,x)=>{r(s.map(b=>b.id===c?{...b,tabId:x}:b)),d(x)},j=c=>{l(c)};return reactExports.useEffect(()=>{if(!g)return;const c=b=>{if(!h.current)return;const y=h.current.offsetWidth,p=(b.clientX-h.current.getBoundingClientRect().left)/y*100,u=s.findIndex(R=>R.id===g);if(u===-1)return;const n=[...s],v=n[u].width,E=p-v;n[u].width=Math.max(20,Math.min(80,p)),u<n.length-1&&(n[u+1].width=Math.max(20,Math.min(80,n[u+1].width-E))),r(n)},x=()=>{l(null)};return window.addEventListener("mousemove",c),window.addEventListener("mouseup",x),()=>{window.removeEventListener("mousemove",c),window.removeEventListener("mouseup",x)}},[g,s]),jsxRuntimeExports.jsxs("div",{ref:h,className:"relative h-full w-full flex",children:[s.map((c,x)=>jsxRuntimeExports.jsxs("div",{className:"relative flex flex-col border-r border-gray-700 last:border-r-0",style:{width:`${c.width}%`},children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-gray-800 border-b border-gray-700",children:[jsxRuntimeExports.jsx("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:jsxRuntimeExports.jsxs("select",{value:c.tabId||"",onChange:b=>i(c.id,b.target.value),className:"flex-1 bg-gray-700 text-white text-sm rounded px-2 py-1 min-w-0",children:[jsxRuntimeExports.jsx("option",{value:"",children:"Select tab..."}),a.map(b=>jsxRuntimeExports.jsx("option",{value:b.id,children:b.title||b.url},b.id))]})}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-1",children:s.length>1&&jsxRuntimeExports.jsx("button",{onClick:()=>m(c.id),className:"p-1 text-gray-400 hover:text-white transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-4 h-4"})})})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 relative",children:c.tabId?jsxRuntimeExports.jsx("iframe",{src:a.find(b=>b.id===c.tabId)?.url||"about:blank",className:"w-full h-full border-0",title:`Pane ${x+1}`}):jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center h-full bg-gray-900 text-gray-500",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("p",{className:"text-sm mb-2",children:"No tab selected"}),jsxRuntimeExports.jsx("p",{className:"text-xs",children:"Select a tab from the dropdown above"})]})})}),x<s.length-1&&jsxRuntimeExports.jsx("div",{onMouseDown:()=>j(c.id),className:"absolute right-0 top-0 bottom-0 w-1 bg-gray-700 hover:bg-purple-500 cursor-col-resize z-10"})]},c.id)),t!=="split-3"&&jsxRuntimeExports.jsx("button",{onClick:o,className:"absolute bottom-4 right-4 bg-purple-600 hover:bg-purple-700 text-white p-3 rounded-full shadow-lg transition-all hover:scale-110",title:"Add pane",children:jsxRuntimeExports.jsx(Plus,{className:"w-5 h-5"})})]})}function decrypt(t,e){try{const s=atob(t);let r="";for(let a=0;a<s.length;a++)r+=String.fromCharCode(s.charCodeAt(a)^e.charCodeAt(a%e.length));return r}catch{return""}}function RegenVault(){const[t,e]=reactExports.useState([]),[s,r]=reactExports.useState(!1),[a,f]=reactExports.useState(""),[d,h]=reactExports.useState(!0),[g,l]=reactExports.useState(60),o=a||"default-key";reactExports.useEffect(()=>{const x=localStorage.getItem("regen-vault-tabs");if(x)try{const b=JSON.parse(x);e(b)}catch{}if(d){const b=setInterval(()=>{e(y=>{const w=Date.now(),p=y.filter(u=>u.expiresAt>w);return p.length!==y.length&&localStorage.setItem("regen-vault-tabs",JSON.stringify(p)),p})},6e4);return()=>clearInterval(b)}},[d]);const m=()=>{a.length>=4&&r(!0)},i=x=>{const b=t.filter(y=>y.id!==x);e(b),localStorage.setItem("regen-vault-tabs",JSON.stringify(b))},j=async x=>{if(!s)return;const b=decrypt(x.url,o);window.open(b,"_blank")},c=()=>{confirm("Delete all vault tabs? This cannot be undone.")&&(e([]),localStorage.removeItem("regen-vault-tabs"))};return s?jsxRuntimeExports.jsxs("div",{className:"flex flex-col h-full bg-gray-900",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Lock,{className:"w-5 h-5 text-purple-400"}),jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-white",children:"Vault"}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-gray-400",children:["(",t.length," tabs)"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-400",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:d,onChange:x=>h(x.target.checked),className:"rounded"}),"Auto-delete"]}),d&&jsxRuntimeExports.jsxs("select",{value:g,onChange:x=>l(Number(x.target.value)),className:"bg-gray-800 text-white text-xs rounded px-2 py-1",children:[jsxRuntimeExports.jsx("option",{value:5,children:"5 min"}),jsxRuntimeExports.jsx("option",{value:15,children:"15 min"}),jsxRuntimeExports.jsx("option",{value:60,children:"1 hour"}),jsxRuntimeExports.jsx("option",{value:1440,children:"24 hours"})]}),jsxRuntimeExports.jsx("button",{onClick:c,className:"p-2 text-red-400 hover:text-red-300 transition-colors",children:jsxRuntimeExports.jsx(Trash2,{className:"w-5 h-5"})})]})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:t.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center text-gray-400 mt-8",children:[jsxRuntimeExports.jsx(Shield,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),jsxRuntimeExports.jsx("p",{className:"text-sm",children:"No vault tabs yet"}),jsxRuntimeExports.jsx("p",{className:"text-xs mt-2",children:"Create a private tab to add it to the vault"})]}):jsxRuntimeExports.jsx("div",{className:"space-y-2",children:t.map(x=>jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-800 rounded-lg hover:bg-gray-700 transition-colors",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-white truncate",children:decrypt(x.title,o)||"Untitled"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-400 truncate",children:decrypt(x.url,o)}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Expires: ",new Date(x.expiresAt).toLocaleTimeString()]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>j(x),className:"p-2 text-blue-400 hover:text-blue-300 transition-colors",children:jsxRuntimeExports.jsx(Eye,{className:"w-4 h-4"})}),jsxRuntimeExports.jsx("button",{onClick:()=>i(x.id),className:"p-2 text-red-400 hover:text-red-300 transition-colors",children:jsxRuntimeExports.jsx(Trash2,{className:"w-4 h-4"})})]})]},x.id))})})]}):jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center h-full bg-gray-900 p-8",children:[jsxRuntimeExports.jsx(Shield,{className:"w-16 h-16 text-purple-400 mb-4"}),jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Regen Vault"}),jsxRuntimeExports.jsx("p",{className:"text-gray-400 mb-6",children:"Enter password to unlock private tabs"}),jsxRuntimeExports.jsxs("div",{className:"w-full max-w-sm space-y-4",children:[jsxRuntimeExports.jsx("input",{type:"password",value:a,onChange:x=>f(x.target.value),onKeyPress:x=>x.key==="Enter"&&m(),placeholder:"Vault password",className:"w-full bg-gray-800 text-white rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-purple-500"}),jsxRuntimeExports.jsx("button",{onClick:m,className:"w-full bg-purple-600 hover:bg-purple-700 text-white px-4 py-3 rounded-lg font-semibold",children:"Unlock Vault"})]})]})}const BUILT_IN_THEMES=[{id:"dark",name:"Dark",colors:{primary:"#8b5cf6",secondary:"#ec4899",background:"#1a1d28",surface:"#252836",text:"#ffffff",accent:"#10b981"}},{id:"neon",name:"Neon",colors:{primary:"#00f5ff",secondary:"#ff00ff",background:"#0a0a0a",surface:"#1a1a2e",text:"#00ff00",accent:"#ff0080"}},{id:"amoled",name:"AMOLED",colors:{primary:"#ffffff",secondary:"#888888",background:"#000000",surface:"#111111",text:"#ffffff",accent:"#00ff00"}},{id:"minimal",name:"Minimal",colors:{primary:"#3b82f6",secondary:"#64748b",background:"#ffffff",surface:"#f8fafc",text:"#1e293b",accent:"#3b82f6"}},{id:"anime",name:"Anime",colors:{primary:"#ff6b9d",secondary:"#c44569",background:"#f8d7da",surface:"#fff0f3",text:"#2d3436",accent:"#ff6b9d"}}];function ThemeEngine(){const[t,e]=reactExports.useState(BUILT_IN_THEMES),[s,r]=reactExports.useState("dark"),[a,f]=reactExports.useState(!1),[d,h]=reactExports.useState({id:"custom",name:"Custom Theme",colors:{primary:"#8b5cf6",secondary:"#ec4899",background:"#1a1d28",surface:"#252836",text:"#ffffff",accent:"#10b981"}});reactExports.useEffect(()=>{const o=localStorage.getItem("regen-themes");if(o)try{const i=JSON.parse(o);e([...BUILT_IN_THEMES,...i])}catch{}const m=localStorage.getItem("regen-active-theme");m&&(r(m),g(m))},[]);const g=o=>{const m=t.find(j=>j.id===o);if(!m)return;const i=document.documentElement;i.style.setProperty("--color-primary",m.colors.primary),i.style.setProperty("--color-secondary",m.colors.secondary),i.style.setProperty("--color-background",m.colors.background),i.style.setProperty("--color-surface",m.colors.surface),i.style.setProperty("--color-text",m.colors.text),i.style.setProperty("--color-accent",m.colors.accent),m.wallpaper&&i.style.setProperty("--wallpaper",`url(${m.wallpaper})`),r(o),localStorage.setItem("regen-active-theme",o)},l=()=>{const o=[...t],m=o.findIndex(j=>j.id==="custom");m>=0?o[m]=d:o.push(d),e(o);const i=o.filter(j=>!BUILT_IN_THEMES.find(c=>c.id===j.id));localStorage.setItem("regen-themes",JSON.stringify(i)),f(!1),toast.success("Theme saved!")};return jsxRuntimeExports.jsxs("div",{className:"p-4 space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[jsxRuntimeExports.jsx(Palette,{className:"w-5 h-5"}),"Themes"]}),jsxRuntimeExports.jsx("button",{onClick:()=>f(!a),className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg text-sm",children:a?"Close Builder":"Theme Builder"})]}),a&&jsxRuntimeExports.jsxs("div",{className:"p-4 bg-gray-800 rounded-lg space-y-4",children:[jsxRuntimeExports.jsx("input",{type:"text",value:d.name,onChange:o=>h({...d,name:o.target.value}),placeholder:"Theme name",className:"w-full bg-gray-700 text-white rounded-lg px-3 py-2"}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-2 gap-4",children:Object.entries(d.colors).map(([o,m])=>jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"text-sm text-gray-400 capitalize mb-1 block",children:o}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("input",{type:"color",value:m,onChange:i=>h({...d,colors:{...d.colors,[o]:i.target.value}}),className:"w-12 h-10 rounded"}),jsxRuntimeExports.jsx("input",{type:"text",value:m,onChange:i=>h({...d,colors:{...d.colors,[o]:i.target.value}}),className:"flex-1 bg-gray-700 text-white rounded-lg px-3 py-2 text-sm"})]})]},o))}),jsxRuntimeExports.jsx("button",{onClick:l,className:"w-full bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg",children:"Save Theme"})]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-2 gap-3",children:t.map(o=>jsxRuntimeExports.jsxs("button",{onClick:()=>g(o.id),className:`p-4 rounded-lg border-2 transition-all ${s===o.id?"border-purple-500 bg-purple-500/20":"border-gray-700 bg-gray-800 hover:border-gray-600"}`,children:[jsxRuntimeExports.jsx("div",{className:"h-20 rounded mb-2",style:{background:`linear-gradient(135deg, ${o.colors.primary}, ${o.colors.secondary})`}}),jsxRuntimeExports.jsx("p",{className:"text-sm font-semibold text-white",children:o.name}),s===o.id&&jsxRuntimeExports.jsx("p",{className:"text-xs text-purple-400 mt-1",children:"Active"})]},o.id))})]})}function AIDeveloperConsole(){const[code,setCode]=reactExports.useState(""),[output,setOutput]=reactExports.useState(""),[isRunning,setIsRunning]=reactExports.useState(!1),[aiExplanation,setAiExplanation]=reactExports.useState(""),[error,setError]=reactExports.useState(null),consoleRef=reactExports.useRef(null),runCode=async()=>{setIsRunning(!0),setOutput(""),setError(null);try{const iframe=document.createElement("iframe");iframe.style.display="none",document.body.appendChild(iframe);const iframeWindow=iframe.contentWindow;if(!iframeWindow)throw new Error("Failed to create sandbox");let capturedOutput="";const consoleObj=iframeWindow.console;if(consoleObj&&consoleObj.log){const t=consoleObj.log;consoleObj.log=(...e)=>{capturedOutput+=e.map(s=>String(s)).join(" ")+`
`,t.apply(consoleObj,e)}}const result=iframeWindow.eval?iframeWindow.eval(code):eval(code);result!==void 0&&(capturedOutput+=String(result)+`
`),setOutput(capturedOutput||"Code executed successfully"),document.body.removeChild(iframe)}catch(t){setError(t.message),setOutput(`Error: ${t.message}`)}finally{setIsRunning(!1)}},explainError=async t=>{try{const e=await fetch("http://localhost:4000/api/ai/explain-error",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({error:t,code})});if(e.ok){const s=await e.json();setAiExplanation(s.explanation||"No explanation available")}else setAiExplanation("Failed to get AI explanation")}catch{setAiExplanation("AI service unavailable")}},generateCode=async t=>{try{const e=await fetch("http://localhost:4000/api/ai/generate-code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:t,language:"javascript"})});if(e.ok){const s=await e.json();setCode(s.code||""),toast.success("Code generated!")}}catch{toast.error("Failed to generate code")}},fixCode=async()=>{if(error)try{const t=await fetch("http://localhost:4000/api/ai/fix-code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code,error})});if(t.ok){const e=await t.json();setCode(e.fixedCode||code),setError(null),toast.success("Code fixed!")}}catch{toast.error("Failed to fix code")}};return reactExports.useEffect(()=>{error&&explainError(error)},[error]),jsxRuntimeExports.jsxs("div",{className:"flex flex-col h-full bg-gray-900 text-white",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Code,{className:"w-5 h-5 text-purple-400"}),jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold",children:"AI Developer Console"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>generateCode("Create a function that calculates factorial"),className:"px-3 py-1 bg-purple-600 hover:bg-purple-700 rounded text-sm flex items-center gap-1",children:[jsxRuntimeExports.jsx(Sparkles,{className:"w-4 h-4"}),"Generate"]}),error&&jsxRuntimeExports.jsxs("button",{onClick:fixCode,className:"px-3 py-1 bg-green-600 hover:bg-green-700 rounded text-sm flex items-center gap-1",children:[jsxRuntimeExports.jsx(Zap,{className:"w-4 h-4"}),"Fix"]}),jsxRuntimeExports.jsxs("button",{onClick:runCode,disabled:isRunning||!code.trim(),className:"px-3 py-1 bg-blue-600 hover:bg-blue-700 rounded text-sm flex items-center gap-1 disabled:opacity-50",children:[jsxRuntimeExports.jsx(Play,{className:"w-4 h-4"}),"Run"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 flex",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col",children:[jsxRuntimeExports.jsx("div",{className:"p-2 border-b border-gray-700 bg-gray-800",children:jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-400",children:"JavaScript"})}),jsxRuntimeExports.jsx("textarea",{value:code,onChange:t=>setCode(t.target.value),placeholder:"Write or paste JavaScript code here...",className:"flex-1 bg-gray-950 text-green-400 font-mono text-sm p-4 resize-none focus:outline-none",spellCheck:!1})]}),jsxRuntimeExports.jsxs("div",{className:"w-1/2 flex flex-col border-l border-gray-700",children:[jsxRuntimeExports.jsx("div",{className:"p-2 border-b border-gray-700 bg-gray-800",children:jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-400",children:"Output"})}),jsxRuntimeExports.jsxs("div",{ref:consoleRef,className:"flex-1 overflow-y-auto p-4 font-mono text-sm bg-gray-950",children:[isRunning&&jsxRuntimeExports.jsx("div",{className:"text-yellow-400",children:"Running..."}),error&&jsxRuntimeExports.jsx("div",{className:"text-red-400",children:error}),output&&jsxRuntimeExports.jsx("div",{className:"text-green-400 whitespace-pre-wrap",children:output}),!output&&!error&&!isRunning&&jsxRuntimeExports.jsx("div",{className:"text-gray-500",children:"Output will appear here"})]})]})]}),aiExplanation&&jsxRuntimeExports.jsx("div",{className:"p-4 border-t border-gray-700 bg-purple-900/20",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-2",children:[jsxRuntimeExports.jsx(Sparkles,{className:"w-5 h-5 text-purple-400 mt-0.5"}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-purple-300 mb-1",children:"AI Explanation"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-300",children:aiExplanation})]})]})})]})}var __defProp$1=Object.defineProperty,__defNormalProp$1=(t,e,s)=>e in t?__defProp$1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,__publicField$1=(t,e,s)=>__defNormalProp$1(t,typeof e!="symbol"?e+"":e,s);class LightningMode{static init(){this.loadBlocklists(),["google-analytics.com","googletagmanager.com","facebook.net","doubleclick.net","adservice.google","adsystem.amazon","scorecardresearch.com","quantserve.com"].forEach(s=>this.blockedDomains.add(s))}static enable(){this.enabled=!0,this.injectContentScript()}static disable(){this.enabled=!1}static isEnabled(){return this.enabled}static loadBlocklists(){const e=localStorage.getItem("lightning-blocklist");if(e)try{JSON.parse(e).forEach(r=>this.blockedDomains.add(r))}catch{}}static injectContentScript(){return`
      (function() {
        // Block trackers
        const blockedDomains = ${JSON.stringify(Array.from(this.blockedDomains))};
        
        // Intercept fetch
        const originalFetch = window.fetch;
        window.fetch = function(...args) {
          const url = args[0];
          if (typeof url === 'string') {
            const domain = new URL(url).hostname;
            if (blockedDomains.some(b => domain.includes(b))) {
              console.log('[Lightning] Blocked:', url);
              return Promise.reject(new Error('Blocked by Lightning Mode'));
            }
          }
          return originalFetch.apply(this, args);
        };

        // Block script tags
        const observer = new MutationObserver(mutations => {
          mutations.forEach(mutation => {
            mutation.addedNodes.forEach(node => {
              if (node.nodeName === 'SCRIPT') {
                const src = (node as HTMLScriptElement).src;
                if (src && blockedDomains.some(b => src.includes(b))) {
                  console.log('[Lightning] Blocked script:', src);
                  node.remove();
                }
              }
            });
          });
        });

        observer.observe(document.head, { childList: true, subtree: true });

        // Remove ads
        const adSelectors = [
          '[class*="ad"]',
          '[id*="ad"]',
          '[class*="advertisement"]',
          'iframe[src*="ads"]',
        ];

        const removeAds = () => {
          adSelectors.forEach(selector => {
            document.querySelectorAll(selector).forEach(el => {
              if (el.textContent?.length < 100) { // Small elements likely ads
                el.remove();
              }
            });
          });
        };

        removeAds();
        setInterval(removeAds, 2000);
      })();
    `}static shouldBlock(e){if(!this.enabled)return!1;try{const s=new URL(e).hostname;return Array.from(this.blockedDomains).some(r=>s.includes(r))}catch{return!1}}static addBlockedDomain(e){this.blockedDomains.add(e);const s=Array.from(this.blockedDomains);localStorage.setItem("lightning-blocklist",JSON.stringify(s))}}__publicField$1(LightningMode,"enabled",!1);__publicField$1(LightningMode,"blockedDomains",new Set);__publicField$1(LightningMode,"blockedScripts",new Set);LightningMode.init();function FeaturesMenu(){const t=useTokens(),[e,s]=reactExports.useState(!1),[r,a]=reactExports.useState(null),{regenSidebarOpen:f,setRegenSidebarOpen:d}=useAppStore(),h=reactExports.useRef(null),g=reactExports.useRef(null),l=reactExports.useCallback(()=>{s(!1),h.current?.focus()},[]);reactExports.useEffect(()=>{if(!e)return;function i(j){const c=j.target;!g.current?.contains(c)&&!h.current?.contains(c)&&l()}return window.addEventListener("pointerdown",i),()=>window.removeEventListener("pointerdown",i)},[l,e]),reactExports.useEffect(()=>{if(!e)return;function i(j){j.key==="Escape"&&(j.preventDefault(),l())}return window.addEventListener("keydown",i),()=>window.removeEventListener("keydown",i)},[l,e]);const o=[{id:"sidebar",icon:PanelRight,label:"Regen Sidebar",color:"purple"},{id:"split",icon:Columns2,label:"Split View",color:"blue"},{id:"vault",icon:Lock,label:"Regen Vault",color:"green"},{id:"lightning",icon:Zap,label:"Lightning Mode",color:"yellow"},{id:"theme",icon:Palette,label:"Theme Engine",color:"pink"},{id:"sync",icon:Cloud,label:"Sync Cloud",color:"cyan"},{id:"dev",icon:Code,label:"Dev Console",color:"orange"}],m=i=>{i==="sidebar"?(d(!0),l()):i==="lightning"?(LightningMode.isEnabled()?(LightningMode.disable(),toast.success("Lightning Mode disabled")):(LightningMode.enable(),toast.success("Lightning Mode enabled - faster browsing!")),l()):i==="sync"?(toast.info("Sync feature - configure your sync endpoint"),l()):(a(i),l())};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("button",{ref:h,type:"button","aria-label":"Features menu","aria-haspopup":"menu","aria-expanded":e,className:"rounded-lg p-2 text-[var(--text-secondary)] transition-colors hover:text-[var(--text-primary)] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-[var(--color-primary-500)]",onClick:i=>{i.stopPropagation(),i.nativeEvent?.stopImmediatePropagation&&i.nativeEvent.stopImmediatePropagation(),s(j=>!j)},onMouseDown:i=>{i.stopPropagation(),i.nativeEvent?.stopImmediatePropagation&&i.nativeEvent.stopImmediatePropagation()},children:jsxRuntimeExports.jsx(Sparkles,{className:"h-5 w-5","aria-hidden":!0})}),e&&jsxRuntimeExports.jsxs("div",{ref:g,role:"menu","aria-label":"Features",className:"absolute right-0 z-50 mt-3 w-64 rounded-2xl border border-purple-500/50 bg-[var(--surface-panel)] shadow-2xl",children:[jsxRuntimeExports.jsx("div",{className:"flex items-center justify-between border-b border-[var(--surface-border)] px-4 py-3",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Sparkles,{className:"w-4 h-4 text-purple-400"}),jsxRuntimeExports.jsx("p",{className:"text-sm font-semibold text-[var(--text-primary)]",children:"Features"})]})}),jsxRuntimeExports.jsx("div",{className:"space-y-1 px-2 py-2",style:{fontSize:t.fontSize.sm},children:o.map(i=>{const j=i.icon,c={purple:"text-purple-400",blue:"text-blue-400",green:"text-green-400",yellow:"text-yellow-400",pink:"text-pink-400",cyan:"text-cyan-400",orange:"text-orange-400"}[i.color]||"text-gray-400";return jsxRuntimeExports.jsxs("button",{type:"button",onClick:x=>{x.stopImmediatePropagation(),x.stopPropagation(),m(i.id)},onMouseDown:x=>{x.stopImmediatePropagation(),x.stopPropagation()},className:"flex w-full items-center gap-3 rounded-lg px-3 py-2 text-left text-sm text-[var(--text-primary)] transition hover:bg-[var(--surface-hover)]",style:{zIndex:10011,isolation:"isolate"},children:[jsxRuntimeExports.jsx(j,{className:`h-5 w-5 ${c}`}),jsxRuntimeExports.jsx("span",{children:i.label})]},i.id)})})]})]}),r==="split"&&jsxRuntimeExports.jsxs("div",{className:"fixed inset-0 z-[100] bg-gray-900",children:[jsxRuntimeExports.jsx(SplitView,{}),jsxRuntimeExports.jsx("button",{onClick:()=>a(null),className:"absolute top-4 right-4 z-[101] p-2 bg-gray-800 text-white rounded-lg hover:bg-gray-700",children:"×"})]}),r==="vault"&&jsxRuntimeExports.jsxs("div",{className:"fixed inset-0 z-[100] bg-gray-900",children:[jsxRuntimeExports.jsx(RegenVault,{}),jsxRuntimeExports.jsx("button",{onClick:()=>a(null),className:"absolute top-4 right-4 z-[101] p-2 bg-gray-800 text-white rounded-lg hover:bg-gray-700",children:"×"})]}),r==="theme"&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-[100] bg-gray-900 overflow-y-auto",children:jsxRuntimeExports.jsxs("div",{className:"max-w-4xl mx-auto p-8",children:[jsxRuntimeExports.jsx(ThemeEngine,{}),jsxRuntimeExports.jsx("button",{onClick:()=>a(null),className:"mt-4 px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-700",children:"Close"})]})}),r==="dev"&&jsxRuntimeExports.jsxs("div",{className:"fixed inset-0 z-[100] bg-gray-900",children:[jsxRuntimeExports.jsx(AIDeveloperConsole,{}),jsxRuntimeExports.jsx("button",{onClick:()=>a(null),className:"absolute top-4 right-4 z-[101] p-2 bg-gray-800 text-white rounded-lg hover:bg-gray-700",children:"×"})]}),f&&jsxRuntimeExports.jsx("div",{className:"fixed right-0 top-0 bottom-0 w-96 z-[90]",children:jsxRuntimeExports.jsx(EnhancedRegenSidebar,{})})]})}const presenceColors={online:"bg-emerald-400",away:"bg-amber-400",busy:"bg-rose-400",offline:"bg-gray-500"};function ProfileMenu(){const[t,e]=reactExports.useState(!1),[s,r]=reactExports.useState(!0),[a,f]=reactExports.useState(null),[d,h]=reactExports.useState("ready"),g=reactExports.useRef(null),l=reactExports.useRef(null),o=reactExports.useCallback(()=>{e(!1),g.current?.focus()},[]);reactExports.useEffect(()=>{async function c(){if(isWebMode()){f({id:"web-user",name:"Web User",email:"user@example.com",avatarUrl:void 0,presence:"online",syncStatus:"ready",orgs:[],activeOrgId:void 0}),h("ready"),r(!1);return}try{const x=await fetch("/api/profile");if(!x.ok)throw new Error("Failed to load profile");const b=x.headers.get("content-type");if(!b||!b.includes("application/json")){f({id:"local-user",name:"Local User",email:"local@example.com",avatarUrl:void 0,presence:"offline",syncStatus:"error",orgs:[],activeOrgId:void 0}),h("error"),r(!1);return}const y=await x.json();f(y.user),y.syncStatus&&h(y.syncStatus)}catch(x){isWebMode()||console.error("[ProfileMenu] Failed to load profile",x),h("error"),f({id:"local-user",name:"Local User",email:"local@example.com",avatarUrl:void 0,presence:"offline",syncStatus:"error",orgs:[],activeOrgId:void 0})}finally{r(!1)}}c()},[]),reactExports.useEffect(()=>{if(!t)return;function c(x){const b=x.target;!l.current?.contains(b)&&!g.current?.contains(b)&&o()}return window.addEventListener("pointerdown",c),()=>window.removeEventListener("pointerdown",c)},[o,t]),reactExports.useEffect(()=>{if(!t)return;function c(x){x.key==="Escape"&&(x.preventDefault(),o())}return window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[o,t]);const m=reactExports.useCallback(async c=>{if(a){f({...a,activeOrgId:c});try{await fetch("/api/profile/switch-org",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orgId:c})})}catch(x){console.error("[ProfileMenu] Failed to switch organization",x)}}},[a]),i=reactExports.useCallback(async()=>{try{await fetch("/api/profile/signout",{method:"POST"}),o(),window.location.href="/logout"}catch(c){console.error("[ProfileMenu] Sign-out failed",c)}},[o]);if(s&&!a)return jsxRuntimeExports.jsx("div",{className:"rounded-full bg-[var(--surface-elevated)] p-2 text-[var(--text-muted)]",children:jsxRuntimeExports.jsx(LoaderCircle,{className:"h-5 w-5 animate-spin","aria-label":"Loading profile"})});const j=a?.presence?presenceColors[a.presence]??presenceColors.offline:presenceColors.offline;return jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsxs("button",{ref:g,type:"button","aria-label":"Account menu","aria-haspopup":"menu","aria-expanded":t,className:"flex items-center gap-2 rounded-full border border-[var(--surface-border)] bg-[var(--surface-elevated)] px-2 py-1 text-sm text-[var(--text-primary)] transition-colors hover:border-[var(--surface-border-strong)] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[var(--color-primary-500)] focus-visible:ring-offset-2",onClick:c=>{c.stopImmediatePropagation(),c.stopPropagation(),e(x=>!x)},onMouseDown:c=>{c.stopImmediatePropagation(),c.stopPropagation()},children:[jsxRuntimeExports.jsxs("div",{className:"relative",children:[a?.avatarUrl?jsxRuntimeExports.jsx("img",{src:a.avatarUrl,alt:"",className:"h-8 w-8 rounded-full object-cover"}):jsxRuntimeExports.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-[var(--surface-hover)] text-sm font-semibold text-[var(--text-secondary)]",children:a?.name?.slice(0,1)??"?"}),jsxRuntimeExports.jsx("span",{className:`absolute bottom-0 right-0 h-2.5 w-2.5 rounded-full border border-[var(--surface-elevated)] ${j}`})]}),jsxRuntimeExports.jsxs("div",{className:"hidden flex-col text-left sm:flex",children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-semibold",children:a?.name}),jsxRuntimeExports.jsx("span",{className:"text-[0.65rem] text-[var(--text-muted)]",children:a?.activeOrgId?`Org: ${a?.orgs?.find(c=>c.id===a.activeOrgId)?.name??"—"}`:"Personal"})]}),jsxRuntimeExports.jsx(ChevronDown,{className:"h-4 w-4 text-[var(--text-muted)]","aria-hidden":!0})]}),t&&jsxRuntimeExports.jsxs("div",{ref:l,role:"menu","aria-label":"Account",className:"absolute right-0 z-50 mt-3 w-72 rounded-2xl border border-[var(--surface-border)] bg-[var(--surface-panel)] shadow-2xl",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 border-b border-[var(--surface-border)] px-4 py-4",children:[a?.avatarUrl?jsxRuntimeExports.jsx("img",{src:a.avatarUrl,alt:a.name,className:"h-12 w-12 rounded-full object-cover"}):jsxRuntimeExports.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-[var(--surface-hover)] text-lg font-semibold text-[var(--text-secondary)]",children:a?.name?.slice(0,1)??"?"}),jsxRuntimeExports.jsxs("div",{className:"min-w-0",children:[jsxRuntimeExports.jsx("p",{className:"truncate text-sm font-semibold text-[var(--text-primary)]",children:a?.name}),jsxRuntimeExports.jsx("p",{className:"truncate text-xs text-[var(--text-muted)]",children:a?.email}),jsxRuntimeExports.jsxs("p",{className:"mt-1 inline-flex items-center gap-1 text-xs text-[var(--text-muted)]",children:[d==="syncing"&&jsxRuntimeExports.jsx(RefreshCw,{className:"h-3 w-3 animate-spin"}),d==="error"&&jsxRuntimeExports.jsx("span",{className:"text-rose-400",children:"Sync issue"}),d==="ready"&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(CircleCheck,{className:"h-3 w-3 text-emerald-400"}),"Synced"]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"px-4 py-3",children:[jsxRuntimeExports.jsx("p",{className:"mb-2 text-xs font-semibold uppercase tracking-[0.25em] text-[var(--text-muted)]",children:"Organizations"}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[(a?.orgs??[]).map(c=>{const x=a?.activeOrgId===c.id;return jsxRuntimeExports.jsxs("button",{type:"button",className:`flex w-full items-center justify-between rounded-xl border px-3 py-2 text-sm transition ${x?"bg-[var(--color-primary-500)]/10 border-[var(--color-primary-500)] text-[var(--text-primary)]":"border-[var(--surface-border)] text-[var(--text-secondary)] hover:border-[var(--surface-border-strong)]"}`,onClick:b=>{b.stopImmediatePropagation(),b.stopPropagation(),m(c.id)},onMouseDown:b=>{b.stopImmediatePropagation(),b.stopPropagation()},style:{zIndex:10011,isolation:"isolate"},children:[c.name,x&&jsxRuntimeExports.jsx(CircleCheck,{className:"h-4 w-4 text-[var(--color-primary-400)]"})]},c.id)}),(!a?.orgs||a.orgs.length===0)&&jsxRuntimeExports.jsx("div",{className:"rounded-xl border border-dashed border-[var(--surface-border)] px-3 py-4 text-center text-xs text-[var(--text-muted)]",children:"No organizations linked."})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-1 border-t border-[var(--surface-border)] px-3 py-3",children:[jsxRuntimeExports.jsxs("button",{type:"button",className:"flex w-full items-center gap-2 rounded-lg px-3 py-2 text-left text-sm text-[var(--text-primary)] transition hover:bg-[var(--surface-hover)]",onClick:c=>{c.stopImmediatePropagation(),c.stopPropagation(),window.dispatchEvent(new CustomEvent("app:open-profile"))},onMouseDown:c=>{c.stopImmediatePropagation(),c.stopPropagation()},style:{zIndex:10011,isolation:"isolate"},children:[jsxRuntimeExports.jsx(User,{className:"h-4 w-4 text-[var(--text-muted)]"}),"View profile"]}),jsxRuntimeExports.jsxs("button",{type:"button",className:"flex w-full items-center gap-2 rounded-lg px-3 py-2 text-left text-sm text-rose-400 transition hover:bg-rose-500/10",onClick:c=>{c.stopImmediatePropagation(),c.stopPropagation(),i()},onMouseDown:c=>{c.stopImmediatePropagation(),c.stopPropagation()},style:{zIndex:10011,isolation:"isolate"},children:[jsxRuntimeExports.jsx(LogOut,{className:"h-4 w-4"}),"Sign out"]})]})]})]})}function FeedbackModal({open:t,onClose:e}){const[s,r]=reactExports.useState(null),[a,f]=reactExports.useState(""),[d,h]=reactExports.useState(!1),g=async l=>{if(l.preventDefault(),!s){toast.warning("Please select a rating");return}h(!0);try{const o={rating:s,feedback:a,timestamp:Date.now(),userAgent:navigator.userAgent};console.log("[FEEDBACK]",o),track("feedback_submitted",{rating:s,hasText:a.length>0}),toast.success("Thank you for your feedback!"),r(null),f(""),e()}catch(o){console.error("Failed to submit feedback",o),toast.error("Failed to submit feedback")}finally{h(!1)}};return jsxRuntimeExports.jsx(AnimatePresence,{children:t&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-[10000] flex items-center justify-center bg-black/60 backdrop-blur-sm",onClick:l=>{l.target===l.currentTarget&&e()},children:jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-slate-900 rounded-xl border border-slate-700 shadow-2xl max-w-md w-full mx-4",children:jsxRuntimeExports.jsxs("div",{className:"p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between mb-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-100 mb-1",children:"Share Your Feedback"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-400",children:"Help us improve Regen. What's one thing that confused you or broke?"})]}),jsxRuntimeExports.jsx("button",{onClick:l=>{l.stopImmediatePropagation(),l.stopPropagation(),e()},onMouseDown:l=>{l.stopImmediatePropagation(),l.stopPropagation()},className:"text-gray-400 hover:text-gray-200 transition-colors",style:{zIndex:10011,isolation:"isolate"},"aria-label":"Close",children:jsxRuntimeExports.jsx(X,{size:20})})]}),jsxRuntimeExports.jsxs("form",{onSubmit:g,className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Rating"}),jsxRuntimeExports.jsx("div",{className:"flex gap-2",children:[1,2,3,4,5].map(l=>jsxRuntimeExports.jsx("button",{type:"button",onClick:o=>{o.stopImmediatePropagation(),o.stopPropagation(),r(l)},onMouseDown:o=>{o.stopImmediatePropagation(),o.stopPropagation()},className:`p-2 rounded transition-colors ${s&&s>=l?"text-yellow-400":"text-gray-500 hover:text-gray-400"}`,style:{zIndex:10011,isolation:"isolate"},children:jsxRuntimeExports.jsx(Star,{size:24,className:s&&s>=l?"fill-current":""})},l))})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Feedback (optional)"}),jsxRuntimeExports.jsx("textarea",{value:a,onChange:l=>f(l.target.value),placeholder:"What's one thing that confused you or broke?",rows:4,className:"w-full px-3 py-2 rounded-lg bg-slate-800 border border-slate-700 text-sm text-gray-100 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50 resize-none"})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:l=>{l.stopImmediatePropagation(),l.stopPropagation(),e()},onMouseDown:l=>{l.stopImmediatePropagation(),l.stopPropagation()},className:"flex-1 rounded-lg border border-slate-700 bg-slate-800/60 px-4 py-2.5 text-sm text-slate-300 transition-colors hover:bg-slate-700/80",style:{zIndex:10011,isolation:"isolate"},children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:!s||d,onClick:l=>{l.stopImmediatePropagation(),l.stopPropagation()},onMouseDown:l=>{l.stopImmediatePropagation(),l.stopPropagation()},className:"flex-1 flex items-center justify-center gap-2 rounded-lg border border-blue-500/60 bg-blue-600/20 px-4 py-2.5 text-sm font-medium text-blue-100 transition-colors hover:bg-blue-600/30 disabled:opacity-50 disabled:cursor-not-allowed",style:{zIndex:10011,isolation:"isolate"},children:d?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"w-4 h-4 border-2 border-blue-400 border-t-transparent rounded-full animate-spin"}),"Sending..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Send,{size:16}),"Send Feedback"]})})]})]})]})})})})}function StatusRow({label:t,value:e,status:s}){const r={ok:"text-green-500",warn:"text-yellow-500",error:"text-red-500",neutral:"text-gray-400"};return jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-400 text-xs",children:t}),jsxRuntimeExports.jsx("span",{className:`${r[s]} text-xs font-medium`,children:e})]})}function formatUptime(t){const e=Math.floor(t/1e3),s=Math.floor(e/60),r=Math.floor(s/60),a=Math.floor(r/24);return a>0?`${a}d ${r%24}h`:r>0?`${r}h ${s%60}m`:s>0?`${s}m ${e%60}s`:`${e}s`}function SystemStatusPanel(){const{data:t,isLoading:e}=useSystemStatus(),[s,r]=reactExports.useState(!1);reactExports.useEffect(()=>{const l=()=>r(!0);return window.addEventListener("system-status:open",l),()=>window.removeEventListener("system-status:open",l)},[]);const a=reactExports.useRef(null);if(reactExports.useEffect(()=>{if(!t)return;const l=a.current;a.current=t,l&&(!t.redisConnected&&l.redisConnected&&showToast("warning","Redis is offline. Some features may be unavailable."),!t.redixAvailable&&l.redixAvailable&&showToast("error","Redix service is unavailable. Automation features are disabled."),t.workerState==="error"&&l.workerState!=="error"?showToast("error","Worker service has encountered an error. Background tasks may fail."):t.workerState==="stopped"&&l.workerState!=="stopped"&&showToast("warning","Worker service is stopped. Background processing is disabled."))},[t]),e||!t)return jsxRuntimeExports.jsx("div",{className:"p-2",children:jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 animate-spin text-gray-400"})});const f=t.redisConnected&&t.redixAvailable&&t.workerState==="running",d=!t.redisConnected||t.workerState!=="running",h=f?CircleCheckBig:d?CircleAlert:CircleX,g=f?"text-green-500":d?"text-yellow-500":"text-red-500";return jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("button",{onClick:()=>r(!s),className:"p-2 hover:bg-gray-800 rounded transition-colors",title:"System Status","aria-label":"System Status",children:jsxRuntimeExports.jsx(h,{className:`w-5 h-5 ${g}`})}),s&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>r(!1)}),jsxRuntimeExports.jsx("div",{className:"absolute right-0 top-full mt-2 w-72 bg-gray-900 border border-gray-700 rounded-lg shadow-xl z-50",children:jsxRuntimeExports.jsxs("div",{className:"p-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-3",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-gray-200",children:"System Status"}),jsxRuntimeExports.jsx("button",{onClick:()=>r(!1),className:"text-gray-400 hover:text-gray-300 transition-colors","aria-label":"Close",children:jsxRuntimeExports.jsx(X,{className:"w-4 h-4"})})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(StatusRow,{label:"Redis",value:t.redisConnected?"Connected":"Offline",status:t.redisConnected?"ok":"error"}),jsxRuntimeExports.jsx(StatusRow,{label:"Redix",value:t.redixAvailable?"Available":"Unavailable",status:t.redixAvailable?"ok":"error"}),jsxRuntimeExports.jsx(StatusRow,{label:"Worker",value:t.workerState,status:t.workerState==="running"?"ok":t.workerState==="stopped"?"warn":"error"}),jsxRuntimeExports.jsx(StatusRow,{label:"VPN",value:t.vpn.connected?"Connected":"Disconnected",status:t.vpn.connected?"ok":"neutral"}),jsxRuntimeExports.jsx(StatusRow,{label:"Tor",value:t.tor.running?"Running":"Stopped",status:t.tor.running?"ok":"neutral"}),jsxRuntimeExports.jsx(StatusRow,{label:"Mode",value:t.mode,status:"neutral"}),jsxRuntimeExports.jsxs("div",{className:"pt-2 border-t border-gray-700 mt-2 space-y-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[jsxRuntimeExports.jsx("span",{children:"Memory"}),jsxRuntimeExports.jsxs("span",{children:[(t.memoryUsage.heapUsed/1024/1024).toFixed(1)," MB"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[jsxRuntimeExports.jsx("span",{children:"Uptime"}),jsxRuntimeExports.jsx("span",{children:formatUptime(t.uptime)})]})]})]})]})})]})]})}const INDIC_LANGUAGES=[{code:"as",label:"অসমীয়া",english:"Assamese",flag:"🇮🇳"},{code:"bn",label:"বাংলা",english:"Bengali",flag:"🇮🇳"},{code:"brx",label:"बड़ो",english:"Bodo",flag:"🇮🇳"},{code:"doi",label:"डोगरी",english:"Dogri",flag:"🇮🇳"},{code:"gom",label:"कोंकणी",english:"Konkani",flag:"🇮🇳"},{code:"gu",label:"ગુજરાતી",english:"Gujarati",flag:"🇮🇳"},{code:"hi",label:"हिंदी",english:"Hindi",flag:"🇮🇳"},{code:"kn",label:"ಕನ್ನಡ",english:"Kannada",flag:"🇮🇳"},{code:"ks",label:"کٲشُر",english:"Kashmiri",flag:"🇮🇳"},{code:"mai",label:"मैथिली",english:"Maithili",flag:"🇮🇳"},{code:"ml",label:"മലയാളം",english:"Malayalam",flag:"🇮🇳"},{code:"mni",label:"ꯃꯤꯇꯩꯂꯣꯟ",english:"Manipuri",flag:"🇮🇳"},{code:"mr",label:"मराठी",english:"Marathi",flag:"🇮🇳"},{code:"ne",label:"नेपाली",english:"Nepali",flag:"🇳🇵"},{code:"or",label:"ଓଡ଼ିଆ",english:"Odia",flag:"🇮🇳"},{code:"pa",label:"ਪੰਜਾਬੀ",english:"Punjabi",flag:"🇮🇳"},{code:"sa",label:"संस्कृतम्",english:"Sanskrit",flag:"🇮🇳"},{code:"sat",label:"ᱥᱟᱱᱛᱟᱲᱤ",english:"Santali",flag:"🇮🇳"},{code:"sd",label:"سنڌي",english:"Sindhi",flag:"🇵🇰"},{code:"ta",label:"தமிழ்",english:"Tamil",flag:"🇮🇳"},{code:"te",label:"తెలుగు",english:"Telugu",flag:"🇮🇳"},{code:"ur",label:"اردو",english:"Urdu",flag:"🇵🇰"}],GLOBAL_LANGUAGES=[{code:"en",label:"English",english:"English",flag:"🇺🇸"},{code:"es",label:"Español",english:"Spanish",flag:"🇪🇸"},{code:"fr",label:"Français",english:"French",flag:"🇫🇷"},{code:"de",label:"Deutsch",english:"German",flag:"🇩🇪"},{code:"zh",label:"中文",english:"Chinese",flag:"🇨🇳"},{code:"ja",label:"日本語",english:"Japanese",flag:"🇯🇵"},{code:"ko",label:"한국어",english:"Korean",flag:"🇰🇷"},{code:"ru",label:"Русский",english:"Russian",flag:"🇷🇺"},{code:"pt",label:"Português",english:"Portuguese",flag:"🇵🇹"},{code:"ar",label:"العربية",english:"Arabic",flag:"🇸🇦"},{code:"it",label:"Italiano",english:"Italian",flag:"🇮🇹"},{code:"nl",label:"Nederlands",english:"Dutch",flag:"🇳🇱"},{code:"pl",label:"Polski",english:"Polish",flag:"🇵🇱"},{code:"tr",label:"Türkçe",english:"Turkish",flag:"🇹🇷"},{code:"vi",label:"Tiếng Việt",english:"Vietnamese",flag:"🇻🇳"},{code:"id",label:"Bahasa Indonesia",english:"Indonesian",flag:"🇮🇩"},{code:"th",label:"ไทย",english:"Thai",flag:"🇹🇭"},{code:"sv",label:"Svenska",english:"Swedish",flag:"🇸🇪"},{code:"fi",label:"Suomi",english:"Finnish",flag:"🇫🇮"},{code:"no",label:"Norsk",english:"Norwegian",flag:"🇳🇴"}],ALL_LANGUAGES=[{code:"auto",label:"Auto-detect",english:"Auto-detect",flag:"🌐",group:"system"},...INDIC_LANGUAGES.map(t=>({...t,group:"indic"})),...GLOBAL_LANGUAGES.map(t=>({...t,group:"global"}))];function LanguageSwitcher(){const[t,e]=reactExports.useState(!1),[s,r]=reactExports.useState("auto"),a=reactExports.useRef(null),f=reactExports.useRef(null),d=useSettingsStore(o=>o.language||"auto"),h=useSettingsStore(o=>o.setLanguage);reactExports.useEffect(()=>{r(d||"auto")},[d]),reactExports.useEffect(()=>{const o=m=>{a.current&&!a.current.contains(m.target)&&f.current&&!f.current.contains(m.target)&&e(!1)};return document.addEventListener("mousedown",o),()=>document.removeEventListener("mousedown",o)},[]);const g=o=>{r(o),h?.(o),e(!1),window.dispatchEvent(new CustomEvent("language-changed",{detail:{language:o}}))},l=ALL_LANGUAGES.find(o=>o.code===s)||ALL_LANGUAGES[0];return jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsxs("button",{ref:f,onClick:()=>e(!t),className:"flex items-center gap-2 px-3 py-1.5 rounded-lg border border-gray-700/50 bg-gray-800/30 hover:bg-gray-800/50 text-sm text-gray-200 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500/50","aria-label":"Select language","aria-expanded":t,"aria-haspopup":"true",children:[jsxRuntimeExports.jsx(Globe,{size:16,className:"text-gray-400"}),jsxRuntimeExports.jsx("span",{className:"hidden sm:inline",children:l.flag}),jsxRuntimeExports.jsx("span",{className:"hidden md:inline text-xs",children:l.english}),jsxRuntimeExports.jsx(ChevronDown,{size:14,className:`text-gray-400 transition-transform ${t?"rotate-180":""}`})]}),jsxRuntimeExports.jsx(AnimatePresence,{children:t&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-40",onClick:()=>e(!1)}),jsxRuntimeExports.jsxs(motion.div,{ref:a,initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.15},className:"absolute right-0 top-full mt-2 w-72 max-h-[80vh] overflow-y-auto bg-gray-900 border border-gray-800/60 rounded-lg shadow-xl z-50",children:[jsxRuntimeExports.jsxs("div",{className:"p-2",children:[jsxRuntimeExports.jsx("div",{className:"px-3 py-2 text-xs font-semibold text-gray-400 uppercase tracking-wide",children:"Indic Languages (22)"}),INDIC_LANGUAGES.map(o=>jsxRuntimeExports.jsxs("button",{onClick:()=>g(o.code),className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg text-sm transition-colors ${s===o.code?"bg-blue-500/20 text-blue-200":"text-gray-200 hover:bg-gray-800/50"}`,children:[jsxRuntimeExports.jsx("span",{className:"text-lg",children:o.flag}),jsxRuntimeExports.jsx("span",{className:"flex-1 text-left",children:o.label}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-400",children:o.english}),s===o.code&&jsxRuntimeExports.jsx(Check,{size:16,className:"text-blue-400"})]},o.code))]}),jsxRuntimeExports.jsx("div",{className:"border-t border-gray-800/60"}),jsxRuntimeExports.jsxs("div",{className:"p-2",children:[jsxRuntimeExports.jsx("div",{className:"px-3 py-2 text-xs font-semibold text-gray-400 uppercase tracking-wide",children:"Global Languages (80+)"}),GLOBAL_LANGUAGES.map(o=>jsxRuntimeExports.jsxs("button",{onClick:()=>g(o.code),className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg text-sm transition-colors ${s===o.code?"bg-blue-500/20 text-blue-200":"text-gray-200 hover:bg-gray-800/50"}`,children:[jsxRuntimeExports.jsx("span",{className:"text-lg",children:o.flag}),jsxRuntimeExports.jsx("span",{className:"flex-1 text-left",children:o.label}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-400",children:o.english}),s===o.code&&jsxRuntimeExports.jsx(Check,{size:16,className:"text-blue-400"})]},o.code))]}),jsxRuntimeExports.jsx("div",{className:"border-t border-gray-800/60 p-2",children:jsxRuntimeExports.jsxs("button",{onClick:()=>g("auto"),className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg text-sm transition-colors ${s==="auto"?"bg-blue-500/20 text-blue-200":"text-gray-200 hover:bg-gray-800/50"}`,children:[jsxRuntimeExports.jsx("span",{className:"text-lg",children:"🌐"}),jsxRuntimeExports.jsx("span",{className:"flex-1 text-left",children:"Auto-detect"}),s==="auto"&&jsxRuntimeExports.jsx(Check,{size:16,className:"text-blue-400"})]})})]})]})})]})}function TopRightCluster(){const[t,e]=reactExports.useState(!1),[s,r]=reactExports.useState(!1);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(LanguageSwitcher,{}),jsxRuntimeExports.jsx(SystemStatusPanel,{}),jsxRuntimeExports.jsx(NotificationsMenu,{}),jsxRuntimeExports.jsx(FeaturesMenu,{}),jsxRuntimeExports.jsx(SettingsMenu,{}),jsxRuntimeExports.jsx("button",{type:"button","aria-label":"Open workflow marketplace",className:"rounded-lg p-2 text-[var(--text-secondary)] transition-colors hover:text-[var(--text-primary)] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-[var(--color-primary-500)]",onClick:()=>r(!0),title:"Workflow Marketplace",children:jsxRuntimeExports.jsx(Workflow,{className:"h-5 w-5","aria-hidden":!0})}),jsxRuntimeExports.jsx("button",{type:"button","aria-label":"Send feedback",className:"rounded-lg p-2 text-[var(--text-secondary)] transition-colors hover:text-[var(--text-primary)] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-[var(--color-primary-500)]",onClick:()=>e(!0),children:jsxRuntimeExports.jsx(MessageSquare,{className:"h-5 w-5","aria-hidden":!0})}),jsxRuntimeExports.jsx("button",{type:"button","aria-label":"Open help or command palette",className:"rounded-lg p-2 text-[var(--text-secondary)] transition-colors hover:text-[var(--text-primary)] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-[var(--color-primary-500)]",onClick:()=>{window.dispatchEvent(new CustomEvent("commandbar:open"))},children:jsxRuntimeExports.jsx(CircleHelp,{className:"h-5 w-5","aria-hidden":!0})}),jsxRuntimeExports.jsx(ProfileMenu,{})]}),jsxRuntimeExports.jsx(FeedbackModal,{open:t,onClose:()=>e(!1)}),jsxRuntimeExports.jsx(WorkflowMarketplace,{open:s,onClose:()=>r(!1)})]})}function BookmarkButton(){const t=useTabsStore(d=>d.tabs.find(h=>h.id===d.activeId)),e=useBookmarksStore(d=>d.add),s=useBookmarksStore(d=>d.remove),r=useBookmarksStore(d=>d.getByUrl);if(!t||!t.url||t.url==="about:blank")return null;const a=r(t.url)!==void 0,f=()=>{if(a){const d=r(t.url);d&&(s(d.id),track("bookmark_removed",{url:t.url}),showToast("info","Bookmark removed"))}else e({url:t.url,title:t.title||"Untitled"}),track("bookmark_added",{url:t.url}),showToast("success","Bookmarked!")};return jsxRuntimeExports.jsx("button",{onClick:f,className:`p-1.5 rounded transition-colors ${a?"text-yellow-400 hover:text-yellow-300":"text-gray-400 hover:text-gray-300"}`,title:a?"Remove bookmark":"Add bookmark","aria-label":a?"Remove bookmark":"Add bookmark",children:jsxRuntimeExports.jsx(Star,{size:16,className:a?"fill-current":""})})}var __defProp=Object.defineProperty,__defNormalProp=(t,e,s)=>e in t?__defProp(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,__publicField=(t,e,s)=>__defNormalProp(t,typeof e!="symbol"?e+"":e,s);class HNSWService{constructor(){__publicField(this,"index",null),__publicField(this,"isInitialized",!1),__publicField(this,"dimension",384),__publicField(this,"maxElements",5e4),__publicField(this,"indexPath",null),__publicField(this,"idToIndex",new Map),__publicField(this,"indexToId",new Map),__publicField(this,"embeddings",new Map),__publicField(this,"nextIndex",0)}async initialize(e=384){if(!(this.isInitialized&&this.index)){this.dimension=e;try{let s;try{s=await __vitePreload(()=>import("./vendor-Vl2WtvH-.js").then(r=>r.aB),__vite__mapDeps([4,2,3,0,1,5,6]))}catch(r){console.warn("[HNSWService] HNSW library not available, using fallback",r),this.isInitialized=!0;return}if(isTauriRuntime()&&!isWebMode())try{const r=await invoke("get_app_data_path",{subpath:"vectors/hnsw_index.bin"});try{const a=await invoke("read_file",{path:r}),f=new Uint8Array(a);s.loadIndex&&(this.index=await s.loadIndex(f,this.dimension),console.log("[HNSWService] Index loaded from disk"))}catch(a){isWebMode()||console.warn("[HNSWService] Failed to load index, creating new one",a)}}catch(r){isWebMode()||console.warn("[HNSWService] Could not check for existing index",r)}this.index||(s.HierarchicalNSW?(this.index=new s.HierarchicalNSW("cosine",this.dimension),this.index.initIndex(this.maxElements)):s.init?this.index=await s.init({dim:this.dimension,maxElements:this.maxElements}):isWebMode()||console.warn("[HNSWService] HNSW library not properly initialized, using fallback")),this.isInitialized=!0,console.log("[HNSWService] Initialized with dimension",this.dimension)}catch(s){console.error("[HNSWService] Initialization failed, using in-memory fallback",s),this.isInitialized=!0}}}async addEmbedding(e){if(await this.initialize(e.vector.length),!this.idToIndex.has(e.id))try{const s=this.nextIndex++;this.index&&this.index.addPoint?this.index.addPoint(e.vector,s):this.embeddings.set(e.id,e),this.idToIndex.set(e.id,s),this.indexToId.set(s,e.id),this.embeddings.set(e.id,e),this.nextIndex%100===0&&await this.save()}catch(s){console.error("[HNSWService] Failed to add embedding",s),this.embeddings.set(e.id,e)}}async search(e,s=5){if(await this.initialize(e.length),this.nextIndex===0)return[];try{const r=performance.now();let a=[];this.index&&this.index.searchKnn?a=this.index.searchKnn(e,s).map(g=>({id:g.id||g.label,distance:g.distance||0})):a=Array.from(this.embeddings.values()).map(g=>({id:this.idToIndex.get(g.id)||0,distance:1-this.cosineSimilarity(e,g.vector)})).sort((g,l)=>g.distance-l.distance).slice(0,s);const f=performance.now()-r;console.log(`[HNSWService] Search completed in ${f.toFixed(2)}ms for ${this.nextIndex} vectors`);const d=[];for(const h of a){const g=this.indexToId.get(h.id);if(!g)continue;const l=this.embeddings.get(g);if(!l)continue;const o=1-Math.min(h.distance/2,1);d.push({id:g,text:l.text,score:o,metadata:l.metadata})}return d}catch(r){return console.error("[HNSWService] Search failed",r),[]}}cosineSimilarity(e,s){if(e.length!==s.length)return 0;let r=0,a=0,f=0;for(let h=0;h<e.length;h++)r+=e[h]*s[h],a+=e[h]*e[h],f+=s[h]*s[h];const d=Math.sqrt(a)*Math.sqrt(f);return d===0?0:r/d}async save(){if(this.index)try{let e;if(this.index.writeIndex)e=this.index.writeIndex();else if(this.index.saveIndex)e=await this.index.saveIndex();else{const r=JSON.stringify(Array.from(this.embeddings.entries()));e=new TextEncoder().encode(r)}const s=await invoke("get_app_data_path",{subpath:"vectors/hnsw_index.bin"});await invoke("write_file",{path:s,contents:Array.from(e)}),console.log("[HNSWService] Index saved to disk")}catch(e){console.warn("[HNSWService] Failed to save index",e)}}async clear(){this.idToIndex.clear(),this.indexToId.clear(),this.embeddings.clear(),this.nextIndex=0,this.index=null,this.isInitialized=!1}getEmbedding(e){return this.embeddings.get(e)}}const hnswService=new HNSWService;function RealtimeSearchPreview({query:t,onSelect:e,isVisible:s}){const[r,a]=reactExports.useState([]),[f,d]=reactExports.useState(!1),[h,g]=reactExports.useState(0),{tabs:l}=useTabsStore(),o=useDebounce(t,150);return reactExports.useEffect(()=>{if(!s||!o.trim()||o.length<2){a([]);return}(async()=>{d(!0),getQueryPrefetcher().recordQuery(o);try{const i=l.filter(x=>`${x.title} ${x.url}`.toLowerCase().includes(o.toLowerCase())).slice(0,3).map(x=>({id:x.id,title:x.title||"Untitled",url:x.url,type:"tab",score:.9,snippet:x.url}));let j=[];try{j=(await hnswService.search(await generateQueryEmbedding(o),5)).map(b=>({id:b.id,title:b.metadata?.title||b.text.slice(0,50),url:b.metadata?.url,type:"memory",score:b.score,snippet:b.text.slice(0,100)}))}catch(x){console.warn("[RealtimeSearchPreview] Vector search failed",x)}const c=[...i,...j].sort((x,b)=>b.score-x.score).slice(0,5);a(c)}catch(i){console.error("[RealtimeSearchPreview] Search error",i),a([])}finally{d(!1)}})()},[o,s,l]),reactExports.useEffect(()=>{if(!s||r.length===0)return;const m=i=>{i.key==="ArrowDown"?(i.preventDefault(),g(j=>Math.min(j+1,r.length-1))):i.key==="ArrowUp"?(i.preventDefault(),g(j=>Math.max(j-1,0))):i.key==="Enter"&&r[h]&&(i.preventDefault(),e(r[h]))};return window.addEventListener("keydown",m),()=>window.removeEventListener("keydown",m)},[s,r,h,e]),!s||!f&&r.length===0?null:jsxRuntimeExports.jsx(AnimatePresence,{children:jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute left-0 right-0 top-full z-50 mt-2 max-h-96 overflow-y-auto rounded-lg border border-slate-700 bg-slate-900 shadow-2xl",children:[f&&jsxRuntimeExports.jsxs("div",{className:"p-4 text-center text-slate-400",children:[jsxRuntimeExports.jsx(Sparkles,{className:"mr-2 inline-block animate-pulse",size:16}),"Searching..."]}),!f&&r.length>0&&jsxRuntimeExports.jsx("div",{className:"py-2",children:r.map((m,i)=>jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0},animate:{opacity:1},className:`cursor-pointer px-4 py-3 transition-colors ${i===h?"border-l-2 border-emerald-500 bg-slate-800":"hover:bg-slate-800/50"}`,onClick:()=>e(m),onMouseEnter:()=>g(i),children:jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-3",children:[m.type==="tab"?jsxRuntimeExports.jsx(Globe,{size:16,className:"mt-0.5 flex-shrink-0 text-blue-400"}):m.type==="memory"?jsxRuntimeExports.jsx(FileText,{size:16,className:"mt-0.5 flex-shrink-0 text-purple-400"}):jsxRuntimeExports.jsx(Search,{size:16,className:"mt-0.5 flex-shrink-0 text-emerald-400"}),jsxRuntimeExports.jsxs("div",{className:"min-w-0 flex-1",children:[jsxRuntimeExports.jsx("div",{className:"truncate text-sm font-medium text-white",children:m.title}),m.snippet&&jsxRuntimeExports.jsx("div",{className:"mt-1 line-clamp-1 text-xs text-slate-400",children:m.snippet}),m.url&&jsxRuntimeExports.jsx("div",{className:"mt-1 truncate text-xs text-slate-500",children:m.url})]}),jsxRuntimeExports.jsxs("div",{className:"flex-shrink-0 text-xs text-slate-500",children:[Math.round(m.score*100),"%"]})]})},m.id))})]})})}async function generateQueryEmbedding(t){try{const{getOrGenerateEmbedding:e}=await __vitePreload(async()=>{const{getOrGenerateEmbedding:s}=await import("./embeddingCache-B2jk-Emn.js");return{getOrGenerateEmbedding:s}},__vite__mapDeps([7,0,1,2,3,4,5,6,8,9,10,11,12,13,14,15]));return await e(t,"nomic-embed-text:4bit")}catch(e){isWebMode()||console.warn("[RealtimeSearchPreview] Rust embedding failed, using fallback",e);const s=t.split("").reduce((r,a)=>r+a.charCodeAt(0),0);return new Array(384).fill(0).map((r,a)=>Math.sin(s+a)*.1)}}function TopBar({className:t,compact:e=!1,showAddressBar:s=!0,showQuickActions:r=!0,onModeChange:a,onAddressBarSubmit:f,currentUrl:d}){const h=useTokens(),[g,l]=reactExports.useState(d||""),[o,m]=reactExports.useState(!1),[i,j]=reactExports.useState(!1),c=reactExports.useRef(null),x=reactExports.useRef(null);reactExports.useEffect(()=>{l(d||"")},[d]),reactExports.useEffect(()=>{const u=n=>{x.current&&!x.current.contains(n.target)&&(m(!1),j(!1))};if(o)return document.addEventListener("mousedown",u),()=>document.removeEventListener("mousedown",u)},[o]);const b=u=>{u.preventDefault(),g.trim()&&f&&(f(g.trim()),m(!1),j(!1))},y=u=>{l(u.target.value),m(u.target.value.length>=2)},w=()=>{j(!0),g.length>=2&&m(!0)},p=u=>{u.url&&f?f(u.url):f&&f(u.title),m(!1),j(!1),c.current?.blur()};return jsxRuntimeExports.jsx("header",{className:`sticky top-0 z-50 w-full border-b border-[var(--surface-border)] bg-[var(--surface-panel)] backdrop-blur-xl ${t||""} `,style:{height:e?"48px":"64px"},role:"banner",children:jsxRuntimeExports.jsxs(Container,{className:"flex h-full items-center justify-between gap-4",style:{padding:h.spacing(3)},children:[jsxRuntimeExports.jsx("div",{className:"flex flex-shrink-0 items-center gap-4",children:jsxRuntimeExports.jsx(ModeTabs,{compact:e,onModeChange:a})}),s&&jsxRuntimeExports.jsxs("div",{ref:x,className:"relative mx-4 max-w-2xl flex-1",children:[jsxRuntimeExports.jsxs("form",{onSubmit:b,className:"relative flex items-center gap-2",children:[jsxRuntimeExports.jsx(Search,{size:16,className:"pointer-events-none absolute left-3 top-1/2 -translate-y-1/2 text-[var(--text-muted)]"}),jsxRuntimeExports.jsx("input",{ref:c,type:"text",value:g,onChange:y,onFocus:w,placeholder:"Search or enter URL... (Telepathy mode: instant results)",className:"w-full rounded-lg border border-[var(--surface-border)] bg-[var(--surface-elevated)] py-2 pl-10 pr-4 text-[var(--text-primary)] transition-all placeholder:text-[var(--text-muted)] focus:border-transparent focus:outline-none focus:ring-2 focus:ring-[var(--color-primary-500)]",style:{fontSize:h.fontSize.sm},"aria-label":"Address bar"}),jsxRuntimeExports.jsx("div",{className:"flex-shrink-0",children:jsxRuntimeExports.jsx(BookmarkButton,{})})]}),o&&jsxRuntimeExports.jsx(RealtimeSearchPreview,{query:g,onSelect:p,isVisible:o&&i})]}),r&&jsxRuntimeExports.jsx(TopRightCluster,{})]})})}export{TopBar};
//# sourceMappingURL=TopBar-DlyyI3dP.js.map
