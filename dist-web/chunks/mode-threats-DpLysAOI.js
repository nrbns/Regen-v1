import{r as l,j as e,e as i,s as f,o as v,g as N,t as u,E as w,u as z,v as S}from"./vendor-react-gmX1Lmvt.js";import{g as L}from"./core-ai-yFIunLTZ.js";import"./vendor-react-dom-Bkb6jJ_S.js";import"./vendor-Vl2WtvH-.js";import"./vendor-zustand-BWsgwsXr.js";import"./mode-manager.ts-DwguZmJt.js";import"./core-memory-DmK-uh9X.js";function I(){const[a,h]=l.useState(""),[t,n]=l.useState(null),[c,d]=l.useState(!1),[o,x]=l.useState(null),p=L("threats.agent"),y=async s=>{if(s.preventDefault(),!!a.trim()){d(!0),x(null),n(null);try{let r=null;try{r=await window.api?.threats?.scanUrl?.(a)}catch{console.warn("[ThreatsPanel] IPC scan not available, using agent only")}const g=await p({prompt:`Analyze security threats for URL: ${a}`,context:{mode:"Threats",url:a,scanResult:r}}),j={url:a,riskLevel:r?.riskLevel||"medium",threats:r?.threats||[{type:"General Security Check",severity:"medium",description:"Security analysis completed via AI agent",recommendation:"Review AI analysis below for specific recommendations"}],aiAnalysis:g.success?g.output:void 0};n(j)}catch(r){console.error("[ThreatsPanel] Scan failed:",r),x(r instanceof Error?r.message:"Failed to scan URL")}finally{d(!1)}}},m=s=>{switch(s){case"critical":return"text-red-400 bg-red-500/10 border-red-500/30";case"high":return"text-orange-400 bg-orange-500/10 border-orange-500/30";case"medium":return"text-yellow-400 bg-yellow-500/10 border-yellow-500/30";case"low":return"text-green-400 bg-green-500/10 border-green-500/30"}},b=s=>{switch(s){case"critical":case"high":return e.jsx(S,{size:16,className:"text-red-400"});case"medium":return e.jsx(u,{size:16,className:"text-yellow-400"});case"low":return e.jsx(z,{size:16,className:"text-green-400"});default:return e.jsx(i,{size:16,className:"text-gray-400"})}};return e.jsxs("div",{className:"flex h-full flex-col bg-[#1A1D28] text-gray-100",children:[e.jsx("div",{className:"border-b border-gray-800/40 bg-gray-900/40 px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"rounded-lg bg-red-500/10 p-2",children:e.jsx(i,{size:20,className:"text-red-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-100",children:"Threat Mode"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Security analysis with network isolation"})]}),e.jsxs("div",{className:"ml-auto flex items-center gap-2 text-xs text-green-400",children:[e.jsx(f,{size:14}),e.jsx("span",{children:"Ghost Mode + Tor Active"})]})]})}),e.jsx("div",{className:"border-b border-gray-800/40 px-6 py-4",children:e.jsxs("form",{onSubmit:y,className:"flex gap-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(v,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"url",value:a,onChange:s=>h(s.target.value),placeholder:"Enter URL to scan for threats...",className:"w-full bg-gray-800/50 border border-gray-700/50 rounded-lg pl-10 pr-4 py-2.5 text-sm text-gray-200 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-red-500/50 focus:border-red-500/50"})]}),e.jsx("button",{type:"submit",disabled:c||!a.trim(),className:"px-6 py-2.5 bg-red-600 hover:bg-red-500 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg text-sm font-medium text-white transition-colors flex items-center gap-2",children:c?e.jsxs(e.Fragment,{children:[e.jsx(N,{size:16,className:"animate-spin"}),"Scanning..."]}):e.jsxs(e.Fragment,{children:[e.jsx(i,{size:16}),"Scan"]})})]})}),o&&e.jsx("div",{className:"border-b border-gray-800/40 bg-red-500/10 px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-300",children:[e.jsx(u,{size:18}),o]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:t?e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsx("div",{className:`rounded-lg border p-4 ${m(t.riskLevel)}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide mb-1",children:"Overall Risk Level"}),e.jsx("div",{className:"text-2xl font-bold capitalize",children:t.riskLevel})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"URL"}),e.jsxs("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"text-sm hover:underline flex items-center gap-1",children:[t.url,e.jsx(w,{size:14})]})]})]})}),t.aiAnalysis&&e.jsxs("div",{className:"rounded-lg border border-purple-500/30 bg-purple-500/5 p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-purple-300 mb-2",children:"AI Threat Analysis"}),e.jsx("div",{className:"text-sm text-gray-300 whitespace-pre-wrap",children:t.aiAnalysis})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-200",children:"Detected Threats"}),t.threats.map((s,r)=>e.jsx("div",{className:"rounded-lg border border-gray-700/50 bg-gray-800/30 p-4 space-y-2",children:e.jsx("div",{className:"flex items-start justify-between gap-3",children:e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[b(s.severity),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-200",children:s.type}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full border capitalize ${m(s.severity)}`,children:s.severity})]}),e.jsx("p",{className:"text-sm text-gray-300",children:s.description}),e.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:[e.jsx("span",{className:"font-semibold",children:"Recommendation:"})," ",s.recommendation]})]})]})})},r))]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[e.jsx("div",{className:"rounded-full border border-dashed border-gray-700/60 bg-gray-800/30 p-8 mb-4",children:e.jsx(i,{size:48,className:"text-gray-500"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-200 mb-2",children:"No scan results"}),e.jsx("p",{className:"text-sm text-gray-400 max-w-md",children:"Enter a URL above to analyze security threats, vulnerabilities, and get threat intelligence."})]})})]})}export{I as default};
//# sourceMappingURL=mode-threats-DpLysAOI.js.map
