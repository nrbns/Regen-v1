const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["chunks/mode-research-BclgCwOH.js","chunks/core-ai-yFIunLTZ.js","chunks/vendor-zustand-BWsgwsXr.js","chunks/vendor-react-gmX1Lmvt.js","chunks/vendor-react-dom-Bkb6jJ_S.js","chunks/vendor-Vl2WtvH-.js","chunks/mode-manager.ts-DwguZmJt.js","chunks/core-memory-DmK-uh9X.js","chunks/vendor-utils-5Vdoy44w.js","chunks/mode-docs-FcsoolLb.js","chunks/vendor-pdf-ejcqEZLU.js","chunks/vendor-mammoth-BPQIafDs.js","chunks/vendor-framer-motion-DDE19Uim.js","chunks/mode-trade-BU963YAc.js","chunks/vendor-charts-CEM9Czug.js","chunks/mode-threats-DpLysAOI.js"])))=>i.map(i=>d[i]);
import{i as f,e as be,a as ge,b as oe,_,t as ye}from"./core-ai-yFIunLTZ.js";import{r as l,j as e,F as W,a2 as B,E as G,X as I,S as H,aB as je,U as ve,o as we,g as E,aC as Ne,u as ke,aD as ne,aE as Se,aF as Ce,aG as Ae,Q as Re,aH as Ee}from"./vendor-react-gmX1Lmvt.js";import{a as q,i as Q,b as _e,E as T}from"../assets/index-D9cF9G1U.js";import{O as ze}from"./OmniDesk-C5fSodZ1.js";import{A as D,m as C}from"./vendor-framer-motion-DDE19Uim.js";import{s as L}from"./mode-research-BclgCwOH.js";import"./vendor-zustand-BWsgwsXr.js";import"./vendor-Vl2WtvH-.js";import"./mode-manager.ts-DwguZmJt.js";import"./core-memory-DmK-uh9X.js";import"./vendor-react-dom-Bkb6jJ_S.js";import"@tauri-apps/api/core";import"./vendor-utils-5Vdoy44w.js";import"./mode-docs-FcsoolLb.js";import"./vendor-pdf-ejcqEZLU.js";import"./vendor-mammoth-BPQIafDs.js";function Fe({isOpen:s,onClose:i,document:a,highlightText:r}){const o=l.useRef(null);l.useEffect(()=>{if(s&&r&&o.current){const c=o.current,u=r.toLowerCase();if(c.textContent?.toLowerCase().includes(u)){const N=window.document.createTreeWalker(c,NodeFilter.SHOW_TEXT,null);let j;for(;j=N.nextNode();)if(j.textContent?.toLowerCase().includes(u)){const m=j.parentElement;if(m&&m.textContent){const k=m.innerHTML.replace(new RegExp(r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi"),'<span class="bg-yellow-400/30 text-yellow-200 rounded px-1">$&</span>');m.innerHTML=k,m.scrollIntoView({behavior:"smooth",block:"center"});break}}}}},[s,r]);const d=async()=>{if(a.url)try{await f.tabs.create(a.url)}catch(c){console.error("Failed to open in tab:",c)}};return s?e.jsx(D,{children:e.jsx(C.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",onClick:i,children:e.jsxs(C.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"w-full max-w-4xl max-h-[90vh] bg-slate-950 border border-slate-800 rounded-2xl shadow-2xl flex flex-col overflow-hidden",onClick:c=>c.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-800 bg-slate-900",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-500/20 text-blue-400",children:a.type==="pdf"?e.jsx(W,{size:20}):e.jsx(B,{size:20})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-100 truncate",children:a.title}),a.url&&e.jsx("p",{className:"text-xs text-gray-400 truncate mt-1",children:a.url})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[a.url&&e.jsx("button",{onClick:d,className:"p-2 rounded-lg hover:bg-slate-800 text-gray-400 hover:text-gray-200 transition-colors",title:"Open in new tab",children:e.jsx(G,{size:18})}),e.jsx("button",{onClick:i,className:"p-2 rounded-lg hover:bg-slate-800 text-gray-400 hover:text-gray-200 transition-colors",children:e.jsx(I,{size:18})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:a.content?e.jsx("div",{ref:o,className:"prose prose-invert max-w-none text-gray-200 leading-relaxed",dangerouslySetInnerHTML:{__html:a.content}}):a.snippet?e.jsxs("div",{className:"text-gray-200 leading-relaxed",children:[e.jsx("p",{className:"text-lg mb-4",children:a.snippet}),e.jsx("p",{className:"text-sm text-gray-400",children:'Full document content not available. Click "Open in new tab" to view the complete document.'})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[e.jsx(W,{size:48,className:"opacity-50 mb-4"}),e.jsx("p",{children:"No content available for this document."})]})}),e.jsx("div",{className:"p-4 border-t border-slate-800 bg-slate-900/50",children:e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400",children:[e.jsx("span",{className:"px-2 py-1 rounded bg-slate-800 uppercase",children:a.type}),r&&e.jsxs("span",{className:"text-yellow-400",children:['Highlighted: "',r.slice(0,50),'..."']})]})})]})})}):null}function Te(s,i){const a=[];s.trim().length>0&&a.push({id:"save-summary",type:"save_summary",label:"Save summary to notes",description:"Store these key takeaways in the current research session.",payload:{summary:s},badge:"Recommended"});const r=i[0];return r?.url&&a.push({id:"open-source",type:"open_url",label:`Open ${r.label}`,description:"Review the highest-confidence citation in a new tab.",payload:{url:r.url}}),a.push({id:"follow-up",type:"follow_up",label:"Ask a follow-up question",description:"Use the summary to draft a more specific research prompt.",payload:{prompt:`Give me 3 follow-up questions based on this summary:
${s}`}}),a}function Le(s){return s?Object.entries(s).reduce((i,[a,r])=>(r!=null&&r!==""&&(i[a]=r),i),{}):{}}function Pe(s){if(!Array.isArray(s))return;const i=s.map(a=>{if(typeof a=="string")return a;if(a&&typeof a=="object"){const r="url"in a&&typeof a.url=="string"?a.url:void 0,o="label"in a&&typeof a.label=="string"?a.label:void 0;return r||o}}).filter(a=>!!a);return i.length?i:void 0}function ie(s,i,a){const r=s.trim(),o=i?.map((d,c)=>({label:d.replace(/^https?:\/\//,"").split("/")[0]||`Source ${c+1}`,url:d}))||[];return{summary:r||"No summary available.",confidence:r?.78:.4,actions:Te(r,o),citations:o,model:a}}async function Ie(s){const i={url:s.context.url,text:s.context.selection||s.context.notes};try{const a=await f.agent.ask(s.prompt,i);if(!a||!a.answer)throw new Error("Agent returned an empty answer");return ie(a.answer,a.sources,a.model)}catch(a){console.warn("[ResearchAgent] IPC agent failed, falling back to aiEngine",a);const r=await be.runTask({kind:"agent",prompt:s.prompt,context:Le(s.context),mode:"research",llm:{temperature:.2,maxTokens:600}},()=>{});return ie(r?.text||"",Pe(r?.citations),r?.model)}}async function De(s,i){switch(s.type){case"open_url":{const a=s.payload?.url;a&&await f.tabs.create(a);return}case"save_summary":{const a=s.payload?.summary;if(!a)return;const r=i.url||"about:blank";await f.research.saveNotes(r,a,[]);return}case"follow_up":return s.payload?.prompt;default:return}}const Oe="Summarize this page and list 3 concrete follow-up actions for my research.";function Ve(){const[s,i]=l.useState(""),[a,r]=l.useState(!1),[o,d]=l.useState([]),[c,u]=l.useState([]),[N,j]=l.useState(null),[m,k]=l.useState(!1),[O,K]=l.useState(null),[ce,X]=l.useState(),{activeId:z,tabs:de}=ge(),v=de.find(t=>t.id===z),V=l.useRef(null),M=l.useRef(null),J=l.useRef(null),[A,Y]=l.useState(Oe),[b,Z]=l.useState(null),[S,ee]=l.useState(!1),[te,U]=l.useState(null),[se,ae]=l.useState(null),re=oe(t=>t.mode)==="Research";l.useEffect(()=>{re&&!m&&k(!0)},[re,m]),l.useEffect(()=>{m&&q().catch(t=>{console.error("Failed to sync documents on mount:",t)})},[m]),l.useEffect(()=>{const t=()=>{k(!0)};return Q.on("research:keyboard-open-pane",t),()=>{Q.off("research:keyboard-open-pane",t)}},[]),l.useEffect(()=>()=>{V.current&&M.current&&window.ipc?.removeListener&&window.ipc.removeListener(V.current,M.current)},[]);const xe=l.useCallback(async()=>{if(!(!s.trim()||a)){r(!0),d([]),u([]),j(null);try{const t=await _e(s.trim(),5);if(t.length>0){const x=t.map(p=>({id:p.id,title:p.metadata.title||"Cached Document",url:p.metadata.url||"",snippet:p.content.slice(0,200)+"...",type:p.metadata.sourceType||"web",confidence:.8}));u(x)}const{channel:n}=await f.researchStream.start(s.trim(),"default");if(V.current=n,window.ipc?.on){const x=(p,g)=>{switch(g?.type){case"chunk":d(w=>[...w,{content:g.content,citations:g.citations||[]}]);break;case"sources":if(g.entries){const w=Object.entries(g.entries).flatMap(([y,R])=>(Array.isArray(R)?R:[]).map(h=>({id:h.id||y,title:h.title||"Untitled",url:h.url||h.fragmentUrl||"",snippet:h.snippet,type:"web",confidence:h.relevanceScore,publishedAt:h.publishedAt})));u(y=>{const R=new Set(y.map($=>$.id)),h=w.filter($=>!R.has($.id));return[...y,...h]})}break;case"complete":r(!1);break;case"error":r(!1),console.error("Research error:",g.message);break}};M.current=x,window.ipc.on(n,x)}}catch(t){r(!1),console.error("Failed to start research:",t)}}},[s,a]),ue=l.useCallback(async()=>{if(v?.id)try{const{snapshotId:t}=await f.research.saveSnapshot(v.id);console.log("Tab snapshot saved:",t),setTimeout(async()=>{try{await q()}catch(n){console.error("Failed to sync to cache:",n)}},2e3)}catch(t){console.error("Failed to save snapshot:",t)}},[v]),me=l.useCallback(async t=>{const n=t.target.files?.[0];if(n)try{const x=await f.research.uploadFile(n);console.log("File uploaded:",x),setTimeout(async()=>{try{await q()}catch(p){console.error("Failed to sync to cache:",p)}},2e3),t.target.value=""}catch(x){console.error("Failed to upload file:",x),t.target.value=""}},[]),F=l.useCallback(()=>{let t;if(typeof window<"u"&&window.getSelection){const n=window.getSelection()?.toString();n&&(t=n.slice(0,2e3))}return{url:v?.url||void 0,title:v?.title||void 0,selection:t,mode:"research"}},[v]),pe=l.useCallback(async()=>{if(!(!A.trim()||S)){ee(!0),U(null);try{const t=F(),n=await Ie({prompt:A.trim(),context:t,allowActions:!0});Z(n),L("success","Research Agent ready"),f.telemetry?.trackFeature&&f.telemetry.trackFeature("research_agent","run").catch(()=>{})}catch(t){console.error("[ResearchPane] Research Agent failed:",t),U(t instanceof Error?t.message:"Unable to run Research Agent."),L("error","Research Agent failed")}finally{ee(!1)}}},[A,S,F]),he=l.useCallback(async t=>{ae(t.id);try{const n=await De(t,F());n&&(Y(n),requestAnimationFrame(()=>J.current?.focus())),L("success",t.type==="follow_up"?"Drafted follow-up question":"Action executed")}catch(n){console.error("[ResearchPane] Agent action failed:",n),L("error","Failed to run action")}finally{ae(null)}},[F]),fe=l.useCallback(async t=>{try{z?await f.tabs.navigate(z,t):await f.tabs.create(t)}catch(n){console.error("Failed to open source:",n)}},[z]),le=l.useCallback(async(t,n)=>{try{K({id:t.id,title:t.title,url:t.url,type:t.type==="repo"?"web":t.type,snippet:t.snippet}),X(n)}catch(x){console.error("Failed to load document:",x)}},[]);return m?e.jsxs(C.div,{initial:{x:400},animate:{x:0},exit:{x:400},className:"fixed right-0 top-0 z-50 flex h-full w-96 flex-col border-l border-slate-800 bg-slate-950 shadow-2xl",role:"complementary","aria-label":"Research Mode panel",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-800 bg-slate-900 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{size:18,className:"text-blue-400"}),e.jsx("h2",{className:"text-sm font-semibold text-gray-100",children:"Research Mode"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:ue,disabled:!v,className:"rounded p-1.5 text-gray-400 transition-colors hover:bg-slate-800 hover:text-gray-200 disabled:cursor-not-allowed disabled:opacity-40",title:"Save current tab snapshot",children:e.jsx(je,{size:16})}),e.jsxs("label",{className:"cursor-pointer rounded p-1.5 text-gray-400 transition-colors hover:bg-slate-800 hover:text-gray-200",children:[e.jsx(ve,{size:16}),e.jsx("input",{type:"file",accept:".pdf,.docx,.txt,.md",onChange:me,className:"hidden"})]}),e.jsx("button",{onClick:()=>k(!1),className:"rounded p-1.5 text-gray-400 transition-colors hover:bg-slate-800 hover:text-gray-200",children:e.jsx(I,{size:16})})]})]}),e.jsx("div",{className:"border-b border-slate-800 bg-slate-900/50 p-4",children:e.jsxs("form",{"aria-label":"Research query form",onSubmit:t=>{t.preventDefault(),xe()},className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(we,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500"}),e.jsx("input",{type:"text",value:s,onChange:t=>i(t.target.value),placeholder:"Ask a research question...",className:"w-full rounded-lg border border-slate-700 bg-slate-800 py-2 pl-10 pr-4 text-sm text-gray-100 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50",disabled:a,"aria-label":"Research question"})]}),e.jsx("button",{type:"submit",disabled:a||!s.trim(),className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-blue-700 disabled:cursor-not-allowed disabled:bg-slate-700",children:a?e.jsxs(e.Fragment,{children:[e.jsx(E,{size:14,className:"animate-spin"}),"Searching..."]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{size:14}),"Search"]})})]})}),e.jsxs("div",{className:"flex-1 space-y-4 overflow-y-auto p-4",children:[e.jsxs("div",{className:"space-y-3 rounded-2xl border border-slate-800 bg-slate-900/60 p-4",role:"region","aria-label":"Research Agent",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-slate-200",children:[e.jsx(Ne,{size:16,className:"text-blue-400"}),"Research Agent"]}),b&&e.jsxs("span",{className:"text-xs text-slate-400",children:["Confidence ",(b.confidence*100).toFixed(0),"%"]})]}),e.jsx("textarea",{id:"research-pane-agent-prompt",name:"research-agent-prompt",ref:J,value:A,onChange:t=>Y(t.target.value),rows:3,className:"w-full rounded-xl border border-slate-800 bg-slate-950/60 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 disabled:opacity-60",placeholder:"Ask the Research Agent to summarize, compare, or plan next steps...","aria-label":"Research agent prompt",disabled:S}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:pe,disabled:S||!A.trim(),className:"inline-flex items-center gap-2 rounded-lg bg-gradient-to-r from-blue-500 to-indigo-500 px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-blue-900/30 transition hover:from-blue-400 hover:to-indigo-400 disabled:cursor-not-allowed disabled:opacity-60",children:[S?e.jsx(E,{size:16,className:"animate-spin"}):e.jsx(H,{size:16}),S?"Running agent…":"Run Research Agent"]}),b&&e.jsx("button",{type:"button",onClick:()=>{Z(null),U(null)},className:"rounded-lg border border-slate-800 px-3 py-2 text-xs font-medium text-slate-300 transition hover:border-slate-600 hover:text-slate-100",children:"Clear"})]}),te&&e.jsx("div",{className:"rounded-lg border border-rose-500/40 bg-rose-500/10 px-3 py-2 text-xs text-rose-200",children:te}),b&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"rounded-xl border border-slate-800 bg-slate-950/60 p-3 text-sm text-slate-100",children:[e.jsx("p",{className:"whitespace-pre-line leading-relaxed",children:b.summary}),b.citations.length>0&&e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:b.citations.map(t=>e.jsxs("a",{href:t.url,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-1 rounded-full border border-blue-500/40 px-2 py-0.5 text-[11px] text-blue-200 transition hover:border-blue-400 hover:text-white",children:[e.jsx(G,{size:12}),t.label]},t.url))})]}),e.jsxs("div",{className:"space-y-2",children:[b.actions.length===0&&e.jsx("div",{className:"rounded-lg border border-slate-800 bg-slate-950/50 px-3 py-2 text-xs text-slate-400",role:"status","aria-live":"polite",children:"The agent did not recommend any actions for this query."}),b.actions.map(t=>e.jsxs("button",{type:"button",onClick:()=>he(t),disabled:se===t.id,className:"flex w-full items-center justify-between rounded-lg border border-slate-800 bg-slate-950/40 px-3 py-2 text-left text-sm text-slate-200 transition hover:border-blue-500/40 hover:bg-slate-900/70 disabled:cursor-wait disabled:opacity-60",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.label}),t.description&&e.jsx("div",{className:"text-xs text-slate-400",children:t.description}),t.badge&&e.jsx("div",{className:"mt-1 inline-flex rounded-full border border-emerald-500/30 bg-emerald-500/10 px-2 py-0.5 text-[10px] uppercase tracking-wide text-emerald-200",children:t.badge})]}),se===t.id?e.jsx(E,{size:16,className:"animate-spin text-blue-400"}):e.jsx(ke,{size:16,className:"text-emerald-400"})]},t.id))]})]})]}),o.length>0&&e.jsxs("div",{className:"space-y-3","aria-live":"polite",children:[e.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide text-gray-400",children:"Answer"}),e.jsxs("div",{className:"space-y-3 rounded-lg border border-slate-800 bg-slate-900/50 p-4",children:[o.map((t,n)=>e.jsx("div",{className:"text-sm leading-relaxed text-gray-200",children:t.content.split(/(\[(\d+)\])/g).map((x,p)=>{const g=x.match(/^\[(\d+)\]$/);if(g){const w=g[1],y=c.find((R,h)=>h+1===parseInt(w));return e.jsxs("button",{onClick:()=>{y&&le(y)},className:"ml-1 inline-flex cursor-pointer items-center justify-center rounded-full border border-blue-500/40 bg-blue-500/15 px-1.5 py-0.5 text-[10px] text-blue-200 transition-colors hover:border-blue-400/60 hover:bg-blue-500/25",title:y?`View source: ${y.title}`:`Citation ${w}`,children:["[",w,"]"]},p)}return e.jsx("span",{children:x},p)})},n)),a&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[e.jsx(E,{size:12,className:"animate-spin"}),"Streaming answer..."]})]})]}),c.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-xs font-semibold uppercase tracking-wide text-gray-400",children:["Sources (",c.length,")"]}),e.jsx("div",{className:"space-y-2",children:e.jsx(D,{children:c.map(t=>e.jsx(C.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0},className:`cursor-pointer space-y-2 rounded-lg border p-3 transition-colors ${N===t.id?"border-blue-500/60 bg-blue-500/10":"border-slate-800 bg-slate-900/50 hover:border-slate-700"}`,role:"button",tabIndex:0,"aria-pressed":N===t.id,onClick:()=>j(N===t.id?null:t.id),onKeyDown:n=>{(n.key==="Enter"||n.key===" ")&&(n.preventDefault(),j(N===t.id?null:t.id))},children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"mb-1 flex items-center gap-2",children:[e.jsx("span",{className:"rounded bg-slate-800 px-1.5 py-0.5 text-[10px] uppercase text-gray-400",children:t.type}),t.confidence&&e.jsxs("span",{className:"text-[10px] text-gray-500",children:[Math.round(t.confidence*100),"% match"]})]}),e.jsx("h4",{className:"truncate text-sm font-medium text-gray-200",children:t.title}),t.snippet&&e.jsx("p",{className:"mt-1 line-clamp-2 text-xs text-gray-400",children:t.snippet}),e.jsx("p",{className:"mt-1 truncate text-[10px] text-gray-500",children:t.url})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:n=>{n.stopPropagation(),le(t,t.snippet)},className:"rounded p-1.5 text-gray-400 transition-colors hover:bg-slate-800 hover:text-gray-200",title:"View document",children:e.jsx(W,{size:14})}),t.url&&e.jsx("button",{onClick:n=>{n.stopPropagation(),fe(t.url)},className:"rounded p-1.5 text-gray-400 transition-colors hover:bg-slate-800 hover:text-gray-200",title:"Open in tab",children:e.jsx(G,{size:14})})]})]})},t.id))})})]}),!a&&o.length===0&&c.length===0&&e.jsxs("div",{className:"flex h-full flex-col items-center justify-center space-y-3 text-center text-gray-500",children:[e.jsx(B,{size:48,className:"opacity-50"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-400",children:"Start researching"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Ask a question or save a tab snapshot to begin"})]})]})]}),O&&e.jsx(Fe,{isOpen:!!O,onClose:()=>{K(null),X(void 0)},document:O,highlightText:ce})]}):e.jsx("button",{onClick:()=>k(!0),className:"fixed right-4 top-20 z-50 rounded-full bg-blue-600 p-3 text-white shadow-lg transition-colors hover:bg-blue-700",title:"Open Research Pane","aria-label":"Open Research Pane",children:e.jsx(B,{size:20})})}function Me(){const[s,i]=l.useState(null),[a,r]=l.useState(!1);return l.useEffect(()=>{const o=d=>{i(d.detail),r(!0),setTimeout(()=>{r(!1)},15e3)};if(window.addEventListener("weather-update",o),typeof window<"u"&&window.__TAURI__){const{listen:d}=require("@tauri-apps/api/event");d("weather-update",c=>{i(c.payload),r(!0),setTimeout(()=>r(!1),15e3)})}return()=>{window.removeEventListener("weather-update",o)}},[]),!s||!a?null:e.jsx(D,{children:e.jsxs(C.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"fixed top-20 right-5 bg-gradient-to-br from-purple-900 to-blue-900 p-6 rounded-2xl text-white shadow-2xl border border-purple-500 max-w-sm z-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-2xl font-bold",children:s.city}),e.jsx("button",{onClick:()=>r(!1),className:"text-gray-400 hover:text-white transition-colors",children:e.jsx(I,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"text-5xl my-2 font-bold",children:s.temp}),e.jsxs("div",{className:"text-lg text-gray-300 mb-2",children:["Feels like ",s.feels]}),e.jsxs("div",{className:"capitalize text-xl mb-4 flex items-center gap-2",children:[s.desc.includes("rain")||s.desc.includes("बारिश")?e.jsx(ne,{className:"w-5 h-5"}):s.desc.includes("cloud")||s.desc.includes("बादल")?e.jsx(Se,{className:"w-5 h-5"}):e.jsx(Ce,{className:"w-5 h-5"}),s.desc]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"w-4 h-4"}),e.jsxs("span",{children:["Humidity: ",s.humidity,"%"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"w-4 h-4"}),e.jsxs("span",{children:["Wind: ",s.wind," km/h"]})]})]}),e.jsxs("div",{className:"text-xs mt-3 opacity-70 text-center",children:["Source: ",s.source==="live"?"Live API":"Cached data"]})]})})}function Ue(){const[s,i]=l.useState(null),[a,r]=l.useState(!1);return l.useEffect(()=>{const o=d=>{i(d.detail),r(!0),setTimeout(()=>r(!1),2e4)};return window.addEventListener("flight-card",o),typeof window<"u"&&window.__TAURI__&&_(async()=>{const{listen:d}=await import("@tauri-apps/api/event");return{listen:d}},[]).then(({listen:d})=>{d("flight-card",c=>{i(c.payload),r(!0),setTimeout(()=>r(!1),2e4)})}).catch(()=>{}),()=>{window.removeEventListener("flight-card",o)}},[]),!s||!a?null:e.jsx(D,{children:e.jsxs(C.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-gradient-to-r from-indigo-900 to-purple-900 p-8 rounded-2xl text-white shadow-2xl border border-purple-500 max-w-md z-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"text-center flex-1",children:[e.jsxs("div",{className:"text-2xl font-bold flex items-center justify-center gap-2",children:[s.from," ",e.jsx(Re,{className:"w-5 h-5"})," ",s.to]}),e.jsx("div",{className:"text-sm text-gray-300 mt-1",children:s.type})]}),e.jsx("button",{onClick:()=>r(!1),className:"text-gray-400 hover:text-white transition-colors",children:e.jsx(I,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"text-center text-5xl my-4 font-bold",children:s.price}),e.jsxs("div",{className:"text-center text-lg mb-2",children:[e.jsxs("div",{children:["Out: ",s.depart]}),s.return!=="—"&&e.jsxs("div",{children:["Return: ",s.return]})]}),e.jsxs("div",{className:"text-center text-xl mb-4 flex items-center justify-center gap-2",children:[e.jsx(Ee,{className:"w-5 h-5"}),s.airline]}),e.jsx("button",{onClick:()=>{const o=document.querySelector("iframe");o&&(o.focus(),ye.info("Click in the booking window to proceed to payment"))},className:"mt-4 w-full bg-green-500 hover:bg-green-600 px-8 py-3 rounded-full text-xl font-bold transition-colors",children:"Go to Payment"}),e.jsxs("div",{className:"text-xs text-center mt-3 opacity-70",children:["Source: ",s.source==="live"?"Live prices":"Cached data"]})]})})}const $e=l.lazy(()=>_(()=>import("./mode-research-BclgCwOH.js").then(s=>s.o),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))),He=l.lazy(()=>_(()=>import("./mode-trade-BU963YAc.js"),__vite__mapDeps([13,1,2,3,4,5,6,7,14,12,0,8,9,10,11]))),qe=l.lazy(()=>_(()=>import("./mode-docs-FcsoolLb.js").then(s=>s.D),__vite__mapDeps([9,10,11,5,3,4,1,2,6,7,12])).then(s=>({default:s.DocumentMode}))),We=l.lazy(()=>_(()=>import("./mode-threats-DpLysAOI.js"),__vite__mapDeps([15,3,4,5,1,2,6,7]))),P=()=>e.jsxs("div",{className:"flex flex-col items-center justify-center h-full w-full p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(E,{className:"w-5 h-5 animate-spin text-emerald-400"}),e.jsx("span",{className:"text-sm text-gray-400",children:"Loading mode..."})]}),e.jsxs("div",{className:"w-full max-w-2xl space-y-4 animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-800 rounded w-3/4"}),e.jsx("div",{className:"h-4 bg-gray-800 rounded w-1/2"}),e.jsx("div",{className:"h-32 bg-gray-800 rounded"}),e.jsx("div",{className:"h-4 bg-gray-800 rounded w-5/6"})]})]});function ct(){const s=oe(r=>r.mode),[i,a]=l.useState(!1);return l.useEffect(()=>{a(!1);const r=()=>{const u=!!(document.fullscreenElement||window.webkitFullscreenElement||window.mozFullScreenElement);u!==i&&a(u)},o=setTimeout(r,100),d=u=>{a(u.fullscreen)},c=Q.on("app:fullscreen-changed",d);return document.addEventListener("fullscreenchange",r),document.addEventListener("webkitfullscreenchange",r),document.addEventListener("mozfullscreenchange",r),()=>{clearTimeout(o),c(),document.removeEventListener("fullscreenchange",r),document.removeEventListener("webkitfullscreenchange",r),document.removeEventListener("mozfullscreenchange",r)}},[]),e.jsxs("div",{className:`h-full w-full bg-[#1A1D28] flex flex-col overflow-hidden ${i?"absolute inset-0":""}`,children:[s==="Browse"||!s?e.jsx("div",{className:"flex-1 w-full relative min-h-0 overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 z-20 pointer-events-none",children:e.jsx("div",{className:"pointer-events-auto h-full w-full overflow-hidden",children:e.jsx(ze,{variant:"overlay"})})})}):s==="Research"?e.jsx("div",{className:"flex-1 w-full relative flex flex-col min-h-0 overflow-hidden",children:e.jsx(T,{componentName:"ResearchPanel",retryable:!0,children:e.jsx(l.Suspense,{fallback:e.jsx(P,{}),children:e.jsx($e,{})})})}):s==="Trade"?e.jsx("div",{className:"flex-1 w-full relative flex flex-col min-h-0 overflow-hidden",children:e.jsx(T,{componentName:"TradePanel",retryable:!0,children:e.jsx(l.Suspense,{fallback:e.jsx(P,{}),children:e.jsx(He,{})})})}):s==="Docs"?e.jsx("div",{className:"flex-1 w-full relative flex flex-col min-h-0 overflow-hidden",children:e.jsx(T,{componentName:"DocumentMode",retryable:!0,children:e.jsx(l.Suspense,{fallback:e.jsx(P,{}),children:e.jsx(qe,{})})})}):s==="Threats"?e.jsx("div",{className:"flex-1 w-full relative flex flex-col min-h-0 overflow-hidden",children:e.jsx(T,{componentName:"ThreatsPanel",retryable:!0,children:e.jsx(l.Suspense,{fallback:e.jsx(P,{}),children:e.jsx(We,{})})})}):e.jsx("div",{className:"flex-1 w-full flex items-center justify-center bg-[#1A1D28]",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsxs("h2",{className:"text-2xl font-semibold text-gray-300",children:[s," Mode"]}),e.jsx("p",{className:"text-gray-500",children:"Coming Soon"}),e.jsx("p",{className:"text-sm text-gray-600 max-w-md",children:"This mode is under development. Switch to Research mode to get started with AI-powered browsing."})]})}),!i&&s!=="Research"&&e.jsx(Ve,{}),e.jsx(Me,{}),e.jsx(Ue,{})]})}export{ct as default};
//# sourceMappingURL=Home-l_WNGaND.js.map
