{"version":3,"file":"mode-threats-DpLysAOI.js","sources":["../../src/modes/threats/index.tsx"],"sourcesContent":["import { useState } from 'react';\r\nimport { Shield, AlertTriangle, CheckCircle2, XCircle, Loader2, Search, ExternalLink, Lock } from 'lucide-react';\r\nimport { useAgentExecutor } from '../../core/agents/useAgentRuntime';\r\n\r\ninterface ThreatResult {\r\n  url: string;\r\n  riskLevel: 'low' | 'medium' | 'high' | 'critical';\r\n  threats: Array<{\r\n    type: string;\r\n    severity: 'low' | 'medium' | 'high' | 'critical';\r\n    description: string;\r\n    recommendation: string;\r\n  }>;\r\n  aiAnalysis?: string;\r\n}\r\n\r\nexport default function ThreatsPanel() {\r\n  const [url, setUrl] = useState('');\r\n  const [result, setResult] = useState<ThreatResult | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const runThreatsAgent = useAgentExecutor('threats.agent');\r\n\r\n  const handleScan = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!url.trim()) return;\r\n\r\n    setLoading(true);\r\n    setError(null);\r\n    setResult(null);\r\n\r\n    try {\r\n      // Try IPC threat scan first\r\n      let scanResult: any = null;\r\n      try {\r\n        scanResult = await (window as any).api?.threats?.scanUrl?.(url);\r\n      } catch {\r\n        console.warn('[ThreatsPanel] IPC scan not available, using agent only');\r\n      }\r\n\r\n      // Run AI agent for threat analysis\r\n      const agentResult = await runThreatsAgent({\r\n        prompt: `Analyze security threats for URL: ${url}`,\r\n        context: { mode: 'Threats', url, scanResult },\r\n      });\r\n\r\n      // Build threat result\r\n      const threatResult: ThreatResult = {\r\n        url,\r\n        riskLevel: scanResult?.riskLevel || 'medium',\r\n        threats: scanResult?.threats || [\r\n          {\r\n            type: 'General Security Check',\r\n            severity: 'medium',\r\n            description: 'Security analysis completed via AI agent',\r\n            recommendation: 'Review AI analysis below for specific recommendations',\r\n          },\r\n        ],\r\n        aiAnalysis: agentResult.success ? agentResult.output : undefined,\r\n      };\r\n\r\n      setResult(threatResult);\r\n    } catch (err) {\r\n      console.error('[ThreatsPanel] Scan failed:', err);\r\n      setError(err instanceof Error ? err.message : 'Failed to scan URL');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const getRiskColor = (risk: ThreatResult['riskLevel']) => {\r\n    switch (risk) {\r\n      case 'critical':\r\n        return 'text-red-400 bg-red-500/10 border-red-500/30';\r\n      case 'high':\r\n        return 'text-orange-400 bg-orange-500/10 border-orange-500/30';\r\n      case 'medium':\r\n        return 'text-yellow-400 bg-yellow-500/10 border-yellow-500/30';\r\n      case 'low':\r\n        return 'text-green-400 bg-green-500/10 border-green-500/30';\r\n    }\r\n  };\r\n\r\n  const getSeverityIcon = (severity: string) => {\r\n    switch (severity) {\r\n      case 'critical':\r\n      case 'high':\r\n        return <XCircle size={16} className=\"text-red-400\" />;\r\n      case 'medium':\r\n        return <AlertTriangle size={16} className=\"text-yellow-400\" />;\r\n      case 'low':\r\n        return <CheckCircle2 size={16} className=\"text-green-400\" />;\r\n      default:\r\n        return <Shield size={16} className=\"text-gray-400\" />;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex h-full flex-col bg-[#1A1D28] text-gray-100\">\r\n      {/* Header */}\r\n      <div className=\"border-b border-gray-800/40 bg-gray-900/40 px-6 py-4\">\r\n        <div className=\"flex items-center gap-3\">\r\n          <div className=\"rounded-lg bg-red-500/10 p-2\">\r\n            <Shield size={20} className=\"text-red-400\" />\r\n          </div>\r\n          <div>\r\n            <h2 className=\"text-lg font-semibold text-gray-100\">Threat Mode</h2>\r\n            <p className=\"text-xs text-gray-400\">Security analysis with network isolation</p>\r\n          </div>\r\n          <div className=\"ml-auto flex items-center gap-2 text-xs text-green-400\">\r\n            <Lock size={14} />\r\n            <span>Ghost Mode + Tor Active</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Scan Input */}\r\n      <div className=\"border-b border-gray-800/40 px-6 py-4\">\r\n        <form onSubmit={handleScan} className=\"flex gap-3\">\r\n          <div className=\"flex-1 relative\">\r\n            <Search size={18} className=\"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400\" />\r\n            <input\r\n              type=\"url\"\r\n              value={url}\r\n              onChange={(e) => setUrl(e.target.value)}\r\n              placeholder=\"Enter URL to scan for threats...\"\r\n              className=\"w-full bg-gray-800/50 border border-gray-700/50 rounded-lg pl-10 pr-4 py-2.5 text-sm text-gray-200 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-red-500/50 focus:border-red-500/50\"\r\n            />\r\n          </div>\r\n          <button\r\n            type=\"submit\"\r\n            disabled={loading || !url.trim()}\r\n            className=\"px-6 py-2.5 bg-red-600 hover:bg-red-500 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg text-sm font-medium text-white transition-colors flex items-center gap-2\"\r\n          >\r\n            {loading ? (\r\n              <>\r\n                <Loader2 size={16} className=\"animate-spin\" />\r\n                Scanning...\r\n              </>\r\n            ) : (\r\n              <>\r\n                <Shield size={16} />\r\n                Scan\r\n              </>\r\n            )}\r\n          </button>\r\n        </form>\r\n      </div>\r\n\r\n      {/* Error */}\r\n      {error && (\r\n        <div className=\"border-b border-gray-800/40 bg-red-500/10 px-6 py-4\">\r\n          <div className=\"flex items-center gap-2 text-sm text-red-300\">\r\n            <AlertTriangle size={18} />\r\n            {error}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Results */}\r\n      <div className=\"flex-1 overflow-y-auto p-6\">\r\n        {!result ? (\r\n          <div className=\"flex flex-col items-center justify-center h-full text-center\">\r\n            <div className=\"rounded-full border border-dashed border-gray-700/60 bg-gray-800/30 p-8 mb-4\">\r\n              <Shield size={48} className=\"text-gray-500\" />\r\n            </div>\r\n            <h3 className=\"text-lg font-semibold text-gray-200 mb-2\">No scan results</h3>\r\n            <p className=\"text-sm text-gray-400 max-w-md\">\r\n              Enter a URL above to analyze security threats, vulnerabilities, and get threat intelligence.\r\n            </p>\r\n          </div>\r\n        ) : (\r\n          <div className=\"max-w-4xl mx-auto space-y-6\">\r\n            {/* Risk Summary */}\r\n            <div className={`rounded-lg border p-4 ${getRiskColor(result.riskLevel)}`}>\r\n              <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                  <div className=\"text-xs uppercase tracking-wide mb-1\">Overall Risk Level</div>\r\n                  <div className=\"text-2xl font-bold capitalize\">{result.riskLevel}</div>\r\n                </div>\r\n                <div className=\"text-right\">\r\n                  <div className=\"text-xs text-gray-400 mb-1\">URL</div>\r\n                  <a\r\n                    href={result.url}\r\n                    target=\"_blank\"\r\n                    rel=\"noopener noreferrer\"\r\n                    className=\"text-sm hover:underline flex items-center gap-1\"\r\n                  >\r\n                    {result.url}\r\n                    <ExternalLink size={14} />\r\n                  </a>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* AI Analysis */}\r\n            {result.aiAnalysis && (\r\n              <div className=\"rounded-lg border border-purple-500/30 bg-purple-500/5 p-4\">\r\n                <div className=\"text-xs font-semibold text-purple-300 mb-2\">AI Threat Analysis</div>\r\n                <div className=\"text-sm text-gray-300 whitespace-pre-wrap\">{result.aiAnalysis}</div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Threats List */}\r\n            <div className=\"space-y-3\">\r\n              <div className=\"text-sm font-semibold text-gray-200\">Detected Threats</div>\r\n              {result.threats.map((threat, idx) => (\r\n                <div\r\n                  key={idx}\r\n                  className=\"rounded-lg border border-gray-700/50 bg-gray-800/30 p-4 space-y-2\"\r\n                >\r\n                  <div className=\"flex items-start justify-between gap-3\">\r\n                    <div className=\"flex items-start gap-3 flex-1\">\r\n                      {getSeverityIcon(threat.severity)}\r\n                      <div className=\"flex-1\">\r\n                        <div className=\"flex items-center gap-2 mb-1\">\r\n                          <span className=\"text-sm font-semibold text-gray-200\">{threat.type}</span>\r\n                          <span\r\n                            className={`text-xs px-2 py-0.5 rounded-full border capitalize ${getRiskColor(\r\n                              threat.severity as ThreatResult['riskLevel']\r\n                            )}`}\r\n                          >\r\n                            {threat.severity}\r\n                          </span>\r\n                        </div>\r\n                        <p className=\"text-sm text-gray-300\">{threat.description}</p>\r\n                        <p className=\"text-xs text-gray-400 mt-2\">\r\n                          <span className=\"font-semibold\">Recommendation:</span> {threat.recommendation}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n"],"names":["ThreatsPanel","url","setUrl","useState","result","setResult","loading","setLoading","error","setError","runThreatsAgent","useAgentExecutor","handleScan","e","scanResult","agentResult","threatResult","err","getRiskColor","risk","getSeverityIcon","severity","jsx","XCircle","AlertTriangle","CheckCircle2","Shield","jsxs","Lock","Search","Fragment","Loader2","ExternalLink","threat","idx"],"mappings":"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"}