{"version":3,"file":"firstLaunch-ChO73SC_.js","sources":["../../src/core/installer/firstLaunch.ts"],"sourcesContent":["/**\n * First Launch Detection and Setup\n * Checks if this is first launch and triggers installer if needed\n */\n\nimport { checkOllamaInstalled, checkInstalledModels } from './ollamaInstaller';\n\nconst FIRST_LAUNCH_KEY = 'regen:firstLaunch';\nconst SETUP_COMPLETE_KEY = 'regen:setupComplete';\n\nexport interface FirstLaunchStatus {\n  isFirstLaunch: boolean;\n  needsSetup: boolean;\n  ollamaInstalled: boolean;\n  modelsInstalled: boolean;\n}\n\n/**\n * Check if this is the first launch\n */\nexport function isFirstLaunch(): boolean {\n  if (typeof window === 'undefined') return false;\n  const firstLaunch = localStorage.getItem(FIRST_LAUNCH_KEY);\n  return firstLaunch === null;\n}\n\n/**\n * Mark first launch as complete\n */\nexport function markFirstLaunchComplete(): void {\n  if (typeof window === 'undefined') return;\n  localStorage.setItem(FIRST_LAUNCH_KEY, 'false');\n}\n\n/**\n * Check if setup is complete\n */\nexport function isSetupComplete(): boolean {\n  if (typeof window === 'undefined') return true;\n  const complete = localStorage.getItem(SETUP_COMPLETE_KEY);\n  return complete === 'true';\n}\n\n/**\n * Mark setup as complete\n */\nexport function markSetupComplete(): void {\n  if (typeof window === 'undefined') return;\n  localStorage.setItem(SETUP_COMPLETE_KEY, 'true');\n}\n\n/**\n * Check current setup status\n */\nexport async function checkSetupStatus(): Promise<FirstLaunchStatus> {\n  const isFirst = isFirstLaunch();\n  const setupComplete = isSetupComplete();\n\n  let ollamaInstalled = false;\n  let modelsInstalled = false;\n\n  if (!setupComplete) {\n    ollamaInstalled = await checkOllamaInstalled();\n    if (ollamaInstalled) {\n      const installedModels = await checkInstalledModels();\n      modelsInstalled = ['phi3:mini', 'llava:7b'].every(m =>\n        installedModels.some((im: string) => im.includes(m.split(':')[0]))\n      );\n    }\n  } else {\n    ollamaInstalled = true;\n    modelsInstalled = true;\n  }\n\n  return {\n    isFirstLaunch: isFirst,\n    needsSetup: !setupComplete || !ollamaInstalled || !modelsInstalled,\n    ollamaInstalled,\n    modelsInstalled,\n  };\n}\n"],"names":["SETUP_COMPLETE_KEY","markSetupComplete"],"mappings":"kPAQA,MAAMA,EAAqB,sBAsCpB,SAASC,GAA0B,CACpC,OAAO,OAAW,KACtB,aAAa,QAAQD,EAAoB,MAAM,CACjD"}