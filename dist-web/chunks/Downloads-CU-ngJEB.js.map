{"version":3,"file":"Downloads-CU-ngJEB.js","sources":["../../src/components/common/Portal.tsx","../../src/components/MediaPlayer.tsx","../../src/routes/Downloads.tsx"],"sourcesContent":["import { type ReactNode, useEffect, useState } from 'react';\r\nimport { createPortal } from 'react-dom';\r\n\r\ninterface PortalProps {\r\n  children: ReactNode;\r\n  containerId?: string;\r\n}\r\n\r\nexport function Portal({ children, containerId = 'portal-root' }: PortalProps) {\r\n  const [element, setElement] = useState<HTMLElement | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (typeof document === 'undefined') {\r\n      return;\r\n    }\r\n\r\n    let container = document.getElementById(containerId) as HTMLElement | null;\r\n    let created = false;\r\n\r\n    if (!container) {\r\n      container = document.createElement('div');\r\n      container.id = containerId;\r\n      document.body.appendChild(container);\r\n      created = true;\r\n    }\r\n\r\n    setElement(container);\r\n\r\n    return () => {\r\n      if (created && container?.parentNode) {\r\n        container.parentNode.removeChild(container);\r\n      }\r\n    };\r\n  }, [containerId]);\r\n\r\n  if (!element) {\r\n    return null;\r\n  }\r\n\r\n  return createPortal(children, element);\r\n}\r\n","import { useCallback, useEffect, useMemo, useRef, useState } from 'react';\r\nimport { AnimatePresence, motion } from 'framer-motion';\r\nimport {\r\n  AudioLines,\r\n  Laptop,\r\n  Maximize2,\r\n  Minimize2,\r\n  MonitorPlay,\r\n  Pause,\r\n  Play,\r\n  PlayCircle,\r\n  SkipBack,\r\n  SkipForward,\r\n  Volume2,\r\n  VolumeX,\r\n  X,\r\n} from 'lucide-react';\r\nimport { Portal } from './common/Portal';\r\nimport { ipc } from '../lib/ipc-typed';\r\nimport { isDevEnv } from '../lib/env';\r\n\r\ntype MediaKind = 'video' | 'audio';\r\n\r\nconst VIDEO_EXTENSIONS = ['mp4', 'm4v', 'mov', 'webm', 'mkv', 'avi', 'mpg', 'mpeg', 'ogv'];\r\nconst AUDIO_EXTENSIONS = ['mp3', 'm4a', 'aac', 'wav', 'flac', 'ogg', 'opus', 'aiff', 'oga'];\r\n\r\nfunction normalizeFileUrl(filePath: string): string {\r\n  if (!filePath) return '';\r\n  if (filePath.startsWith('file://')) {\r\n    return filePath;\r\n  }\r\n\r\n  let normalized = filePath.replace(/\\\\/g, '/');\r\n\r\n  if (/^[a-zA-Z]:/.test(normalized)) {\r\n    normalized = `/${normalized}`;\r\n  } else if (!normalized.startsWith('/')) {\r\n    normalized = `/${normalized}`;\r\n  }\r\n\r\n  return encodeURI(`file://${normalized}`);\r\n}\r\n\r\nexport function getMediaKind(fileName?: string | null): MediaKind | null {\r\n  if (!fileName) return null;\r\n  const extension = fileName.split('.').pop()?.toLowerCase();\r\n  if (!extension) return null;\r\n  if (VIDEO_EXTENSIONS.includes(extension)) return 'video';\r\n  if (AUDIO_EXTENSIONS.includes(extension)) return 'audio';\r\n  return null;\r\n}\r\n\r\nexport interface MediaPlayerProps {\r\n  filePath: string;\r\n  fileName?: string;\r\n  autoPlay?: boolean;\r\n  onClose: () => void;\r\n}\r\n\r\nexport function MediaPlayer({ filePath, fileName, autoPlay = true, onClose }: MediaPlayerProps) {\r\n  const mediaKind = useMemo<MediaKind | null>(() => getMediaKind(fileName || filePath), [fileName, filePath]);\r\n  const sourceUrl = useMemo(() => normalizeFileUrl(filePath), [filePath]);\r\n  const mediaRef = useRef<HTMLVideoElement | HTMLAudioElement | null>(null);\r\n\r\n  const [isPlaying, setIsPlaying] = useState(autoPlay);\r\n  const [currentTime, setCurrentTime] = useState(0);\r\n  const [duration, setDuration] = useState(0);\r\n  const [volume, setVolume] = useState(1);\r\n  const [muted, setMuted] = useState(false);\r\n  const [hovered, setHovered] = useState(false);\r\n  const [isFullscreen, setIsFullscreen] = useState(false);\r\n  const [pipSupported, setPipSupported] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const handler = (event: KeyboardEvent) => {\r\n      if (event.key === 'Escape') {\r\n        onClose();\r\n      }\r\n    };\r\n    window.addEventListener('keydown', handler);\r\n    return () => window.removeEventListener('keydown', handler);\r\n  }, [onClose]);\r\n\r\n  useEffect(() => {\r\n    const element = mediaRef.current;\r\n    if (!element) return;\r\n\r\n    const handleLoaded = () => {\r\n      setDuration(element.duration || 0);\r\n      setVolume(element.volume);\r\n      setMuted(element.muted);\r\n    };\r\n    const handleTime = () => setCurrentTime(element.currentTime || 0);\r\n    const handlePlay = () => setIsPlaying(true);\r\n    const handlePause = () => setIsPlaying(false);\r\n    const handleVolumeChange = () => {\r\n      setVolume(element.volume);\r\n      setMuted(element.muted);\r\n    };\r\n\r\n    element.addEventListener('loadedmetadata', handleLoaded);\r\n    element.addEventListener('timeupdate', handleTime);\r\n    element.addEventListener('play', handlePlay);\r\n    element.addEventListener('pause', handlePause);\r\n    element.addEventListener('volumechange', handleVolumeChange);\r\n\r\n    if (autoPlay) {\r\n      const maybePromise = element.play();\r\n      if (maybePromise && typeof maybePromise.then === 'function') {\r\n        maybePromise.catch(() => {\r\n          // Autoplay might be blocked; keep state consistent\r\n          setIsPlaying(false);\r\n        });\r\n      }\r\n    }\r\n\r\n    if (mediaKind === 'video' && typeof document !== 'undefined') {\r\n      setPipSupported(Boolean((document as any).pictureInPictureEnabled));\r\n    } else {\r\n      setPipSupported(false);\r\n    }\r\n\r\n    return () => {\r\n      element.removeEventListener('loadedmetadata', handleLoaded);\r\n      element.removeEventListener('timeupdate', handleTime);\r\n      element.removeEventListener('play', handlePlay);\r\n      element.removeEventListener('pause', handlePause);\r\n      element.removeEventListener('volumechange', handleVolumeChange);\r\n      element.pause();\r\n    };\r\n  }, [autoPlay, mediaKind, sourceUrl]);\r\n\r\n  const togglePlay = useCallback(() => {\r\n    const element = mediaRef.current;\r\n    if (!element) return;\r\n    if (element.paused) {\r\n      const maybePromise = element.play();\r\n      if (maybePromise && typeof maybePromise.then === 'function') {\r\n        maybePromise.catch(() => setIsPlaying(false));\r\n      }\r\n    } else {\r\n      element.pause();\r\n    }\r\n  }, []);\r\n\r\n  const toggleMute = useCallback(() => {\r\n    const element = mediaRef.current;\r\n    if (!element) return;\r\n    element.muted = !element.muted;\r\n  }, []);\r\n\r\n  const handleVolumeChange = (value: number) => {\r\n    const element = mediaRef.current;\r\n    if (!element) return;\r\n    const nextVolume = Math.min(1, Math.max(0, value));\r\n    element.volume = nextVolume;\r\n    element.muted = nextVolume === 0;\r\n  };\r\n\r\n  const handleSeek = (value: number) => {\r\n    const element = mediaRef.current;\r\n    if (!element || !Number.isFinite(duration) || duration <= 0) return;\r\n    element.currentTime = (value / 100) * duration;\r\n    setCurrentTime(element.currentTime);\r\n  };\r\n\r\n  const skipBy = (seconds: number) => {\r\n    const element = mediaRef.current;\r\n    if (!element) return;\r\n    element.currentTime = Math.min(Math.max(0, element.currentTime + seconds), duration || element.currentTime);\r\n  };\r\n\r\n  const togglePictureInPicture = async () => {\r\n    if (mediaKind !== 'video') return;\r\n    const videoElement = mediaRef.current as (HTMLVideoElement & { requestPictureInPicture?: () => Promise<PictureInPictureWindow> }) | null;\r\n    if (!videoElement || typeof videoElement.requestPictureInPicture !== 'function') return;\r\n\r\n    try {\r\n      const doc = document as any;\r\n      if (doc.pictureInPictureElement) {\r\n        await doc.exitPictureInPicture?.();\r\n      } else {\r\n        await videoElement.requestPictureInPicture();\r\n      }\r\n    } catch (error) {\r\n      if (isDevEnv()) {\r\n        console.warn('[MediaPlayer] Failed to request Picture-in-Picture:', error);\r\n      }\r\n    }\r\n  };\r\n\r\n  const toggleFullscreen = () => {\r\n    const container = document.getElementById('ob-media-player-container');\r\n    if (!container) return;\r\n    const doc = document as any;\r\n\r\n    if (!isFullscreen) {\r\n      container.requestFullscreen?.().then(() => setIsFullscreen(true)).catch(() => {});\r\n    } else {\r\n      doc.exitFullscreen?.().then(() => setIsFullscreen(false)).catch(() => {});\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const handleFsChange = () => {\r\n      const doc = document as any;\r\n      setIsFullscreen(Boolean(doc.fullscreenElement));\r\n    };\r\n    document.addEventListener('fullscreenchange', handleFsChange);\r\n    return () => document.removeEventListener('fullscreenchange', handleFsChange);\r\n  }, []);\r\n\r\n  const openFile = () => {\r\n    if (!filePath) return;\r\n    ipc.downloads.openFile(filePath).catch(() => {});\r\n  };\r\n\r\n  const showInFolder = () => {\r\n    if (!filePath) return;\r\n    ipc.downloads.showInFolder(filePath).catch(() => {});\r\n  };\r\n\r\n  const formatTime = (value: number) => {\r\n    if (!Number.isFinite(value)) return '0:00';\r\n    const totalSeconds = Math.max(0, Math.round(value));\r\n    const minutes = Math.floor(totalSeconds / 60);\r\n    const seconds = totalSeconds % 60;\r\n    const hours = Math.floor(minutes / 60);\r\n    if (hours > 0) {\r\n      const remainingMinutes = minutes % 60;\r\n      return `${hours}:${remainingMinutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;\r\n    }\r\n    return `${minutes}:${seconds.toString().padStart(2, '0')}`;\r\n  };\r\n\r\n  const progressPercent = duration > 0 ? Math.min(100, Math.max(0, (currentTime / duration) * 100)) : 0;\r\n\r\n  return (\r\n    <Portal>\r\n      <AnimatePresence>\r\n        <motion.div\r\n          className=\"fixed inset-0 z-[200] flex items-center justify-center bg-black/70 backdrop-blur-sm px-6 py-8\"\r\n          initial={{ opacity: 0 }}\r\n          animate={{ opacity: 1 }}\r\n          exit={{ opacity: 0 }}\r\n          onClick={onClose}\r\n        >\r\n          <motion.div\r\n            id=\"ob-media-player-container\"\r\n            className=\"relative w-full max-w-4xl overflow-hidden rounded-2xl border border-gray-700/60 bg-gray-950/90 shadow-2xl\"\r\n            initial={{ y: 40, opacity: 0 }}\r\n            animate={{ y: 0, opacity: 1 }}\r\n            exit={{ y: 40, opacity: 0 }}\r\n            transition={{ type: 'spring', damping: 22, stiffness: 180 }}\r\n            onClick={(event) => event.stopPropagation()}\r\n          >\r\n            <div className=\"flex items-center justify-between border-b border-gray-800/60 bg-gray-900/70 px-4 py-3\">\r\n              <div>\r\n                <p className=\"text-sm font-medium text-gray-100\">{fileName || filePath.split(/[\\\\/]/).pop() || 'Media file'}</p>\r\n                <p className=\"text-xs text-gray-400\">\r\n                  {mediaKind ? mediaKind.toUpperCase() : 'Unknown'} • {formatTime(duration)}\r\n                </p>\r\n              </div>\r\n              <div className=\"flex items-center gap-2\">\r\n                <button\r\n                  onClick={openFile}\r\n                  className=\"rounded-lg border border-gray-700/70 bg-gray-800/70 px-3 py-1.5 text-xs text-gray-200 transition hover:border-blue-500/60 hover:text-blue-300\"\r\n                >\r\n                  Open\r\n                </button>\r\n                <button\r\n                  onClick={showInFolder}\r\n                  className=\"rounded-lg border border-gray-700/70 bg-gray-800/70 px-3 py-1.5 text-xs text-gray-200 transition hover:border-blue-500/60 hover:text-blue-300\"\r\n                >\r\n                  Reveal\r\n                </button>\r\n                <button\r\n                  onClick={onClose}\r\n                  className=\"rounded-lg border border-gray-700/70 bg-gray-800/70 p-1.5 text-gray-300 transition hover:border-red-500/60 hover:text-red-300\"\r\n                >\r\n                  <X size={16} />\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            <div\r\n              className={`relative flex flex-col items-center justify-center bg-black ${mediaKind === 'audio' ? 'py-12' : 'py-4'}`}\r\n              onMouseEnter={() => setHovered(true)}\r\n              onMouseLeave={() => setHovered(false)}\r\n            >\r\n              {mediaKind === 'video' && sourceUrl ? (\r\n                <video\r\n                  ref={mediaRef as React.RefObject<HTMLVideoElement>}\r\n                  src={sourceUrl}\r\n                  className=\"max-h-[60vh] w-full bg-black object-contain\"\r\n                  autoPlay={autoPlay}\r\n                  controls={false}\r\n                />\r\n              ) : null}\r\n\r\n              {mediaKind === 'audio' && sourceUrl ? (\r\n                <div className=\"flex w-full flex-col items-center gap-6 px-8\">\r\n                  <div className=\"mt-4 flex h-32 w-32 items-center justify-center rounded-3xl bg-gradient-to-br from-blue-500/30 to-purple-500/30 text-blue-200\">\r\n                    <AudioLines size={64} />\r\n                  </div>\r\n                  <audio ref={mediaRef as React.RefObject<HTMLAudioElement>} src={sourceUrl} autoPlay={autoPlay} controls={false} />\r\n                </div>\r\n              ) : null}\r\n\r\n              {!mediaKind || !sourceUrl ? (\r\n                <div className=\"flex h-48 w-full flex-col items-center justify-center gap-3 text-center text-gray-400\">\r\n                  <MonitorPlay size={40} className=\"text-gray-600\" />\r\n                  <p className=\"text-sm\">Unable to load media preview</p>\r\n                  <p className=\"text-xs text-gray-500\">Unsupported format or missing file reference.</p>\r\n                </div>\r\n              ) : null}\r\n\r\n              {mediaKind && sourceUrl ? (\r\n                <motion.div\r\n                  className=\"absolute bottom-3 left-1/2 z-10 w-[92%] -translate-x-1/2 rounded-xl border border-gray-800/80 bg-gray-900/95 px-4 py-3 shadow-xl backdrop-blur\"\r\n                  animate={{ opacity: hovered || !isPlaying ? 1 : 0.85 }}\r\n                >\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <button\r\n                      onClick={togglePlay}\r\n                      className=\"flex h-10 w-10 items-center justify-center rounded-full bg-blue-600/90 text-white transition hover:bg-blue-500\"\r\n                    >\r\n                      {isPlaying ? <Pause size={18} /> : <Play size={18} />}\r\n                    </button>\r\n\r\n                    <div className=\"flex flex-col gap-1 text-xs text-gray-400\">\r\n                      <span className=\"font-mono text-sm text-gray-100\">{formatTime(currentTime)}</span>\r\n                      <span className=\"font-mono text-[11px] text-gray-500\">{formatTime(duration - currentTime)} remaining</span>\r\n                    </div>\r\n\r\n                    <input\r\n                      type=\"range\"\r\n                      min={0}\r\n                      max={100}\r\n                      value={progressPercent}\r\n                      onChange={(event) => handleSeek(Number(event.target.value))}\r\n                      className=\"flex-1 accent-blue-500\"\r\n                    />\r\n\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <button\r\n                        onClick={() => skipBy(-10)}\r\n                        className=\"rounded-full border border-gray-700/60 p-2 text-gray-300 transition hover:border-blue-500/60 hover:text-blue-300\"\r\n                        title=\"Back 10 seconds\"\r\n                      >\r\n                        <SkipBack size={16} />\r\n                      </button>\r\n                      <button\r\n                        onClick={() => skipBy(10)}\r\n                        className=\"rounded-full border border-gray-700/60 p-2 text-gray-300 transition hover:border-blue-500/60 hover:text-blue-300\"\r\n                        title=\"Forward 10 seconds\"\r\n                      >\r\n                        <SkipForward size={16} />\r\n                      </button>\r\n\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <button\r\n                          onClick={toggleMute}\r\n                          className=\"rounded-full border border-gray-700/60 p-2 text-gray-300 transition hover:border-blue-500/60 hover:text-blue-300\"\r\n                        >\r\n                          {muted || volume === 0 ? <VolumeX size={16} /> : <Volume2 size={16} />}\r\n                        </button>\r\n                        <input\r\n                          type=\"range\"\r\n                          min={0}\r\n                          max={100}\r\n                          value={muted ? 0 : Math.round(volume * 100)}\r\n                          onChange={(event) => handleVolumeChange(Number(event.target.value) / 100)}\r\n                          className=\"w-24 accent-blue-500\"\r\n                        />\r\n                      </div>\r\n\r\n                      {pipSupported ? (\r\n                        <button\r\n                          onClick={togglePictureInPicture}\r\n                          className=\"rounded-full border border-gray-700/60 p-2 text-gray-300 transition hover:border-blue-500/60 hover:text-blue-300\"\r\n                          title=\"Toggle picture-in-picture\"\r\n                        >\r\n                          <PlayCircle size={16} />\r\n                        </button>\r\n                      ) : null}\r\n\r\n                      <button\r\n                        onClick={toggleFullscreen}\r\n                        className=\"rounded-full border border-gray-700/60 p-2 text-gray-300 transition hover:border-blue-500/60 hover:text-blue-300\"\r\n                        title={isFullscreen ? 'Exit fullscreen' : 'Enter fullscreen'}\r\n                      >\r\n                        {isFullscreen ? <Minimize2 size={16} /> : <Maximize2 size={16} />}\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                </motion.div>\r\n              ) : null}\r\n            </div>\r\n\r\n            <div className=\"flex items-center justify-between border-t border-gray-800/60 bg-gray-900/70 px-4 py-3 text-xs text-gray-400\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <Laptop size={14} className=\"text-blue-300\" />\r\n                <span>Secure local playback</span>\r\n              </div>\r\n              <span>{filePath}</span>\r\n            </div>\r\n          </motion.div>\r\n        </motion.div>\r\n      </AnimatePresence>\r\n    </Portal>\r\n  );\r\n}\r\n\r\n\r\n","import { useEffect, useState } from 'react';\nimport { Download as DownloadIcon, FolderOpen, CheckCircle, XCircle, Clock, Loader, Pause, Play, X, PlayCircle, RotateCw, List } from 'lucide-react';\nimport { motion } from 'framer-motion';\nimport { ipc } from '../lib/ipc-typed';\nimport { DownloadUpdate } from '../lib/ipc-events';\nimport { ipcEvents } from '../lib/ipc-events';\nimport { MediaPlayer, getMediaKind } from '../components/MediaPlayer';\n\ntype DownloadSafety = {\n  status: 'pending' | 'clean' | 'warning' | 'blocked' | 'unknown';\n  threatLevel?: 'low' | 'medium' | 'high' | 'critical';\n  details?: string;\n  recommendations?: string[];\n  scannedAt?: number;\n  quarantinePath?: string;\n};\n\ntype DownloadItem = { \n  id: string; \n  url: string; \n  filename?: string;\n  status: 'pending' | 'downloading' | 'completed' | 'failed' | 'cancelled' | 'blocked' | 'paused' | 'verifying'; \n  path?: string; \n  createdAt: number;\n  progress?: number;\n  receivedBytes?: number;\n  totalBytes?: number;\n  checksum?: string;\n  safety?: DownloadSafety;\n  speedBytesPerSec?: number;\n  etaSeconds?: number;\n};\n\nexport default function DownloadsPage() {\n  const [items, setItems] = useState<DownloadItem[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [previewItem, setPreviewItem] = useState<DownloadItem | null>(null);\n  const [queueStatus, setQueueStatus] = useState<{ active: number; queued: number; maxConcurrent: number } | null>(null);\n\n  useEffect(() => {\n    const loadDownloads = async () => {\n      try {\n        const list = (await ipc.downloads.list()) as DownloadItem[];\n        if (Array.isArray(list)) {\n          setItems(list.sort((a, b) => b.createdAt - a.createdAt));\n        }\n      } catch (error) {\n        console.error('Failed to load downloads:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    loadDownloads();\n\n    // Load queue status\n    const loadQueueStatus = async () => {\n      try {\n        const status = await ipc.downloads.getQueue?.();\n        if (status) {\n          setQueueStatus(status);\n        }\n      } catch (error) {\n        console.error('Failed to load queue status:', error);\n      }\n    };\n    loadQueueStatus();\n    const queueInterval = setInterval(loadQueueStatus, 2000); // Update every 2 seconds\n\n    const updateItem = (update: DownloadUpdate) => {\n      if (!update?.id) return;\n      setItems(prev => {\n        const existingIndex = prev.findIndex(item => item.id === update.id);\n        const updatedItem: DownloadItem = {\n          id: update.id,\n          url: update.url,\n          filename: update.filename,\n          status: (update.status as DownloadItem['status']) || 'downloading',\n          path: update.path,\n          checksum: update.checksum,\n          createdAt: update.createdAt || Date.now(),\n          progress: update.progress,\n          receivedBytes: update.receivedBytes,\n          totalBytes: update.totalBytes,\n          safety: update.safety,\n          speedBytesPerSec: update.speedBytesPerSec,\n          etaSeconds: update.etaSeconds,\n        };\n\n        if (existingIndex >= 0) {\n          const next = [...prev];\n          next[existingIndex] = {\n            ...next[existingIndex],\n            ...updatedItem,\n            createdAt: next[existingIndex].createdAt || updatedItem.createdAt,\n          };\n          return next.sort((a, b) => b.createdAt - a.createdAt);\n        }\n\n        return [updatedItem, ...prev].sort((a, b) => b.createdAt - a.createdAt);\n      });\n    };\n\n    const progressUnsub = ipcEvents.on<DownloadUpdate>('downloads:progress', updateItem);\n    const doneUnsub = ipcEvents.on<DownloadUpdate>('downloads:done', updateItem);\n\n    return () => {\n      progressUnsub();\n      doneUnsub();\n      clearInterval(queueInterval);\n    };\n  }, []);\n\n  const formatBytes = (bytes?: number) => {\n    if (!bytes) return 'Unknown';\n    if (bytes === 0) return '0 Bytes';\n    const k = 1024;\n    const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n    return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];\n  };\n\n  const calcPercent = (item: DownloadItem) => {\n    if (typeof item.progress === 'number') {\n      return Math.min(100, Math.max(0, Math.round(item.progress * 100)));\n    }\n    if (item.totalBytes && item.totalBytes > 0) {\n      return Math.min(100, Math.round(((item.receivedBytes || 0) / item.totalBytes) * 100));\n    }\n    if (item.status === 'completed' || item.status === 'verifying') return 100;\n    return 0;\n  };\n\n  const formatSpeed = (bps?: number) => {\n    if (!bps || !Number.isFinite(bps) || bps <= 0) return '—';\n    const units = ['B/s', 'KB/s', 'MB/s', 'GB/s'];\n    const idx = Math.min(units.length - 1, Math.floor(Math.log(bps) / Math.log(1024)));\n    const value = bps / Math.pow(1024, idx);\n    return `${value >= 100 ? Math.round(value) : Math.round(value * 10) / 10} ${units[idx]}`;\n  };\n\n  const formatEta = (seconds?: number) => {\n    if (seconds === undefined || !Number.isFinite(seconds) || seconds <= 0) return '—';\n    const rounded = Math.max(0, Math.round(seconds));\n    const hours = Math.floor(rounded / 3600);\n    const minutes = Math.floor((rounded % 3600) / 60);\n    const secs = rounded % 60;\n    const parts = [];\n    if (hours > 0) parts.push(`${hours}h`);\n    if (minutes > 0 || hours > 0) parts.push(`${minutes}m`);\n    parts.push(`${secs}s`);\n    return parts.join(' ');\n  };\n\n  const isPreviewable = (item: DownloadItem) => {\n    if (!item?.path || item.status !== 'completed') return false;\n    return Boolean(getMediaKind(item.filename || item.path));\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'completed':\n        return <CheckCircle size={16} className=\"text-green-400\" />;\n      case 'failed':\n      case 'blocked':\n        return <XCircle size={16} className=\"text-red-400\" />;\n      case 'downloading':\n      case 'paused':\n      case 'verifying':\n        return <Loader size={16} className=\"text-blue-400 animate-spin\" />;\n      case 'cancelled':\n        return <XCircle size={16} className=\"text-gray-500\" />;\n      default:\n        return <Clock size={16} className=\"text-gray-400\" />;\n    }\n  };\n\n  const handleOpenFile = (path?: string) => {\n    if (path) {\n      // Use IPC to open file in system default application\n      ipc.downloads.openFile?.(path).catch(console.error);\n    }\n  };\n\n  const handleOpenFolder = (path?: string) => {\n    if (path) {\n      // Use IPC to open folder in file explorer\n      ipc.downloads.showInFolder?.(path).catch(console.error);\n    }\n  };\n\n  const renderSafetyBadge = (safety?: DownloadSafety) => {\n    if (!safety) return null;\n    const base = 'px-2 py-0.5 rounded-full text-[10px] font-semibold uppercase tracking-wide border';\n    switch (safety.status) {\n      case 'clean':\n        return <span className={`${base} bg-emerald-500/15 border-emerald-500/30 text-emerald-200`}>Scanned Clean</span>;\n      case 'warning':\n        return <span className={`${base} bg-amber-500/15 border-amber-500/30 text-amber-200`}>Review Recommended</span>;\n      case 'blocked':\n        return <span className={`${base} bg-red-500/15 border-red-500/40 text-red-200`}>Quarantined</span>;\n      case 'pending':\n        return <span className={`${base} bg-blue-500/15 border-blue-500/30 text-blue-200`}>Scanning…</span>;\n      default:\n        return <span className={`${base} bg-gray-500/15 border-gray-600/40 text-gray-300`}>Scan Unavailable</span>;\n    }\n  };\n\n  const renderSafetyDetails = (safety?: DownloadSafety) => {\n    if (!safety) return null;\n    return (\n      <div className=\"text-xs text-gray-500 space-y-1 mt-2\">\n        <div className=\"flex items-center gap-2\">\n          {renderSafetyBadge(safety)}\n          {safety.threatLevel && (\n            <span className=\"text-[10px] uppercase text-gray-400\">\n              Threat level: {safety.threatLevel}\n            </span>\n          )}\n        </div>\n        {safety.details && <div>{safety.details}</div>}\n        {safety.recommendations && safety.recommendations.length > 0 && (\n          <ul className=\"list-disc list-inside text-[11px] space-y-0.5\">\n            {safety.recommendations.slice(0, 3).map((rec, idx) => (\n              <li key={`${safety.scannedAt}-${idx}`}>{rec}</li>\n            ))}\n          </ul>\n        )}\n        {safety.status === 'blocked' && safety.quarantinePath && (\n          <div className=\"text-[11px] text-red-300\">\n            File moved to quarantine: <span className=\"font-mono\">{safety.quarantinePath}</span>\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  if (loading) {\n    return (\n      <div className=\"h-full w-full flex items-center justify-center bg-[#1A1D28]\">\n        <Loader size={24} className=\"text-blue-400 animate-spin\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"h-full w-full bg-[#1A1D28] text-gray-100 flex flex-col\">\n      <div className=\"p-6 border-b border-gray-800/50\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h2 className=\"text-2xl font-bold\">Downloads</h2>\n            <p className=\"text-sm text-gray-400 mt-1\">\n              {items.length} {items.length === 1 ? 'download' : 'downloads'}\n            </p>\n          </div>\n          {queueStatus && (\n            <div className=\"flex items-center gap-4 text-sm\">\n              <div className=\"flex items-center gap-2 px-3 py-1.5 rounded-lg bg-blue-500/10 border border-blue-500/30\">\n                <Loader size={14} className=\"text-blue-400 animate-spin\" />\n                <span className=\"text-blue-300\">Active:</span>\n                <span className=\"text-blue-200 font-semibold\">{queueStatus.active}/{queueStatus.maxConcurrent}</span>\n              </div>\n              {queueStatus.queued > 0 && (\n                <div className=\"flex items-center gap-2 px-3 py-1.5 rounded-lg bg-amber-500/10 border border-amber-500/30\">\n                  <List size={14} className=\"text-amber-400\" />\n                  <span className=\"text-amber-300\">Queued:</span>\n                  <span className=\"text-amber-200 font-semibold\">{queueStatus.queued}</span>\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n      </div>\n\n      <div className=\"flex-1 overflow-y-auto p-6\">\n        {items.length === 0 ? (\n          <div className=\"flex flex-col items-center justify-center h-full text-center\">\n            <DownloadIcon size={48} className=\"text-gray-600 mb-4\" />\n            <h3 className=\"text-lg font-semibold text-gray-300 mb-2\">No downloads yet</h3>\n            <p className=\"text-sm text-gray-500\">Files you download will appear here</p>\n          </div>\n        ) : (\n          <div className=\"space-y-3\">\n            {items.map((d) => (\n              <motion.div\n                key={d.id}\n                data-testid=\"download-card\"\n                data-download-id={d.id}\n                data-filename={d.filename || ''}\n                initial={{ opacity: 0, y: 10 }}\n                animate={{ opacity: 1, y: 0 }}\n                className=\"bg-gray-900/60 backdrop-blur-sm border border-gray-800/50 rounded-lg p-4 hover:bg-gray-900/80 transition-all\"\n              >\n                <div className=\"flex items-start justify-between gap-4\">\n                  <div className=\"flex-1 min-w-0\">\n                    <div className=\"flex items-center gap-2 mb-2\">\n                      {getStatusIcon(d.status)}\n                      <span className=\"font-medium text-gray-200 truncate\">\n                        {d.filename || d.url.split('/').pop() || 'Download'}\n                      </span>\n                      {renderSafetyBadge(d.safety)}\n                    </div>\n                    \n                    {/* Progress bar for active downloads */}\n                    {d.status === 'downloading' || d.status === 'paused' ? (\n                      <div className=\"mb-3\">\n                        <div className=\"flex items-center justify-between text-xs text-gray-300 mb-1.5\">\n                          <span className=\"font-medium\">{formatBytes(d.receivedBytes)} / {formatBytes(d.totalBytes)}</span>\n                          <span className=\"font-semibold text-blue-400\">{calcPercent(d)}%</span>\n                        </div>\n                        <div className=\"w-full bg-gray-800 rounded-full h-2.5 overflow-hidden mb-2\">\n                          <motion.div\n                            className=\"h-full bg-gradient-to-r from-blue-500 to-cyan-500\"\n                            initial={{ width: 0 }}\n                            animate={{ width: `${calcPercent(d)}%` }}\n                            transition={{ duration: 0.3 }}\n                          />\n                        </div>\n                        <div className=\"flex items-center gap-4 text-xs font-medium\">\n                          <div className=\"flex items-center gap-1.5 px-2 py-1 rounded-md bg-blue-500/10 border border-blue-500/30\">\n                            <span className=\"text-blue-300\">Speed:</span>\n                            <span className=\"text-blue-200 font-semibold\">{formatSpeed(d.speedBytesPerSec)}</span>\n                          </div>\n                          <div className=\"flex items-center gap-1.5 px-2 py-1 rounded-md bg-purple-500/10 border border-purple-500/30\">\n                            <Clock size={12} className=\"text-purple-300\" />\n                            <span className=\"text-purple-300\">ETA:</span>\n                            <span className=\"text-purple-200 font-semibold\">{formatEta(d.etaSeconds)}</span>\n                          </div>\n                        </div>\n                      </div>\n                    ) : null}\n\n                    {d.status === 'verifying' && (\n                      <div className=\"mb-2 text-xs text-blue-300 flex items-center gap-2\">\n                        <Loader className=\"h-4 w-4 animate-spin\" />\n                        <span>Verifying download integrity…</span>\n                      </div>\n                    )}\n\n                    <div className=\"text-xs text-gray-400 space-y-1\">\n                      <div className=\"flex items-center gap-2\">\n                        <span className=\"truncate\">{d.url}</span>\n                        {d.totalBytes && d.totalBytes > 1024 * 1024 * 1024 && (\n                          <span className=\"px-2 py-0.5 rounded-full bg-purple-500/15 border border-purple-500/30 text-purple-200 text-[10px] font-semibold\">\n                            Large File ({formatBytes(d.totalBytes)})\n                          </span>\n                        )}\n                      </div>\n                      <div className=\"flex items-center gap-4\">\n                        <span>{new Date(d.createdAt).toLocaleString()}</span>\n                        <span className=\"capitalize\">{d.status}</span>\n                        {d.path && (\n                          <span className=\"truncate max-w-xs\" title={d.path}>\n                            {d.path.replace(/^.*[\\\\\\/]/, '')}\n                          </span>\n                        )}\n                      </div>\n                      {d.checksum && (\n                        <div className=\"text-xs text-gray-500 truncate\" title={`SHA-256: ${d.checksum}`}>\n                          SHA-256: {d.checksum.slice(0, 12)}…\n                        </div>\n                      )}\n                      {renderSafetyDetails(d.safety)}\n                    </div>\n                  </div>\n\n                  {/* Action buttons */}\n                  <div className=\"flex items-center gap-2\">\n                    {d.status === 'downloading' && (\n                      <>\n                        <motion.button\n                          onClick={async () => {\n                            try {\n                              await ipc.downloads.pause(d.id);\n                              setItems(prev => prev.map(item => \n                                item.id === d.id ? { ...item, status: 'paused' as const } : item\n                              ));\n                            } catch (error) {\n                              console.error('Failed to pause download:', error);\n                            }\n                          }}\n                          whileHover={{ scale: 1.05 }}\n                          whileTap={{ scale: 0.95 }}\n                          className=\"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-amber-500/20 hover:bg-amber-500/30 border border-amber-500/40 text-amber-200 font-medium text-xs transition-colors\"\n                          title=\"Pause download\"\n                        >\n                          <Pause size={16} />\n                          <span>Pause</span>\n                        </motion.button>\n                        <motion.button\n                          onClick={async () => {\n                            try {\n                              await ipc.downloads.cancel(d.id);\n                              setItems(prev => prev.map(item => \n                                item.id === d.id ? { ...item, status: 'cancelled' as const } : item\n                              ));\n                            } catch (error) {\n                              console.error('Failed to stop download:', error);\n                            }\n                          }}\n                          whileHover={{ scale: 1.05 }}\n                          whileTap={{ scale: 0.95 }}\n                          className=\"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-red-500/20 hover:bg-red-500/30 border border-red-500/40 text-red-200 font-medium text-xs transition-colors\"\n                          title=\"Stop download\"\n                        >\n                          <X size={16} />\n                          <span>Stop</span>\n                        </motion.button>\n                      </>\n                    )}\n                    {d.status === 'paused' && (\n                      <>\n                        <motion.button\n                          onClick={async () => {\n                            try {\n                              await ipc.downloads.resume(d.id);\n                              setItems(prev => prev.map(item => \n                                item.id === d.id ? { ...item, status: 'downloading' as const } : item\n                              ));\n                            } catch (error) {\n                              console.error('Failed to resume download:', error);\n                            }\n                          }}\n                          whileHover={{ scale: 1.05 }}\n                          whileTap={{ scale: 0.95 }}\n                          className=\"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-green-500/20 hover:bg-green-500/30 border border-green-500/40 text-green-200 font-medium text-xs transition-colors\"\n                          title=\"Resume download\"\n                        >\n                          <Play size={16} />\n                          <span>Resume</span>\n                        </motion.button>\n                        <motion.button\n                          onClick={async () => {\n                            try {\n                              await ipc.downloads.cancel(d.id);\n                              setItems(prev => prev.map(item => \n                                item.id === d.id ? { ...item, status: 'cancelled' as const } : item\n                              ));\n                            } catch (error) {\n                              console.error('Failed to stop download:', error);\n                            }\n                          }}\n                          whileHover={{ scale: 1.05 }}\n                          whileTap={{ scale: 0.95 }}\n                          className=\"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-red-500/20 hover:bg-red-500/30 border border-red-500/40 text-red-200 font-medium text-xs transition-colors\"\n                          title=\"Stop download\"\n                        >\n                          <X size={16} />\n                          <span>Stop</span>\n                        </motion.button>\n                      </>\n                    )}\n                    {(d.status === 'failed' || d.status === 'cancelled') && (\n                      <motion.button\n                        onClick={async () => {\n                          try {\n                            await ipc.downloads.retry?.(d.id);\n                            setItems(prev => prev.map(item => \n                              item.id === d.id ? { ...item, status: 'pending' as const } : item\n                            ));\n                            // Reload queue status\n                            const status = await ipc.downloads.getQueue?.();\n                            if (status) setQueueStatus(status);\n                          } catch (error) {\n                            console.error('Failed to retry download:', error);\n                          }\n                        }}\n                        whileHover={{ scale: 1.05 }}\n                        whileTap={{ scale: 0.95 }}\n                        className=\"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-blue-500/20 hover:bg-blue-500/30 border border-blue-500/40 text-blue-200 font-medium text-xs transition-colors\"\n                        title=\"Retry download\"\n                      >\n                        <RotateCw size={16} />\n                        <span>Retry</span>\n                      </motion.button>\n                    )}\n                    {(d.status === 'completed' || d.status === 'failed' || d.status === 'cancelled' || d.status === 'blocked') && d.path && (\n                      <>\n                        {d.status !== 'blocked' && d.status === 'completed' && (\n                          <motion.button\n                            onClick={() => handleOpenFile(d.path)}\n                            whileHover={{ scale: 1.1 }}\n                            whileTap={{ scale: 0.9 }}\n                            className=\"p-2 rounded-lg bg-gray-800/60 hover:bg-gray-800 border border-gray-700/50 text-gray-300 hover:text-blue-400 transition-colors\"\n                            title=\"Open file\"\n                          >\n                            <DownloadIcon size={18} />\n                          </motion.button>\n                        )}\n                        {d.status === 'completed' && d.path && isPreviewable(d) && (\n                          <motion.button\n                            onClick={() => setPreviewItem(d)}\n                            whileHover={{ scale: 1.1 }}\n                            whileTap={{ scale: 0.9 }}\n                            className=\"p-2 rounded-lg bg-gray-800/60 hover:bg-gray-800 border border-gray-700/50 text-gray-300 hover:text-purple-400 transition-colors\"\n                            title=\"Preview media\"\n                          >\n                            <PlayCircle size={18} />\n                          </motion.button>\n                        )}\n                        <motion.button\n                          onClick={() => handleOpenFolder(d.path)}\n                          whileHover={{ scale: 1.1 }}\n                          whileTap={{ scale: 0.9 }}\n                          className=\"p-2 rounded-lg bg-gray-800/60 hover:bg-gray-800 border border-gray-700/50 text-gray-300 hover:text-blue-400 transition-colors\"\n                          title=\"Show in folder\"\n                        >\n                          <FolderOpen size={18} />\n                        </motion.button>\n                      </>\n                    )}\n                  </div>\n                </div>\n              </motion.div>\n            ))}\n          </div>\n        )}\n      </div>\n      {previewItem && previewItem.path && (\n        <MediaPlayer\n          filePath={previewItem.path}\n          fileName={previewItem.filename}\n          onClose={() => setPreviewItem(null)}\n        />\n      )}\n    </div>\n  );\n}\n\n\n"],"names":["Portal","children","containerId","element","setElement","useState","useEffect","container","created","createPortal","VIDEO_EXTENSIONS","AUDIO_EXTENSIONS","normalizeFileUrl","filePath","normalized","getMediaKind","fileName","extension","MediaPlayer","autoPlay","onClose","mediaKind","useMemo","sourceUrl","mediaRef","useRef","isPlaying","setIsPlaying","currentTime","setCurrentTime","duration","setDuration","volume","setVolume","muted","setMuted","hovered","setHovered","isFullscreen","setIsFullscreen","pipSupported","setPipSupported","handler","event","handleLoaded","handleTime","handlePlay","handlePause","handleVolumeChange","maybePromise","togglePlay","useCallback","toggleMute","value","nextVolume","handleSeek","skipBy","seconds","togglePictureInPicture","videoElement","doc","error","isDevEnv","toggleFullscreen","handleFsChange","openFile","ipc","showInFolder","formatTime","totalSeconds","minutes","hours","remainingMinutes","progressPercent","jsx","AnimatePresence","motion","jsxs","X","AudioLines","MonitorPlay","Pause","Play","SkipBack","SkipForward","VolumeX","Volume2","PlayCircle","Minimize2","Maximize2","Laptop","DownloadsPage","items","setItems","loading","setLoading","previewItem","setPreviewItem","queueStatus","setQueueStatus","list","a","b","loadQueueStatus","status","queueInterval","updateItem","update","prev","existingIndex","item","updatedItem","next","progressUnsub","ipcEvents","doneUnsub","formatBytes","bytes","k","sizes","i","calcPercent","formatSpeed","bps","units","idx","formatEta","rounded","secs","parts","isPreviewable","getStatusIcon","CheckCircle","XCircle","Loader","Clock","handleOpenFile","path","handleOpenFolder","renderSafetyBadge","safety","base","renderSafetyDetails","rec","List","DownloadIcon","d","Fragment","RotateCw","FolderOpen"],"mappings":"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"}