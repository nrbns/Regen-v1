import{l as r,t as s}from"./mode-research-BclgCwOH.js";import"./core-ai-yFIunLTZ.js";import"./vendor-zustand-BWsgwsXr.js";import"./vendor-react-gmX1Lmvt.js";import"./vendor-react-dom-Bkb6jJ_S.js";import"./vendor-Vl2WtvH-.js";import"./mode-manager.ts-DwguZmJt.js";import"./core-memory-DmK-uh9X.js";import"./vendor-utils-5Vdoy44w.js";import"./mode-docs-FcsoolLb.js";import"./vendor-pdf-ejcqEZLU.js";import"./vendor-mammoth-BPQIafDs.js";import"./vendor-framer-motion-DDE19Uim.js";var n=Object.defineProperty,a=(i,e,t)=>e in i?n(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,o=(i,e,t)=>a(i,typeof e!="symbol"?e+"":e,t);class u{constructor(){o(this,"currentUser",null),o(this,"authMethod",null)}async initialize(){try{const e=localStorage.getItem("regen_auth");if(e){const t=JSON.parse(e);this.currentUser=t.user,this.authMethod=t.method,r.info("[Auth] Restored session for user:",this.currentUser?.id),s("auth_session_restored",{userId:this.currentUser?.id})}}catch(e){r.error("[Auth] Failed to restore session:",e)}return this.getState()}async requestMagicLink(e){try{return r.info("[Auth] Magic link requested for:",e),s("auth_magic_link_requested",{email:e}),await new Promise(t=>setTimeout(t,1e3)),{success:!0,message:"Check your email for the magic link"}}catch(t){return r.error("[Auth] Magic link request failed:",t),{success:!1,message:"Failed to send magic link. Please try again."}}}async requestDeviceCode(){try{r.info("[Auth] Device code requested"),s("auth_device_code_requested");const e=Math.random().toString(36).slice(2,10).toUpperCase(),t=Date.now()+600*1e3;return{code:e,expiresAt:t}}catch(e){return r.error("[Auth] Device code request failed:",e),null}}async verifyMagicLink(e){try{const t={id:`user-${Date.now()}-${Math.random().toString(36).slice(2,9)}`,createdAt:Date.now(),lastSeenAt:Date.now()};return this.currentUser=t,this.authMethod="magic_link",this.persistState(),r.info("[Auth] Magic link verified, user:",t.id),s("auth_magic_link_verified",{userId:t.id}),this.getState()}catch(t){throw r.error("[Auth] Magic link verification failed:",t),t}}async verifyDeviceCode(e){try{const t={id:`user-${Date.now()}-${Math.random().toString(36).slice(2,9)}`,createdAt:Date.now(),lastSeenAt:Date.now()};return this.currentUser=t,this.authMethod="device_code",this.persistState(),r.info("[Auth] Device code verified, user:",t.id),s("auth_device_code_verified",{userId:t.id}),this.getState()}catch(t){throw r.error("[Auth] Device code verification failed:",t),t}}async createAnonymousSession(){const e={id:`anon-${Date.now()}-${Math.random().toString(36).slice(2,9)}`,createdAt:Date.now(),lastSeenAt:Date.now()};return this.currentUser=e,this.authMethod="anonymous",this.persistState(),r.info("[Auth] Anonymous session created:",e.id),s("auth_anonymous_session_created",{userId:e.id}),this.getState()}async signOut(){const e=this.currentUser?.id;this.currentUser=null,this.authMethod=null,localStorage.removeItem("regen_auth"),r.info("[Auth] User signed out:",e),s("auth_signed_out",{userId:e})}getState(){return{user:this.currentUser,isAuthenticated:!!this.currentUser,method:this.authMethod}}getCurrentUser(){return this.currentUser}persistState(){localStorage.setItem("regen_auth",JSON.stringify({user:this.currentUser,method:this.authMethod}))}updateLastSeen(){this.currentUser&&(this.currentUser.lastSeenAt=Date.now(),this.persistState())}}const M=new u;export{M as authService};
//# sourceMappingURL=auth-Cg8cvnkf.js.map
