import{r as n,j as e,ak as I,X as F,o as T,b7 as U,a3 as j,bg as N,b8 as A,D as O,U as $,a0 as J}from"./vendor-react-gmX1Lmvt.js";import{C as M,D as B,E as p,F as w,G as P,H as Q,I as q,J as G}from"./core-ai-yFIunLTZ.js";import{A as H,m as y}from"./vendor-framer-motion-DDE19Uim.js";import"./vendor-react-dom-Bkb6jJ_S.js";import"./vendor-Vl2WtvH-.js";import"./vendor-zustand-BWsgwsXr.js";import"./mode-manager.ts-DwguZmJt.js";import"./core-memory-DmK-uh9X.js";function te({open:u,onClose:h}){const[l,d]=n.useState([]),[S,c]=n.useState({}),[s,o]=n.useState(null),[v,b]=n.useState(null),[x,E]=n.useState(""),[g,C]=n.useState("");n.useEffect(()=>{if(!u)return;const t=()=>{const a=p();d(a),c(w()),s===null&&a.length>0&&o(a.length-1)};t();const r=setInterval(t,1e3);return()=>clearInterval(r)},[u,s]),n.useEffect(()=>{if(s!==null&&s>=0&&s<l.length)try{const t=M(s);b(t)}catch(t){console.error("[RedixDebug] Failed to get state at index:",t),b(null)}else b(null)},[s,l.length]);const f=n.useMemo(()=>{let t=l;if(x&&(t=B(x)),g){const r=g.toLowerCase();t=t.filter(a=>a.type.toLowerCase().includes(r)||JSON.stringify(a.payload).toLowerCase().includes(r))}return t},[l,x,g]),k=n.useMemo(()=>{const t=new Set(l.map(r=>r.type));return Array.from(t).sort()},[l]),z=()=>{const t=P();if(t){c(t);const r=p();d(r),r.length>0?o(r.length-1):o(null)}},R=()=>{const t=Q();if(t){c(t);const r=p();d(r),r.length>0&&o(r.length-1)}},D=()=>{try{const t=q(),r=new Blob([t],{type:"application/json"}),a=URL.createObjectURL(r),i=document.createElement("a");i.href=a,i.download=`redix-event-log-${Date.now()}.json`,i.click(),URL.revokeObjectURL(a)}catch(t){console.error("[RedixDebug] Failed to export:",t),alert("Failed to export event log")}},L=()=>{const t=document.createElement("input");t.type="file",t.accept="application/json",t.onchange=async r=>{const a=r.target.files?.[0];if(a)try{const i=await a.text();G(i);const m=p();d(m),c(w()),m.length>0&&o(m.length-1)}catch(i){console.error("[RedixDebug] Failed to import:",i),alert("Failed to import event log")}},t.click()};return e.jsx(H,{children:u&&e.jsxs(e.Fragment,{children:[e.jsx(y.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:h,className:"fixed inset-0 bg-black/50 z-50"}),e.jsxs(y.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},className:"fixed right-0 top-0 bottom-0 w-[800px] bg-gray-900 border-l border-gray-800 z-50 flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-800",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{size:20,className:"text-purple-400"}),e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Redix Debug Panel"})]}),e.jsx("button",{onClick:h,className:"rounded-lg p-1.5 text-gray-400 hover:text-white hover:bg-gray-800 transition-colors",children:e.jsx(F,{size:18})})]}),e.jsxs("div",{className:"p-4 border-b border-gray-800 space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(T,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search events...",value:g,onChange:t=>C(t.target.value),className:"w-full pl-10 pr-4 py-2 rounded-lg bg-gray-800/50 border border-gray-700 text-white placeholder:text-gray-500 focus:outline-none focus:border-purple-500/50"})]}),e.jsxs("select",{value:x,onChange:t=>E(t.target.value),className:"px-3 py-2 rounded-lg bg-gray-800/50 border border-gray-700 text-white focus:outline-none focus:border-purple-500/50",children:[e.jsx("option",{value:"",children:"All Types"}),k.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>o(0),disabled:l.length===0,className:"px-3 py-1.5 rounded-lg bg-gray-800/50 border border-gray-700 text-white disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-700/50",children:e.jsx(U,{size:14})}),e.jsx("button",{onClick:()=>s!==null&&o(Math.max(0,s-1)),disabled:s===null||s===0,className:"px-3 py-1.5 rounded-lg bg-gray-800/50 border border-gray-700 text-white disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-700/50",children:e.jsx(j,{size:14})}),e.jsx("div",{className:"flex-1 text-center text-sm text-gray-400",children:s!==null?`${s+1} / ${l.length}`:"No events"}),e.jsx("button",{onClick:()=>s!==null&&o(Math.min(l.length-1,s+1)),disabled:s===null||s===l.length-1,className:"px-3 py-1.5 rounded-lg bg-gray-800/50 border border-gray-700 text-white disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-700/50",children:e.jsx(N,{size:14})}),e.jsx("button",{onClick:()=>o(l.length-1),disabled:l.length===0,className:"px-3 py-1.5 rounded-lg bg-gray-800/50 border border-gray-700 text-white disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-700/50",children:e.jsx(A,{size:14})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:z,className:"px-3 py-1.5 rounded-lg bg-gray-800/50 border border-gray-700 text-white hover:bg-gray-700/50",children:[e.jsx(j,{size:14,className:"inline mr-1"}),"Undo"]}),e.jsxs("button",{onClick:R,className:"px-3 py-1.5 rounded-lg bg-gray-800/50 border border-gray-700 text-white hover:bg-gray-700/50",children:[e.jsx(N,{size:14,className:"inline mr-1"}),"Redo"]}),e.jsx("div",{className:"flex-1"}),e.jsxs("button",{onClick:D,className:"px-3 py-1.5 rounded-lg bg-gray-800/50 border border-gray-700 text-white hover:bg-gray-700/50",children:[e.jsx(O,{size:14,className:"inline mr-1"}),"Export"]}),e.jsxs("button",{onClick:L,className:"px-3 py-1.5 rounded-lg bg-gray-800/50 border border-gray-700 text-white hover:bg-gray-700/50",children:[e.jsx($,{size:14,className:"inline mr-1"}),"Import"]})]})]}),e.jsxs("div",{className:"flex-1 overflow-hidden flex",children:[e.jsx("div",{className:"w-1/2 border-r border-gray-800 overflow-y-auto",children:e.jsx("div",{className:"p-4 space-y-2",children:f.length===0?e.jsxs("div",{className:"text-center text-gray-500 py-8",children:[e.jsx(J,{size:32,className:"mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No events found"})]}):f.map(t=>{const r=l.findIndex(i=>i.id===t.id),a=r===s;return e.jsxs(y.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},onClick:()=>o(r),className:`p-3 rounded-lg border cursor-pointer transition-colors ${a?"bg-purple-500/20 border-purple-500/40":"bg-gray-800/50 border-gray-700/50 hover:border-purple-500/40"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-1",children:[e.jsx("div",{className:"text-xs text-purple-400 font-medium",children:t.type}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(t.timestamp).toLocaleTimeString()})]}),e.jsx("div",{className:"text-xs text-gray-300 line-clamp-2",children:JSON.stringify(t.payload).substring(0,100)})]},t.id)})})}),e.jsx("div",{className:"w-1/2 overflow-y-auto",children:e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-300 mb-3",children:s!==null?`State at Event ${s+1}`:"Current State"}),e.jsx("pre",{className:"text-xs text-gray-400 bg-gray-800/50 p-3 rounded-lg border border-gray-700 overflow-auto",children:JSON.stringify(v!==null?v:S,null,2)})]})})]})]})]})})}export{te as RedixDebugPanel};
//# sourceMappingURL=RedixDebugPanel-B__gR_cw.js.map
