{"version":3,"file":"ConsentTimeline-7BgCPkqX.js","sources":["../../src/components/Consent/ConsentTimelineView.tsx","../../src/routes/ConsentTimeline.tsx"],"sourcesContent":["/**\r\n * Consent Timeline - Visual history of privacy decisions\r\n * Unique feature: Ethical transparency > Comet's opacity\r\n */\r\n\r\nimport { useEffect, useMemo } from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport { Clock, Shield, ShieldCheck, ShieldAlert, AlertTriangle, CheckCircle2, XCircle } from 'lucide-react';\r\nimport { formatDistanceToNow } from 'date-fns';\r\nimport { useTrustDashboardStore } from '../../state/trustDashboardStore';\r\n\r\nconst ACTION_LABELS: Record<string, string> = {\r\n  download: 'Download file',\r\n  form_submit: 'Submit form',\r\n  login: 'Login request',\r\n  scrape: 'Scrape content',\r\n  export_data: 'Export data',\r\n  access_clipboard: 'Clipboard access',\r\n  access_camera: 'Camera access',\r\n  access_microphone: 'Microphone access',\r\n  access_filesystem: 'Filesystem access',\r\n  ai_cloud: 'Cloud AI call',\r\n};\r\n\r\nexport function ConsentTimelineView() {\r\n  const { consentTimeline, refresh, loading } = useTrustDashboardStore();\r\n\r\n  useEffect(() => {\r\n    void refresh();\r\n    const interval = setInterval(() => {\r\n      void refresh();\r\n    }, 30000);\r\n    return () => clearInterval(interval);\r\n  }, [refresh]);\r\n\r\n  const groupedTimeline = useMemo(() => {\r\n    const groups: Record<string, typeof consentTimeline> = {};\r\n    const now = Date.now();\r\n    const oneHour = 60 * 60 * 1000;\r\n    const oneDay = 24 * oneHour;\r\n\r\n    consentTimeline.forEach((record) => {\r\n      const age = now - record.timestamp;\r\n      let group: string;\r\n\r\n      if (age < oneHour) {\r\n        group = 'Last hour';\r\n      } else if (age < oneDay) {\r\n        group = 'Today';\r\n      } else if (age < 7 * oneDay) {\r\n        group = 'This week';\r\n      } else if (age < 30 * oneDay) {\r\n        group = 'This month';\r\n      } else {\r\n        group = 'Older';\r\n      }\r\n\r\n      if (!groups[group]) {\r\n        groups[group] = [];\r\n      }\r\n      groups[group].push(record);\r\n    });\r\n\r\n    return Object.entries(groups).map(([label, items]) => ({\r\n      label,\r\n      items: items.sort((a, b) => b.timestamp - a.timestamp),\r\n    }));\r\n  }, [consentTimeline]);\r\n\r\n  if (loading && consentTimeline.length === 0) {\r\n    return (\r\n      <div className=\"flex h-full items-center justify-center\">\r\n        <div className=\"text-sm text-gray-400\">Loading consent timelineâ€¦</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"h-full overflow-y-auto bg-[#0f111a] p-4 sm:p-6\">\r\n      <div className=\"mx-auto max-w-4xl\">\r\n        <header className=\"mb-6\">\r\n          <div className=\"flex items-center gap-2 text-xs uppercase tracking-wide text-emerald-300/80\">\r\n            <Shield size={14} />\r\n            Consent Timeline\r\n          </div>\r\n          <h1 className=\"mt-2 text-xl sm:text-2xl font-semibold text-white\">Privacy Decisions History</h1>\r\n          <p className=\"mt-1 text-sm text-gray-400\">\r\n            Complete audit trail of all consent requests and approvals\r\n          </p>\r\n        </header>\r\n\r\n        {consentTimeline.length === 0 ? (\r\n          <div className=\"rounded-2xl border border-slate-800/60 bg-slate-900/70 p-8 sm:p-12 text-center\">\r\n            <Clock size={48} className=\"mx-auto mb-4 text-gray-600\" />\r\n            <h3 className=\"text-lg font-semibold text-gray-300 mb-2\">No consent activity yet</h3>\r\n            <p className=\"text-sm text-gray-500\">\r\n              Privacy decisions will appear here as you browse and interact with sites.\r\n            </p>\r\n          </div>\r\n        ) : (\r\n          <div className=\"space-y-6 sm:space-y-8\">\r\n            {groupedTimeline.map((group) => (\r\n              <section key={group.label} className=\"space-y-3\">\r\n                <h2 className=\"text-sm font-semibold uppercase tracking-wide text-gray-500\">{group.label}</h2>\r\n                <div className=\"space-y-2\">\r\n                  {group.items.map((record) => {\r\n                    const status = record.revokedAt\r\n                      ? { label: 'Revoked', icon: XCircle, tone: 'text-red-300 border-red-400/40 bg-red-500/10' }\r\n                      : record.approved\r\n                        ? { label: 'Approved', icon: ShieldCheck, tone: 'text-emerald-300 border-emerald-400/40 bg-emerald-500/10' }\r\n                        : { label: 'Pending', icon: Clock, tone: 'text-amber-300 border-amber-400/40 bg-amber-500/10' };\r\n\r\n                    const riskIcon =\r\n                      record.action.risk === 'high'\r\n                        ? AlertTriangle\r\n                        : record.action.risk === 'medium'\r\n                          ? ShieldAlert\r\n                          : CheckCircle2;\r\n\r\n                    const RiskIcon = riskIcon;\r\n                    const StatusIcon = status.icon;\r\n\r\n                    return (\r\n                      <motion.div\r\n                        key={record.id}\r\n                        initial={{ opacity: 0, x: -10 }}\r\n                        animate={{ opacity: 1, x: 0 }}\r\n                        className=\"rounded-xl border border-slate-800/60 bg-slate-900/70 p-3 sm:p-4 hover:bg-slate-900/90 transition-colors\"\r\n                      >\r\n                        <div className=\"flex items-start gap-3 sm:gap-4\">\r\n                          <div className=\"flex h-10 w-10 sm:h-12 sm:w-12 shrink-0 items-center justify-center rounded-xl border border-slate-800/70 bg-slate-900/80\">\r\n                            <RiskIcon size={18} className=\"sm:w-5 sm:h-5 text-emerald-300\" />\r\n                          </div>\r\n                          <div className=\"flex-1 min-w-0\">\r\n                            <div className=\"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2 mb-1\">\r\n                              <span className=\"font-medium text-sm sm:text-base text-gray-200\">\r\n                                {ACTION_LABELS[record.action.type] ?? record.action.type}\r\n                              </span>\r\n                              <span className=\"text-xs text-slate-500\">\r\n                                {formatDistanceToNow(record.timestamp, { addSuffix: true })}\r\n                              </span>\r\n                            </div>\r\n                            <div className=\"text-xs sm:text-sm text-gray-400 mb-2\">{record.action.description}</div>\r\n                            {record.action.target && (\r\n                              <div className=\"text-xs text-slate-500 truncate\" title={record.action.target}>\r\n                                {record.action.target}\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                          <div className=\"flex flex-col items-end gap-2\">\r\n                            <span className={`inline-flex items-center gap-1.5 rounded-full border px-2 sm:px-2.5 py-1 text-xs ${status.tone}`}>\r\n                              <StatusIcon size={12} />\r\n                              <span className=\"hidden sm:inline\">{status.label}</span>\r\n                            </span>\r\n                            {record.revokedAt && (\r\n                              <span className=\"text-xs text-red-400\">\r\n                                Revoked {formatDistanceToNow(record.revokedAt, { addSuffix: true })}\r\n                              </span>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                      </motion.div>\r\n                    );\r\n                  })}\r\n                </div>\r\n              </section>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n","import { ConsentTimelineView } from '../components/Consent/ConsentTimelineView';\r\n\r\nexport default function ConsentTimeline() {\r\n  return <ConsentTimelineView />;\r\n}\r\n\r\n"],"names":["ACTION_LABELS","ConsentTimelineView","consentTimeline","refresh","loading","useTrustDashboardStore","useEffect","interval","groupedTimeline","useMemo","groups","now","oneHour","oneDay","record","age","group","label","items","b","jsx","jsxs","Shield","Clock","status","XCircle","ShieldCheck","RiskIcon","AlertTriangle","ShieldAlert","CheckCircle2","StatusIcon","motion","formatDistanceToNow","ConsentTimeline"],"mappings":"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"}