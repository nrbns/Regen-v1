import{l as s}from"./mode-research-BclgCwOH.js";import{a as p,b as c}from"./core-ai-yFIunLTZ.js";import{authService as n}from"./auth-Cg8cvnkf.js";import"./vendor-react-gmX1Lmvt.js";import"./vendor-react-dom-Bkb6jJ_S.js";import"./vendor-Vl2WtvH-.js";import"./vendor-utils-5Vdoy44w.js";import"./core-memory-DmK-uh9X.js";import"./mode-docs-FcsoolLb.js";import"./vendor-pdf-ejcqEZLU.js";import"./vendor-mammoth-BPQIafDs.js";import"./vendor-framer-motion-DDE19Uim.js";import"./vendor-zustand-BWsgwsXr.js";import"./mode-manager.ts-DwguZmJt.js";var l=Object.defineProperty,m=(t,r,e)=>r in t?l(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e,a=(t,r,e)=>m(t,typeof r!="symbol"?r+"":r,e);class d{constructor(){a(this,"reports",[]),a(this,"enabled",!0),a(this,"maxReports",50)}initialize(){const r=localStorage.getItem("regen_crash_reporting_consent");this.enabled=r==="true",window.addEventListener("error",e=>{this.captureError(e.error||new Error(e.message),{filename:e.filename,lineno:e.lineno,colno:e.colno})}),window.addEventListener("unhandledrejection",e=>{this.captureError(e.reason instanceof Error?e.reason:new Error(String(e.reason)),{})}),s.info("[CrashReporter] Initialized")}captureError(r,e){if(!this.enabled)return;const o={id:`crash-${Date.now()}-${Math.random().toString(36).slice(2,9)}`,error:{message:r.message,stack:r.stack,name:r.name},context:{route:window.location.pathname,mode:c.getState().mode,tabCount:p.getState().tabs.length,timestamp:Date.now(),userAgent:navigator.userAgent,url:window.location.href,...e},user:n.getCurrentUser()?{id:n.getCurrentUser().id}:void 0,environment:{platform:navigator.platform,version:window.__OMNIBROWSER_VERSION__||"unknown"}};this.reports.push(o),this.reports.length>this.maxReports&&(this.reports=this.reports.slice(-this.maxReports)),s.error("[CrashReporter] Error captured:",o),this.sendReport(o).catch(i=>{s.error("[CrashReporter] Failed to send report:",i)})}async sendReport(r){try{s.info("[CrashReporter] Would send report:",r.id);const e=localStorage.getItem("regen_crash_reports"),o=e?JSON.parse(e):[];o.push(r),localStorage.setItem("regen_crash_reports",JSON.stringify(o.slice(-10)))}catch(e){s.error("[CrashReporter] Failed to send report:",e)}}isEnabled(){return this.enabled}setEnabled(r){this.enabled=r,localStorage.setItem("regen_crash_reporting_consent",String(r)),s.info("[CrashReporter]",r?"Enabled":"Disabled")}getStoredReports(){try{const r=localStorage.getItem("regen_crash_reports");return r?JSON.parse(r):[]}catch{return[]}}clearStoredReports(){localStorage.removeItem("regen_crash_reports"),this.reports=[]}}const v=new d;export{v as crashReporter};
//# sourceMappingURL=crash-reporting-Dtoe4cFC.js.map
