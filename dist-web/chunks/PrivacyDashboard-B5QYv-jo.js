import{r as c,j as s,T as f,o as v,bk as x,bj as p,e as y,b2 as m}from"./vendor-react-gmX1Lmvt.js";import{m as b}from"./vendor-framer-motion-DDE19Uim.js";var w=Object.defineProperty,k=(l,e,t)=>e in l?w(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t,u=(l,e,t)=>k(l,typeof e!="symbol"?e+"":e,t);class S{constructor(){u(this,"trustRecords",new Map),u(this,"defaultPolicy",{allowTracking:!1,allowCookies:!0,allowThirdPartyCookies:!1,blockAds:!0,blockTrackers:!0,blockFingerprinting:!0,allowLocation:!1,allowNotifications:!1,allowCamera:!1,allowMicrophone:!1})}getTrustLevel(e){const t=this.trustRecords.get(e);return t?t.trustLevel:"neutral"}setTrustLevel(e,t){const r=this.trustRecords.get(e),a={domain:e,trustLevel:t,lastUpdated:Date.now(),visitCount:(r?.visitCount||0)+1,privacyScore:this.calculatePrivacyScore(t),violations:r?.violations||[]};this.trustRecords.set(e,a),this.saveToStorage()}getPrivacyPolicy(e){const t=this.getTrustLevel(e),r={...this.defaultPolicy};return t==="trusted"?(r.allowTracking=!0,r.allowThirdPartyCookies=!0,r.blockAds=!1,r.blockTrackers=!1):(t==="untrusted"||t==="blocked")&&(r.allowTracking=!1,r.allowThirdPartyCookies=!1,r.blockAds=!0,r.blockTrackers=!0,r.blockFingerprinting=!0),r}async auditPrivacy(e){if(typeof window<"u"&&window.__TAURI__)try{return await window.__TAURI__.invoke("privacy_audit",{domain:e})}catch(t){console.error("[TrustControls] Audit failed:",t)}return{domain:e,timestamp:Date.now(),trackers:[],cookies:0,thirdPartyRequests:0,privacyScore:50,recommendations:["Enable tracker blocking","Block third-party cookies"]}}recordViolation(e,t){const r=this.trustRecords.get(e);if(r)r.violations.includes(t)||(r.violations.push(t),r.privacyScore=Math.max(0,r.privacyScore-10),r.trustLevel=this.updateTrustLevelFromScore(r.privacyScore),this.trustRecords.set(e,r),this.saveToStorage());else{const a={domain:e,trustLevel:"untrusted",lastUpdated:Date.now(),visitCount:1,privacyScore:40,violations:[t]};this.trustRecords.set(e,a),this.saveToStorage()}}calculatePrivacyScore(e){switch(e){case"trusted":return 90;case"neutral":return 50;case"untrusted":return 30;case"blocked":return 0;default:return 50}}updateTrustLevelFromScore(e){return e>=80?"trusted":e>=50?"neutral":e>=20?"untrusted":"blocked"}getAllRecords(){return Array.from(this.trustRecords.values())}clearRecords(){this.trustRecords.clear(),this.saveToStorage()}saveToStorage(){if(!(typeof window>"u"))try{const e=Array.from(this.trustRecords.entries());localStorage.setItem("regen:trust-records",JSON.stringify(e))}catch(e){console.error("[TrustControls] Failed to save to storage:",e)}}loadFromStorage(){if(!(typeof window>"u"))try{const e=localStorage.getItem("regen:trust-records");if(e){const t=JSON.parse(e);this.trustRecords=new Map(t)}}catch(e){console.error("[TrustControls] Failed to load from storage:",e)}}getRecommendations(e){const t=this.auditPrivacy(e),r=[];return t.then(a=>{a.trackers.length>0&&r.push("Enable tracker blocking"),a.thirdPartyRequests>10&&r.push("Block third-party requests"),a.cookies>20&&r.push("Clear cookies regularly")}),r}}const i=new S;typeof window<"u"&&i.loadFromStorage();const T={trusted:"text-emerald-400 bg-emerald-500/20 border-emerald-500/40",neutral:"text-blue-400 bg-blue-500/20 border-blue-500/40",untrusted:"text-yellow-400 bg-yellow-500/20 border-yellow-500/40",blocked:"text-red-400 bg-red-500/20 border-red-500/40"},j={trusted:m,neutral:y,untrusted:p,blocked:x};function C(){const[l,e]=c.useState([]),[t,r]=c.useState("");c.useEffect(()=>{i.loadFromStorage(),e(i.getAllRecords())},[]);const a=(o,n)=>{i.setTrustLevel(o,n),e(i.getAllRecords())},h=async o=>{const n=await i.auditPrivacy(o);console.log("[PrivacyDashboard] Audit result:",n)},d=l.filter(o=>o.domain.toLowerCase().includes(t.toLowerCase()));return s.jsxs("div",{className:"flex flex-col gap-4 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-100",children:"Privacy Dashboard"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Manage domain trust levels and privacy settings"})]}),s.jsxs("button",{onClick:()=>{i.clearRecords(),e([])},className:"flex items-center gap-2 rounded-lg border border-red-500/40 bg-red-500/10 px-4 py-2 text-red-400 transition hover:bg-red-500/20",children:[s.jsx(f,{size:16}),"Clear All"]})]}),s.jsxs("div",{className:"relative",children:[s.jsx(v,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"}),s.jsx("input",{type:"text",value:t,onChange:o=>r(o.target.value),placeholder:"Search domains...",className:"w-full rounded-lg border border-neutral-700 bg-neutral-800 py-2 pl-10 pr-4 text-sm text-gray-200 placeholder-gray-500 focus:border-emerald-500 focus:outline-none"})]}),s.jsx("div",{className:"space-y-2",children:d.length===0?s.jsx("div",{className:"py-8 text-center text-gray-400",children:t?"No domains found":"No trust records yet"}):d.map(o=>{const n=j[o.trustLevel];return s.jsxs(b.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex items-center justify-between rounded-lg border border-neutral-700 bg-neutral-800/50 p-4",children:[s.jsxs("div",{className:"flex flex-1 items-center gap-3",children:[s.jsx("div",{className:`rounded-lg border p-2 ${T[o.trustLevel]}`,children:s.jsx(n,{size:20})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium text-gray-200",children:o.domain}),s.jsxs("div",{className:"text-xs text-gray-400",children:["Score: ",o.privacyScore,"/100 â€¢ Visits: ",o.visitCount]}),o.violations.length>0&&s.jsxs("div",{className:"mt-1 text-xs text-red-400",children:[o.violations.length," violation(s)"]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>h(o.domain),className:"rounded border border-neutral-600 bg-neutral-700 px-3 py-1.5 text-xs text-gray-300 transition hover:bg-neutral-600",children:"Audit"}),s.jsxs("select",{value:o.trustLevel,onChange:g=>a(o.domain,g.target.value),className:"rounded border border-neutral-600 bg-neutral-700 px-3 py-1.5 text-xs text-gray-300 focus:border-emerald-500 focus:outline-none",children:[s.jsx("option",{value:"trusted",children:"Trusted"}),s.jsx("option",{value:"neutral",children:"Neutral"}),s.jsx("option",{value:"untrusted",children:"Untrusted"}),s.jsx("option",{value:"blocked",children:"Blocked"})]})]})]},o.domain)})})]})}export{C as P};
//# sourceMappingURL=PrivacyDashboard-B5QYv-jo.js.map
