{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "AI Trading Signal",
  "description": "Schema for AI-generated trading signals with explainability",
  "type": "object",
  "required": ["id", "symbol", "action", "confidence", "entryPrice", "rationale", "modelVersion", "generatedAt"],
  "properties": {
    "id": {
      "type": "string",
      "description": "Unique signal identifier",
      "example": "signal-20250115-143022-aapl-buy-72"
    },
    "symbol": {
      "type": "string",
      "description": "Trading symbol",
      "example": "AAPL"
    },
    "action": {
      "type": "string",
      "enum": ["buy", "sell", "hold", "close"],
      "description": "Recommended action"
    },
    "confidence": {
      "type": "number",
      "minimum": 0,
      "maximum": 100,
      "description": "Confidence score (0-100)",
      "example": 72
    },
    "entryPrice": {
      "type": "number",
      "description": "Recommended entry price",
      "example": 149.50
    },
    "stopLoss": {
      "type": "number",
      "description": "Recommended stop loss price",
      "example": 146.00
    },
    "takeProfit": {
      "type": "number",
      "description": "Recommended take profit price",
      "example": 155.00
    },
    "positionSize": {
      "type": "number",
      "description": "Recommended position size (shares/contracts)",
      "example": 100
    },
    "positionSizeReason": {
      "type": "string",
      "description": "Explanation for position sizing",
      "example": "Based on 2% portfolio risk, ATR of 1.2, and max drawdown of 5%"
    },
    "rationale": {
      "type": "string",
      "description": "Human-readable explanation of the signal",
      "example": "Rising volume (1.5x average) combined with RSI oversold (42) suggests mean reversion opportunity. MACD showing bullish crossover."
    },
    "contributingFactors": {
      "type": "array",
      "description": "Top contributing factors with weights",
      "items": {
        "type": "object",
        "required": ["factor", "weight", "value", "impact"],
        "properties": {
          "factor": {
            "type": "string",
            "description": "Factor name",
            "examples": ["volume_spike", "rsi_oversold", "macd_crossover", "volatility_compression", "news_sentiment"]
          },
          "weight": {
            "type": "number",
            "minimum": 0,
            "maximum": 1,
            "description": "Relative weight of this factor (0-1)"
          },
          "value": {
            "type": "number",
            "description": "Current value of the factor"
          },
          "impact": {
            "type": "string",
            "enum": ["positive", "negative", "neutral"],
            "description": "Impact on signal confidence"
          },
          "description": {
            "type": "string",
            "description": "Human-readable description"
          }
        }
      },
      "example": [
        {
          "factor": "volume_spike",
          "weight": 0.35,
          "value": 1.52,
          "impact": "positive",
          "description": "Volume 1.52x 20-day average indicates strong interest"
        },
        {
          "factor": "rsi_oversold",
          "weight": 0.28,
          "value": 42,
          "impact": "positive",
          "description": "RSI at 42 suggests oversold condition, potential bounce"
        },
        {
          "factor": "macd_crossover",
          "weight": 0.22,
          "value": 0.15,
          "impact": "positive",
          "description": "MACD line crossed above signal line (bullish)"
        }
      ]
    },
    "modelVersion": {
      "type": "string",
      "description": "AI model version identifier",
      "example": "signal-v2.1.3"
    },
    "modelInputs": {
      "type": "object",
      "description": "Snapshot of inputs fed to the model",
      "properties": {
        "ohlcv": {
          "type": "object",
          "properties": {
            "open": { "type": "number" },
            "high": { "type": "number" },
            "low": { "type": "number" },
            "close": { "type": "number" },
            "volume": { "type": "integer" }
          }
        },
        "indicators": {
          "type": "object",
          "properties": {
            "rsi": { "type": "number" },
            "macd": { "type": "number" },
            "macd_signal": { "type": "number" },
            "atr": { "type": "number" },
            "sma_20": { "type": "number" },
            "sma_50": { "type": "number" }
          }
        },
        "marketContext": {
          "type": "object",
          "properties": {
            "volatility": { "type": "number" },
            "spread": { "type": "number" },
            "liquidity": { "type": "string", "enum": ["high", "medium", "low"] }
          }
        }
      }
    },
    "generatedAt": {
      "type": "string",
      "format": "date-time",
      "description": "Timestamp when signal was generated"
    },
    "expiresAt": {
      "type": "string",
      "format": "date-time",
      "description": "Timestamp when signal expires (typically 5-15 minutes)"
    },
    "riskMetrics": {
      "type": "object",
      "description": "Risk assessment for this signal",
      "properties": {
        "maxLoss": {
          "type": "number",
          "description": "Maximum potential loss (stop loss - entry) * quantity"
        },
        "maxGain": {
          "type": "number",
          "description": "Maximum potential gain (take profit - entry) * quantity"
        },
        "riskRewardRatio": {
          "type": "number",
          "description": "Risk/reward ratio"
        },
        "winProbability": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Estimated probability of profit"
        },
        "portfolioRiskPercent": {
          "type": "number",
          "description": "Percentage of portfolio at risk"
        }
      }
    },
    "alternativeScenarios": {
      "type": "array",
      "description": "Alternative market scenarios and outcomes",
      "items": {
        "type": "object",
        "properties": {
          "scenario": {
            "type": "string",
            "examples": ["bullish_breakout", "bearish_reversal", "sideways_consolidation"]
          },
          "probability": {
            "type": "number",
            "minimum": 0,
            "maximum": 1
          },
          "outcome": {
            "type": "string",
            "description": "Expected outcome description"
          },
          "priceTarget": {
            "type": "number",
            "description": "Price target in this scenario"
          }
        }
      }
    }
  }
}

