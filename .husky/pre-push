#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸš« Push to protected branches requires all CI checks to pass"
echo ""

BRANCH=$(git rev-parse --abbrev-ref HEAD)

# Check if pushing to protected branch
if [ "$BRANCH" = "main" ] || [ "$BRANCH" = "develop" ]; then
  echo "âš ï¸  Pushing to protected branch: $BRANCH"
  echo ""
  echo "Required CI checks:"
  echo "  âœ“ Lint & Type Check"
  echo "  âœ“ Format Check"
  echo "  âœ“ Unit Tests"
  echo "  âœ“ Integration Tests"
  echo "  âœ“ Security Scans"
  echo "  âœ“ Build"
  echo "  âœ“ E2E Tests"
  echo "  âœ“ K6 Load Tests"
  echo ""
  echo "âŒ Direct push blocked. Please:"
  echo "  1. Create a PR"
  echo "  2. Wait for CI checks to pass"
  echo "  3. Get approval"
  echo "  4. Merge via PR"
  echo ""
  exit 1
fi

echo "âœ… Push allowed to branch: $BRANCH"
